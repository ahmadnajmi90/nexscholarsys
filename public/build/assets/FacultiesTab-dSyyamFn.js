import{r,a as h,j as e}from"./app-KJq67BEp.js";import{V as c}from"./index-DCAMIVIg.js";import O from"./FacultyFormModal-DNDYJdx5.js";import I from"./ConfirmationModal-xSdsBU4L.js";import{d as T,F as L,p as Q,q as V}from"./index-dgbq4OcT.js";function H(){const[v,N]=r.useState([]),[d,f]=r.useState([]),[y,b]=r.useState(!0),[u,_]=r.useState(""),[n,w]=r.useState(""),[s,o]=r.useState({current_page:1,per_page:10,total:0,last_page:1}),[F,p]=r.useState(!1),[S,m]=r.useState(!1),[l,x]=r.useState(null),[k,j]=r.useState("create");r.useEffect(()=>{C()},[]),r.useEffect(()=>{n?g():f([])},[n,s.current_page,u]);const C=async()=>{try{const t=await h.get("/api/v1/universities",{params:{per_page:100}});N(t.data.data)}catch(t){console.error("Error fetching universities:",t),c.error("Failed to load universities")}},g=async()=>{if(n){b(!0);try{const t=await h.get("/api/v1/faculties",{params:{university_id:n,page:s.current_page,per_page:s.per_page,search:u||void 0,with_university:!0}});f(t.data.data),o({current_page:t.data.meta.current_page,per_page:t.data.meta.per_page,total:t.data.meta.total,last_page:t.data.meta.last_page})}catch(t){console.error("Error fetching faculties:",t),c.error("Failed to load faculties")}finally{b(!1)}}},M=t=>{w(t.target.value),o(a=>({...a,current_page:1}))},i=t=>{o(a=>({...a,current_page:t}))},E=t=>{t.preventDefault(),o(a=>({...a,current_page:1}))},D=()=>{x(null),j("create"),p(!0)},P=t=>{x(t),j("edit"),p(!0)},U=t=>{x(t),m(!0)},$=async()=>{if(l)try{await h.delete(`/api/v1/faculties/${l.id}`),c.success("Faculty deleted successfully!"),g()}catch(t){console.error("Error deleting faculty:",t),t.response&&t.response.status===409?c.error(t.response.data.message||"Cannot delete faculty with existing users"):c.error("Failed to delete faculty")}finally{m(!1)}},A=()=>{p(!1),g()};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Faculties"}),e.jsxs("button",{onClick:D,className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",disabled:!n,children:[e.jsx(T,{className:"mr-2"})," Add Faculty"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"university",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select University"}),e.jsxs("select",{id:"university",value:n,onChange:M,className:"block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select a university"}),v.map(t=>e.jsx("option",{value:t.id,children:t.full_name},t.id))]})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6",children:e.jsxs("form",{onSubmit:E,className:"flex",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(L,{className:"text-gray-400"})}),e.jsx("input",{type:"text",value:u,onChange:t=>_(t.target.value),placeholder:"Search faculties...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsx("button",{type:"submit",className:"ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Search"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Academicians"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Postgraduates"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Undergraduates"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center",children:"Loading..."})}):d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center",children:"No faculties found"})}):d.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.academicians_count||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.postgraduates_count||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.undergraduates_count||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsxs("button",{onClick:()=>P(t),className:"text-blue-600 hover:text-blue-900 mr-4",children:[e.jsx(Q,{className:"inline"})," Edit"]}),e.jsxs("button",{onClick:()=>U(t),className:"text-red-600 hover:text-red-900",children:[e.jsx(V,{className:"inline"})," Delete"]})]})]},t.id))})]})}),!y&&d.length>0&&e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 mt-4",children:[e.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>i(s.current_page-1),disabled:s.current_page===1,className:`relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 ${s.current_page===1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Previous"}),e.jsx("button",{onClick:()=>i(s.current_page+1),disabled:s.current_page===s.last_page,className:`relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 ${s.current_page===s.last_page?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(s.current_page-1)*s.per_page+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(s.current_page*s.per_page,s.total)})," ","of ",e.jsx("span",{className:"font-medium",children:s.total})," results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>i(s.current_page-1),disabled:s.current_page===1,className:`relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ${s.current_page===1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:[e.jsx("span",{className:"sr-only",children:"Previous"}),"←"]}),[...Array(s.last_page).keys()].map(t=>{const a=t+1;return a===1||a===s.last_page||Math.abs(a-s.current_page)<=1?e.jsx("button",{onClick:()=>i(a),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${a===s.current_page?"bg-blue-600 text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:outline-offset-0"}`,children:a},a):a===2&&s.current_page>3||a===s.last_page-1&&s.current_page<s.last_page-2?e.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700",children:"..."},a):null}),e.jsxs("button",{onClick:()=>i(s.current_page+1),disabled:s.current_page===s.last_page,className:`relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ${s.current_page===s.last_page?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:[e.jsx("span",{className:"sr-only",children:"Next"}),"→"]})]})})]})]})]}),e.jsx(O,{isOpen:F,onClose:A,faculty:l,universityId:n||null,mode:k}),e.jsx(I,{isOpen:S,title:"Delete Faculty",message:`Are you sure you want to delete ${l==null?void 0:l.name}? This action cannot be undone.`,onConfirm:$,onCancel:()=>m(!1)})]})}export{H as default};
