import{r as o,j as e,Y as y,b as f}from"./app-DQ4-jIOt.js";import{R as j}from"./quill.snow-RlLQOO7y.js";const w=({isOpen:i})=>i?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Sending Email..."}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Please wait while your email is being sent."})]})}):null;function k({auth:i,to:u,replyTo:h}){const[n,c]=o.useState([]),[m,d]=o.useState(!1),[r,x]=o.useState({to:u,subject:"",message:""}),g=async l=>{l.preventDefault(),d(!0);const s=new FormData;s.append("to",r.to),s.append("subject",r.subject),s.append("message",r.message),n.length>0&&(console.log("Number of attachments:",n.length),n.forEach((t,a)=>{console.log(`Attaching file ${a+1}:`,{name:t.name,size:t.size,type:t.type}),s.append(`attachments[${a}]`,t)})),console.log("FormData entries:");for(let[t,a]of s.entries())a instanceof File?console.log(`${t}: File: ${a.name} (${a.size} bytes)`):console.log(`${t}: ${a}`);try{const a=await(await fetch("/email/send",{method:"POST",body:s,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"},credentials:"same-origin"})).json();if(a.success)console.log("Email sent successfully:",a),window.alert(a.message||"Email sent successfully!"),console.log("Alert shown, navigating back..."),window.history.back();else throw new Error(a.message||"Failed to send email")}catch(t){console.error("Error sending email:",t),window.alert(t.message||"Failed to send email. Please try again.")}finally{d(!1)}},p=l=>{const s=Array.from(l.target.files);console.log("Files selected:",s.map(t=>({name:t.name,size:t.size,type:t.type}))),c(t=>[...t,...s])},b=l=>{c(s=>s.filter((t,a)=>a!==l))};return e.jsxs(e.Fragment,{children:[e.jsx(y,{title:"Compose Email"}),e.jsx(w,{isOpen:m}),e.jsx("div",{className:"relative min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-8 pb-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-4 sm:px-6 py-5 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Compose Message"}),e.jsx(f,{onClick:()=>window.history.back(),className:"flex items-center justify-center w-8 h-8 bg-gray-100 text-gray-600 rounded-full hover:bg-gray-200 transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("form",{onSubmit:g,className:"p-4 sm:p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"To:"}),e.jsx("input",{type:"email",value:r.to,readOnly:!0,className:"mt-1 w-full rounded-lg border-gray-300 p-3 sm:p-4 text-base shadow-sm bg-gray-50 cursor-not-allowed text-gray-700",placeholder:"Recipient Email"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reply-To:"}),e.jsx("input",{type:"email",value:h,readOnly:!0,className:"mt-1 w-full rounded-lg border-gray-300 p-3 sm:p-4 text-base shadow-sm bg-gray-50 cursor-not-allowed text-gray-700",placeholder:"Reply Email Address"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subject:"}),e.jsx("input",{type:"text",value:r.subject,onChange:l=>x(s=>({...s,subject:l.target.value})),className:"mt-1 w-full rounded-lg border-gray-300 p-3 sm:p-4 text-base shadow-sm",placeholder:"Enter Email Subject",required:!0,autoFocus:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Message:"}),e.jsx("div",{className:"mt-1 lg:min-h-[300px] md:min-h-[300px] min-h-[320px]",children:e.jsx(j,{theme:"snow",value:r.message,onChange:l=>x(s=>({...s,message:l})),placeholder:"Type your message here...",style:{height:"250px",maxHeight:"400px"},className:"rounded-lg border-gray-300"})})]}),e.jsx("div",{className:"border-t border-gray-200 my-2"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Attachments:"}),e.jsx("input",{type:"file",onChange:p,multiple:!0,className:`block w-full text-sm text-gray-500
                                            file:mr-4 file:py-2 file:px-4
                                            file:rounded-full file:border-0
                                            file:text-sm file:font-semibold
                                            file:bg-blue-50 file:text-blue-700
                                            hover:file:bg-blue-100`}),n.length>0&&e.jsx("div",{className:"mt-3 space-y-2 max-h-40 overflow-y-auto",children:n.map((l,s)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[e.jsxs("span",{className:"text-sm text-gray-600 truncate max-w-[calc(100%-2rem)]",children:[l.name," (",(l.size/1024/1024).toFixed(2)," MB)"]}),e.jsx("button",{type:"button",onClick:()=>b(s),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},s))})]}),e.jsx("div",{className:"border-t border-gray-200 my-2"}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{type:"submit",disabled:m,className:"w-full sm:w-auto bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center space-x-2 disabled:opacity-50 font-medium",children:[e.jsx("span",{children:"Send"}),e.jsx("svg",{className:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})]})})]})})]})})})]})}export{k as default};
