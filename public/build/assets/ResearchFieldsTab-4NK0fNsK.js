import{r as t,a as f,j as s}from"./app-KJq67BEp.js";import{V as n}from"./index-DCAMIVIg.js";import re from"./FieldOfResearchFormModal-ehrSwCfm.js";import te from"./ResearchAreaFormModal-Boo5hgmq.js";import le from"./NicheDomainFormModal-CbV48hvQ.js";import C from"./ConfirmationModal-xSdsBU4L.js";import{d as S,F as k,p as A,q as M}from"./index-dgbq4OcT.js";function he(){const[E,T]=t.useState([]),[_,R]=t.useState([]),[$,O]=t.useState([]),[g,m]=t.useState({fields:!0,areas:!1,domains:!1}),[l,P]=t.useState(null),[o,p]=t.useState(null),[i,L]=t.useState({fields:"",areas:"",domains:""}),[u,r]=t.useState({fieldForm:!1,areaForm:!1,domainForm:!1,fieldDelete:!1,areaDelete:!1,domainDelete:!1}),[d,b]=t.useState(null),[c,y]=t.useState(null),[h,j]=t.useState(null),[v,x]=t.useState({field:"create",area:"create",domain:"create"});t.useEffect(()=>{N()},[i.fields]),t.useEffect(()=>{l?F():(R([]),p(null))},[l,i.areas]),t.useEffect(()=>{o?w():O([])},[o,i.domains]);const N=async()=>{m(e=>({...e,fields:!0}));try{const e=await f.get("/api/v1/fields-of-research",{params:{per_page:100,search:i.fields||void 0}});T(e.data.data)}catch(e){console.error("Error fetching fields of research:",e),n.error("Failed to load fields of research")}finally{m(e=>({...e,fields:!1}))}},F=async()=>{if(l){m(e=>({...e,areas:!0}));try{const e=await f.get("/api/v1/research-areas",{params:{field_of_research_id:l.id,per_page:100,search:i.areas||void 0}});R(e.data.data)}catch(e){console.error("Error fetching research areas:",e),n.error("Failed to load research areas")}finally{m(e=>({...e,areas:!1}))}}},w=async()=>{if(o){m(e=>({...e,domains:!0}));try{const e=await f.get("/api/v1/niche-domains",{params:{research_area_id:o.id,per_page:100,search:i.domains||void 0}});O(e.data.data)}catch(e){console.error("Error fetching niche domains:",e),n.error("Failed to load niche domains")}finally{m(e=>({...e,domains:!1}))}}},I=e=>{P(e),p(null)},Q=e=>{p(e)},D=(e,a)=>{L(ae=>({...ae,[e]:a}))},V=()=>{b(null),x(e=>({...e,field:"create"})),r(e=>({...e,fieldForm:!0}))},q=e=>{b(e),x(a=>({...a,field:"edit"})),r(a=>({...a,fieldForm:!0}))},H=e=>{b(e),r(a=>({...a,fieldDelete:!0}))},z=()=>{r(e=>({...e,fieldForm:!1})),N()},B=async()=>{if(d)try{await f.delete(`/api/v1/fields-of-research/${d.id}`),n.success("Field of research deleted successfully!"),N(),l&&l.id===d.id&&P(null)}catch(e){console.error("Error deleting field of research:",e),e.response&&e.response.status===409?n.error(e.response.data.message||"Cannot delete field with existing research areas"):n.error("Failed to delete field of research")}finally{r(e=>({...e,fieldDelete:!1}))}},G=()=>{y(null),x(e=>({...e,area:"create"})),r(e=>({...e,areaForm:!0}))},J=e=>{y(e),x(a=>({...a,area:"edit"})),r(a=>({...a,areaForm:!0}))},K=e=>{y(e),r(a=>({...a,areaDelete:!0}))},U=()=>{r(e=>({...e,areaForm:!1})),F()},W=async()=>{if(c)try{await f.delete(`/api/v1/research-areas/${c.id}`),n.success("Research area deleted successfully!"),F(),o&&o.id===c.id&&p(null)}catch(e){console.error("Error deleting research area:",e),e.response&&e.response.status===409?n.error(e.response.data.message||"Cannot delete area with existing niche domains"):n.error("Failed to delete research area")}finally{r(e=>({...e,areaDelete:!1}))}},X=()=>{j(null),x(e=>({...e,domain:"create"})),r(e=>({...e,domainForm:!0}))},Y=e=>{j(e),x(a=>({...a,domain:"edit"})),r(a=>({...a,domainForm:!0}))},Z=e=>{j(e),r(a=>({...a,domainDelete:!0}))},ee=()=>{r(e=>({...e,domainForm:!1})),w()},se=async()=>{if(h)try{await f.delete(`/api/v1/niche-domains/${h.id}`),n.success("Niche domain deleted successfully!"),w()}catch(e){console.error("Error deleting niche domain:",e),n.error("Failed to delete niche domain")}finally{r(e=>({...e,domainDelete:!1}))}};return s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Research Fields Hierarchy"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Fields of Research"}),s.jsxs("button",{onClick:V,className:"inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",children:[s.jsx(S,{className:"mr-1"})," Add"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(k,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:i.fields,onChange:e=>D("fields",e.target.value),placeholder:"Search fields...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:g.fields?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):E.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No fields found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:E.map(e=>s.jsxs("li",{className:`py-3 px-2 cursor-pointer hover:bg-gray-50 ${l&&l.id===e.id?"bg-blue-50":""}`,onClick:()=>I(e),children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:a=>{a.stopPropagation(),q(e)},className:"text-blue-600 hover:text-blue-900",children:s.jsx(A,{})}),s.jsx("button",{onClick:a=>{a.stopPropagation(),H(e)},className:"text-red-600 hover:text-red-900",children:s.jsx(M,{})})]})]}),s.jsxs("span",{className:"block text-xs text-gray-500",children:[e.research_areas_count||0," research areas"]})]},e.id))})})]}),s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Research Areas"}),s.jsxs("button",{onClick:G,className:"inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",disabled:!l,children:[s.jsx(S,{className:"mr-1"})," Add"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(k,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:i.areas,onChange:e=>D("areas",e.target.value),placeholder:"Search areas...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",disabled:!l})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:l?g.areas?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):_.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No research areas found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:_.map(e=>s.jsxs("li",{className:`py-3 px-2 cursor-pointer hover:bg-gray-50 ${o&&o.id===e.id?"bg-blue-50":""}`,onClick:()=>Q(e),children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:a=>{a.stopPropagation(),J(e)},className:"text-blue-600 hover:text-blue-900",children:s.jsx(A,{})}),s.jsx("button",{onClick:a=>{a.stopPropagation(),K(e)},className:"text-red-600 hover:text-red-900",children:s.jsx(M,{})})]})]}),s.jsxs("span",{className:"block text-xs text-gray-500",children:[e.niche_domains_count||0," niche domains"]})]},e.id))}):s.jsx("p",{className:"text-center py-4 text-gray-500",children:"Select a field to view research areas"})})]}),s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Niche Domains"}),s.jsxs("button",{onClick:X,className:"inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",disabled:!o,children:[s.jsx(S,{className:"mr-1"})," Add"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(k,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:i.domains,onChange:e=>D("domains",e.target.value),placeholder:"Search domains...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",disabled:!o})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:o?g.domains?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):$.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No niche domains found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:$.map(e=>s.jsx("li",{className:"py-3 px-2 hover:bg-gray-50",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>Y(e),className:"text-blue-600 hover:text-blue-900",children:s.jsx(A,{})}),s.jsx("button",{onClick:()=>Z(e),className:"text-red-600 hover:text-red-900",children:s.jsx(M,{})})]})]})},e.id))}):s.jsx("p",{className:"text-center py-4 text-gray-500",children:"Select a research area to view niche domains"})})]})]}),s.jsx(re,{isOpen:u.fieldForm,onClose:z,field:d,mode:v.field}),s.jsx(te,{isOpen:u.areaForm,onClose:U,area:c,fieldId:l?l.id:null,mode:v.area}),s.jsx(le,{isOpen:u.domainForm,onClose:ee,domain:h,areaId:o?o.id:null,mode:v.domain}),s.jsx(C,{isOpen:u.fieldDelete,title:"Delete Field of Research",message:`Are you sure you want to delete "${d==null?void 0:d.name}"? This action cannot be undone.`,onConfirm:B,onCancel:()=>r(e=>({...e,fieldDelete:!1}))}),s.jsx(C,{isOpen:u.areaDelete,title:"Delete Research Area",message:`Are you sure you want to delete "${c==null?void 0:c.name}"? This action cannot be undone.`,onConfirm:W,onCancel:()=>r(e=>({...e,areaDelete:!1}))}),s.jsx(C,{isOpen:u.domainDelete,title:"Delete Niche Domain",message:`Are you sure you want to delete "${h==null?void 0:h.name}"? This action cannot be undone.`,onConfirm:se,onCancel:()=>r(e=>({...e,domainDelete:!1}))})]})}export{he as default};
