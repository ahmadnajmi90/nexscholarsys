import{W as M,j as e,b as T,r as x,q as J,y as a}from"./app-iMgHp_eS.js";import{G as ke,L as ye,M as ve}from"./MainLayout-BZ9qQRI7.js";import{T as Ne}from"./TextInput-PMIHhHcg.js";import{I as $,a as _}from"./InputError-BMVSv-U-.js";import{P as G}from"./PrimaryButton-DP4M3mkB.js";import{S as K}from"./SecondaryButton-BSeKTz41.js";import{V as j,c as w}from"./index---wvTow-.js";import{M as Ce}from"./Modal-CtrNcR4a.js";import{S as De}from"./react-select.esm-6ABf47Ml.js";import{M as Se}from"./ManageCollaboratorsModal-CdLplFmv.js";import{C as R}from"./ConfirmationModal-C_8An4hm.js";import"./purify.es-9JUW7zMc.js";import{C as Ge,a as We,b as Ee}from"./collapsible-7drI9qMI.js";import{B as C}from"./button-Ct11kXcH.js";import{c as Pe,d as Ae,D as Me,j as Oe,k as Fe}from"./core.esm-eYGPNMRF.js";import{S as $e,a as _e,b as Ie,c as Te,d as H}from"./select-BXNqCCbm.js";import{C as Le}from"./chevron-down-LlZn8pLr.js";import{C as ze}from"./chevron-right-I-HzKVbz.js";import{F as I}from"./folder-open-ChjFwgTU.js";import{c as Q}from"./createLucideIcon-BXdi-pyk.js";import{T as L}from"./trash-2-aKutZ3MS.js";import{D as X,a as ee,b as re,c as se,e as oe}from"./dialog-CvesY_b2.js";import{I as te}from"./input-CdYr2Bcx.js";import{L as ae}from"./label-DMRicobw.js";import{A as Ye,a as Be,b as Ve,c as Ue,d as qe,e as Re,f as He,g as Ze}from"./alert-dialog-DTA1zc-v.js";import{U as Je}from"./users-B-SRuXWr.js";import{P as Ke}from"./plus-DMt_FYHM.js";import{B as F}from"./briefcase-DV5twO-B.js";import"./house-BKiqbpiZ.js";import"./zap-nfA3yaWI.js";import"./settings-C1-Fh3R5.js";import"./useRoles-B2_ZtqZN.js";import"./chevron-left-Doetd6kK.js";import"./proxy-C4MdbyQL.js";import"./user-round-4L2MoMDj.js";import"./clipboard-list-DdyUkn_-.js";import"./dollar-sign-B8d8tr0D.js";import"./calendar-D8qiMF9A.js";import"./file-text-C4_We7ct.js";import"./message-square-6J3gYpZ9.js";import"./graduation-cap-Cm3VtJAw.js";import"./building-1Tspi58Y.js";import"./Dropdown-CqwMmC7a.js";import"./transition-GCCCemnQ.js";import"./sparkles-DUShLJ3x.js";import"./bookmark-3wtOc-_d.js";import"./folder-kanban-Bflve8F-.js";import"./building-2-Dg3QJa8P.js";import"./database-D3pYEDtY.js";import"./shield-BiBcY61c.js";import"./index-BQ_UROI9.js";import"./analytics-BQ374C1C.js";import"./iconBase-DNAnfLIv.js";import"./index-B-2HQZRs.js";import"./supervisionConstants-BuM5-H5X.js";import"./utils-CBfrqCZ4.js";import"./ThreadPane-CINILE3j.js";import"./scroll-area-Q_LSXepR.js";import"./index-CBiZf16v.js";import"./index-CPRTWrZv.js";import"./index-ZtdpDmOR.js";import"./index-DGrGDkv0.js";import"./index-BRZqG0or.js";import"./index-BdQq_4o_.js";import"./format-BOijCLBA.js";import"./en-US-DIdCsyf3.js";import"./dialog-tgbUGkxp.js";import"./download-DxUHOtTV.js";import"./x-ZEpUl_jb.js";import"./isSameDay-BHs4V-zU.js";import"./constructNow-6bIQB1GK.js";import"./addDays-KHeCUDUr.js";import"./search-cbBBwD34.js";import"./circle-check-big-BORgBAPo.js";import"./tooltip-D0CFLqml.js";import"./index-B_K2CkPG.js";import"./index-CrTPggVb.js";import"./index-BFoK7Kyw.js";import"./floating-ui.dom-D5EC_49c.js";import"./index-Bgv0hvvi.js";import"./index-BF2RFu8G.js";import"./index-BJzUWGlx.js";import"./index-Chjiymov.js";import"./user-DVj4gD4f.js";import"./info-BFfWr03M.js";import"./triangle-alert-tP59DIQ0.js";import"./index-DsEBhFHQ.js";import"./index-DKGZNE_Q.js";import"./index-TSyOZiO6.js";import"./index-vpnpucSR.js";import"./check-D26Fs7Uc.js";import"./chevron-up-LkcO-j5k.js";import"./index-CUVil98b.js";import"./index-CdJFUDDL.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Xe=Q("FolderPlus",Qe);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],rr=Q("Pen",er);function sr({isOpen:s,onClose:n}){const{data:o,setData:m,post:f,processing:u,errors:d,reset:c}=M({name:"",description:""}),g=p=>{p.preventDefault(),f(route("project-hub.workspaces.store"),{onSuccess:()=>{j.success(`Workspace "${o.name}" created successfully.`),c(),n()},onError:i=>{console.error("Error creating workspace:",i),j.error("Failed to create workspace. Please check the form for errors.")}})};return s?e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:n}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md relative z-10",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Workspace"}),e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx($,{htmlFor:"name",value:"Workspace Name"}),e.jsx(Ne,{id:"name",type:"text",className:"mt-1 block w-full",value:o.name,onChange:p=>m("name",p.target.value),required:!0}),e.jsx(_,{message:d.name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx($,{htmlFor:"description",value:"Description (Optional)"}),e.jsx("textarea",{id:"description",className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",value:o.description,onChange:p=>m("description",p.target.value),rows:"3"}),e.jsx(_,{message:d.description,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(K,{onClick:n,disabled:u,children:"Cancel"}),e.jsx(G,{type:"submit",disabled:u,children:u?"Creating...":"Create Workspace"})]})]})]})]}):null}function or({show:s,onClose:n,linkableProjects:o=[]}){const{data:m,setData:f,post:u,processing:d,errors:c,reset:g}=M({post_project_id:""}),p=i=>{i.preventDefault(),u(route("project-hub.projects.store"),{preserveScroll:!0,onSuccess:h=>{const y=o.find(v=>v.id===m.post_project_id),D=y?y.title:"Project";j.success(`Project "${D}" created successfully.`),g(),n()},onError:h=>{console.error("Error creating project:",h),j.error("Failed to create project. Please check the form for errors.")}})};return e.jsx(Ce,{show:s,onClose:n,maxWidth:"md",children:e.jsxs("form",{onSubmit:p,className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create Workspace from Project"}),e.jsxs("div",{className:"mb-6",children:[e.jsx($,{htmlFor:"post_project_id",value:"Select a Project to Create a Workspace For",className:"mb-2"}),o.length>0?e.jsxs(e.Fragment,{children:[e.jsx(De,{id:"post_project_id",options:o.map(i=>({value:i.id,label:i.title})),onChange:i=>f("post_project_id",i?i.value:""),className:"w-full",classNamePrefix:"select",placeholder:"Select a project...",required:!0}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"The workspace will inherit the title and description from the selected project."})]}):e.jsxs("div",{className:"text-amber-600 py-4 px-3 bg-amber-50 border border-amber-200 rounded-md",children:[e.jsx("p",{className:"mb-3",children:"You don't have any projects available for linking. Please create a project first."}),e.jsx(T,{href:route("post-projects.create"),className:"inline-flex items-center px-4 py-2 bg-amber-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-amber-700 focus:bg-amber-700 active:bg-amber-900 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 transition ease-in-out duration-150",children:"Create Project"})]}),e.jsx(_,{message:c.post_project_id,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx(K,{onClick:n,className:"mr-2",children:"Cancel"}),e.jsx(G,{type:"submit",disabled:d||o.length===0,children:"Create Workspace"})]})]})})}function Z({group:s,workspaces:n=[],isUngrouped:o=!1,allGroups:m=[],onEdit:f,onDelete:u}){const[d,c]=x.useState(!0),g=Array.isArray(n)?n:n?.data||[],{setNodeRef:p,isOver:i}=Pe({id:o?"ungrouped":`group-${s?.id}`,data:{type:"group",groupId:o?null:s?.id,isUngrouped:o}});return e.jsxs(Ge,{open:d,onOpenChange:c,className:"border rounded-lg bg-white shadow-sm",children:[e.jsxs(We,{className:"flex items-center justify-between w-full p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors rounded-t-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[d?e.jsx(Le,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}):e.jsx(ze,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),e.jsx(I,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:o?"Ungrouped":s.name}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",g.length,")"]})]}),!o&&e.jsxs("div",{className:"flex items-center gap-2",onClick:h=>h.stopPropagation(),children:[e.jsx(C,{variant:"ghost",size:"sm",onClick:()=>f(s),className:"h-8 w-8 p-0",children:e.jsx(rr,{className:"w-4 h-4"})}),e.jsx(C,{variant:"ghost",size:"sm",onClick:()=>u(s),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(L,{className:"w-4 h-4"})})]})]}),e.jsx(Ee,{children:e.jsx("div",{ref:p,className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4 transition-colors ${i?"bg-blue-50 dark:bg-blue-900/20":""}`,children:g.length===0?e.jsx("div",{className:"col-span-full text-center py-8 text-gray-500 dark:text-gray-400",children:i?"Drop workspace here":"No workspaces in this group"}):g.map(h=>e.jsx(tr,{workspace:h,allGroups:m,currentGroupId:o?null:s?.id},h.id))})})]})}function tr({workspace:s,allGroups:n,currentGroupId:o}){const{auth:m}=J().props,{attributes:f,listeners:u,setNodeRef:d,transform:c,isDragging:g}=Ae({id:`workspace-${s.id}`,data:{type:"workspace",workspace:s}}),p=c?{transform:`translate3d(${c.x}px, ${c.y}px, 0)`}:void 0,h=(s.owner?.academician||s.owner?.postgraduate||s.owner?.undergraduate)?.full_name||s.owner?.name||"Unknown",y=m.user.id===s.owner_id?"You":h,D=m.user.id===s.owner_id,v=()=>{confirm(`Delete workspace "${s.name}"? This action cannot be undone and will delete all boards and tasks.`)&&a.delete(route("project-hub.workspaces.destroy",s.id),{preserveScroll:!0,onSuccess:()=>w.success("Workspace deleted successfully"),onError:()=>w.error("Failed to delete workspace")})},W=b=>{const P=b==="ungrouped"?null:b;P===null?a.post(route("project-hub.workspaces.unassign",s.id),{},{preserveScroll:!0,onSuccess:()=>w.success("Workspace moved to ungrouped"),onError:()=>w.error("Failed to move workspace")}):a.post(route("project-hub.workspace-groups.assign",{workspaceGroup:P,workspace:s.id}),{},{preserveScroll:!0,onSuccess:()=>w.success("Workspace moved to group"),onError:()=>w.error("Failed to move workspace")})};return e.jsxs("div",{ref:d,style:p,className:`relative border rounded-lg bg-white dark:bg-gray-800 hover:shadow-md transition-shadow ${g?"opacity-50 shadow-xl":""}`,children:[e.jsx("div",{...u,...f,className:"absolute top-2 left-2 p-1 cursor-move hover:bg-gray-100 dark:hover:bg-gray-700 rounded",title:"Drag to move",children:e.jsx(ke,{className:"w-4 h-4 text-gray-400"})}),D&&e.jsx("button",{onClick:b=>{b.preventDefault(),b.stopPropagation(),v()},className:"absolute top-2 right-2 p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"Delete workspace",children:e.jsx(L,{className:"w-4 h-4"})}),e.jsx(T,{href:route("project-hub.workspaces.show",s.id),className:"block pt-2 pb-3 px-4 pl-10",children:e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mt-1",children:s.name})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 px-4 mb-3",children:[e.jsxs("span",{children:["Owner: ",y]}),e.jsxs("span",{children:[s.members_count||0," members"]})]}),e.jsx("div",{className:"px-4 pb-3",onClick:b=>b.stopPropagation(),children:e.jsxs($e,{value:o?.toString()||"ungrouped",onValueChange:W,children:[e.jsx(_e,{className:"w-full h-8 text-xs",children:e.jsx(Ie,{placeholder:"Move to..."})}),e.jsxs(Te,{children:[e.jsx(H,{value:"ungrouped",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-3 h-3"}),"Ungrouped"]})}),n.map(b=>e.jsx(H,{value:b.id.toString(),children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-3 h-3"}),b.name]})},b.id))]})]})})]})}function ar({isOpen:s,onClose:n}){const{data:o,setData:m,post:f,processing:u,errors:d,reset:c}=M({name:""}),g=p=>{p.preventDefault(),f(route("project-hub.workspace-groups.store"),{onSuccess:()=>{c(),n(),w.success("Group created successfully")},onError:i=>{i.name?w.error(i.name):w.error("Failed to create group")}})};return e.jsx(X,{open:s,onOpenChange:n,children:e.jsxs(ee,{className:"sm:max-w-[425px]",children:[e.jsx(re,{children:e.jsx(se,{children:"Create Workspace Group"})}),e.jsxs("form",{onSubmit:g,children:[e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"name",children:"Group Name"}),e.jsx(te,{id:"name",value:o.name,onChange:p=>m("name",p.target.value),placeholder:"e.g., DSPD1573 Student Groups",className:"w-full",autoFocus:!0}),d.name&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:d.name})]})}),e.jsxs(oe,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:n,disabled:u,children:"Cancel"}),e.jsx(C,{type:"submit",disabled:u||!o.name.trim(),children:u?"Creating...":"Create Group"})]})]})]})})}function nr({isOpen:s,onClose:n,group:o}){const{data:m,setData:f,put:u,processing:d,errors:c,reset:g}=M({name:o?.name||""});x.useEffect(()=>{o&&f("name",o.name)},[o]);const p=i=>{i.preventDefault(),o&&u(route("project-hub.workspace-groups.update",o.id),{preserveScroll:!0,onSuccess:()=>{g(),n(),w.success("Group updated successfully")},onError:h=>{h.name?w.error(h.name):w.error("Failed to update group")}})};return e.jsx(X,{open:s,onOpenChange:n,children:e.jsxs(ee,{className:"sm:max-w-[425px]",children:[e.jsx(re,{children:e.jsx(se,{children:"Edit Workspace Group"})}),e.jsxs("form",{onSubmit:p,children:[e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"name",children:"Group Name"}),e.jsx(te,{id:"name",value:m.name,onChange:i=>f("name",i.target.value),placeholder:"e.g., DSPD1573 Student Groups",className:"w-full",autoFocus:!0}),c.name&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:c.name})]})}),e.jsxs(oe,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:n,disabled:d,children:"Cancel"}),e.jsx(C,{type:"submit",disabled:d||!m.name.trim(),children:d?"Updating...":"Update Group"})]})]})]})})}function lr({isOpen:s,onClose:n,group:o}){const m=()=>{o&&a.delete(route("project-hub.workspace-groups.destroy",o.id),{preserveScroll:!0,onSuccess:()=>{n(),w.success("Group deleted successfully. Workspaces moved to ungrouped.")},onError:()=>{w.error("Failed to delete group")}})};return e.jsx(Ye,{open:s,onOpenChange:n,children:e.jsxs(Be,{children:[e.jsxs(Ve,{children:[e.jsx(Ue,{children:"Delete Workspace Group"}),e.jsxs(qe,{children:['Are you sure you want to delete "',o?.name,'"? All workspaces in this group will be moved to ungrouped. This action cannot be undone.']})]}),e.jsxs(Re,{children:[e.jsx(He,{children:"Cancel"}),e.jsx(Ze,{onClick:m,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:"Delete"})]})]})})}function cr({workspaceGroups:s=[],ungroupedWorkspaces:n=[],workspaces:o,projects:m,linkableProjects:f,connections:u}){Array.isArray(o)||o?.data;const d=Array.isArray(m)?m:m?.data||[],{auth:c}=J().props,[g,p]=x.useState(!1),[i,h]=x.useState(!1),[y,D]=x.useState(null),[v,W]=x.useState(null),[b,P]=x.useState(!1),[ne,le]=x.useState(null),[ce,ie]=x.useState(null),[de,z]=x.useState(!1),[pe,Y]=x.useState(!1),[me,B]=x.useState(!1),[V,A]=x.useState(null),S=Array.isArray(s)?s:[],E=Array.isArray(n)?n:n?.data||[],U=c.user.academician!==null;x.useEffect(()=>{if(!window.Echo)return;const r=[];return S.forEach(l=>{(Array.isArray(l.workspaces)?l.workspaces:l.workspaces?.data||[]).forEach(N=>{const k=window.Echo.private(`workspaces.${N.id}`);r.push({id:N.id,type:"workspace",channel:k}),k.listen(".workspace.updated",()=>{console.log("Workspace updated, reloading..."),a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),k.listen(".workspace.deleted",()=>{console.log("Workspace deleted, reloading..."),a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),k.listen(".workspace.member.added",()=>{a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),k.listen(".workspace.member.removed",()=>{a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),k.listen(".board.created",()=>{a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),k.listen(".board.deleted",()=>{a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})})})}),E.forEach(l=>{const t=window.Echo.private(`workspaces.${l.id}`);r.push({id:l.id,type:"workspace",channel:t}),t.listen(".workspace.updated",()=>{a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),t.listen(".workspace.deleted",()=>{a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),t.listen(".workspace.member.added",()=>{a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),t.listen(".workspace.member.removed",()=>{a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),t.listen(".board.created",()=>{a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),t.listen(".board.deleted",()=>{a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})})}),d.forEach(l=>{const t=window.Echo.private(`projects.${l.id}`);r.push({id:l.id,type:"project",channel:t}),t.listen(".project.updated",()=>{a.reload({only:["projects"]})}),t.listen(".project.deleted",()=>{a.reload({only:["projects"]})}),t.listen(".project.member.added",()=>{a.reload({only:["projects"]})}),t.listen(".project.member.removed",()=>{a.reload({only:["projects"]})}),t.listen(".board.created",()=>{a.reload({only:["projects"]})}),t.listen(".board.deleted",()=>{a.reload({only:["projects"]})})}),()=>{r.forEach(({id:l,type:t})=>{window.Echo.leave(`${t}s.${l}`)})}},[S.length,E.length,d.length]),x.useEffect(()=>{if(!window.Echo||!c.user.id)return;const r=window.Echo.private(`App.Models.User.${c.user.id}`);return r.listen(".workspace.member.added",l=>{const t=l.workspace?.name||"a workspace";j.success(`You were added to ${t}`),a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),r.listen(".project.member.added",l=>{const t=l.project?.name||"a project";j.success(`You were added to ${t}`),a.reload({only:["projects"]})}),r.listen(".board.member.added",l=>{const t=l.board?.name||"a board",N=l.parent?.name||"";j.success(`You were added to board "${t}"${N?` in ${N}`:""}`),a.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces","projects"]})}),()=>{r.stopListening(".workspace.member.added"),r.stopListening(".project.member.added"),r.stopListening(".board.member.added"),window.Echo.leave(`App.Models.User.${c.user.id}`)}},[c.user.id]);const ue=()=>{y&&a.delete(route("project-hub.workspaces.destroy",y.id),{onSuccess:()=>{j.success(`Workspace "${y.name}" deleted successfully.`),D(null)},onError:r=>{console.error("Error deleting workspace:",r),j.error("Failed to delete workspace. Please try again.")}})},he=(r,l)=>{r.preventDefault(),r.stopPropagation(),W(l)},xe=()=>{v&&a.delete(route("project-hub.projects.destroy",v.id),{onSuccess:()=>{j.success(`Project "${v.name}" deleted successfully.`),W(null)},onError:r=>{console.error("Error deleting project:",r),j.error("Failed to delete project. Please try again.")}})},ge=r=>{A(r),Y(!0)},je=r=>{A(r),B(!0)},[q,O]=x.useState(null),fe=r=>{const{active:l}=r;l.data.current?.type==="workspace"&&O(l.data.current.workspace)},we=r=>{const{active:l,over:t}=r;if(!t){O(null);return}if(t.data.current?.type==="group"){const N=l.data.current.workspace.id,k=t.data.current.groupId;k===null?a.post(route("project-hub.workspaces.unassign",N),{},{preserveScroll:!0,onSuccess:()=>j.success("Workspace moved to ungrouped"),onError:()=>j.error("Failed to move workspace")}):a.post(route("project-hub.workspace-groups.assign",{workspaceGroup:k,workspace:N}),{},{preserveScroll:!0,onSuccess:()=>j.success("Workspace moved to group"),onError:()=>j.error("Failed to move workspace")})}O(null)};return e.jsxs("div",{className:"space-y-8 lg:mt-2 mt-20 mb-8",children:[e.jsxs("div",{className:"space-y-6 lg:mx-0 mx-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 pl-2",children:"Your Workspaces"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(C,{variant:"outline",onClick:()=>z(!0),children:[e.jsx(Xe,{className:"w-4 h-4 mr-2"})," New Group"]}),e.jsxs(G,{onClick:()=>p(!0),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"})," New Workspace"]})]})]}),S.length===0&&E.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"mx-auto bg-gray-100 rounded-full w-16 h-16 flex items-center justify-center",children:e.jsx(Je,{className:"w-8 h-8 text-gray-500"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No workspaces yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first workspace to start organizing your projects."}),e.jsxs(G,{onClick:()=>p(!0),children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"})," Create Workspace"]})]}):e.jsxs(Me,{collisionDetection:Oe,onDragStart:fe,onDragEnd:we,children:[e.jsxs("div",{className:"space-y-4",children:[S.map(r=>e.jsx(Z,{group:r,workspaces:r.workspaces,allGroups:S,onEdit:ge,onDelete:je},r.id)),E.length>0&&e.jsx(Z,{isUngrouped:!0,workspaces:E,allGroups:S})]}),e.jsx(Fe,{children:q?e.jsx("div",{className:"p-4 border rounded-lg bg-white shadow-xl opacity-90",children:e.jsx("h3",{className:"font-semibold text-gray-900",children:q.name})}):null})]})]}),e.jsxs("div",{className:"space-y-6 lg:mx-0 mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 pl-2",children:"Your Projects"}),e.jsx("div",{className:"space-x-2",children:U&&e.jsxs(G,{onClick:()=>h(!0),children:[e.jsx(F,{className:"w-4 h-4 mr-2"})," New Project"]})})]}),d.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"mx-auto bg-gray-100 rounded-full w-16 h-16 flex items-center justify-center",children:e.jsx(F,{className:"w-8 h-8 text-gray-500"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No projects yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first project to start organizing your research."}),e.jsx("div",{className:"space-x-2",children:U&&e.jsxs(G,{onClick:()=>h(!0),children:[e.jsx(F,{className:"w-4 h-4 mr-2"})," Create Project"]})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(r=>{const t=(r.owner.academician||r.owner.postgraduate||r.owner.undergraduate)?.full_name||r.owner.name,N=c.user.id===r.owner_id?"You":t,k=c.user.id===r.owner_id;return e.jsxs("div",{className:"relative border rounded-lg bg-white dark:bg-gray-800 hover:shadow-md transition-shadow flex flex-col min-h-[140px]",children:[k&&e.jsx("button",{onClick:be=>he(be,r),className:"absolute top-2 right-2 p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors z-10",title:"Delete project",children:e.jsx(L,{className:"w-4 h-4"})}),e.jsx(T,{href:route("project-hub.projects.show",r.id),className:"block pt-2 px-4 flex-grow",children:e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mt-1 pr-8",children:r.name})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 px-4 pb-4 border-t pt-3 mt-auto",children:[e.jsxs("span",{children:["Owner: ",N]}),e.jsxs("span",{children:[r.members_count||0," members"]})]})]},r.id)})})]}),e.jsx(sr,{isOpen:g,onClose:()=>p(!1)}),e.jsx(or,{show:i,onClose:()=>h(!1),linkableProjects:f||[]}),e.jsx(Se,{show:b,onClose:()=>{P(!1),le(null),ie(null)},context:ne,contextType:ce,connections:u||[]}),e.jsx(R,{show:!!y,onClose:()=>D(null),onConfirm:ue,title:"Delete Workspace",message:y?`Are you sure you want to delete the workspace "${y.name}"? This action cannot be undone and will delete all boards and tasks within this workspace.`:""}),e.jsx(R,{show:!!v,onClose:()=>W(null),onConfirm:xe,title:"Delete Project",message:v?`Are you sure you want to delete the project "${v.name}"? This action cannot be undone and will delete all boards and tasks within this project.`:""}),e.jsx(ar,{isOpen:de,onClose:()=>z(!1)}),e.jsx(nr,{isOpen:pe,onClose:()=>{Y(!1),A(null)},group:V}),e.jsx(lr,{isOpen:me,onClose:()=>{B(!1),A(null)},group:V})]})}cr.layout=s=>e.jsx(ve,{title:"NexLab",children:s,TopMenuOpen:!1});export{cr as default};
