import{r as n,j as e,Y as Pe,a as re,y as De}from"./app-DycluJDi.js";import{M as Ee}from"./MainLayout-B6p5qXtx.js";import{c as Fe}from"./index-CRoFkAwq.js";import{T as $e,a as qe,b as le,c as ie}from"./tabs--JuXotzZ.js";import{C as E,b as H,a as F,c as ne,d as Be}from"./card--WzO-fcI.js";import{B as D}from"./badge-7bhQenKW.js";import{B as A}from"./button-DrpbBg5w.js";import{A as fe,a as je}from"./avatar-DLxWZnV0.js";import"./separator-VuB0UWa5.js";import{A as Ve,a as ze}from"./alert-DSLdBZdj.js";import Le from"./RelationshipDetailModal-B5Tvln1H.js";import Ye from"./SupervisorRelationshipDetailModal-BibDsv5r.js";import He from"./ScheduleMeetingDialog-DxmMlWVk.js";import We from"./UnifiedRequestDetailCard-Bh558qwq.js";import Ge from"./ForceUnbindRequestModal-B2Hmdlhk.js";import Qe from"./UnifiedNotificationModal-JluQ4iu2.js";import Xe from"./RecentActivityPanel-C_vYS6kY.js";import Je from"./UpcomingMeetingsPanel-B5CVUfeB.js";import Ke from"./CoSupervisorSearchModal-6-_jOTbs.js";import Ze from"./CoSupervisorInvitationCard-DlF6zS7M.js";import Oe from"./CoSupervisorInvitationDetailPanel-D9UdiBa4.js";import{l as Ie}from"./logError-D4ezqrCx.js";import{U as es}from"./users-B5watpD6.js";import{U as ce}from"./user-plus-DYe-3CX-.js";import{C as be}from"./calendar-clock-CmwHfodY.js";import{c as ss}from"./createLucideIcon-D0KJwFBT.js";import{C as ts}from"./clipboard-list-BHEDK9c8.js";import{U as as}from"./user-round-D0HJxKcP.js";import{C as rs}from"./clock-3-Dz6ZU_zD.js";import{F as ve}from"./file-text-CM_fgsBl.js";import{C as ls}from"./circle-check-DBw7ke1n.js";import{M as is}from"./message-circle-Ct4Mc-YM.js";import{S as cs}from"./settings-CcnxK-77.js";import{C as ds}from"./circle-x-B0ePoeZ3.js";import{H as ns}from"./history-C-nHJ_-o.js";import{f as de}from"./format-Dv9Rm441.js";import{f as os}from"./formatDistanceToNow-GKXiLTrL.js";import"./house-DuQe23QT.js";import"./zap-DV9Acmiq.js";import"./folder-open-Bgm5Yl-Q.js";import"./useRoles-Ex28E3oj.js";import"./chevron-left-CCTwwUf3.js";import"./proxy-BQWTDGOX.js";import"./dollar-sign-DggTktnR.js";import"./calendar-B99WzEhS.js";import"./message-square-DJV6gM-2.js";import"./graduation-cap-D5C30QRj.js";import"./building-0UgdvqyI.js";import"./Dropdown-YylP5fBo.js";import"./transition-CPF_n0Aj.js";import"./sparkles-BmXWKRKa.js";import"./bookmark-DgZoxyTC.js";import"./folder-kanban-DWpojK_X.js";import"./building-2-D0BlUxRJ.js";import"./database-Bdq9zUMP.js";import"./shield-CJ75fCXR.js";import"./index-D2lR-Ixd.js";import"./analytics-BQ374C1C.js";import"./index-B8HlzDGM.js";import"./iconBase--qfUO0jU.js";import"./supervisionConstants-BuM5-H5X.js";import"./Modal-B5RxEfWL.js";import"./dialog-BhLoydV6.js";import"./PrimaryButton-BmPLB8rg.js";import"./SecondaryButton-BMDFl-bS.js";import"./x-DMdqOVgw.js";import"./chevron-right-Ccsl5LyU.js";import"./search-B-v2ubcP.js";import"./circle-check-big-CCdWVaOD.js";import"./tooltip-Bjh7jqzi.js";import"./index-CQUljECt.js";import"./index-Cyyfgiou.js";import"./index-CjkJyM6P.js";import"./index-TfP-1Own.js";import"./index-DhTYVmtt.js";import"./index-MS7JGIS8.js";import"./floating-ui.dom-eiE65J5j.js";import"./index-DygBQkXJ.js";import"./index-C_G9iF1W.js";import"./index-Bf3MYqwD.js";import"./utils-D-KgF5mV.js";import"./briefcase-B4GBZk0m.js";import"./user-gMN38dzl.js";import"./index-0qH_eg9b.js";import"./index-3QGgbkx-.js";import"./index-D7eWovwz.js";import"./index-CGrAONsN.js";import"./dialog-Bfq9Mh4w.js";import"./index-DFBzGmTk.js";import"./index-BsSxmoif.js";import"./tslib.es6-CmEaCU22.js";import"./scroll-area-DStNuix4.js";import"./index-BdQq_4o_.js";import"./ThreadPane-B59ibpsg.js";import"./AttachmentPreviewModal-o5AETYTO.js";import"./download-BSCvsIuy.js";import"./isSameDay-Dm-A-V7S.js";import"./en-US-DNUEYIb-.js";import"./modalAnimations-CCENKliM.js";import"./supervisionHelpers-EJT0WNFw.js";import"./textarea-CSq6H5gP.js";import"./UnbindRequestModal-Dh6S40t4.js";import"./user-minus-Dy6Dt6Xk.js";import"./triangle-alert-CJCKiVvc.js";import"./loader-circle-DBMiS7kS.js";import"./ResearchTab-DgcBBqsq.js";import"./input-DGTuyCNK.js";import"./plus-DH2wwcTw.js";import"./trash-2-B8Zt6fdt.js";import"./circle-Cf-nDHgh.js";import"./DocumentsTab-BPlP3H6g.js";import"./select-CATK_wLT.js";import"./index-DbGR7Odn.js";import"./chevron-down-CWxqwc3h.js";import"./chevron-up-Ba7z8PNf.js";import"./check-B8VjmKe5.js";import"./DocumentPreviewModal-BpVXpdNe.js";import"./upload-CkFes5p6.js";import"./eye-Dwc4GoVS.js";import"./UnifiedOverviewTab-Hu8ps4s-.js";import"./mail-vd1JXS-x.js";import"./phone-Cz2eoHVX.js";import"./globe-VmxN95cK.js";import"./RelationshipHistoryTab-BiwPbhVH.js";import"./circle-alert-C0Kb6UEK.js";import"./video-BDzp7SjL.js";import"./external-link-C7oBCvIe.js";import"./sticky-note-O8t9pa_K.js";import"./label-DymNAe9a.js";import"./useGoogleCalendar-B8hZgA0d.js";import"./AcceptSupervisorOfferModal-B81_Rofl.js";import"./checkbox-Cy0T5o2F.js";import"./AcceptSupervisionRequestModal-DRywlDI2.js";import"./lightbulb-ClojK8Oe.js";import"./DeclineSupervisionRequestModal-CPNEXl4-.js";import"./RejectUnbindModal-HbW-SPs-.js";import"./clock-CXQ5cZnz.js";import"./arrow-right-CWOFNc3l.js";import"./constructNow-DtVD-0hX.js";import"./MeetingActionMenu-L3cT7v54.js";import"./dropdown-menu-AR5wIcrT.js";import"./ellipsis-vertical-BBNn6lEy.js";import"./RescheduleMeetingDialog-BOcLTxdd.js";import"./map-pin-Cra05FqG.js";import"./isTomorrow-DJhbrIGS.js";import"./addDays-CAl2nVVE.js";import"./index-CDt3b6_8.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["path",{d:"M15.6 2.7a10 10 0 1 0 5.7 5.7",key:"1e0p6d"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M13.4 10.6 19 5",key:"1kr7tw"}]],ps=ss("CircleGauge",ms),Ne=[{key:"pending",label:"Pending",badge:["pending","pending_student_acceptance"]},{key:"accepted",label:"Accepted",badge:"accepted"},{key:"rejected",label:"Rejected",badge:"rejected"},{key:"cancelled",label:"Cancelled",badge:["cancelled","auto_cancelled"]}];function ir(){const[s,d]=n.useState("requests"),[t,j]=n.useState([]),[a,_]=n.useState([]),[m,C]=n.useState([]),[o,w]=n.useState(null),[p,u]=n.useState(null),[y,x]=n.useState(null),[b,i]=n.useState(null),[k,W]=n.useState(!0),[O,G]=n.useState(!1),[Q,$]=n.useState(null),[g,q]=n.useState("pending"),[B,T]=n.useState(!1),[V,X]=n.useState(null),[S,v]=n.useState([]),[z,we]=n.useState([]),[M,_e]=n.useState([]),[oe,me]=n.useState(null),[ye,I]=n.useState(!1),[pe,Ce]=n.useState([]),[Se,Re]=n.useState([]),[ke,ee]=n.useState(0),[ue,Me]=n.useState(0),se=async()=>{try{$(null),W(!0);const[r,l,c]=await Promise.all([re.get(route("supervision.requests.index")),re.get(route("supervision.relationships.index")),re.get("/api/v1/app/supervision/cosupervisor-invitations/my-invitations")]);j(r.data.data||[]);const R=l.data.data||[],h=R.filter(N=>N.status==="active"||N.status==="active"&&N.activeUnbindRequest),P=R.filter(N=>N.status==="terminated");if(_(h),C(P),v(c.data.as_cosupervisor||[]),we(c.data.to_approve||[]),_e(c.data.as_initiator||[]),Me(N=>N+1),p){const N=h.find(Y=>Y.id===p.id)||P.find(Y=>Y.id===p.id);u(N||null)}return R}catch(r){return Ie(r,"Supervision fetchData"),$("Unable to load supervision data right now."),[]}finally{W(!1)}},U=async()=>{O||(G(!0),await se(),G(!1))};n.useEffect(()=>{se()},[]),n.useEffect(()=>{if(k||t.length===0)return;const r=t.filter(h=>h.status==="accepted"&&!h.student_response_acknowledged_at),l=t.filter(h=>h.status==="auto_cancelled"&&!h.student_response_acknowledged_at);(r.length>0||l.length>0)&&(Ce(r),Re(l),I(!0));const c=localStorage.getItem("supervisor_last_viewed_cancelled_tab"),R=t.filter(h=>h.status==="cancelled"||h.status==="auto_cancelled");if(c){const h=new Date(c),P=R.filter(N=>new Date(N.decision_at||N.updated_at)>h);ee(P.length)}else ee(R.length)},[t,k]);const Ae=()=>{q("cancelled"),localStorage.setItem("supervisor_last_viewed_cancelled_tab",new Date().toISOString()),ee(0)},te=n.useMemo(()=>{for(const r of a){const l=r.activeUnbindRequest;if(l&&l.status==="pending"&&l.initiated_by==="student")return{unbindRequest:l,relationship:r}}return null},[a]),J=n.useMemo(()=>t.filter(r=>{const l=Ne.find(R=>R.key===g);return l?(Array.isArray(l.badge)?l.badge:[l.badge]).includes(r.status):!1}),[t,g]),L=n.useMemo(()=>{if(g==="pending"){const r=S.filter(c=>c.cosupervisor_status==="pending"||c.cosupervisor_status==="accepted"&&c.approver_status==="pending"),l=M.filter(c=>!c.completed_at&&!c.cancelled_at&&c.cosupervisor_status!=="rejected"&&c.approver_status!=="rejected");return[...r,...z,...l]}else if(g==="accepted"){const r=S.filter(c=>c.completed_at),l=M.filter(c=>c.completed_at);return[...r,...l]}else if(g==="rejected"){const r=S.filter(c=>c.cosupervisor_status==="rejected"||c.approver_status==="rejected"),l=M.filter(c=>c.cosupervisor_status==="rejected"||c.approver_status==="rejected");return[...r,...l]}else if(g==="cancelled"){const r=S.filter(c=>c.cancelled_at),l=M.filter(c=>c.cancelled_at);return[...r,...l]}return[]},[g,S,z,M]),K=n.useMemo(()=>{const r=a.length,l=S.filter(f=>f.cosupervisor_status==="pending"||f.cosupervisor_status==="accepted"&&f.approver_status==="pending").length,c=M.filter(f=>!f.completed_at&&!f.cancelled_at&&f.cosupervisor_status!=="rejected"&&f.approver_status!=="rejected").length,R=t.filter(f=>f.status==="pending"||f.status==="pending_student_acceptance").length+l+z.length+c,h=new Date,P=h.getMonth(),N=h.getFullYear(),Y=a.reduce((f,ae)=>{if(ae.meetings&&Array.isArray(ae.meetings)){const Ue=ae.meetings.filter(xe=>{if(!xe.scheduled_for)return!1;const ge=new Date(xe.scheduled_for);return ge.getMonth()===P&&ge.getFullYear()===N});return f+Ue.length}return f},0),Te=a.filter(f=>f.scholarlab_board_id).length;return{totalStudents:r,pendingRequests:R,meetingsThisMonth:Y,activeWorkspaces:Te}},[a,t,S,z,M]);return e.jsxs(Ee,{title:"Supervisor Dashboard",children:[e.jsx(Pe,{title:"Supervisor Dashboard"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-3 py-3 sm:px-4 sm:py-4 md:px-5 md:py-5 lg:px-0 lg:py-0 pb-6 space-y-6",children:[Q&&e.jsx(Ve,{variant:"destructive",children:e.jsx(ze,{children:Q})}),!k&&e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 pb-6 border-b border-slate-200",children:[e.jsx(Z,{value:K.totalStudents,label:"Total Students",icon:es,iconColor:"text-indigo-600",bgColor:"bg-indigo-50"}),e.jsx(Z,{value:K.pendingRequests,label:"Pending Requests",icon:ce,iconColor:"text-amber-600",bgColor:"bg-amber-50"}),e.jsx(Z,{value:K.meetingsThisMonth,label:"Meetings this Month",icon:be,iconColor:"text-green-600",bgColor:"bg-green-50"}),e.jsx(Z,{value:K.activeWorkspaces,label:"Active Workspaces",icon:ps,iconColor:"text-blue-600",bgColor:"bg-blue-50"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-0",children:[e.jsx("div",{className:"lg:col-span-9 lg:pr-6 lg:border-r border-slate-200",children:e.jsxs($e,{value:s,onValueChange:d,className:"space-y-6",children:[e.jsxs(qe,{className:"grid w-full grid-cols-3 bg-gray-100 p-1 rounded-lg h-12",children:[e.jsx(le,{value:"requests",className:"data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm data-[state=inactive]:text-gray-600 rounded-md transition-all py-2",children:"Manage Requests"}),e.jsx(le,{value:"students",className:"data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm data-[state=inactive]:text-gray-600 rounded-md transition-all py-2",children:"My Students"}),e.jsx(le,{value:"terminated",className:"data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm data-[state=inactive]:text-gray-600 rounded-md transition-all py-2",children:"Terminated"})]}),e.jsxs(ie,{value:"requests",className:"space-y-4",children:[e.jsx(us,{filter:g,onChange:q,onCancelledClick:Ae,requests:t,coSupervisorInvitations:S,approvalInvitations:z,myInitiatedInvitations:M,cancelledBadgeCount:ke}),k?e.jsx(vs,{}):e.jsxs("div",{className:"space-y-6",children:[L.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5 text-indigo-600"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[g==="pending"&&"Co-Supervisor Invitations",g==="accepted"&&"Accepted Co-Supervisor Invitations",g==="rejected"&&"Rejected Co-Supervisor Invitations",g==="cancelled"&&"Cancelled Co-Supervisor Invitations"]}),e.jsx(D,{variant:"secondary",className:"bg-indigo-100 text-indigo-700",children:L.length})]}),e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:L.map(r=>e.jsx(Ze,{invitation:r,onClick:()=>me(r)},r.id))})]}),J.length===0&&L.length===0?e.jsx(hs,{status:g}):J.length>0?e.jsxs("div",{children:[L.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ts,{className:"w-5 h-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Supervision Requests"}),e.jsx(D,{variant:"secondary",className:"bg-gray-100 text-gray-700",children:J.length})]}),e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:J.map(r=>e.jsx(xs,{request:r,onOpenDetail:l=>i(l)},r.id))})]}):null]})]}),e.jsx(ie,{value:"students",children:k?e.jsx(he,{}):a.length===0?e.jsx(fs,{}):e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:a.map(r=>e.jsx(gs,{relationship:r,onOpenDetail:l=>{l.preferred_tab?u(l):u(r),w(null)},onScheduleMeeting:l=>x(l),onAddCoSupervisor:l=>{X(l),T(!0)}},r.id))})}),e.jsx(ie,{value:"terminated",children:k?e.jsx(he,{}):m.length===0?e.jsx(js,{}):e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:m.map(r=>e.jsx(bs,{relationship:r,onViewHistory:l=>{u(l),w(null)}},r.id))})})]})}),e.jsx("div",{className:"lg:col-span-3 lg:pl-6 mt-6 lg:mt-0",children:e.jsxs("div",{className:"sticky top-6 space-y-6",children:[e.jsx(Xe,{userRole:"supervisor",triggerReload:ue}),e.jsx(Je,{userRole:"supervisor",triggerReload:ue})]})})]}),p&&!o&&e.jsx(Ye,{relationship:p,onClose:()=>u(null),onUpdated:U}),o&&e.jsx(Le,{request:o,relationship:p,onClose:()=>{w(null),u(null)},onUpdated:U}),e.jsx(He,{relationship:y,onClose:()=>x(null),onScheduled:U,userRole:"supervisor"}),b&&e.jsx(We,{request:b,onClose:()=>i(null),onUpdated:U,userRole:"supervisor"}),te&&e.jsx(Ge,{unbindRequest:te.unbindRequest,relationship:te.relationship,onResponse:U,userRole:"supervisor"}),e.jsx(Qe,{type:"response",data:{acceptances:pe,rejections:Se},isOpen:ye,onClose:()=>I(!1),onNavigate:()=>{pe.length>0&&d("students"),I(!1)}}),B&&V&&e.jsx(Ke,{isOpen:B,onClose:()=>T(!1),relationship:V,onInvite:()=>{T(!1),Fe.success("Co-supervisor invitation sent!"),U()}}),oe&&e.jsx(Oe,{invitation:oe,onClose:()=>me(null),onUpdated:()=>{se()}})]})]})}function us({filter:s,onChange:d,onCancelledClick:t,requests:j,coSupervisorInvitations:a,approvalInvitations:_,myInitiatedInvitations:m,cancelledBadgeCount:C}){return e.jsx("div",{className:"flex flex-wrap items-center gap-3",children:Ne.map(o=>{const w=Array.isArray(o.badge)?o.badge:[o.badge];let p=j.filter(x=>w.includes(x.status)).length;if(o.key==="pending"){const x=(a==null?void 0:a.filter(i=>i.cosupervisor_status==="pending"||i.cosupervisor_status==="accepted"&&i.approver_status==="pending").length)||0,b=(m==null?void 0:m.filter(i=>!i.completed_at&&!i.cancelled_at&&i.cosupervisor_status!=="rejected"&&i.approver_status!=="rejected").length)||0;p+=x+((_==null?void 0:_.length)||0)+b}else if(o.key==="accepted"){const x=(a==null?void 0:a.filter(i=>i.completed_at).length)||0,b=(m==null?void 0:m.filter(i=>i.completed_at).length)||0;p+=x+b}else if(o.key==="rejected"){const x=(a==null?void 0:a.filter(i=>i.cosupervisor_status==="rejected"||i.approver_status==="rejected").length)||0,b=(m==null?void 0:m.filter(i=>i.cosupervisor_status==="rejected"||i.approver_status==="rejected").length)||0;p+=x+b}else if(o.key==="cancelled"){const x=(a==null?void 0:a.filter(i=>i.cancelled_at).length)||0,b=(m==null?void 0:m.filter(i=>i.cancelled_at).length)||0;p+=x+b}const u=o.key==="cancelled",y=u&&C>0;return e.jsxs("div",{className:"relative",children:[e.jsxs(A,{variant:s===o.key?"default":"outline",onClick:()=>u&&t?t():d(o.key),className:"flex items-center gap-2",children:[o.label,e.jsx(D,{variant:s===o.key?"secondary":"outline",children:p})]}),y&&e.jsx("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white shadow-md",children:C})]},o.key)})})}function xs({request:s,onOpenDetail:d}){var b;const t=s==null?void 0:s.student,j=(t==null?void 0:t.full_name)??"Student",a=t!=null&&t.profile_picture?`/storage/${t.profile_picture}`:null,_=((b=t==null?void 0:t.university)==null?void 0:b.name)??null,m=(s==null?void 0:s.status)??"pending",C=s!=null&&s.submitted_at?de(new Date(s.submitted_at),"dd/MM/yyyy"):"—",o=s!=null&&s.submitted_at?os(new Date(s.submitted_at),{addSuffix:!0}):null,w={pending:"bg-amber-50 text-amber-700 border-none",pending_student_acceptance:"bg-blue-50 text-blue-700 border-none",accepted:"bg-emerald-50 text-emerald-700 border-none",rejected:"bg-rose-50 text-rose-700 border-none",cancelled:"bg-slate-100 text-slate-600 border-none",auto_cancelled:"bg-slate-100 text-slate-600 border-none"},p={pending:"Awaiting your review",pending_student_acceptance:"Awaiting student acceptance",accepted:"Accepted — relationship established",rejected:"Rejected — feedback provided",cancelled:"Cancelled by student",auto_cancelled:"Auto-cancelled after student accepted another offer"},u=w[m]??w.pending,y=p[m]??"Pending response",x=m.split("_").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" ");return e.jsxs("div",{className:"border rounded-xl p-5 bg-white shadow-sm hover:shadow-md transition-shadow cursor-pointer",onClick:()=>d(s),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center overflow-hidden flex-shrink-0",children:a?e.jsx("img",{src:a,alt:j,className:"w-full h-full object-cover rounded-full"}):e.jsx(as,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-[1.05rem] font-semibold text-gray-900 leading-snug truncate",children:j}),_&&e.jsx("p",{className:"text-sm text-gray-600 truncate font-normal",children:_}),o&&e.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:o})]})]}),e.jsx(D,{className:`${u} flex-shrink-0`,children:x})]}),e.jsx("div",{className:"mt-4",children:e.jsx("h4",{className:"text-base font-semibold text-slate-900 line-clamp-2 leading-snug",children:(s==null?void 0:s.proposal_title)??"Supervision request"})}),y&&e.jsx("div",{className:"mt-2 flex items-start gap-1.5",children:e.jsx("span",{className:"text-sm text-slate-600",children:y})}),e.jsxs("div",{className:"mt-4 flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(rs,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:C})]}),(s==null?void 0:s.attachments)&&s.attachments.length>0&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ve,{className:"w-3.5 h-3.5"}),e.jsxs("span",{children:[s.attachments.length," file",s.attachments.length!==1?"s":""]})]})]}),e.jsx("div",{className:"mt-4 flex items-center gap-2 pt-4 border-t",children:e.jsxs(A,{variant:"outline",size:"sm",className:"flex-1",onClick:i=>{i.stopPropagation(),d(s)},children:[e.jsx(ls,{className:"mr-2 h-4 w-4"}),"View Details"]})})]})}function gs({relationship:s,onOpenDetail:d,onScheduleMeeting:t,onAddCoSupervisor:j}){var $,g,q,B,T,V,X,S;const a=(s==null?void 0:s.student)??{},_=a.profile_picture?`/storage/${a.profile_picture}`:null,m=a.full_name??"Student",C=(($=a.university)==null?void 0:$.name)||((g=a.university)==null?void 0:g.full_name)||"",o=((q=a.faculty)==null?void 0:q.name)||"",w=((B=a.research_domains)==null?void 0:B[0])||((T=a.field_of_research)==null?void 0:T[0])||"",p=(s==null?void 0:s.role)==="main"?"Main":"Co-supervisor",u=(s==null?void 0:s.cohort)||"",y=s!=null&&s.meeting_cadence?s.meeting_cadence.charAt(0).toUpperCase()+s.meeting_cadence.slice(1):"",x=m.split(" ").map(v=>v[0]).join("").toUpperCase().slice(0,3),b=((V=s==null?void 0:s.meetings)==null?void 0:V.length)||0,i=((X=s==null?void 0:s.onboarding_checklist_items)==null?void 0:X.filter(v=>!v.completed).length)||0,k=((S=s==null?void 0:s.documents)==null?void 0:S.length)||0,W=()=>{d==null||d({...s,preferred_tab:"overview"}),setTimeout(()=>{t==null||t(s)},100)},O=()=>{d==null||d({...s,preferred_tab:"chat"})},G=()=>{d==null||d({...s,preferred_tab:"documents"})},Q=()=>{De.visit(route("supervision.relationships.show",s.id))};return e.jsxs(E,{className:"shadow-sm hover:shadow-md transition-shadow cursor-pointer",onClick:()=>d==null?void 0:d({...s,preferred_tab:"overview"}),children:[e.jsx(H,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx(fe,{className:"h-12 w-12 border-2 border-slate-200",children:_?e.jsx("img",{src:_,alt:m,className:"h-full w-full object-cover"}):e.jsx(je,{className:"bg-indigo-100 text-indigo-700 font-semibold text-xs",children:x})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-base font-bold text-slate-900 truncate mb-1",children:m}),e.jsx("p",{className:"text-sm text-slate-600 truncate",children:C&&o?`${C} • ${o}`:C||o||"University"}),w&&e.jsx("p",{className:"text-xs text-slate-500 mt-1.5 line-clamp-1",children:w})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1 flex-shrink-0",children:[e.jsx(D,{className:"bg-slate-900 text-white border-none hover:bg-slate-800 px-2 py-0.5 text-xs",children:p}),u&&y&&e.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[u," • ",y]})]})]})}),e.jsxs(F,{className:"space-y-3 pb-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-slate-50",children:[e.jsx("div",{className:"text-xl font-bold text-slate-900",children:b}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Meetings"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-slate-50",children:[e.jsx("div",{className:"text-xl font-bold text-slate-900",children:i}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Tasks"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-slate-50",children:[e.jsx("div",{className:"text-xl font-bold text-slate-900",children:k}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Documents"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(A,{variant:"outline",size:"sm",className:"w-full h-8 text-xs",onClick:v=>{v.stopPropagation(),W()},children:[e.jsx(be,{className:"mr-1.5 h-3.5 w-3.5"}),"Schedule Meeting"]}),e.jsxs(A,{variant:"outline",size:"sm",className:"w-full h-8 text-xs",onClick:v=>{v.stopPropagation(),O()},children:[e.jsx(is,{className:"mr-1.5 h-3.5 w-3.5"}),"Chat"]}),e.jsxs(A,{variant:"outline",size:"sm",className:"w-full h-8 text-xs",onClick:v=>{v.stopPropagation(),G()},children:[e.jsx(ve,{className:"mr-1.5 h-3.5 w-3.5"}),"Share Document"]}),e.jsxs(A,{variant:"outline",size:"sm",className:"w-full h-8 text-xs",onClick:v=>{v.stopPropagation(),Q()},children:[e.jsx(cs,{className:"mr-1.5 h-3.5 w-3.5"}),"Manage"]})]}),(s==null?void 0:s.role)==="main"&&j&&e.jsxs(A,{variant:"default",size:"sm",className:"w-full h-8 text-xs bg-indigo-600 hover:bg-indigo-700",onClick:v=>{v.stopPropagation(),j(s)},children:[e.jsx(ce,{className:"mr-1.5 h-3.5 w-3.5"}),"Add Co-Supervisor"]})]})]})}function hs({status:s}){const d={pending:{title:"No pending requests",description:"You do not have any new supervision proposals right now. Students will appear here when they submit a request or when they need to accept your offer."},accepted:{title:"No accepted requests yet",description:"Accepted proposals appear here. When you approve a student and they accept, they will transition to the My Students tab."},rejected:{title:"No rejected requests",description:"Rejected proposals will appear here for reference."},cancelled:{title:"No cancelled requests",description:"Cancelled requests (by student or system) will appear here for reference."}}[s]||{title:"No requests found",description:"Try selecting another status filter."};return e.jsxs(E,{className:"border-dashed border-slate-200",children:[e.jsx(H,{children:e.jsx(ne,{className:"text-lg font-semibold text-slate-800",children:d.title})}),e.jsx(F,{className:"text-sm text-slate-600",children:d.description})]})}function fs(){return e.jsxs(E,{className:"border-dashed border-slate-200",children:[e.jsx(H,{children:e.jsx(ne,{className:"text-lg font-semibold text-slate-800",children:"No supervisees yet"})}),e.jsx(F,{className:"text-sm text-slate-600",children:"Once you accept a student, they will appear here for ongoing management. Use the Manage Requests tab to approve new proposals."})]})}function js(){return e.jsxs(E,{className:"border-dashed border-slate-200",children:[e.jsx(H,{children:e.jsx(ne,{className:"text-lg font-semibold text-slate-800",children:"No terminated relationships"})}),e.jsx(F,{className:"text-sm text-slate-600",children:"Terminated supervision relationships will appear here for historical reference. This includes unbind requests, graduations, and other reasons for ending supervision."})]})}function bs({relationship:s,onViewHistory:d}){var w;const t=s==null?void 0:s.student,j=(t==null?void 0:t.full_name)||"Student",a=j.split(" ").map(p=>p[0]).join("").toUpperCase().slice(0,3),_=s!=null&&s.accepted_at?de(new Date(s.accepted_at),"dd/MM/yyyy"):"—",m=s!=null&&s.terminated_at?de(new Date(s.terminated_at),"dd/MM/yyyy"):"—",o=(()=>{var u;const p=(u=s==null?void 0:s.unbindRequests)==null?void 0:u.find(y=>y.status==="approved"||y.status==="force_unbind");return p?p.status==="force_unbind"?"Force Unbind (3 attempts)":"Unbind Request Approved":"Supervision Ended"})();return e.jsxs(E,{className:"border-slate-200 bg-slate-50/50 hover:shadow-md transition-shadow",children:[e.jsx(H,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(fe,{className:"h-12 w-12",children:t!=null&&t.profile_picture?e.jsx("img",{src:`/storage/${t.profile_picture}`,alt:j,className:"h-full w-full object-cover"}):e.jsx(je,{className:"bg-slate-200 text-slate-600 font-semibold",children:a})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-slate-900 truncate",children:j}),e.jsx("p",{className:"text-sm text-slate-500",children:((w=t==null?void 0:t.university)==null?void 0:w.name)||"University"}),e.jsx("div",{className:"mt-2",children:e.jsx(D,{className:"bg-red-50 text-red-700 border-red-200 border",children:"Terminated"})})]})]})}),e.jsxs(F,{className:"space-y-3 pb-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Started"}),e.jsx("div",{className:"font-medium text-slate-700",children:_})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Ended"}),e.jsx("div",{className:"font-medium text-slate-700",children:m})]})]}),e.jsx("div",{className:"pt-2 border-t border-slate-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ds,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Reason"}),e.jsx("div",{className:"text-sm text-slate-700",children:o})]})]})})]}),e.jsx(Be,{className:"pt-3",children:e.jsxs(A,{variant:"outline",className:"w-full",onClick:()=>d(s),children:[e.jsx(ns,{className:"mr-2 h-4 w-4"}),"View History"]})})]})}function vs(){return e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:Array.from({length:4}).map((s,d)=>e.jsxs("div",{className:"border border-dashed rounded-xl p-4 sm:p-5 bg-white shadow-sm animate-pulse min-h-[300px] sm:min-h-[320px] flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-1.5 sm:space-y-2 min-w-0",children:[e.jsx("div",{className:"h-3.5 sm:h-4 w-28 sm:w-32 rounded bg-slate-200"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-20 sm:w-24 rounded bg-slate-100"}),e.jsx("div",{className:"h-2 sm:h-2.5 w-24 sm:w-28 rounded bg-slate-100"})]})]}),e.jsx("div",{className:"h-5 sm:h-6 w-16 sm:w-20 rounded-full bg-slate-200 flex-shrink-0"})]}),e.jsxs("div",{className:"mt-3 sm:mt-4",children:[e.jsx("div",{className:"h-4 sm:h-5 w-full rounded bg-slate-100"}),e.jsx("div",{className:"h-4 sm:h-5 w-3/4 rounded bg-slate-100 mt-2"})]}),e.jsx("div",{className:"mt-2 flex-1 space-y-2",children:e.jsx("div",{className:"h-12 sm:h-14 w-full rounded-md bg-slate-100"})}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-3 sm:gap-4",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-20 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-16 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-24 rounded bg-slate-100"})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-2 pt-3 sm:pt-4 border-t border-slate-200",children:[e.jsx("div",{className:"h-8 sm:h-9 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-8 sm:h-9 w-8 sm:w-9 rounded bg-slate-200"})]})]},`request-skeleton-${d}`))})}function he(){return e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:Array.from({length:4}).map((s,d)=>e.jsxs("div",{className:"border border-dashed rounded-xl p-4 sm:p-5 bg-white shadow-sm animate-pulse min-h-[280px] sm:min-h-[300px] flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-1.5 sm:space-y-2 min-w-0",children:[e.jsx("div",{className:"h-3.5 sm:h-4 w-28 sm:w-32 rounded bg-slate-200"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-20 sm:w-24 rounded bg-slate-100"}),e.jsx("div",{className:"h-2 sm:h-2.5 w-24 sm:w-28 rounded bg-slate-100"})]})]}),e.jsx("div",{className:"h-5 sm:h-6 w-14 sm:w-16 rounded-full bg-slate-100 flex-shrink-0"})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex-1",children:[e.jsx("div",{className:"h-3.5 sm:h-4 w-full rounded bg-slate-100"}),e.jsx("div",{className:"h-3.5 sm:h-4 w-2/3 rounded bg-slate-100 mt-2"})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-20 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-16 rounded bg-slate-100"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-24 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-20 rounded bg-slate-100"})]})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-2 pt-3 sm:pt-4 border-t border-slate-200",children:[e.jsx("div",{className:"h-8 sm:h-9 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-8 sm:h-9 w-8 sm:w-9 rounded bg-slate-200"})]})]},`student-skeleton-${d}`))})}function Z({value:s,label:d,icon:t,iconColor:j,bgColor:a}){return e.jsx(E,{className:"border-slate-200 shadow-sm",children:e.jsx(F,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-slate-900",children:s}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:d})]}),e.jsx("div",{className:`${a} p-3 rounded-lg`,children:e.jsx(t,{className:`h-6 w-6 ${j}`})})]})})})}export{ir as default};
