import{r as a,a as b,j as e,y as I}from"./app-C9aRItHR.js";import{V as n}from"./index-XngfYQdO.js";import $ from"./FacultyFormModal-vHcqFAtO.js";import T from"./ConfirmationModal-DcA9PrvQ.js";import{P as L}from"./Pagination-DQk92FZF.js";import{b as Q,h as V,m as R,n as q}from"./index-DWLkSDCh.js";import"./chevron-left-CXvSSDf-.js";import"./createLucideIcon-BKESxhZR.js";import"./chevron-right-D08KHBfF.js";import"./iconBase-BnDH7fxV.js";function ee(){const[j,v]=a.useState([]),[l,g]=a.useState({data:[],meta:{}}),[h,f]=a.useState(!0),[u,N]=a.useState(""),[r,w]=a.useState(""),[o,i]=a.useState({current_page:1,per_page:10,total:0,last_page:1}),[_,p]=a.useState(!1),[F,m]=a.useState(!1),[c,x]=a.useState(null),[S,y]=a.useState("create");a.useEffect(()=>{k()},[]),a.useEffect(()=>{r?d():g({data:[],meta:{from:0}})},[r,o.current_page,u]);const k=async()=>{try{const t=await b.get("/api/v1/app/universities",{params:{per_page:100}});v(t.data.data)}catch(t){console.error("Error fetching universities:",t),n.error("Failed to load universities")}},d=async()=>{if(r){f(!0);try{const t=await b.get("/api/v1/app/faculties",{params:{university_id:r,page:o.current_page,per_page:o.per_page,search:u||void 0,with_university:!0}});g({data:t.data.data,meta:t.data.meta}),i({current_page:t.data.meta.current_page,per_page:t.data.meta.per_page,total:t.data.meta.total,last_page:t.data.meta.last_page})}catch(t){console.error("Error fetching faculties:",t),n.error("Failed to load faculties")}finally{f(!1)}}},C=t=>{w(t.target.value),i(s=>({...s,current_page:1}))},M=t=>{i(s=>({...s,current_page:t}))},E=t=>{t.preventDefault(),i(s=>({...s,current_page:1}))},P=()=>{x(null),y("create"),p(!0)},U=t=>{x(t),y("edit"),p(!0)},A=t=>{x(t),m(!0)},D=()=>{if(!c)return;(async()=>{try{I.delete(`/admin/data-management/faculties/${c.id}`),n.success("Faculty deleted successfully!"),d()}catch(s){s.response?s.response.status===404?(n.error("Faculty not found. It may have been already deleted."),d()):s.response.data?.error?n.error(s.response.data.error):s.response.data?.message?n.error(s.response.data.message):n.error(`Error (${s.response.status}): Unable to delete faculty.`):n.error("Network error or server not responding."),console.error("Error deleting faculty:",s)}finally{m(!1)}})()},O=()=>{p(!1),d()};return e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Faculties"}),e.jsxs("button",{onClick:()=>{r&&P()},disabled:!r,className:`inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest ${r?"hover:bg-blue-700 active:bg-blue-900":"opacity-50 cursor-not-allowed"} focus:outline-none focus:border-blue-900 focus:ring ring-blue-300`,children:[e.jsx(Q,{className:"mr-2"})," Add Faculty"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"university",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select University"}),e.jsxs("select",{id:"university",value:r,onChange:C,className:"block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select a university"}),j.map(t=>e.jsx("option",{value:t.id,children:t.full_name},t.id))]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6",children:e.jsxs("form",{onSubmit:E,className:"flex",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(V,{className:"text-gray-400"})}),e.jsx("input",{type:"text",value:u,onChange:t=>N(t.target.value),placeholder:"Search faculties...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsx("button",{type:"submit",className:"ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Search"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Academicians"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Postgraduates"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Undergraduates"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center",children:"Loading..."})}):l.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center",children:"No faculties found"})}):l.data.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:l.meta.from+s}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.academicians_count||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.postgraduates_count||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.undergraduates_count||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsxs("button",{onClick:()=>U(t),className:"text-blue-600 hover:text-blue-900 mr-4",children:[e.jsx(R,{className:"inline"})," Edit"]}),e.jsxs("button",{onClick:()=>A(t),className:"text-red-600 hover:text-red-900",children:[e.jsx(q,{className:"inline"})," Delete"]})]})]},t.id))})]})}),!h&&l.data.length>0&&e.jsx("div",{className:"mt-6",children:e.jsx(L,{currentPage:o.current_page,totalPages:o.last_page,onPageChange:M})})]}),e.jsx($,{isOpen:_,onClose:O,faculty:c,universityId:r||null,mode:S}),e.jsx(T,{isOpen:F,title:"Delete Faculty",message:`Are you sure you want to delete ${c?.name}? This action cannot be undone.`,onConfirm:D,onCancel:()=>m(!1)})]})}export{ee as default};
