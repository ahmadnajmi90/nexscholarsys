import{q as L,r as f,R as S,j as e,y as q}from"./app-Doi1BfNX.js";import{O as B,S as F}from"./modalAnimations-CCENKliM.js";import{g as V,f as D,a as H}from"./supervisionHelpers-EJT0WNFw.js";import{T as $,a as z,b as p,c as b}from"./tabs-BgtJ-Aqh.js";import{B as m}from"./button-KPEq8PdI.js";import{B as J}from"./badge-Be2D36dO.js";import{A as X,a as Y}from"./avatar-D-ohjjtQ.js";import{S as T}from"./scroll-area-Du06xGgY.js";import{T as G}from"./ThreadPane-B5BIAZi7.js";import K from"./ScheduleMeetingDialog-Bg9sEkOz.js";import Q from"./UnifiedOverviewTab-DNnrDGUR.js";import W from"./UnbindRequestModal-C0DyPriN.js";import{R as Z}from"./RelationshipHistoryTab-D0VInf3e.js";import{T as U,a as ee,b as se,c as R}from"./tooltip-CJCiABJO.js";import{A as te}from"./index-CvKzrQIm.js";import{m as _}from"./proxy-BUFhk0Wh.js";import{X as ae}from"./x-DrXySrr5.js";import{C as re}from"./calendar-CBO9yeE8.js";import{V as ie}from"./video-CabzSFea.js";import{U as le}from"./user-minus-aiA-FD3x.js";import{E as oe}from"./external-link-DYFIg7ks.js";import"./index-B_QUZuO0.js";import"./index-FRhtyj0h.js";import"./index-BGtqCWya.js";import"./index-Ct-Jk4RI.js";import"./index-Be4Hbpsc.js";import"./index-BdR5mO0l.js";import"./index-CkAoBwhz.js";import"./index-Bb94jkfk.js";import"./utils-D-KgF5mV.js";import"./index-CGrAONsN.js";import"./index-BdQq_4o_.js";import"./Modal-BjJ_nX2Q.js";import"./dialog-DYcl7DcC.js";import"./transition-Dk-vnbkR.js";import"./format-Dv9Rm441.js";import"./en-US-DNUEYIb-.js";import"./file-text-CjHuEEW2.js";import"./createLucideIcon-BIWf6Fgr.js";import"./download-Xk6ccwe6.js";import"./index-dbiIR3J5.js";import"./isSameDay-Dm-A-V7S.js";import"./input-yCRxI6tt.js";import"./textarea-B9-sF3_G.js";import"./label-BYlrvoGV.js";import"./alert-DlfG3K4y.js";import"./logError-D4ezqrCx.js";import"./useGoogleCalendar-BXh9FXme.js";import"./loader-circle-D1uCPtBJ.js";import"./user-round-B_eanpyP.js";import"./briefcase-Cs22VvWr.js";import"./mail-7f1JiwhA.js";import"./phone-CDfQ_U-X.js";import"./graduation-cap-BiSIS5Fh.js";import"./globe-CO-0Byd6.js";import"./calendar-clock-DWMtvC7-.js";import"./triangle-alert-uV-J_FuU.js";import"./circle-alert-DIrS-PEp.js";import"./users-CJk5icQ6.js";import"./index-CZA6k5rr.js";import"./index-BkPy3AN8.js";import"./floating-ui.dom-eiE65J5j.js";import"./index-CJzlUPP7.js";import"./index-BvLvCl4J.js";function js({relationship:s,onClose:i,onUpdated:t,isReadOnly:y=!1,defaultTab:d="overview"}){var h;const{auth:k}=L().props,[A,j]=f.useState(d),[C,l]=f.useState(!1),[M,u]=f.useState(!1);S.useEffect(()=>{const a=c=>{var N,w;((w=(N=c.detail)==null?void 0:N.relationship)==null?void 0:w.id)===(s==null?void 0:s.id)&&l(!0)};return window.addEventListener("open-schedule-meeting",a),()=>window.removeEventListener("open-schedule-meeting",a)},[s==null?void 0:s.id]),S.useEffect(()=>{j(d)},[d]);const O=()=>{q.visit(route("supervision.relationships.show",s.id))};if(!s)return null;const o=(s==null?void 0:s.academician)??{},x=o.full_name??"Supervisor",g=o.profile_picture?`/storage/${o.profile_picture}`:null,n=s.status??"active",r=(s==null?void 0:s.active_unbind_request)||(s==null?void 0:s.activeUnbindRequest),v=r?"pending_unbind":n,I=!y&&n==="active"&&!r,E=V(x),P=v==="pending_unbind"?"Pending Unbind":D(v);return e.jsxs(e.Fragment,{children:[e.jsx(te,{children:e.jsx(_.div,{...B,className:"fixed inset-0 z-40 flex items-center justify-end bg-black/50",onClick:i,children:e.jsxs(_.div,{...F,className:"w-full max-w-3xl h-full bg-white shadow-xl overflow-hidden flex flex-col",onClick:a=>a.stopPropagation(),children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx(X,{className:"h-12 w-12",children:g?e.jsx("img",{src:g,alt:x,className:"h-full w-full object-cover"}):e.jsx(Y,{className:"bg-indigo-100 text-indigo-700 text-sm font-semibold",children:E})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:x}),e.jsxs("p",{className:"text-sm text-slate-600",children:["Supervisor Â· ",s.role==="main"?"Main Supervisor":"Co-Supervisor"]}),e.jsx("div",{className:"mt-2",children:e.jsx(J,{className:`${H(v)} border`,children:P})})]})]}),e.jsx("button",{onClick:i,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(ae,{className:"h-5 w-5 text-slate-500"})})]})}),I&&e.jsxs("div",{className:"px-6 py-4 border-b bg-slate-50",children:[e.jsxs("div",{className:"flex gap-3 mb-3",children:[e.jsxs(m,{variant:"outline",className:"flex-1",onClick:()=>l(!0),children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Schedule Meeting"]}),e.jsxs(m,{className:"flex-1 bg-slate-900 hover:bg-slate-800",disabled:!(s!=null&&s.meetings)||s.meetings.length===0||!((h=s.meetings[0])!=null&&h.location_link),onClick:()=>{var c;const a=(c=s==null?void 0:s.meetings)==null?void 0:c[0];a!=null&&a.location_link&&window.open(a.location_link,"_blank","noopener,noreferrer")},children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Join Meeting"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(U,{children:e.jsxs(ee,{children:[e.jsx(se,{asChild:!0,children:e.jsx("div",{className:"flex-1",children:e.jsxs(m,{variant:"outline",className:"w-full border-red-300 text-red-700 hover:bg-red-50",onClick:()=>u(!0),disabled:r||n!=="active",children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),"Remove Relationship"]})})}),r&&e.jsx(R,{children:e.jsx("p",{children:"Unbind request pending approval"})}),n!=="active"&&!r&&e.jsx(R,{children:e.jsx("p",{children:"Relationship is no longer active"})})]})}),e.jsxs(m,{variant:"outline",className:"flex-1",onClick:O,children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Show Full Page"]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs($,{value:A,onValueChange:j,className:"h-full flex flex-col",children:[e.jsxs(z,{className:"px-6 bg-gray-100 w-full justify-start rounded-none h-auto p-0 gap-0",children:[e.jsx(p,{value:"overview",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Overview"}),e.jsx(p,{value:"chat",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Chat"}),e.jsx(p,{value:"history",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"History"})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx(b,{value:"overview",className:"mt-0 h-full",children:e.jsx(T,{className:"h-full",children:e.jsx(Q,{relationship:s,person:o,userRole:"student",activeUnbindRequest:r})})}),e.jsx(b,{value:"chat",className:"mt-0 h-full",children:s!=null&&s.conversation_id?e.jsx("div",{className:"p-6 h-full",children:e.jsx("div",{className:"border border-slate-200 rounded-lg bg-white shadow-sm h-full overflow-hidden",children:e.jsx(G,{conversationId:s.conversation_id,auth:k,onConversationRead:()=>{},onConversationIncrementUnread:()=>{},onAfterSend:()=>t==null?void 0:t()})})}):e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:e.jsx("p",{className:"text-sm text-slate-500",children:"No conversation available yet."})})})}),e.jsx(b,{value:"history",className:"mt-0 h-full",children:e.jsx(T,{className:"h-full",children:e.jsx(Z,{relationship:s})})})]})]})})]})})}),e.jsx(K,{relationship:C?s:null,onClose:()=>l(!1),onScheduled:()=>{l(!1),t==null||t()},userRole:"student"}),e.jsx(W,{isOpen:M,relationship:s,onClose:()=>u(!1),onUnbindInitiated:()=>{u(!1),t==null||t(),i==null||i()},userRole:"student"})]})}export{js as default};
