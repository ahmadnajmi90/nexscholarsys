import{r as n,a as j,j as e}from"./app-D4sU-mOt.js";import{V as i}from"./index-DCM_u3Zp.js";import E from"./UniversityFormModal-1D9TOg6r.js";import $ from"./ConfirmationModal-D_aMFWfi.js";import{d as A,F as O,s as P,t as I}from"./index-rTanxS3a.js";import"./NationalityForm-CAMk3Ekh.js";import"./InputLabel-BtDVmO34.js";import"./react-select.esm-BQbATOgU.js";import"./InputError-CEho5qFp.js";function H(){const[d,v]=n.useState([]),[h,f]=n.useState(!0),[p,N]=n.useState(""),[t,u]=n.useState({current_page:1,per_page:10,total:0,last_page:1}),[w,x]=n.useState(!1),[_,m]=n.useState(!1),[l,g]=n.useState(null),[k,y]=n.useState("create");n.useEffect(()=>{c()},[t.current_page,p]);const c=async()=>{f(!0);try{const s=await j.get("/api/v1/universities",{params:{page:t.current_page,per_page:t.per_page,search:p||void 0}});v(s.data.data),u({current_page:s.data.meta.current_page,per_page:s.data.meta.per_page,total:s.data.meta.total,last_page:s.data.meta.last_page})}catch(s){console.error("Error fetching universities:",s),i.error("Failed to load universities")}finally{f(!1)}},o=s=>{u(r=>({...r,current_page:s}))},S=s=>{s.preventDefault(),u(r=>({...r,current_page:1}))},C=()=>{g(null),y("create"),x(!0)},M=s=>{g(s),y("edit"),x(!0)},F=s=>{g(s),m(!0)},U=()=>{if(!l)return;(async()=>{var r,b;try{await j.delete(`/api/v1/universities/${l.id}`),i.success("University deleted successfully!"),c()}catch(a){a.response?a.response.status===404?(i.error("University not found. It may have been already deleted."),c()):a.response.status===409?i.error("Cannot delete university with existing faculties. Delete the faculties first."):(r=a.response.data)!=null&&r.error?i.error(a.response.data.error):(b=a.response.data)!=null&&b.message?i.error(a.response.data.message):i.error(`Error (${a.response.status}): Unable to delete university.`):i.error("Network error or server not responding."),console.error("Error deleting university:",a)}finally{m(!1)}})()},D=()=>{x(!1),c()};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Universities"}),e.jsxs("button",{onClick:C,className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",children:[e.jsx(A,{className:"mr-2"})," Add University"]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("form",{onSubmit:S,className:"flex",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(O,{className:"text-gray-400"})}),e.jsx("input",{type:"text",value:p,onChange:s=>N(s.target.value),placeholder:"Search universities...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsx("button",{type:"submit",className:"ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Search"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Short Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Country"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Faculties"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center",children:"Loading..."})}):d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center",children:"No universities found"})}):d.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.full_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.short_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.country}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.faculties_count||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsxs("button",{onClick:()=>M(s),className:"text-blue-600 hover:text-blue-900 mr-4",children:[e.jsx(P,{className:"inline"})," Edit"]}),e.jsxs("button",{onClick:()=>F(s),className:"text-red-600 hover:text-red-900",children:[e.jsx(I,{className:"inline"})," Delete"]})]})]},s.id))})]})}),!h&&d.length>0&&e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 mt-4",children:[e.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>o(t.current_page-1),disabled:t.current_page===1,className:`relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 ${t.current_page===1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Previous"}),e.jsx("button",{onClick:()=>o(t.current_page+1),disabled:t.current_page===t.last_page,className:`relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 ${t.current_page===t.last_page?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(t.current_page-1)*t.per_page+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(t.current_page*t.per_page,t.total)})," ","of ",e.jsx("span",{className:"font-medium",children:t.total})," results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>o(t.current_page-1),disabled:t.current_page===1,className:`relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ${t.current_page===1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:[e.jsx("span",{className:"sr-only",children:"Previous"}),"←"]}),[...Array(t.last_page).keys()].map(s=>{const r=s+1;return r===1||r===t.last_page||Math.abs(r-t.current_page)<=1?e.jsx("button",{onClick:()=>o(r),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${r===t.current_page?"bg-blue-600 text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:outline-offset-0"}`,children:r},r):r===2&&t.current_page>3||r===t.last_page-1&&t.current_page<t.last_page-2?e.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700",children:"..."},r):null}),e.jsxs("button",{onClick:()=>o(t.current_page+1),disabled:t.current_page===t.last_page,className:`relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ${t.current_page===t.last_page?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:[e.jsx("span",{className:"sr-only",children:"Next"}),"→"]})]})})]})]}),e.jsx(E,{isOpen:w,onClose:D,university:l,mode:k}),e.jsx($,{isOpen:_,title:"Delete University",message:`Are you sure you want to delete ${l==null?void 0:l.full_name}? This action cannot be undone.`,onConfirm:U,onCancel:()=>m(!1)})]})}export{H as default};
