import{r as l,j as e,Y as Ue,a as Z,y as De}from"./app-D_isCBrZ.js";import{M as Ie}from"./MainLayout-DFHTJA1K.js";import{c as Pe}from"./index-S2oVNL1R.js";import{T as Ee,a as Fe,b as ee,c as se}from"./tabs-qSfZPpU_.js";import{C as D,a as I,b as $,c as re,d as $e}from"./card-D45-gtvy.js";import{B as U}from"./badge-CsPEGvq-.js";import{B as A}from"./button-CvkXbyNI.js";import{A as he,a as ge}from"./avatar-DiF5jK1a.js";import"./separator-C4LAXWrB.js";import{A as Be,a as Ve}from"./alert-D0_wd7P2.js";import ze from"./RelationshipDetailModal-ChCdY8bV.js";import Le from"./SupervisorRelationshipDetailModal-DGArue9m.js";import Oe from"./ScheduleMeetingDialog-DtBPuyLy.js";import Ye from"./UnifiedRequestDetailCard-CxYJCsKR.js";import He from"./ForceUnbindRequestModal-Dz3QMium.js";import We from"./UnifiedNotificationModal-lRvc4Uw_.js";import Ge from"./RecentActivityPanel-DjYldjHB.js";import Qe from"./UpcomingMeetingsPanel-C4c9JvTm.js";import Xe from"./CoSupervisorSearchModal-DBpomFGe.js";import Je from"./CoSupervisorInvitationCard-DsHiz2eC.js";import Ke from"./CoSupervisorInvitationDetailPanel-BVB-HX2g.js";import{l as Ze}from"./logError-BloCzXDJ.js";import{U as es}from"./users-CzJIWcZi.js";import{U as te}from"./user-plus-DBVpKWbN.js";import{C as fe}from"./calendar-clock-BXI-GMf6.js";import{c as ss}from"./createLucideIcon-BT85Csak.js";import{C as ts}from"./clipboard-list-bDsaPQ1j.js";import{U as as}from"./user-round-DHB2rLfi.js";import{C as rs}from"./clock-3-Bz-izu3q.js";import{F as je}from"./file-text-aNmLS6r1.js";import{C as is}from"./circle-check-DHGBAWKG.js";import{M as ls}from"./message-circle-DZ-DL43K.js";import{S as ns}from"./settings-JsLbx9pE.js";import{C as os}from"./circle-x-CzwLWDcz.js";import{H as cs}from"./history-Ce0OkC6P.js";import{f as ae}from"./format-BOijCLBA.js";import{f as ds}from"./formatDistanceToNow-CZclDLe0.js";import"./house-C09fpVO9.js";import"./zap-7CK7LKMF.js";import"./folder-open-CA9bVcGc.js";import"./useRoles-Bqwai8Sw.js";import"./chevron-left-BjuclT0k.js";import"./proxy-hyWpbevY.js";import"./dollar-sign-CKWtW4Ws.js";import"./calendar-D8HyrHOR.js";import"./message-square-aRmyvbGu.js";import"./graduation-cap-BDaXx5-Y.js";import"./building-BzLX-1Tq.js";import"./Dropdown-C4pTIkAa.js";import"./transition-B-iVJ-Dl.js";import"./sparkles-DBHFI2EX.js";import"./bookmark-IOsNloOG.js";import"./folder-kanban-YiDVfHbK.js";import"./building-2-BotSZuIB.js";import"./database-OkIdYBy7.js";import"./shield-DIRjH5Xw.js";import"./index-B2H7aNu6.js";import"./analytics-BQ374C1C.js";import"./iconBase-Ky0bhwWY.js";import"./index-Dje2_Jfs.js";import"./supervisionConstants-BuM5-H5X.js";import"./utils-CBfrqCZ4.js";import"./ThreadPane-DXxMgnx_.js";import"./Modal-DC1ukoCH.js";import"./dialog-C6ICxX1D.js";import"./index-BG6TJDBP.js";import"./scroll-area-Bgije4Ta.js";import"./index-BxE-5CCQ.js";import"./index-CL6H2niU.js";import"./index--9W6mpJI.js";import"./index-DEX240OH.js";import"./index-BdQq_4o_.js";import"./download-C9pj9r2a.js";import"./x-DHPN06jQ.js";import"./isSameDay-BHs4V-zU.js";import"./en-US-DIdCsyf3.js";import"./constructNow-6bIQB1GK.js";import"./addDays-KHeCUDUr.js";import"./PrimaryButton-ER2dCufN.js";import"./SecondaryButton-CXsAGrXg.js";import"./search-oexLbFuf.js";import"./circle-check-big-C8DvMf6D.js";import"./chevron-right-Be2Bs3JC.js";import"./tooltip-CQVkmZ9i.js";import"./index-CoKnqvF_.js";import"./index-BSdNhmJ5.js";import"./index-8kpB6Eh5.js";import"./floating-ui.dom-D5EC_49c.js";import"./index-lKKoak1a.js";import"./index-Be7aubF8.js";import"./index-DKcCfogn.js";import"./index-Chjiymov.js";import"./dialog-D0uO8m2L.js";import"./index-BsmCtA5d.js";import"./index-BlbDubjO.js";import"./briefcase-BrtHsIPx.js";import"./user-B_P0OToR.js";import"./index-DD7f-jjb.js";import"./index-4DfuBNxG.js";import"./index-CdJFUDDL.js";import"./modalAnimations-CCENKliM.js";import"./supervisionHelpers-EJT0WNFw.js";import"./textarea-BHHa1WcU.js";import"./UnbindRequestModal-CjPjX1te.js";import"./user-minus-Bknv6i5e.js";import"./triangle-alert-Ekv-lfWL.js";import"./loader-circle-CUkwbdmU.js";import"./ResearchTab-BUGlnz42.js";import"./input-D-699YHd.js";import"./plus-D2jnJcPE.js";import"./trash-2-CCAXz_vu.js";import"./circle-oANRF4u5.js";import"./DocumentsTab-xlnEVDGp.js";import"./select-5Xk_1kGA.js";import"./index-DQXIHc7t.js";import"./chevron-down-Ccqnoyn8.js";import"./check-Cn-yF-8e.js";import"./chevron-up-CkRQIwml.js";import"./DocumentPreviewModal-fNofmB36.js";import"./upload-6J3aFnW3.js";import"./eye-6RvFiSEB.js";import"./UnifiedOverviewTab-CUhaIYhn.js";import"./mail-BWUDoef7.js";import"./phone-lKHNJrjH.js";import"./globe-BrJUhyAR.js";import"./RelationshipHistoryTab-DLK1SM-T.js";import"./circle-alert-D1CpmkQ4.js";import"./video-BSC8ERkf.js";import"./external-link-Ci6-j8Wy.js";import"./sticky-note-BJAXLsBM.js";import"./label-BCqeSoMm.js";import"./useGoogleCalendar-BdjEqcNS.js";import"./AcceptSupervisorOfferModal-gDmfx3c9.js";import"./checkbox-zZ-V3_T6.js";import"./AcceptSupervisionRequestModal-CN3Bram7.js";import"./lightbulb-CMZ5CblB.js";import"./DeclineSupervisionRequestModal-fa-9ib0C.js";import"./RejectUnbindModal-RpuFKpRJ.js";import"./clock-A6ijzZaL.js";import"./arrow-right-B1Q8s1Sb.js";import"./MeetingActionMenu-CP8Hr8lJ.js";import"./dropdown-menu-DVqPq_ka.js";import"./alert-dialog-U-3G6WOe.js";import"./ellipsis-vertical-BfduWr0V.js";import"./RescheduleMeetingDialog-CxiTMd70.js";import"./map-pin-C72Sfp5Z.js";import"./isTomorrow-BmoHjX9b.js";import"./index-BeI-chHt.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["path",{d:"M15.6 2.7a10 10 0 1 0 5.7 5.7",key:"1e0p6d"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M13.4 10.6 19 5",key:"1kr7tw"}]],ps=ss("CircleGauge",ms),ve=[{key:"pending",label:"Pending",badge:["pending","pending_student_acceptance"]},{key:"accepted",label:"Accepted",badge:"accepted"},{key:"rejected",label:"Rejected",badge:"rejected"},{key:"cancelled",label:"Cancelled",badge:["cancelled","auto_cancelled"]}];function nr(){const[s,d]=l.useState("requests"),[n,v]=l.useState([]),[i,y]=l.useState([]),[p,_]=l.useState([]),[c,x]=l.useState(null),[m,b]=l.useState(null),[S,h]=l.useState(null),[u,o]=l.useState(null),[R,B]=l.useState(!0),[H,V]=l.useState(!1),[z,g]=l.useState(null),[w,ie]=l.useState("pending"),[le,W]=l.useState(!1),[ne,be]=l.useState(null),[k,Ne]=l.useState([]),[P,we]=l.useState([]),[M,ye]=l.useState([]),[oe,ce]=l.useState(null),[_e,G]=l.useState(!1),[de,Ce]=l.useState([]),[Se,Re]=l.useState([]),[ke,Q]=l.useState(0),[me,Me]=l.useState(0),X=async()=>{try{g(null),B(!0);const[t,a,r]=await Promise.all([Z.get(route("supervision.requests.index")),Z.get(route("supervision.relationships.index")),Z.get("/api/v1/app/supervision/cosupervisor-invitations/my-invitations")]);v(t.data.data||[]);const C=a.data.data||[],f=C.filter(N=>N.status==="active"||N.status==="active"&&N.activeUnbindRequest),q=C.filter(N=>N.status==="terminated");if(y(f),_(q),Ne(r.data.as_cosupervisor||[]),we(r.data.to_approve||[]),ye(r.data.as_initiator||[]),Me(N=>N+1),m){const N=f.find(F=>F.id===m.id)||q.find(F=>F.id===m.id);b(N||null)}return C}catch(t){return Ze(t,"Supervision fetchData"),g("Unable to load supervision data right now."),[]}finally{B(!1)}},T=async()=>{H||(V(!0),await X(),V(!1))};l.useEffect(()=>{X()},[]),l.useEffect(()=>{if(R||n.length===0)return;const t=n.filter(f=>f.status==="accepted"&&!f.student_response_acknowledged_at),a=n.filter(f=>f.status==="auto_cancelled"&&!f.student_response_acknowledged_at);(t.length>0||a.length>0)&&(Ce(t),Re(a),G(!0));const r=localStorage.getItem("supervisor_last_viewed_cancelled_tab"),C=n.filter(f=>f.status==="cancelled"||f.status==="auto_cancelled");if(r){const f=new Date(r),q=C.filter(N=>new Date(N.decision_at||N.updated_at)>f);Q(q.length)}else Q(C.length)},[n,R]);const Ae=()=>{ie("cancelled"),localStorage.setItem("supervisor_last_viewed_cancelled_tab",new Date().toISOString()),Q(0)},J=l.useMemo(()=>{for(const t of i){const a=t.activeUnbindRequest;if(a&&a.status==="pending"&&a.initiated_by==="student")return{unbindRequest:a,relationship:t}}return null},[i]),L=l.useMemo(()=>n.filter(t=>{const a=ve.find(C=>C.key===w);return a?(Array.isArray(a.badge)?a.badge:[a.badge]).includes(t.status):!1}),[n,w]),E=l.useMemo(()=>{if(w==="pending"){const t=k.filter(r=>r.cosupervisor_status==="pending"||r.cosupervisor_status==="accepted"&&r.approver_status==="pending"),a=M.filter(r=>!r.completed_at&&!r.cancelled_at&&r.cosupervisor_status!=="rejected"&&r.approver_status!=="rejected");return[...t,...P,...a]}else if(w==="accepted"){const t=k.filter(r=>r.completed_at),a=M.filter(r=>r.completed_at);return[...t,...a]}else if(w==="rejected"){const t=k.filter(r=>r.cosupervisor_status==="rejected"||r.approver_status==="rejected"),a=M.filter(r=>r.cosupervisor_status==="rejected"||r.approver_status==="rejected");return[...t,...a]}else if(w==="cancelled"){const t=k.filter(r=>r.cancelled_at),a=M.filter(r=>r.cancelled_at);return[...t,...a]}return[]},[w,k,P,M]),O=l.useMemo(()=>{const t=i.length,a=k.filter(j=>j.cosupervisor_status==="pending"||j.cosupervisor_status==="accepted"&&j.approver_status==="pending").length,r=M.filter(j=>!j.completed_at&&!j.cancelled_at&&j.cosupervisor_status!=="rejected"&&j.approver_status!=="rejected").length,C=n.filter(j=>j.status==="pending"||j.status==="pending_student_acceptance").length+a+P.length+r,f=new Date,q=f.getMonth(),N=f.getFullYear(),F=i.reduce((j,K)=>{if(K.meetings&&Array.isArray(K.meetings)){const qe=K.meetings.filter(pe=>{if(!pe.scheduled_for)return!1;const ue=new Date(pe.scheduled_for);return ue.getMonth()===q&&ue.getFullYear()===N});return j+qe.length}return j},0),Te=i.filter(j=>j.scholarlab_board_id).length;return{totalStudents:t,pendingRequests:C,meetingsThisMonth:F,activeWorkspaces:Te}},[i,n,k,P,M]);return e.jsxs(Ie,{title:"Supervisor Dashboard",children:[e.jsx(Ue,{title:"Supervisor Dashboard"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-3 py-3 sm:px-4 sm:py-4 md:px-5 md:py-5 lg:px-0 lg:py-0 pb-6 space-y-6",children:[z&&e.jsx(Be,{variant:"destructive",children:e.jsx(Ve,{children:z})}),!R&&e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 pb-6 border-b border-slate-200",children:[e.jsx(Y,{value:O.totalStudents,label:"Total Students",icon:es,iconColor:"text-indigo-600",bgColor:"bg-indigo-50"}),e.jsx(Y,{value:O.pendingRequests,label:"Pending Requests",icon:te,iconColor:"text-amber-600",bgColor:"bg-amber-50"}),e.jsx(Y,{value:O.meetingsThisMonth,label:"Meetings this Month",icon:fe,iconColor:"text-green-600",bgColor:"bg-green-50"}),e.jsx(Y,{value:O.activeWorkspaces,label:"Active Workspaces",icon:ps,iconColor:"text-blue-600",bgColor:"bg-blue-50"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-0",children:[e.jsx("div",{className:"lg:col-span-9 lg:pr-6 lg:border-r border-slate-200",children:e.jsxs(Ee,{value:s,onValueChange:d,className:"space-y-6",children:[e.jsxs(Fe,{className:"grid w-full grid-cols-3 bg-gray-100 p-1 rounded-lg h-12",children:[e.jsx(ee,{value:"requests",className:"data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm data-[state=inactive]:text-gray-600 rounded-md transition-all py-2",children:"Manage Requests"}),e.jsx(ee,{value:"students",className:"data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm data-[state=inactive]:text-gray-600 rounded-md transition-all py-2",children:"My Students"}),e.jsx(ee,{value:"terminated",className:"data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm data-[state=inactive]:text-gray-600 rounded-md transition-all py-2",children:"Terminated"})]}),e.jsxs(se,{value:"requests",className:"space-y-4",children:[e.jsx(us,{filter:w,onChange:ie,onCancelledClick:Ae,requests:n,coSupervisorInvitations:k,approvalInvitations:P,myInitiatedInvitations:M,cancelledBadgeCount:ke}),R?e.jsx(bs,{}):e.jsxs("div",{className:"space-y-6",children:[E.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5 text-indigo-600"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[w==="pending"&&"Co-Supervisor Invitations",w==="accepted"&&"Accepted Co-Supervisor Invitations",w==="rejected"&&"Rejected Co-Supervisor Invitations",w==="cancelled"&&"Cancelled Co-Supervisor Invitations"]}),e.jsx(U,{variant:"secondary",className:"bg-indigo-100 text-indigo-700",children:E.length})]}),e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:E.map(t=>e.jsx(Je,{invitation:t,onClick:()=>ce(t)},t.id))})]}),L.length===0&&E.length===0?e.jsx(gs,{status:w}):L.length>0?e.jsxs("div",{children:[E.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ts,{className:"w-5 h-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Supervision Requests"}),e.jsx(U,{variant:"secondary",className:"bg-gray-100 text-gray-700",children:L.length})]}),e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:L.map(t=>e.jsx(xs,{request:t,onOpenDetail:a=>o(a)},t.id))})]}):null]})]}),e.jsx(se,{value:"students",children:R?e.jsx(xe,{}):i.length===0?e.jsx(fs,{}):e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:i.map(t=>e.jsx(hs,{relationship:t,onOpenDetail:a=>{a.preferred_tab?b(a):b(t),x(null)},onScheduleMeeting:a=>h(a),onAddCoSupervisor:a=>{be(a),W(!0)}},t.id))})}),e.jsx(se,{value:"terminated",children:R?e.jsx(xe,{}):p.length===0?e.jsx(js,{}):e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:p.map(t=>e.jsx(vs,{relationship:t,onViewHistory:a=>{b(a),x(null)}},t.id))})})]})}),e.jsx("div",{className:"lg:col-span-3 lg:pl-6 mt-6 lg:mt-0",children:e.jsxs("div",{className:"sticky top-6 space-y-6",children:[e.jsx(Ge,{userRole:"supervisor",triggerReload:me}),e.jsx(Qe,{userRole:"supervisor",triggerReload:me})]})})]}),m&&!c&&e.jsx(Le,{relationship:m,onClose:()=>b(null),onUpdated:T}),c&&e.jsx(ze,{request:c,relationship:m,onClose:()=>{x(null),b(null)},onUpdated:T}),e.jsx(Oe,{relationship:S,onClose:()=>h(null),onScheduled:T,userRole:"supervisor"}),u&&e.jsx(Ye,{request:u,onClose:()=>o(null),onUpdated:T,userRole:"supervisor"}),J&&e.jsx(He,{unbindRequest:J.unbindRequest,relationship:J.relationship,onResponse:T,userRole:"supervisor"}),e.jsx(We,{type:"response",data:{acceptances:de,rejections:Se},isOpen:_e,onClose:()=>G(!1),onNavigate:()=>{de.length>0&&d("students"),G(!1)}}),le&&ne&&e.jsx(Xe,{isOpen:le,onClose:()=>W(!1),relationship:ne,onInvite:()=>{W(!1),Pe.success("Co-supervisor invitation sent!"),T()}}),oe&&e.jsx(Ke,{invitation:oe,onClose:()=>ce(null),onUpdated:()=>{X()}})]})]})}function us({filter:s,onChange:d,onCancelledClick:n,requests:v,coSupervisorInvitations:i,approvalInvitations:y,myInitiatedInvitations:p,cancelledBadgeCount:_}){return e.jsx("div",{className:"flex flex-wrap items-center gap-3",children:ve.map(c=>{const x=Array.isArray(c.badge)?c.badge:[c.badge];let m=v.filter(h=>x.includes(h.status)).length;if(c.key==="pending"){const h=i?.filter(o=>o.cosupervisor_status==="pending"||o.cosupervisor_status==="accepted"&&o.approver_status==="pending").length||0,u=p?.filter(o=>!o.completed_at&&!o.cancelled_at&&o.cosupervisor_status!=="rejected"&&o.approver_status!=="rejected").length||0;m+=h+(y?.length||0)+u}else if(c.key==="accepted"){const h=i?.filter(o=>o.completed_at).length||0,u=p?.filter(o=>o.completed_at).length||0;m+=h+u}else if(c.key==="rejected"){const h=i?.filter(o=>o.cosupervisor_status==="rejected"||o.approver_status==="rejected").length||0,u=p?.filter(o=>o.cosupervisor_status==="rejected"||o.approver_status==="rejected").length||0;m+=h+u}else if(c.key==="cancelled"){const h=i?.filter(o=>o.cancelled_at).length||0,u=p?.filter(o=>o.cancelled_at).length||0;m+=h+u}const b=c.key==="cancelled",S=b&&_>0;return e.jsxs("div",{className:"relative",children:[e.jsxs(A,{variant:s===c.key?"default":"outline",onClick:()=>b&&n?n():d(c.key),className:"flex items-center gap-2",children:[c.label,e.jsx(U,{variant:s===c.key?"secondary":"outline",children:m})]}),S&&e.jsx("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white shadow-md",children:_})]},c.key)})})}function xs({request:s,onOpenDetail:d}){const n=s?.student,v=n?.full_name??"Student",i=n?.profile_picture?`/storage/${n.profile_picture}`:null,y=n?.university?.name??null,p=s?.status??"pending",_=s?.submitted_at?ae(new Date(s.submitted_at),"dd/MM/yyyy"):"—",c=s?.submitted_at?ds(new Date(s.submitted_at),{addSuffix:!0}):null,x={pending:"bg-amber-50 text-amber-700 border-none",pending_student_acceptance:"bg-blue-50 text-blue-700 border-none",accepted:"bg-emerald-50 text-emerald-700 border-none",rejected:"bg-rose-50 text-rose-700 border-none",cancelled:"bg-slate-100 text-slate-600 border-none",auto_cancelled:"bg-slate-100 text-slate-600 border-none"},m={pending:"Awaiting your review",pending_student_acceptance:"Awaiting student acceptance",accepted:"Accepted — relationship established",rejected:"Rejected — feedback provided",cancelled:"Cancelled by student",auto_cancelled:"Auto-cancelled after student accepted another offer"},b=x[p]??x.pending,S=m[p]??"Pending response",h=p.split("_").map(u=>u.charAt(0).toUpperCase()+u.slice(1)).join(" ");return e.jsxs("div",{className:"border rounded-xl p-5 bg-white shadow-sm hover:shadow-md transition-shadow cursor-pointer",onClick:()=>d(s),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center overflow-hidden flex-shrink-0",children:i?e.jsx("img",{src:i,alt:v,className:"w-full h-full object-cover rounded-full"}):e.jsx(as,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-[1.05rem] font-semibold text-gray-900 leading-snug truncate",children:v}),y&&e.jsx("p",{className:"text-sm text-gray-600 truncate font-normal",children:y}),c&&e.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:c})]})]}),e.jsx(U,{className:`${b} flex-shrink-0`,children:h})]}),e.jsx("div",{className:"mt-4",children:e.jsx("h4",{className:"text-base font-semibold text-slate-900 line-clamp-2 leading-snug",children:s?.proposal_title??"Supervision request"})}),S&&e.jsx("div",{className:"mt-2 flex items-start gap-1.5",children:e.jsx("span",{className:"text-sm text-slate-600",children:S})}),e.jsxs("div",{className:"mt-4 flex items-center gap-4 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(rs,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:_})]}),s?.attachments&&s.attachments.length>0&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(je,{className:"w-3.5 h-3.5"}),e.jsxs("span",{children:[s.attachments.length," file",s.attachments.length!==1?"s":""]})]})]}),e.jsx("div",{className:"mt-4 flex items-center gap-2 pt-4 border-t",children:e.jsxs(A,{variant:"outline",size:"sm",className:"flex-1",onClick:u=>{u.stopPropagation(),d(s)},children:[e.jsx(is,{className:"mr-2 h-4 w-4"}),"View Details"]})})]})}function hs({relationship:s,onOpenDetail:d,onScheduleMeeting:n,onAddCoSupervisor:v}){const i=s?.student??{},y=i.profile_picture?`/storage/${i.profile_picture}`:null,p=i.full_name??"Student",_=i.university?.name||i.university?.full_name||"",c=i.faculty?.name||"",x=i.research_domains?.[0]||i.field_of_research?.[0]||"",m=s?.role==="main"?"Main":"Co-supervisor",b=s?.cohort||"",S=s?.meeting_cadence?s.meeting_cadence.charAt(0).toUpperCase()+s.meeting_cadence.slice(1):"",h=p.split(" ").map(g=>g[0]).join("").toUpperCase().slice(0,3),u=s?.meetings?.length||0,o=s?.onboarding_checklist_items?.filter(g=>!g.completed).length||0,R=s?.documents?.length||0,B=()=>{d?.({...s,preferred_tab:"overview"}),setTimeout(()=>{n?.(s)},100)},H=()=>{d?.({...s,preferred_tab:"chat"})},V=()=>{d?.({...s,preferred_tab:"documents"})},z=()=>{De.visit(route("supervision.relationships.show",s.id))};return e.jsxs(D,{className:"shadow-sm hover:shadow-md transition-shadow cursor-pointer",onClick:()=>d?.({...s,preferred_tab:"overview"}),children:[e.jsx($,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx(he,{className:"h-12 w-12 border-2 border-slate-200",children:y?e.jsx("img",{src:y,alt:p,className:"h-full w-full object-cover"}):e.jsx(ge,{className:"bg-indigo-100 text-indigo-700 font-semibold text-xs",children:h})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-base font-bold text-slate-900 truncate mb-1",children:p}),e.jsx("p",{className:"text-sm text-slate-600 truncate",children:_&&c?`${_} • ${c}`:_||c||"University"}),x&&e.jsx("p",{className:"text-xs text-slate-500 mt-1.5 line-clamp-1",children:x})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1 flex-shrink-0",children:[e.jsx(U,{className:"bg-slate-900 text-white border-none hover:bg-slate-800 px-2 py-0.5 text-xs",children:m}),b&&S&&e.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:[b," • ",S]})]})]})}),e.jsxs(I,{className:"space-y-3 pb-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-slate-50",children:[e.jsx("div",{className:"text-xl font-bold text-slate-900",children:u}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Meetings"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-slate-50",children:[e.jsx("div",{className:"text-xl font-bold text-slate-900",children:o}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Tasks"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-slate-50",children:[e.jsx("div",{className:"text-xl font-bold text-slate-900",children:R}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Documents"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(A,{variant:"outline",size:"sm",className:"w-full h-8 text-xs",onClick:g=>{g.stopPropagation(),B()},children:[e.jsx(fe,{className:"mr-1.5 h-3.5 w-3.5"}),"Schedule Meeting"]}),e.jsxs(A,{variant:"outline",size:"sm",className:"w-full h-8 text-xs",onClick:g=>{g.stopPropagation(),H()},children:[e.jsx(ls,{className:"mr-1.5 h-3.5 w-3.5"}),"Chat"]}),e.jsxs(A,{variant:"outline",size:"sm",className:"w-full h-8 text-xs",onClick:g=>{g.stopPropagation(),V()},children:[e.jsx(je,{className:"mr-1.5 h-3.5 w-3.5"}),"Share Document"]}),e.jsxs(A,{variant:"outline",size:"sm",className:"w-full h-8 text-xs",onClick:g=>{g.stopPropagation(),z()},children:[e.jsx(ns,{className:"mr-1.5 h-3.5 w-3.5"}),"Manage"]})]}),s?.role==="main"&&v&&e.jsxs(A,{variant:"default",size:"sm",className:"w-full h-8 text-xs bg-indigo-600 hover:bg-indigo-700",onClick:g=>{g.stopPropagation(),v(s)},children:[e.jsx(te,{className:"mr-1.5 h-3.5 w-3.5"}),"Add Co-Supervisor"]})]})]})}function gs({status:s}){const d={pending:{title:"No pending requests",description:"You do not have any new supervision proposals right now. Students will appear here when they submit a request or when they need to accept your offer."},accepted:{title:"No accepted requests yet",description:"Accepted proposals appear here. When you approve a student and they accept, they will transition to the My Students tab."},rejected:{title:"No rejected requests",description:"Rejected proposals will appear here for reference."},cancelled:{title:"No cancelled requests",description:"Cancelled requests (by student or system) will appear here for reference."}}[s]||{title:"No requests found",description:"Try selecting another status filter."};return e.jsxs(D,{className:"border-dashed border-slate-200",children:[e.jsx($,{children:e.jsx(re,{className:"text-lg font-semibold text-slate-800",children:d.title})}),e.jsx(I,{className:"text-sm text-slate-600",children:d.description})]})}function fs(){return e.jsxs(D,{className:"border-dashed border-slate-200",children:[e.jsx($,{children:e.jsx(re,{className:"text-lg font-semibold text-slate-800",children:"No supervisees yet"})}),e.jsx(I,{className:"text-sm text-slate-600",children:"Once you accept a student, they will appear here for ongoing management. Use the Manage Requests tab to approve new proposals."})]})}function js(){return e.jsxs(D,{className:"border-dashed border-slate-200",children:[e.jsx($,{children:e.jsx(re,{className:"text-lg font-semibold text-slate-800",children:"No terminated relationships"})}),e.jsx(I,{className:"text-sm text-slate-600",children:"Terminated supervision relationships will appear here for historical reference. This includes unbind requests, graduations, and other reasons for ending supervision."})]})}function vs({relationship:s,onViewHistory:d}){const n=s?.student,v=n?.full_name||"Student",i=v.split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,3),y=s?.accepted_at?ae(new Date(s.accepted_at),"dd/MM/yyyy"):"—",p=s?.terminated_at?ae(new Date(s.terminated_at),"dd/MM/yyyy"):"—",c=(()=>{const x=s?.unbindRequests?.find(m=>m.status==="approved"||m.status==="force_unbind");return x?x.status==="force_unbind"?"Force Unbind (3 attempts)":"Unbind Request Approved":"Supervision Ended"})();return e.jsxs(D,{className:"border-slate-200 bg-slate-50/50 hover:shadow-md transition-shadow",children:[e.jsx($,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(he,{className:"h-12 w-12",children:n?.profile_picture?e.jsx("img",{src:`/storage/${n.profile_picture}`,alt:v,className:"h-full w-full object-cover"}):e.jsx(ge,{className:"bg-slate-200 text-slate-600 font-semibold",children:i})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-slate-900 truncate",children:v}),e.jsx("p",{className:"text-sm text-slate-500",children:n?.university?.name||"University"}),e.jsx("div",{className:"mt-2",children:e.jsx(U,{className:"bg-red-50 text-red-700 border-red-200 border",children:"Terminated"})})]})]})}),e.jsxs(I,{className:"space-y-3 pb-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Started"}),e.jsx("div",{className:"font-medium text-slate-700",children:y})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Ended"}),e.jsx("div",{className:"font-medium text-slate-700",children:p})]})]}),e.jsx("div",{className:"pt-2 border-t border-slate-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(os,{className:"h-4 w-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-0.5",children:"Reason"}),e.jsx("div",{className:"text-sm text-slate-700",children:c})]})]})})]}),e.jsx($e,{className:"pt-3",children:e.jsxs(A,{variant:"outline",className:"w-full",onClick:()=>d(s),children:[e.jsx(cs,{className:"mr-2 h-4 w-4"}),"View History"]})})]})}function bs(){return e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:Array.from({length:4}).map((s,d)=>e.jsxs("div",{className:"border border-dashed rounded-xl p-4 sm:p-5 bg-white shadow-sm animate-pulse min-h-[300px] sm:min-h-[320px] flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-1.5 sm:space-y-2 min-w-0",children:[e.jsx("div",{className:"h-3.5 sm:h-4 w-28 sm:w-32 rounded bg-slate-200"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-20 sm:w-24 rounded bg-slate-100"}),e.jsx("div",{className:"h-2 sm:h-2.5 w-24 sm:w-28 rounded bg-slate-100"})]})]}),e.jsx("div",{className:"h-5 sm:h-6 w-16 sm:w-20 rounded-full bg-slate-200 flex-shrink-0"})]}),e.jsxs("div",{className:"mt-3 sm:mt-4",children:[e.jsx("div",{className:"h-4 sm:h-5 w-full rounded bg-slate-100"}),e.jsx("div",{className:"h-4 sm:h-5 w-3/4 rounded bg-slate-100 mt-2"})]}),e.jsx("div",{className:"mt-2 flex-1 space-y-2",children:e.jsx("div",{className:"h-12 sm:h-14 w-full rounded-md bg-slate-100"})}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-3 sm:gap-4",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-20 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-16 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-24 rounded bg-slate-100"})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-2 pt-3 sm:pt-4 border-t border-slate-200",children:[e.jsx("div",{className:"h-8 sm:h-9 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-8 sm:h-9 w-8 sm:w-9 rounded bg-slate-200"})]})]},`request-skeleton-${d}`))})}function xe(){return e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:Array.from({length:4}).map((s,d)=>e.jsxs("div",{className:"border border-dashed rounded-xl p-4 sm:p-5 bg-white shadow-sm animate-pulse min-h-[280px] sm:min-h-[300px] flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-1.5 sm:space-y-2 min-w-0",children:[e.jsx("div",{className:"h-3.5 sm:h-4 w-28 sm:w-32 rounded bg-slate-200"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-20 sm:w-24 rounded bg-slate-100"}),e.jsx("div",{className:"h-2 sm:h-2.5 w-24 sm:w-28 rounded bg-slate-100"})]})]}),e.jsx("div",{className:"h-5 sm:h-6 w-14 sm:w-16 rounded-full bg-slate-100 flex-shrink-0"})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex-1",children:[e.jsx("div",{className:"h-3.5 sm:h-4 w-full rounded bg-slate-100"}),e.jsx("div",{className:"h-3.5 sm:h-4 w-2/3 rounded bg-slate-100 mt-2"})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-20 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-16 rounded bg-slate-100"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-24 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-20 rounded bg-slate-100"})]})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-2 pt-3 sm:pt-4 border-t border-slate-200",children:[e.jsx("div",{className:"h-8 sm:h-9 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-8 sm:h-9 w-8 sm:w-9 rounded bg-slate-200"})]})]},`student-skeleton-${d}`))})}function Y({value:s,label:d,icon:n,iconColor:v,bgColor:i}){return e.jsx(D,{className:"border-slate-200 shadow-sm",children:e.jsx(I,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-slate-900",children:s}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:d})]}),e.jsx("div",{className:`${i} p-3 rounded-lg`,children:e.jsx(n,{className:`h-6 w-6 ${v}`})})]})})})}export{nr as default};
