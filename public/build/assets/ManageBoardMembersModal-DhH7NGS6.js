import{c as se}from"./createLucideIcon-D9Xjp5kf.js";import{r as l,R as m,c as le,j as o,a as oe,y as ie}from"./app-Ba9NEla_.js";import{M as ce}from"./Modal-C3pBVycS.js";import{P as ue}from"./PrimaryButton-pwHuaSyw.js";import{S as de}from"./SecondaryButton-BYvENvvQ.js";import{c as w}from"./index-DW2eQRph.js";import{a as k}from"./utils-D-KgF5mV.js";import{Q as fe,K as me,u as he,b as pe,$ as ge,a as xe,w as ye,e as be,r as ve}from"./InlineEdit-B_ke0Siu.js";import{o as $,p as L,m as je,K as Se,L as U,y as Ne,_ as $e}from"./transition-DxPkQ6VA.js";import{d as R,s as _,H as we,w as ke,c as Ee,U as Pe,o as I}from"./dialog-DI12n2Mi.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],rt=se("LayoutGrid",Ce);function Te(t,r,e){let[a,s]=l.useState(e),i=t!==void 0,d=l.useRef(i),u=l.useRef(!1),h=l.useRef(!1);return i&&!d.current&&!u.current?(u.current=!0,d.current=i,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!i&&d.current&&!h.current&&(h.current=!0,d.current=i,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[i?t:a,$(p=>(i||s(p),r==null?void 0:r(p)))]}function Fe(t){let[r]=l.useState(t);return r}function A(t={},r=null,e=[]){for(let[a,s]of Object.entries(t))O(e,B(r,a),s);return e}function B(t,r){return t?t+"["+r+"]":r}function O(t,r,e){if(Array.isArray(e))for(let[a,s]of e.entries())O(t,B(r,a.toString()),s);else e instanceof Date?t.push([r,e.toISOString()]):typeof e=="boolean"?t.push([r,e?"1":"0"]):typeof e=="string"?t.push([r,e]):typeof e=="number"?t.push([r,`${e}`]):e==null?t.push([r,""]):A(e,r,t)}function Me(t){var r,e;let a=(r=t==null?void 0:t.form)!=null?r:t.closest("form");if(a){for(let s of a.elements)if(s!==t&&(s.tagName==="INPUT"&&s.type==="submit"||s.tagName==="BUTTON"&&s.type==="submit"||s.nodeName==="INPUT"&&s.type==="image")){s.click();return}(e=a.requestSubmit)==null||e.call(a)}}let De=l.createContext(null);function Ie({children:t}){let r=l.useContext(De);if(!r)return m.createElement(m.Fragment,null,t);let{target:e}=r;return e?le.createPortal(m.createElement(m.Fragment,null,t),e):null}function Le({data:t,form:r,disabled:e,onReset:a,overrides:s}){let[i,d]=l.useState(null),u=L();return l.useEffect(()=>{if(a&&i)return u.addEventListener(i,"reset",a)},[i,r,a]),m.createElement(Ie,null,m.createElement(Ue,{setForm:d,formId:r}),A(t).map(([h,p])=>m.createElement(R,{features:_.Hidden,...je({key:h,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:r,disabled:e,name:h,value:p,...s})})))}function Ue({setForm:t,formId:r}){return l.useEffect(()=>{if(r){let e=document.getElementById(r);e&&t(e)}},[t,r]),r?null:m.createElement(R,{features:_.Hidden,as:"input",type:"hidden",hidden:!0,readOnly:!0,ref:e=>{if(!e)return;let a=e.closest("form");a&&t(a)}})}let E=l.createContext(null);E.displayName="GroupContext";let Re=l.Fragment;function _e(t){var r;let[e,a]=l.useState(null),[s,i]=me(),[d,u]=ke(),h=l.useMemo(()=>({switch:e,setSwitch:a}),[e,a]),p={},y=t,b=U();return m.createElement(u,{name:"Switch.Description",value:d},m.createElement(i,{name:"Switch.Label",value:s,props:{htmlFor:(r=h.switch)==null?void 0:r.id,onClick(n){e&&(n.currentTarget instanceof HTMLLabelElement&&n.preventDefault(),e.click(),e.focus({preventScroll:!0}))}}},m.createElement(E.Provider,{value:h},b({ourProps:p,theirProps:y,slot:{},defaultTag:Re,name:"Switch.Group"}))))}let Ae="button";function Be(t,r){var e;let a=l.useId(),s=he(),i=Ee(),{id:d=s||`headlessui-switch-${a}`,disabled:u=i||!1,checked:h,defaultChecked:p,onChange:y,name:b,value:n,form:c,autoFocus:f=!1,...v}=t,x=l.useContext(E),[G,H]=l.useState(null),K=l.useRef(null),q=Ne(K,r,x===null?null:x.setSwitch,H),j=Fe(p),[S,N]=Te(h,y,j??!1),V=L(),[P,C]=l.useState(!1),T=$(()=>{C(!0),N==null||N(!S),V.nextFrame(()=>{C(!1)})}),W=$(g=>{if(ve(g.currentTarget))return g.preventDefault();g.preventDefault(),T()}),z=$(g=>{g.key===I.Space?(g.preventDefault(),T()):g.key===I.Enter&&Me(g.currentTarget)}),J=$(g=>g.preventDefault()),Q=pe(),X=Pe(),{isFocusVisible:F,focusProps:Y}=ge({autoFocus:f}),{isHovered:M,hoverProps:Z}=xe({isDisabled:u}),{pressed:D,pressProps:ee}=ye({disabled:u}),te=l.useMemo(()=>({checked:S,disabled:u,hover:M,focus:F,active:D,autofocus:f,changing:P}),[S,M,F,D,u,P,f]),re=$e({id:d,ref:q,role:"switch",type:be(t,G),tabIndex:t.tabIndex===-1?0:(e=t.tabIndex)!=null?e:0,"aria-checked":S,"aria-labelledby":Q,"aria-describedby":X,disabled:u||void 0,autoFocus:f,onClick:W,onKeyUp:z,onKeyPress:J},Y,Z,ee),ne=l.useCallback(()=>{if(j!==void 0)return N==null?void 0:N(j)},[N,j]),ae=U();return m.createElement(m.Fragment,null,b!=null&&m.createElement(Le,{disabled:u,data:{[b]:n||"on"},overrides:{type:"checkbox",checked:S},form:c,onReset:ne}),ae({ourProps:re,theirProps:v,slot:te,defaultTag:Ae,name:"Switch"}))}let Oe=Se(Be),Ge=_e,He=fe,Ke=we,qe=Object.assign(Oe,{Group:Ge,Label:He,Description:Ke});function nt({show:t,onClose:r,board:e,workspaceMembers:a}){const[s,i]=l.useState([]),[d,u]=l.useState(!1);l.useEffect(()=>{t&&e&&e.members&&i(e.members.map(n=>n.id))},[t,e]);const h=n=>{i(c=>c.includes(n)?c.filter(f=>f!==n):[...c,n])},p=n=>{n.preventDefault(),u(!0),oe.post(route("project-hub.boards.sync-members",e.id),{user_ids:s}).then(c=>{w.success("Board access updated successfully"),ie.reload({preserveScroll:!0,onSuccess:()=>{r()},onError:()=>{r(),w.error("Changes saved but page refresh failed. Please reload the page.")}})}).catch(c=>{var v,x;const f=((x=(v=c.response)==null?void 0:v.data)==null?void 0:x.message)||"Failed to update board access";w.error(f),u(!1)})},y=n=>{if(!n)return"Unknown User";const c=n.academician||n.postgraduate||n.undergraduate;return(c==null?void 0:c.full_name)||n.name},b=n=>{var f,v,x;if(!n)return null;const c=((f=n.academician)==null?void 0:f.profile_picture)||((v=n.postgraduate)==null?void 0:v.profile_picture)||((x=n.undergraduate)==null?void 0:x.profile_picture);return c?`/storage/${c}`:null};return o.jsx(ce,{show:t,onClose:r,maxWidth:"md",children:o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Manage Board Access"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1 mb-4",children:"Use the toggle to grant or revoke board access for each member."}),o.jsxs("form",{onSubmit:p,className:"space-y-4",children:[o.jsx("div",{className:"bg-gray-50 rounded-lg p-2 max-h-80 overflow-y-auto",children:a&&a.length>0?o.jsx("div",{className:"space-y-3",children:a.map(n=>{var c,f;return o.jsxs("div",{className:k("flex justify-between items-center p-3 rounded-lg transition-colors duration-200",s.includes(n.id)?"bg-indigo-50 border border-indigo-200":"bg-white border border-gray-100"),children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:b(n)?o.jsx("img",{src:b(n),alt:y(n),className:"h-full w-full object-cover"}):o.jsx("span",{className:"text-gray-500 text-sm",children:y(n).charAt(0)})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:y(n)}),o.jsx("p",{className:"text-xs text-gray-500",children:(((c=n.pivot)==null?void 0:c.role)||"Member").charAt(0).toUpperCase()+(((f=n.pivot)==null?void 0:f.role)||"Member").slice(1)})]})]}),o.jsx(qe,{checked:s.includes(n.id),onChange:()=>h(n.id),disabled:d,className:k("relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",s.includes(n.id)?"bg-indigo-600":"bg-gray-200"),children:o.jsx("span",{"aria-hidden":"true",className:k("pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",s.includes(n.id)?"translate-x-5":"translate-x-0")})})]},n.id)})}):o.jsx("div",{className:"text-center p-4",children:o.jsx("p",{className:"text-gray-500",children:"No members available to manage."})})}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx(de,{onClick:r,disabled:d,children:"Cancel"}),o.jsx(ue,{type:"submit",disabled:d,children:d?"Saving...":"Save Changes"})]})]})]})})}export{rt as L,nt as M};
