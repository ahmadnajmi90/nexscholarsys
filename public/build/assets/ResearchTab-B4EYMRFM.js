import{r as o,j as e,b}from"./app-A8xQkvSk.js";import{c as m}from"./index-Km-vM6Jb.js";import{B as h}from"./button-Dz_rydmG.js";import{I as k}from"./input-D2p8biwd.js";import{T as v}from"./textarea-DGdKxzUN.js";import{c as me}from"./index-BEzQHz4a.js";import{P as W}from"./index-7Qlnuq3l.js";import{c as ue}from"./utils-CIsb_jhR.js";import{S as he}from"./scroll-area-COMlVIOb.js";import"./separator-B59s4oDI.js";import{l as j}from"./logError-D4ezqrCx.js";import{L as A}from"./loader-circle-DkpR38mE.js";import{P as X}from"./plus-BqbQZKPX.js";import{T as q}from"./trash-2-XEAf-v5f.js";import{C as xe}from"./circle-check-ddCD_g9w.js";import{C as ge}from"./circle-eov79Dsa.js";import{C as pe}from"./calendar-EpaZ4Aad.js";import{c as fe}from"./createLucideIcon-DPzobtnR.js";import{f as be}from"./format-hTuirObu.js";import"./clsx-B-dksMZM.js";import"./index-OrEFxIKi.js";import"./index-B0SlzLk6.js";import"./en-US-DNUEYIb-.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],je=fe("Save",ve);var T="Progress",I=100,[Ne,Ze]=me(T),[we,ye]=Ne(T),Y=o.forwardRef((t,a)=>{const{__scopeProgress:l,value:n=null,max:i,getValueLabel:S=Ce,...N}=t;(i||i===0)&&!J(i)&&console.error(Me(`${i}`,"Progress"));const c=J(i)?i:I;n!==null&&!Q(n,c)&&console.error(ke(`${n}`,"Progress"));const d=Q(n,c)?n:null,w=_(d)?S(d,c):void 0;return e.jsx(we,{scope:l,value:d,max:c,children:e.jsx(W.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":_(d)?d:void 0,"aria-valuetext":w,role:"progressbar","data-state":U(d,c),"data-value":d??void 0,"data-max":c,...N,ref:a})})});Y.displayName=T;var Z="ProgressIndicator",O=o.forwardRef((t,a)=>{const{__scopeProgress:l,...n}=t,i=ye(Z,l);return e.jsx(W.div,{"data-state":U(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...n,ref:a})});O.displayName=Z;function Ce(t,a){return`${Math.round(t/a*100)}%`}function U(t,a){return t==null?"indeterminate":t===a?"complete":"loading"}function _(t){return typeof t=="number"}function J(t){return _(t)&&!isNaN(t)&&t>0}function Q(t,a){return _(t)&&!isNaN(t)&&t<=a&&t>=0}function Me(t,a){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${a}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${I}\`.`}function ke(t,a){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${a}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${I} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var ee=Y,_e=O;const se=o.forwardRef(({className:t,value:a,...l},n)=>e.jsx(ee,{ref:n,className:ue("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",t),...l,children:e.jsx(_e,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));se.displayName=ee.displayName;function Oe({relationship:t,onUpdated:a,isReadOnly:l=!1}){const[n,i]=o.useState(null),[S,N]=o.useState(!0),[c,d]=o.useState(!1),[w,$]=o.useState(""),[x,y]=o.useState([]),[C,E]=o.useState(0),[F,R]=o.useState(""),[D,L]=o.useState(""),[z,V]=o.useState(""),[G,B]=o.useState(""),[p,M]=o.useState([]),[te,P]=o.useState(!1),[u,f]=o.useState({title:"",description:"",due_date:""}),[H,K]=o.useState(!1);o.useEffect(()=>{ae()},[t==null?void 0:t.id]);const ae=async()=>{if(t!=null&&t.id){N(!0);try{const r=(await b.get(route("supervision.relationships.research.show",t.id))).data.data;i(r),$(r.title||""),y(r.objectives||[]),E(r.progress_percentage||0),R(r.key_findings||""),L(r.literature_notes||""),V(r.methodology_notes||""),B(r.free_form_content||""),M(r.milestones||[])}catch(s){j(s,"ResearchTab loadResearch"),m.error("Failed to load research details")}finally{N(!1)}}},re=async()=>{d(!0);try{await b.put(route("supervision.relationships.research.update",t.id),{title:w,objectives:x,progress_percentage:C,key_findings:F,literature_notes:D,methodology_notes:z,free_form_content:G}),m.success("Research details saved successfully"),a==null||a()}catch(s){j(s,"ResearchTab handleSaveResearch"),m.error("Failed to save research details")}finally{d(!1)}},le=()=>{y([...x,""])},oe=(s,r)=>{const g=[...x];g[s]=r,y(g)},ie=s=>{y(x.filter((r,g)=>g!==s))},ne=async()=>{if(!u.title.trim()){m.error("Milestone title is required");return}K(!0);try{const s=await b.post(route("supervision.relationships.milestones.store",t.id),u);M([...p,s.data.data]),f({title:"",description:"",due_date:""}),P(!1),m.success("Milestone added successfully"),a==null||a()}catch(s){j(s,"ResearchTab handleAddMilestone"),m.error("Failed to add milestone")}finally{K(!1)}},ce=async s=>{try{await b.put(route("supervision.milestones.update",s.id),{completed:!s.completed}),M(p.map(r=>r.id===s.id?{...r,completed:!r.completed}:r)),m.success(`Milestone ${s.completed?"unmarked":"completed"}`),a==null||a()}catch(r){j(r,"ResearchTab handleToggleMilestone"),m.error("Failed to update milestone")}},de=async s=>{if(confirm("Are you sure you want to delete this milestone?"))try{await b.delete(route("supervision.milestones.destroy",s)),M(p.filter(r=>r.id!==s)),m.success("Milestone deleted"),a==null||a()}catch(r){j(r,"ResearchTab handleDeleteMilestone"),m.error("Failed to delete milestone")}};return S?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(A,{className:"h-8 w-8 animate-spin text-indigo-600"})}):e.jsx(he,{className:"h-full",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-900",children:"Research Management"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Track research progress, milestones, and notes collaboratively"})]})}),e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Research Title"}),e.jsx(k,{value:w,onChange:s=>$(s.target.value),placeholder:"Enter your research title...",className:"text-base",disabled:l})]}),e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Overall Progress"}),e.jsxs("span",{className:"text-2xl font-bold text-indigo-600",children:[C,"%"]})]}),e.jsx(se,{value:C,className:"mb-3"}),e.jsx("input",{type:"range",min:"0",max:"100",value:C,onChange:s=>E(Number(s.target.value)),className:"w-full",disabled:l})]}),e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Research Objectives"}),!l&&e.jsxs(h,{size:"sm",variant:"outline",onClick:le,children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Add Objective"]})]}),e.jsx("div",{className:"space-y-3",children:x.length===0?e.jsx("p",{className:"text-sm text-slate-500 text-center py-4",children:'No objectives added yet. Click "Add Objective" to get started.'}):x.map((s,r)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("span",{className:"flex-shrink-0 mt-2 text-sm font-medium text-slate-500",children:[r+1,"."]}),e.jsx(k,{value:s,onChange:g=>oe(r,g.target.value),placeholder:"Enter objective...",className:"flex-1",disabled:l}),!l&&e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>ie(r),className:"flex-shrink-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(q,{className:"h-4 w-4"})})]},r))})]}),e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Milestones"}),!l&&e.jsxs(h,{size:"sm",variant:"outline",onClick:()=>P(!0),children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Add Milestone"]})]}),!l&&te&&e.jsxs("div",{className:"mb-4 p-4 bg-indigo-50 rounded-lg border border-indigo-200",children:[e.jsx(k,{placeholder:"Milestone title",value:u.title,onChange:s=>f({...u,title:s.target.value}),className:"mb-3"}),e.jsx(v,{placeholder:"Description (optional)",value:u.description,onChange:s=>f({...u,description:s.target.value}),rows:2,className:"mb-3"}),e.jsx(k,{type:"date",value:u.due_date,onChange:s=>f({...u,due_date:s.target.value}),className:"mb-3"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>{P(!1),f({title:"",description:"",due_date:""})},children:"Cancel"}),e.jsxs(h,{size:"sm",onClick:ne,disabled:H,children:[H&&e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Add"]})]})]}),e.jsx("div",{className:"space-y-3",children:p.length===0?e.jsx("p",{className:"text-sm text-slate-500 text-center py-4",children:"No milestones yet. Add your first milestone to track progress."}):p.map(s=>e.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-lg border ${s.completed?"bg-green-50 border-green-200":"bg-white border-slate-200"}`,children:[e.jsx("button",{onClick:()=>ce(s),className:"flex-shrink-0 mt-1",disabled:l,children:s.completed?e.jsx(xe,{className:"h-5 w-5 text-green-600"}):e.jsx(ge,{className:"h-5 w-5 text-slate-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:`font-medium ${s.completed?"text-green-900 line-through":"text-slate-900"}`,children:s.title}),s.description&&e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-slate-500",children:[s.due_date&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"h-3 w-3"}),"Due: ",be(new Date(s.due_date),"dd/MM/yyyy")]}),s.creator&&e.jsxs("span",{children:["Created by: ",s.creator.full_name]})]})]}),!l&&e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>de(s.id),className:"flex-shrink-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(q,{className:"h-4 w-4"})})]},s.id))})]}),e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Key Findings"}),e.jsx(v,{value:F,onChange:s=>R(s.target.value),placeholder:"Document your key research findings here...",rows:6,disabled:l})]}),e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Literature Review Notes"}),e.jsx(v,{value:D,onChange:s=>L(s.target.value),placeholder:"Track literature review, key papers, citations...",rows:6,disabled:l})]}),e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Methodology Notes"}),e.jsx(v,{value:z,onChange:s=>V(s.target.value),placeholder:"Document your research methodology, experiments, data collection...",rows:6,disabled:l})]}),e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"General Notes"}),e.jsx(v,{value:G,onChange:s=>B(s.target.value),placeholder:"Add any additional notes, ideas, or observations...",rows:8,disabled:l})]}),!l&&e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(h,{onClick:re,disabled:c,size:"lg",children:[c?e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(je,{className:"mr-2 h-4 w-4"}),"Save All Changes"]})})]})})}export{Oe as default};
