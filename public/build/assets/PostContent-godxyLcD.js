import{r as l,j as e,b as N,a as w}from"./app-DVhy0H9p.js";import{I as y,J as v,U as O,K as k,V as U,W as B,X as G,n as H,d as W}from"./index-nCyfuPKn.js";import{u as V}from"./useRoles-Di03Q3p7.js";import{t as J,a as q}from"./analytics-BQ374C1C.js";import{B as K}from"./BookmarkButton-BO9Kc35C.js";import{p as X}from"./purify.es-B2xYLbnv.js";import{A as Q}from"./arrow-left-0zwV0OUz.js";import{T as Y}from"./tag-RmtORrkp.js";import{F as Z}from"./file-text-DgkdQnqA.js";import"./iconBase-Dh95kHzK.js";import"./index-Bdu0quS4.js";import"./BookmarkHandler-CyH8pXm5.js";import"./tooltip-C_kbNenU.js";import"./index-qiM-PJnI.js";import"./index-BEgRjMNY.js";import"./index-B2VDO2Ow.js";import"./index-BLyIJBR_.js";import"./index-BHSsduQR.js";import"./floating-ui.dom-eiE65J5j.js";import"./index-D-PytR3f.js";import"./utils-CIsb_jhR.js";import"./clsx-B-dksMZM.js";import"./createLucideIcon-CXlRbZBu.js";const _=({html:a,className:n})=>{const r=X.sanitize(a||"",{ALLOWED_TAGS:["b","i","u","p","br","ul","ol","li","strong","em","a","h1","h2","h3","h4","h5","h6"],ALLOWED_ATTR:["href","target","rel"]});return!r||r.trim()===""?e.jsx("p",{className:n,children:"No content available"}):e.jsx("div",{className:n,dangerouslySetInnerHTML:{__html:r}})};function ve({post:a,academicians:n,postgraduates:r,undergraduates:g,isWelcome:L,auth:C,metaTags:S,relatedPosts:m}){const{isAcademician:A,isPostgraduate:E,isUndergraduate:I}=V(),[f,b]=l.useState(null),[d,p]=l.useState(!1),[F,T]=l.useState(a.total_likes||0),[P,$]=l.useState(a.total_shares||0),[R,z]=l.useState(a.liked||!1),[j,i]=l.useState(!1),x=l.useRef(null);l.useEffect(()=>{const s=t=>{x.current&&!x.current.contains(t.target)&&i(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),l.useEffect(()=>{J(window.location.pathname),q("Post","view",a.title,a.id)},[]);const c=A&&n&&n.find(s=>s.academician_id===a.author_id)||E&&r&&r.find(s=>s.postgraduate_id===a.author_id)||I&&g&&g.find(s=>s.undergraduate_id===a.author_id)||null;console.log("Props:",{post:a,metaTags:S});const D=()=>{if(!C){window.location.href=route("login");return}w.post(route("posts.toggleLike",a.url)).then(s=>{T(s.data.total_likes),z(s.data.liked)}).catch(s=>console.error(s))},o=s=>{const t=route("welcome.posts.show",a.url);switch(s){case"copy":navigator.clipboard.writeText(t);break;case"facebook":window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(t)}`,"_blank");break;case"whatsapp":window.open(`https://wa.me/?text=${encodeURIComponent(t)}`,"_blank");break;case"linkedin":window.open(`https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(t)}&title=${encodeURIComponent(a.title)}`,"_blank");break}w.post(route("posts.share",a.url)).then(u=>{$(u.data.total_shares)}).catch(u=>{console.error("Error sharing:",u)})},M=s=>{b(s),p(!0)},h=()=>{p(!1),b(null)};return l.useEffect(()=>{const s=t=>{t.key==="Escape"&&h()};return d&&(document.addEventListener("keydown",s),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",s),document.body.style.overflow="unset"}},[d]),e.jsx("div",{className:"px-6 md:px-8 lg:px-4",children:e.jsxs("div",{className:"max-w-8xl mx-auto py-4 lg:pt-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(N,{onClick:()=>window.history.back(),className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50","aria-label":"Go back to previous page",children:[e.jsx(Q,{className:"w-4 h-4"}),"Back"]})}),a.title&&e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-4 text-left",children:a.title}),c?e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("img",{src:`/storage/${c.profile_picture}`,alt:c.full_name,className:"w-12 h-12 rounded-full object-cover shadow-md bg-gray-200 border-2 border-white"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:c.full_name}),e.jsx("div",{className:"text-gray-500",children:new Date(a.created_at).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]}):e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("img",{src:"/storage/Admin.jpg",alt:"Admin",className:"w-12 h-12 rounded-full object-cover shadow-md border-2 border-white"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:"Admin"}),e.jsx("div",{className:"text-gray-500",children:new Date(a.created_at).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]}),e.jsxs("div",{className:"my-4",children:[e.jsx("hr",{}),e.jsxs("div",{className:"flex flex-wrap items-center space-x-4 py-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{className:"w-6 h-6 text-gray-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:a.total_views})]}),e.jsxs("button",{onClick:D,className:"flex items-center",children:[R?e.jsx(v,{className:"w-6 h-6 text-red-600"}):e.jsx(O,{className:"w-6 h-6 text-gray-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:F})]}),e.jsxs("div",{className:"relative",ref:x,children:[e.jsx("button",{onClick:()=>i(!j),className:"flex items-center",children:e.jsx(k,{className:"w-6 h-6 text-gray-600"})}),j&&e.jsxs("div",{className:"absolute left-0 mt-2 w-40 bg-white shadow-lg rounded z-10",children:[e.jsxs("button",{onClick:()=>{o("copy"),i(!1)},className:"block w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center",children:[e.jsx(U,{className:"w-5 h-5 inline mr-2 text-gray-600"}),"Copy Link"]}),e.jsx("hr",{className:"my-1"}),e.jsxs("button",{onClick:()=>{o("facebook"),i(!1)},className:"block w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center",children:[e.jsx(B,{className:"w-5 h-5 inline mr-2 text-blue-600"}),"Facebook"]}),e.jsxs("button",{onClick:()=>{o("whatsapp"),i(!1)},className:"block w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center",children:[e.jsx(G,{className:"w-5 h-5 inline mr-2 text-green-600"}),"WhatsApp"]}),e.jsxs("button",{onClick:()=>{o("linkedin"),i(!1)},className:"block w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center",children:[e.jsx(H,{className:"w-5 h-5 inline mr-2 text-blue-700"}),"LinkedIn"]})]})]}),e.jsx(K,{bookmarkableType:"post",bookmarkableId:a.id,category:"Posts",iconSize:"w-6 h-6",tooltipPosition:"top"})]}),e.jsx("hr",{})]}),a.featured_image&&e.jsx("img",{src:`/storage/${a.featured_image}`,alt:"Banner",className:"w-full h-auto md:h-64 object-cover mb-4 rounded"}),e.jsx(_,{html:a.content,className:"mb-4 text-gray-700 prose w-full text-left max-w-none break-words leading-relaxed"}),(a.category||a.tags)&&e.jsxs("div",{className:"mt-8 mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6 pb-2 border-b-2 border-gray-200",children:"Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Y,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Information"})]}),e.jsxs("div",{className:"ml-7 space-y-3",children:[a.category&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-gray-600 font-medium w-20",children:"Category:"}),e.jsx("span",{className:"text-gray-900",children:a.category})]}),a.tags&&e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-gray-600 font-medium w-20 mt-0.5",children:"Tags:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.isArray(a.tags)?a.tags.map((s,t)=>e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 border border-blue-200",children:s},t)):e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 border border-blue-200",children:a.tags})})]})]})]})]}),a.attachment&&e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"w-4 h-4 text-gray-500 mr-1"}),e.jsx("span",{className:"text-gray-600 font-medium mr-2",children:"Attachment:"}),e.jsx("a",{href:`/storage/${a.attachment}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"View Attachment"})]})}),e.jsx("hr",{className:"my-6 border-gray-200"}),a.images&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Gallery"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:JSON.parse(a.images).map((s,t)=>e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden aspect-square cursor-pointer",onClick:()=>M(s),children:e.jsx("img",{src:`/storage/${s}`,alt:`Gallery image ${t+1}`,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300"})},t))})]}),e.jsx("hr",{className:"my-6 border-gray-200"}),m&&m.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Other Posts"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(s=>e.jsxs(N,{href:L?route("welcome.posts.show",s.url):route("posts.show",s.url),className:"block relative p-5 transform transition-opacity duration-500 rounded-2xl overflow-hidden h-[300px] flex flex-col justify-end hover:opacity-90",style:{backgroundImage:`url(${encodeURI(s.featured_image?`/storage/${s.featured_image}`:"/storage/default.jpg")})`,backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-40"}),e.jsxs("div",{className:"relative z-10 text-white pr-10",children:[e.jsx("h2",{className:"text-2xl font-bold truncate",title:s.title,children:s.title||"Untitled Post"}),s.content&&e.jsx(_,{html:s.content,className:"text-sm line-clamp-2 mb-2"}),e.jsxs("div",{className:"flex items-center mt-1 space-x-2",children:[e.jsx("p",{className:"text-xs",children:new Date(s.created_at).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{className:"ml-1",children:s.total_views||0})]}),e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx(v,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"ml-1",children:s.total_likes||0})]}),e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{className:"ml-1",children:s.total_shares||0})]})]})]})]})]},s.id))})]}),d&&f&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",onClick:h,children:e.jsxs("div",{className:"relative max-w-7xl mx-auto p-4",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{onClick:h,className:"absolute top-4 right-4 text-red-500 hover:text-red-900 z-50",children:e.jsx(W,{className:"w-8 h-8"})}),e.jsx("img",{src:`/storage/${f}`,alt:"Full size image",className:"max-h-[90vh] w-auto object-contain"})]})})]})})}export{ve as default};
