import{r,a as y,j as e}from"./app-KJq67BEp.js";import{V as l}from"./index-DCAMIVIg.js";import D from"./UniversityFormModal-BmN6mgoI.js";import E from"./ConfirmationModal-xSdsBU4L.js";import{d as U,F as $,p as O,q as P}from"./index-dgbq4OcT.js";function V(){const[o,b]=r.useState([]),[g,h]=r.useState(!0),[c,j]=r.useState(""),[t,d]=r.useState({current_page:1,per_page:10,total:0,last_page:1}),[v,p]=r.useState(!1),[N,x]=r.useState(!1),[n,u]=r.useState(null),[_,f]=r.useState("create");r.useEffect(()=>{m()},[t.current_page,c]);const m=async()=>{h(!0);try{const s=await y.get("/api/v1/universities",{params:{page:t.current_page,per_page:t.per_page,search:c||void 0}});b(s.data.data),d({current_page:s.data.meta.current_page,per_page:s.data.meta.per_page,total:s.data.meta.total,last_page:s.data.meta.last_page})}catch(s){console.error("Error fetching universities:",s),l.error("Failed to load universities")}finally{h(!1)}},i=s=>{d(a=>({...a,current_page:s}))},w=s=>{s.preventDefault(),d(a=>({...a,current_page:1}))},S=()=>{u(null),f("create"),p(!0)},k=s=>{u(s),f("edit"),p(!0)},C=s=>{u(s),x(!0)},M=async()=>{if(n)try{await y.delete(`/api/v1/universities/${n.id}`),l.success("University deleted successfully!"),m()}catch(s){console.error("Error deleting university:",s),s.response&&s.response.status===409?l.error(s.response.data.message||"Cannot delete university with existing faculties"):l.error("Failed to delete university")}finally{x(!1)}},F=()=>{p(!1),m()};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Universities"}),e.jsxs("button",{onClick:S,className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",children:[e.jsx(U,{className:"mr-2"})," Add University"]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("form",{onSubmit:w,className:"flex",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx($,{className:"text-gray-400"})}),e.jsx("input",{type:"text",value:c,onChange:s=>j(s.target.value),placeholder:"Search universities...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsx("button",{type:"submit",className:"ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Search"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Short Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Country"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Faculties"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center",children:"Loading..."})}):o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center",children:"No universities found"})}):o.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.full_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.short_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.country}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.faculties_count||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsxs("button",{onClick:()=>k(s),className:"text-blue-600 hover:text-blue-900 mr-4",children:[e.jsx(O,{className:"inline"})," Edit"]}),e.jsxs("button",{onClick:()=>C(s),className:"text-red-600 hover:text-red-900",children:[e.jsx(P,{className:"inline"})," Delete"]})]})]},s.id))})]})}),!g&&o.length>0&&e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 mt-4",children:[e.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>i(t.current_page-1),disabled:t.current_page===1,className:`relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 ${t.current_page===1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Previous"}),e.jsx("button",{onClick:()=>i(t.current_page+1),disabled:t.current_page===t.last_page,className:`relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 ${t.current_page===t.last_page?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(t.current_page-1)*t.per_page+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(t.current_page*t.per_page,t.total)})," ","of ",e.jsx("span",{className:"font-medium",children:t.total})," results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>i(t.current_page-1),disabled:t.current_page===1,className:`relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ${t.current_page===1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:[e.jsx("span",{className:"sr-only",children:"Previous"}),"←"]}),[...Array(t.last_page).keys()].map(s=>{const a=s+1;return a===1||a===t.last_page||Math.abs(a-t.current_page)<=1?e.jsx("button",{onClick:()=>i(a),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${a===t.current_page?"bg-blue-600 text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:outline-offset-0"}`,children:a},a):a===2&&t.current_page>3||a===t.last_page-1&&t.current_page<t.last_page-2?e.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700",children:"..."},a):null}),e.jsxs("button",{onClick:()=>i(t.current_page+1),disabled:t.current_page===t.last_page,className:`relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ${t.current_page===t.last_page?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:[e.jsx("span",{className:"sr-only",children:"Next"}),"→"]})]})})]})]}),e.jsx(D,{isOpen:v,onClose:F,university:n,mode:_}),e.jsx(E,{isOpen:N,title:"Delete University",message:`Are you sure you want to delete ${n==null?void 0:n.full_name}? This action cannot be undone.`,onConfirm:M,onCancel:()=>x(!1)})]})}export{V as default};
