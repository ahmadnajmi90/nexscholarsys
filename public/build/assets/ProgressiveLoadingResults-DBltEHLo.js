import{r as l,j as e,b as H,a as ce}from"./app-xmIh42KO.js";import{h as K,i as oe,j as de,k as me,l as xe}from"./index-D9eridZg.js";import he from"./RecommendationModal-DGnOe8IC.js";import ge from"./RecommendationDisplay-D1ifnmHu.js";import ue from"./ProfileCard-DVEeZ8N4.js";import{m as fe}from"./proxy-BAb5Dv9p.js";import{S as J}from"./sparkles-oh8aEPVE.js";function X({searchType:n,searchResults:r,universitiesList:y,faculties:I,researchOptions:u,users:C,skills:L,selectedArea:m,selectedUniversity:x,selectedAvailability:$,selectedSkills:N,onLoadMore:_,isLoadingMore:f,onShowInsight:A,supervisionRequests:B=[],activeRelationship:h=null,onRequestSubmitted:z}){const[g,d]=l.useState(!1),[w,E]=l.useState(!1),[t,D]=l.useState(null),[Y,G]=l.useState(!1),[je,Z]=l.useState(""),[U,F]=l.useState(!1),[V,R]=l.useState(null),[O,T]=l.useState([]),[Q,ee]=l.useState(!1),[M,q]=l.useState(!1),b=l.useRef(null);if(l.useEffect(()=>{q(!r)},[r]),l.useEffect(()=>{if(r&&r.matches){T([]);const s=r.matches.slice(0,6);if(T(s),r.matches.slice(6).length>0){const i=setTimeout(()=>{T(r.matches)},300);return()=>clearTimeout(i)}}},[r]),l.useEffect(()=>{const s=new IntersectionObserver(([a])=>{ee(a.isIntersecting)},{threshold:.1});return b.current&&s.observe(b.current),()=>{b.current&&s.unobserve(b.current)}},[b]),l.useEffect(()=>{Q&&!f&&r&&r.has_more&&p.length>0&&_()},[Q,f,r]),!r||!r.matches||r.matches.length===0)return null;const p=r.matches.filter(s=>{const a=s.academician||s.student||{};if(m&&m.length>0){const i=n==="supervisor"||n==="collaborators"&&s.result_type==="academician"?a.research_expertise:a.student_type==="postgraduate"?a.field_of_research:a.research_preference;if(!i||!Array.isArray(i)||!i.some(c=>m.includes(c)))return!1}if(x&&x.length>0&&(!a.university||!x.includes(a.university.toString()))||N&&N.length>0&&(!a.skills||!Array.isArray(a.skills)||!a.skills.some(i=>N.includes(i.id))))return!1;if($){let i;n==="supervisor"?i="availability_as_supervisor":n==="students"?i="supervisorAvailability":n==="collaborators"&&(i=s.result_type==="academician"?"availability_as_supervisor":"supervisorAvailability");const c=a[i];if(c===void 0||c.toString()!==$)return!1}return!0}),se=s=>{E(!0),F(!0);let a=s.ai_insights||"";a||(a=r.matches.find(v=>{const j=v.academician||v.student||{};return(j.id||j.academician_id||j.postgraduate_id||j.undergraduate_id)===(s.academician_id||s.postgraduate_id||s.undergraduate_id||s.id)})?.ai_insights||"");let i=a;if(a){const o=/\b(\d+-\d+-\d+)\b/g;(a.match(o)||[]).forEach(j=>{const k=u.find(P=>`${P.field_of_research_id}-${P.research_area_id}-${P.niche_domain_id}`===j);if(k){const P=`${k.field_of_research_name} - ${k.research_area_name} - ${k.niche_domain_name}`;i=i.replace(new RegExp(j,"g"),P)}})}const c={...s,ai_insights:a,processedInsights:i};console.log("Enhanced profile with insights:",c),D(c),Z(i);const S=s.academician_id||s.result_type==="academician",le=s.academician_id||s.postgraduate_id||s.undergraduate_id||s.id;S?ce.get(route("academicians.quick-info",le)).then(o=>{if(o.data&&o.data.academician){const v={...c,...o.data.academician,ai_insights:a,processedInsights:i,projects_count:o.data.projects_count||0,grants_count:o.data.grants_count||0,publications_count:o.data.publications_count||0};console.log("Final updatedProfile with insights preserved:",v),D(v)}d(!0),E(!1),F(!1)}).catch(o=>{console.error("Error fetching academician detail:",o),d(!0),E(!1),F(!1)}):(d(!0),E(!1),F(!1))},te=(s,a)=>{a.preventDefault(),R(s),G(!0)},ae=()=>{G(!1)},ie=()=>t?.grants_count||0,re=()=>t?.projects_count||0,ne=()=>t?.publications_count||0;return e.jsxs("div",{className:"space-y-8",children:[M&&e.jsx(W,{isSearching:!0,searchQuery:r?.query||"",showHeader:!0,visibleCount:6,universitiesList:y,faculties:I,users:C,researchOptions:u}),!M&&r&&r.matches&&p.length===0&&e.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 text-center mx-2",children:e.jsx("p",{className:"text-sm sm:text-base text-gray-500",children:"No results match your filters. Try adjusting your filter criteria."})}),!M&&r&&r.matches&&p.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 md:gap-8 lg:gap-10",children:[p.slice(0,O.length).map((s,a)=>{const i=s.academician||s.student||{},c=i.id||i.academician_id||i.postgraduate_id||i.undergraduate_id||a;return e.jsx(fe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:a*.05,ease:"easeOut"},children:e.jsx(ue,{match:s,universitiesList:y,researchOptions:u,users:C,searchType:n,supervisionRequests:B,activeRelationship:h,onRequestSubmitted:z,onQuickInfoClick:se,onRecommendClick:te,onShowInsight:A})},`${s.result_type}-${c}`)}),p.length>O.length&&e.jsx("div",{className:"col-span-full",children:e.jsx(W,{isSearching:!0,showHeader:!1,visibleCount:Math.min(3,p.length-O.length),universitiesList:y,faculties:I,users:C,researchOptions:u,searchQuery:"Loading more profiles..."})})]}),r.has_more&&e.jsx("div",{ref:b,className:"mt-8 sm:mt-10 md:mt-12 text-center py-4 sm:py-6",children:f?e.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-3",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 sm:h-6 sm:w-6 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e.jsx("span",{className:"text-gray-600 font-medium text-sm sm:text-base",children:"Loading more results..."})]}):e.jsxs("button",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 active:scale-95 text-white px-6 sm:px-8 py-2.5 sm:py-3 rounded-lg sm:rounded-xl font-semibold text-sm sm:text-base shadow-lg hover:shadow-xl transition-all duration-300 sm:hover:-translate-y-1 touch-manipulation",onClick:_,children:[e.jsx(J,{className:"h-4 w-4 sm:h-5 sm:w-5"}),e.jsx("span",{children:"Load More Results"})]})}),!r.has_more&&p.length>0&&e.jsx("div",{className:"mt-8 sm:mt-10 md:mt-12 text-center py-4 sm:py-6",children:e.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-400",children:[e.jsx("div",{className:"h-px w-8 sm:w-12 bg-gray-300"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:"End of results"}),e.jsx("div",{className:"h-px w-8 sm:w-12 bg-gray-300"})]})})]}),!M&&r&&r.matches&&r.matches.length===0&&e.jsxs("div",{className:"text-center py-8 sm:py-10 md:py-12 bg-gray-50 rounded-lg mx-2",children:[e.jsx(K,{className:"text-gray-400 text-3xl sm:text-4xl md:text-5xl mx-auto mb-3 sm:mb-4"}),e.jsx("h3",{className:"text-lg sm:text-xl font-medium text-gray-700 mb-2 px-4",children:"No matching results found"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-500 max-w-md mx-auto px-4",children:"Try broadening your search terms or exploring different research areas."})]}),g&&t&&e.jsxs(e.Fragment,{children:[console.log("Modal opening with selectedProfile:",t),console.log("AI insights available:",t.ai_insights),e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>d(!1)}),e.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg p-6 w-11/12 max-w-lg max-h-[80vh] overflow-y-auto z-10",onClick:s=>s.stopPropagation(),children:[w?e.jsxs("div",{className:"flex flex-col items-center justify-center py-10",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-500 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e.jsx("p",{className:"text-gray-600",children:"Loading profile information..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-gray-800",children:t.full_name}),e.jsx("hr",{className:"border-t border-gray-800 mb-4"}),e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("h4",{className:"text-lg font-semibold text-blue-800 mb-2 flex items-center",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"AI Match Insights"]}),console.log("Rendering AI insights section with:",{ai_insights:t.ai_insights,processedInsights:t.processedInsights}),U?e.jsxs("div",{className:"flex items-center justify-center p-4",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e.jsx("p",{className:"text-gray-600",children:"Generating detailed insights..."})]}):e.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:t.processedInsights||t.ai_insights||"No insights available for this profile."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Short Bio"}),e.jsx("p",{className:"text-gray-600 whitespace-pre-line",children:t.bio||"Not Provided"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:t.academician_id?"Research Expertise":"Research Interests"}),e.jsx("div",{className:"",children:(()=>{let s=[];return t.academician_id?s=t.research_expertise||[]:t.postgraduate_id||t.student_type==="postgraduate"?s=t.field_of_research||[]:s=t.research_preference||[],Array.isArray(s)&&s.length>0?e.jsx("div",{className:"space-y-2",children:s.map((a,i)=>{const c=u.find(S=>`${S.field_of_research_id}-${S.research_area_id}-${S.niche_domain_id}`===a);return c?e.jsxs("p",{className:"text-gray-600",children:[i+1,". ",c.field_of_research_name," - ",c.research_area_name," - ",c.niche_domain_name]},i):e.jsxs("p",{className:"text-gray-600",children:[i+1,". ",a]},i)})}):e.jsx("p",{className:"text-gray-600",children:"Not Provided"})})()})]}),t.academician_id&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Style of Supervision"}),e.jsx("div",{className:"space-y-2",children:Array.isArray(t.style_of_supervision)&&t.style_of_supervision.length>0?e.jsx("div",{className:"mt-2 text-normal text-gray-600",children:t.style_of_supervision.map((s,a)=>e.jsxs("div",{className:"mb-2",children:[e.jsxs("span",{className:"font-medium",children:[a+1,". ",s]}),e.jsxs("div",{className:"ml-4 text-sm",children:[s==="Directive Supervision"&&"Structured approach with active guidance and regular monitoring",s==="Facilitative Supervision"&&"Supportive approach encouraging student independence",s==="Coaching Supervision"&&"Focuses on personal development and academic growth",s==="Adaptive Supervision"&&"Flexible support based on student's changing needs",s==="Participatory Supervision"&&"Collaborative approach with shared decision-making"]})]},a))}):e.jsx("p",{className:"text-gray-600",children:"Not Specified"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Supervised Student"}),e.jsx("p",{className:"text-gray-600",children:t.supervised_students_count||"Not Provided"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Available Grant and Project"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("p",{className:"text-gray-600",children:[ie()+re()," Projects/Grants"]}),e.jsxs(H,{href:route("academicians.projects",t.url||t.academician_id),className:"mt-2 self-start text-xs px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition duration-200 flex items-center",children:[e.jsx("span",{children:"View Projects"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Publication"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("p",{className:"text-gray-600",children:[ne()," Publications"]}),e.jsxs(H,{href:route("academicians.publications",t.url||t.academician_id),className:"mt-2 self-start text-xs px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition duration-200 flex items-center",children:[e.jsx("span",{children:"View Publications"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Recommendation by Others"}),e.jsx(ge,{academicianId:t.academician_id||t.id})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Skills"}),Array.isArray(t.skills)&&t.skills.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:t.skills.map((s,a)=>{let i=s.name;return s.subdomain&&s.subdomain.domain?i=`${s.subdomain.domain.name} - ${s.subdomain.name} - ${s.name}`:s.full_name?i=s.full_name:i=s.name||`Skill #${a+1}`,e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:i},s.id||a)})}):e.jsx("p",{className:"text-gray-600",children:"No skills listed"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Connect via"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[t.google_scholar&&e.jsx("a",{href:t.google_scholar,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 text-lg hover:text-red-700",title:"Google Scholar",children:e.jsx(oe,{})}),t.personal_website&&e.jsx("a",{href:t.personal_website,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 text-lg hover:text-green-700",title:"Personal Website",children:e.jsx(de,{})}),t.institution_website&&e.jsx("a",{href:t.institution_website,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 text-lg hover:text-blue-700",title:"Institutional Website",children:e.jsx(me,{})}),t.linkedin&&e.jsx("a",{href:t.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 text-lg hover:text-blue-800",title:"LinkedIn",children:e.jsx(xe,{})})]})]})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>d(!1),className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition duration-200",children:"Close"})})]})})]})]}),Y&&V&&e.jsx(he,{academician:V,onClose:()=>G(!1),onSuccess:ae})]})}const ke=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"})),W=({searchResults:n,universitiesList:r,faculties:y,users:I,researchOptions:u,searchQuery:C,isSearching:L,isLoadingMore:m=!1,onLoadMore:x=()=>{},showHeader:$=!0,visibleCount:N=6})=>{const[_,f]=l.useState([]),[A,B]=l.useState(!1),h=l.useRef(null);l.useEffect(()=>{if(n&&n.matches){f([]);const g=n.matches.slice(0,6);if(f(g),n.matches.slice(6).length>0){const w=setTimeout(()=>{f(n.matches)},300);return()=>clearTimeout(w)}}},[n]),l.useEffect(()=>{const g=new IntersectionObserver(([d])=>{B(d.isIntersecting)},{threshold:.1});return h.current&&g.observe(h.current),()=>{h.current&&g.unobserve(h.current)}},[h]),l.useEffect(()=>{A&&!m&&n&&n.has_more&&_.length>0&&x()},[A,m,n,x]);const z=g=>Array(g).fill(null).map((d,w)=>e.jsx(pe,{},`skeleton-${w}`));return L&&(!n||!n.matches)?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6",children:z(N)}):n&&n.matches?e.jsxs("div",{children:[$&&e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:['Supervisor Matches for "',n.query,'"']}),e.jsxs("span",{className:"text-gray-500",children:[n.total," match",n.total!==1?"es":""," found"]})]}),e.jsx(X,{searchType:"supervisor",searchResults:{...n,matches:_},universitiesList:r,faculties:y,users:I,researchOptions:u,onLoadMore:x,isLoadingMore:m}),n.has_more&&e.jsx("div",{ref:h,className:"mt-8 text-center py-4",children:m?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Loading more results..."]}):e.jsx("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md",onClick:x,children:"Load more results"})}),n.total===0&&e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(K,{className:"text-gray-400 text-5xl mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-gray-700 mb-2",children:"No matching supervisors found"}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"Try broadening your search terms or exploring different research areas."})]})]}):null},pe=()=>e.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden relative animate-pulse",children:[e.jsx("div",{className:"h-32 bg-gray-200"}),e.jsx("div",{className:"flex justify-center -mt-12",children:e.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-300 border-4 border-white"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4 mx-auto mb-3"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6 mx-auto mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6 mx-auto mb-4"}),e.jsxs("div",{className:"mt-3 bg-gray-100 p-3 rounded-md",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full mb-1"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6 mb-1"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"})]}),e.jsxs("div",{className:"mt-4 flex justify-center gap-2",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-24"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-24"})]})]}),e.jsxs("div",{className:"mt-4 border-t border-gray-100 p-4 flex justify-around",children:[e.jsx("div",{className:"h-6 w-6 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-6 w-6 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-6 w-6 bg-gray-200 rounded-full"})]})]}),Pe=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"}));export{Pe as P,X as R,ke as a};
