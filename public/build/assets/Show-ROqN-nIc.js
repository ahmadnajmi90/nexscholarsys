import{q as B,r as n,W as M,j as e,b as x,y as g}from"./app-Doi1BfNX.js";import{M as E}from"./MainLayout-VD0w9tEu.js";import{C as D}from"./ConfirmationModal-BH096p0N.js";import{M as S}from"./ManageCollaboratorsModal-DCad9OKU.js";import{L as k,M as P}from"./ManageBoardMembersModal-B8fwnCot.js";import{I as W}from"./InlineEdit-CS9z4LYm.js";import{V as s}from"./index-dbiIR3J5.js";import{C as $}from"./chevron-left-B4SkBdMm.js";import{U as L}from"./user-plus-sw3z_dHP.js";import{P as F}from"./plus-C8EzUFY8.js";import{U as I}from"./users-CJk5icQ6.js";import{T}from"./trash-2-DurOfiw5.js";import"./house-DG9-SKJz.js";import"./createLucideIcon-BIWf6Fgr.js";import"./zap-Jwr2WBUL.js";import"./folder-open-Dt0aD5aH.js";import"./settings-BrND01Uv.js";import"./useRoles-ZkMXyAVp.js";import"./proxy-BUFhk0Wh.js";import"./user-round-B_eanpyP.js";import"./clipboard-list-DrTWdQ-4.js";import"./dollar-sign-D4dg_IhF.js";import"./calendar-CBO9yeE8.js";import"./file-text-CjHuEEW2.js";import"./message-square-THXDma7t.js";import"./graduation-cap-BiSIS5Fh.js";import"./building-Blr4MO9I.js";import"./Dropdown-C3siJS7L.js";import"./transition-Dk-vnbkR.js";import"./sparkles-CoZiYbuv.js";import"./bookmark-TdMgL57n.js";import"./folder-kanban-Ci5r-Zyx.js";import"./building-2-DoFw0cmv.js";import"./database-B1qHiJEl.js";import"./shield-B9sqgGYc.js";import"./index-CvKzrQIm.js";import"./analytics-BQ374C1C.js";import"./index-Degf296b.js";import"./supervisionConstants-BuM5-H5X.js";import"./utils-D-KgF5mV.js";import"./ThreadPane-B5BIAZi7.js";import"./Modal-BjJ_nX2Q.js";import"./dialog-DYcl7DcC.js";import"./scroll-area-Du06xGgY.js";import"./index-FRhtyj0h.js";import"./index-B_QUZuO0.js";import"./index-BdR5mO0l.js";import"./index-Bb94jkfk.js";import"./index-BdQq_4o_.js";import"./format-Dv9Rm441.js";import"./en-US-DNUEYIb-.js";import"./button-KPEq8PdI.js";import"./download-Xk6ccwe6.js";import"./x-DrXySrr5.js";import"./isSameDay-Dm-A-V7S.js";import"./constructNow-DtVD-0hX.js";import"./addDays-CAl2nVVE.js";import"./PrimaryButton-DP3HZhbg.js";import"./SecondaryButton-u54usrQd.js";import"./chevron-right-Dg3EFaoF.js";import"./search-FGZFllxI.js";import"./circle-check-big-BlfyvA-C.js";import"./tooltip-CJCiABJO.js";import"./index-CZA6k5rr.js";import"./index-Be4Hbpsc.js";import"./index-BkPy3AN8.js";import"./floating-ui.dom-eiE65J5j.js";import"./index-CJzlUPP7.js";import"./index-CkAoBwhz.js";import"./index-BvLvCl4J.js";import"./briefcase-Cs22VvWr.js";import"./user-dLQj9SMU.js";import"./triangle-alert-uV-J_FuU.js";import"./InputError-rYQ9y34N.js";import"./react-select.esm-D1FqzvMq.js";import"./info-DZ0gqjkV.js";import"./check-C48ewYru.js";function U({workspace:t,connections:h}){const{auth:b}=B().props,[f,d]=n.useState(!1),[i,m]=n.useState(null),[j,p]=n.useState(!1),[l,u]=n.useState(null),o=M({name:""}),y=r=>{if(r.preventDefault(),!t||!t.data||!t.data.id){console.error("Workspace ID is missing, cannot create board.");return}o.post(route("project-hub.workspaces.boards.store",t.data.id),{onSuccess:()=>{s.success(`Board "${o.data.name}" created successfully.`),d(!1),o.reset()},onError:a=>{console.error("Error creating board:",a),s.error("Failed to create board. Please check the form for errors.")}})},w=(r,a)=>{r.preventDefault(),r.stopPropagation(),m(a)},v=()=>{i&&g.delete(route("project-hub.boards.destroy",i.id),{onSuccess:()=>{s.success(`Board "${i.name}" deleted successfully.`),m(null)},onError:r=>{console.error("Error deleting board:",r),s.error("Failed to delete board. Please try again.")}})},N=(r,a)=>{r.preventDefault(),r.stopPropagation(),u(a)},c=b.user.id===t.data.owner_id;n.useEffect(()=>{if(!t.data.id)return;console.log(`Subscribing to workspace channel: workspaces.${t.data.id}`);const r=window.Echo.private(`workspaces.${t.data.id}`);return r.listen(".workspace.updated",a=>{console.log("Received workspace.updated event:",a),a.workspace.name!==t.data.name&&(t.data.name=a.workspace.name,setWorkspace({...t}))}),()=>{console.log(`Unsubscribing from workspace channel: workspaces.${t.data.id}`),r.stopListening(".workspace.updated"),window.Echo.leave(`workspaces.${t.data.id}`)}},[t.data.id]);const C=async r=>{try{await g.put(route("project-hub.workspaces.update",t.data.id),{name:r,description:t.data.description},{preserveScroll:!0,onSuccess:()=>{s.success("Workspace renamed successfully.")},onError:a=>{console.error("Error renaming workspace:",a),s.error("Failed to rename workspace. Please try again.")}})}catch(a){console.error("Error renaming workspace:",a),s.error("Failed to rename workspace. Please try again.")}};return e.jsxs("div",{className:"w-full md:max-w-8xl md:mx-auto px-4 md:px-4 lg:px-2 py-4 md:py-6 lg:mt-2 mt-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(x,{href:route("project-hub.index"),className:"flex items-center text-gray-500 hover:text-gray-700 mb-2",children:[e.jsx($,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"text-sm",children:"Back to workspaces"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(W,{value:t.data.name,onSave:C,canEdit:c,className:"text-2xl font-bold text-gray-900 truncate max-w-3xl",placeholder:"Workspace name"}),c&&e.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Manage Members"]})]}),t.data.description&&e.jsx("p",{className:"mt-1 text-gray-500 max-w-3xl",children:t.data.description})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Boards"})}),t.data.can.create_board&&(f?e.jsxs("div",{className:"bg-white shadow rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900 mb-3",children:"Create a new board"}),e.jsxs("form",{onSubmit:y,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("input",{type:"text",value:o.data.name,onChange:r=>o.setData("name",r.target.value),className:"w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm text-sm",placeholder:"Board name",disabled:o.processing,autoFocus:!0}),o.errors.name&&e.jsx("div",{className:"text-red-500 text-xs mt-1",children:o.errors.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{type:"button",onClick:()=>{d(!1),o.reset()},className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-xs font-medium text-gray-700 bg-white hover:bg-gray-50",disabled:o.processing,children:"Cancel"}),e.jsx("button",{type:"submit",className:"inline-flex items-center px-3 py-1.5 border border-transparent rounded-md text-xs font-medium text-white bg-indigo-600 hover:bg-indigo-700",disabled:o.processing||!o.data.name.trim(),children:o.processing?"Creating...":"Create Board"})]})]})]}):e.jsxs("button",{type:"button",onClick:()=>d(!0),className:"inline-flex items-center px-4 py-2 mb-6 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Create new board"]})),t.data.boards&&t.data.boards.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:t.data.boards.map(r=>e.jsxs("div",{className:"relative bg-white shadow rounded-lg hover:shadow-md transition-shadow duration-200",children:[e.jsxs(x,{href:route("project-hub.boards.show",r.id),className:"block p-5",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(k,{className:"w-5 h-5 text-indigo-500 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:r.name})]}),e.jsx("div",{className:"flex items-center text-sm text-gray-500 mt-3",children:e.jsxs("span",{children:["Created ",new Date(r.created_at).toLocaleDateString("en-GB")]})})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex space-x-1",children:[c&&e.jsx("button",{onClick:a=>N(a,r),className:"p-1.5 text-gray-400 hover:text-indigo-500 hover:bg-gray-100 rounded-full",title:"Manage board access",children:e.jsx(I,{className:"w-4 h-4"})}),r.can&&r.can.delete&&e.jsx("button",{onClick:a=>w(a,r),className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-gray-100 rounded-full",title:"Delete board",children:e.jsx(T,{className:"w-4 h-4"})})]})]},r.id))}):e.jsx("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:e.jsx("p",{className:"text-gray-500 mb-4",children:"No boards available. Create a board to get started."})})]}),e.jsx(D,{show:!!i,onClose:()=>m(null),onConfirm:v,title:"Delete Board",message:i?`Are you sure you want to delete the board "${i.name}"? This action cannot be undone and will delete all lists and tasks within this board.`:""}),e.jsx(S,{show:j,onClose:()=>p(!1),context:t,contextType:"workspace",connections:h||[]}),l&&e.jsx(P,{show:!!l,onClose:()=>u(null),board:l,workspaceMembers:t.data.members||[]})]})}U.layout=t=>e.jsx(E,{title:"Workspace Boards",children:t,TopMenuOpen:!1});export{U as default};
