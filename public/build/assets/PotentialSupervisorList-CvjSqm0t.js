import{r as o,j as e,a as P,b as I}from"./app-Dyc2YSa7.js";import{c as N}from"./index-Csod4yPu.js";import{l as T,L as K}from"./logError-B6okArUp.js";import{C as O,a as Y,b as G,c as J,d as Q}from"./card-u1sRkX_n.js";import{B as E}from"./button-DDycOZPt.js";import{f as W}from"./formatDistanceToNow-GKXiLTrL.js";import{U}from"./user-round-BvPE_KKu.js";import{c as X}from"./createLucideIcon-DgyMBRUj.js";import{B as Z}from"./book-open-ietLbANk.js";import{F as V}from"./folder-kanban-B9x8dhJX.js";import{U as A}from"./user-plus-Bra8bLqs.js";import{T as q}from"./trash-2-zHsd5w7w.js";import"./utils-CIsb_jhR.js";import"./clsx-B-dksMZM.js";import"./constructNow-DtVD-0hX.js";import"./en-US-DNUEYIb-.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M16 10h.01",key:"1m94wz"}]],L=X("MessageSquareMore",R),z={default:{title:"No potential supervisors yet",description:"Start by adding supervisors from your recommendations list to keep track of who you want to approach."},search:{title:"No matches found",description:"Try adjusting your search filters or browse the full list."}};function ge({shortlist:t=[],requests:u=[],isLoading:j=!1,reload:m,onRequestSupervisor:x,onViewRequest:b,onRemoveSuccess:h,emptyState:y="default"}){const[S,f]=o.useState(null),M=o.useMemo(()=>Array.isArray(u)?u.reduce((s,r)=>{if(!["cancelled","auto_cancelled"].includes(r.status)){const n=String(r.academician_id??"");n&&(s[n]=r)}return s},{}):{},[u]),v=async s=>{var r,n;if(s!=null&&s.academician_id){f(s.academician_id);try{await P.delete(route("supervision.shortlist.destroy",s.academician_id)),N.success("Removed from your potential supervisor list"),h==null||h(s),m==null||m()}catch(i){T(i,"Supervision handleRemove");const p=((n=(r=i==null?void 0:i.response)==null?void 0:r.data)==null?void 0:n.message)||"Failed to remove supervisor";N.error(p)}finally{f(null)}}},w=!j&&(!Array.isArray(t)||t.length===0),{title:_,description:a}=o.useMemo(()=>z[y]??z.default,[y]);return j?e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:Array.from({length:4}).map((s,r)=>e.jsxs("div",{className:"border border-dashed rounded-xl p-5 bg-white shadow-sm animate-pulse",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-32 rounded bg-slate-200"}),e.jsx("div",{className:"h-3 w-24 rounded bg-slate-100"})]})]}),e.jsx("div",{className:"h-3 w-20 rounded bg-slate-100"})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-3 w-24 rounded bg-slate-100"}),e.jsx("div",{className:"h-3 w-28 rounded bg-slate-100"}),e.jsx("div",{className:"h-3 w-20 rounded bg-slate-100"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("div",{className:"h-3 w-32 rounded bg-slate-100"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-6 w-24 rounded-full bg-slate-100"}),e.jsx("div",{className:"h-6 w-20 rounded-full bg-slate-100"})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 pt-4 border-t",children:[e.jsx("div",{className:"h-10 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-10 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-10 w-10 rounded bg-slate-200"})]})]},`potential-skeleton-${r}`))}):w?e.jsxs(O,{className:"border-dashed border-slate-200",children:[e.jsx(Y,{children:e.jsx(G,{className:"text-lg font-semibold text-slate-800",children:_})}),e.jsx(J,{className:"text-sm text-slate-600",children:a}),e.jsx(Q,{children:e.jsx(E,{variant:"outline",onClick:()=>x==null?void 0:x(null),children:"Find supervisors"})})]}):e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:t.map(s=>{var i,p,C,k,l,g;const r=(s==null?void 0:s.academician_id)??((C=(p=(i=s==null?void 0:s.academician)==null?void 0:i.user)==null?void 0:p.academician)==null?void 0:C.academician_id)??((k=s==null?void 0:s.academician)==null?void 0:k.academician_id)??((g=(l=s==null?void 0:s.academician)==null?void 0:l.user)==null?void 0:g.academician_id),n=r?M[String(r)]:null;return e.jsx(ee,{item:s,existingRequest:n,onRemove:v,onRequest:x,onViewRequest:b,isRemoving:S===s.academician_id},s.id)})})}function ee({item:t,onRemove:u,onRequest:j,onViewRequest:m,isRemoving:x,existingRequest:b}){var F;const[h,y]=o.useState(!1),[S,f]=o.useState(!1),[M,v]=o.useState("not_connected"),[w,_]=o.useState(null),a=(t==null?void 0:t.academician)??{},s=a.full_name??"Supervisor",r=a.availability_as_supervisor,n=a.profile_picture?`/storage/${a.profile_picture}`:null,i=t!=null&&t.saved_at?W(new Date(t.saved_at),{addSuffix:!0}):null,p=((F=a.university)==null?void 0:F.name)||"",C=a.publications_count??0,k=a.projects_count??0,l=a.research_areas||[],g=a.url||null,c=a==null?void 0:a.user,B=h?l:l.slice(0,1);o.useEffect(()=>{c!=null&&c.connection_status_with_auth_user&&(v(c.connection_status_with_auth_user.status||"not_connected"),_(c.connection_status_with_auth_user.connection_id||null))},[c]);const $=async()=>{if(c!=null&&c.id){f(!0);try{const d=await P.post(route("api.app.connections.store",c.id));d.data&&d.data.connection&&(v("pending_sent"),_(d.data.connection.id),N.success("Connection request sent"))}catch(d){T(d,"PotentialSupervisorCard connect"),N.error("Failed to send connection request")}finally{f(!1)}}},D=async()=>{if(w){f(!0);try{await P.patch(route("api.app.connections.accept",w)),v("connected"),N.success("Connection request accepted")}catch(d){T(d,"PotentialSupervisorCard acceptRequest"),N.error("Failed to accept connection")}finally{f(!1)}}};return e.jsxs("div",{className:"border rounded-xl p-5 bg-white shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0",children:[g?e.jsx(I,{href:route("academicians.show",g),className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center overflow-hidden hover:ring-2 hover:ring-indigo-300 transition-all cursor-pointer",children:n?e.jsx("img",{src:n,alt:s,className:"w-full h-full object-cover rounded-full"}):e.jsx(U,{className:"w-5 h-5 text-indigo-600"})})}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center overflow-hidden flex-shrink-0",children:n?e.jsx("img",{src:n,alt:s,className:"w-full h-full object-cover rounded-full"}):e.jsx(U,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[g?e.jsx(I,{href:route("academicians.show",g),children:e.jsx("h3",{className:"text-[1.05rem] font-semibold text-gray-900 leading-snug truncate hover:text-indigo-600 transition-colors cursor-pointer",children:s})}):e.jsx("h3",{className:"text-[1.05rem] font-semibold text-gray-900 leading-snug truncate",children:s}),p&&e.jsx("p",{className:"text-sm text-gray-600 truncate font-normal",children:p})]})]}),i&&e.jsxs("div",{className:"text-xs text-slate-500 flex-shrink-0",children:["Saved ",i]})]}),e.jsxs("div",{className:"mt-4 flex items-center flex-wrap gap-x-4 gap-y-2 text-sm text-gray-600",children:[r&&e.jsxs("div",{className:"inline-flex items-center gap-1.5 text-green-700",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:"Accepting Students"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"w-4 h-4 mr-1.5 text-gray-400"}),e.jsxs("span",{children:[C," Publications"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"w-4 h-4 mr-1.5 text-gray-400"}),e.jsxs("span",{children:[k," Projects"]})]})]}),Array.isArray(l)&&l.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-gray-800 text-sm font-medium mb-2",children:"Research Areas:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[B.map((d,H)=>e.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full bg-gray-100 text-gray-700 border border-gray-200",children:d},H)),l.length>1&&e.jsx("button",{onClick:()=>y(!h),className:"px-2.5 py-1 text-xs rounded-full bg-indigo-50 text-indigo-700 border border-indigo-200 hover:bg-indigo-100 transition-colors",children:h?"Show less":`+${l.length-1} more`})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 pt-4 border-t",children:[(()=>{if(S)return e.jsx("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-gray-400 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:"Processing..."});switch(M){case"connected":return e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Connected"]});case"pending_sent":return e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-gray-400 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Pending"]});case"pending_received":return e.jsxs("button",{onClick:D,className:"inline-flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700 flex-1",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Accept"]});case"not_connected":default:return e.jsxs("button",{onClick:$,className:"inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 flex-1",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Connect"]})}})(),e.jsxs(E,{className:"flex-1",variant:b?"outline":"default",onClick:()=>b?m==null?void 0:m(b):j==null?void 0:j(t),children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),b?"View Request":"Request Supervision"]}),e.jsx(E,{type:"button",variant:"outline",size:"icon",disabled:x,onClick:()=>u==null?void 0:u(t),className:"h-10 w-10",children:x?e.jsx(K,{className:"h-4 w-4 animate-spin"}):e.jsx(q,{className:"h-4 w-4"})})]})]})}export{ge as default};
