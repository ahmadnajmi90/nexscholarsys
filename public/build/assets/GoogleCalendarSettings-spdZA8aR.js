import{r as i,j as e}from"./app-D_isCBrZ.js";import{u as M}from"./useGoogleCalendar-BdjEqcNS.js";import{c as $,a as z}from"./index-CL6H2niU.js";import{u as k,P as S}from"./index-BxE-5CCQ.js";import{u as D}from"./index-Be7aubF8.js";import{u as H}from"./index-DQXIHc7t.js";import{u as F}from"./index-lKKoak1a.js";import{c as w}from"./utils-CBfrqCZ4.js";import{B as N}from"./button-CvkXbyNI.js";import{B as L}from"./badge-CsPEGvq-.js";import{R as O,C as U,a as W}from"./index-bF9N-pnm.js";import{C}from"./calendar-D8HyrHOR.js";import{C as q}from"./check-Cn-yF-8e.js";import{I as V}from"./info-DQzHJqPX.js";import{C as X}from"./chevron-up-CkRQIwml.js";import{C as Y}from"./chevron-down-Ccqnoyn8.js";import{R as J}from"./refresh-cw-DuHiGFB3.js";import{E as K}from"./external-link-Ci6-j8Wy.js";import{f as Q}from"./format-BOijCLBA.js";import"./index-S2oVNL1R.js";import"./logError-BloCzXDJ.js";import"./index-BG6TJDBP.js";import"./index-CdJFUDDL.js";import"./index-BSdNhmJ5.js";import"./createLucideIcon-BT85Csak.js";import"./en-US-DIdCsyf3.js";var y="Switch",[Z]=$(y),[ee,se]=Z(y),E=i.forwardRef((a,s)=>{const{__scopeSwitch:t,name:r,checked:n,defaultChecked:x,required:c,disabled:d,value:m="on",onCheckedChange:f,form:o,...h}=a,[u,p]=i.useState(null),g=k(s,j=>p(j)),l=i.useRef(!1),v=u?o||!!u.closest("form"):!0,[b,A]=D({prop:n,defaultProp:x??!1,onChange:f,caller:y});return e.jsxs(ee,{scope:t,checked:b,disabled:d,children:[e.jsx(S.button,{type:"button",role:"switch","aria-checked":b,"aria-required":c,"data-state":T(b),"data-disabled":d?"":void 0,disabled:d,value:m,...h,ref:g,onClick:z(a.onClick,j=>{A(_=>!_),v&&(l.current=j.isPropagationStopped(),l.current||j.stopPropagation())})}),v&&e.jsx(G,{control:u,bubbles:!l.current,name:r,value:m,checked:b,required:c,disabled:d,form:o,style:{transform:"translateX(-100%)"}})]})});E.displayName=y;var P="SwitchThumb",R=i.forwardRef((a,s)=>{const{__scopeSwitch:t,...r}=a,n=se(P,t);return e.jsx(S.span,{"data-state":T(n.checked),"data-disabled":n.disabled?"":void 0,...r,ref:s})});R.displayName=P;var te="SwitchBubbleInput",G=i.forwardRef(({__scopeSwitch:a,control:s,checked:t,bubbles:r=!0,...n},x)=>{const c=i.useRef(null),d=k(c,x),m=H(t),f=F(s);return i.useEffect(()=>{const o=c.current;if(!o)return;const h=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(h,"checked").set;if(m!==t&&p){const g=new Event("click",{bubbles:r});p.call(o,t),o.dispatchEvent(g)}},[m,t,r]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...n,tabIndex:-1,ref:d,style:{...n.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});G.displayName=te;function T(a){return a?"checked":"unchecked"}var B=E,ae=R;const I=i.forwardRef(({className:a,...s},t)=>e.jsx(B,{className:w("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...s,ref:t,children:e.jsx(ae,{className:w("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));I.displayName=B.displayName;const re=O,ne=U,oe=W;function Ie({className:a=""}){const{isConnected:s,isEnabled:t,isLoading:r,tokenExpiresAt:n,connect:x,disconnect:c,syncFromGoogle:d}=M(),[m,f]=i.useState(!1),[o,h]=i.useState(!1),u=async l=>{l&&!s?await x():!l&&s&&confirm("Are you sure you want to disconnect Google Calendar?")&&await c()},p=async()=>{h(!0);try{await d()}finally{h(!1)}},g=l=>{if(!l)return"N/A";try{return Q(new Date(l),"PPp")}catch{return"Invalid date"}};return e.jsxs("div",{className:`space-y-6 ${a}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg flex-shrink-0",children:e.jsx(C,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"text-base font-medium text-gray-900",children:"Google Calendar Sync"}),s&&e.jsxs(L,{variant:"success",className:"text-xs",children:[e.jsx(q,{className:"w-3 h-3 mr-1"}),"Connected"]})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Automatically sync your supervision meetings to Google Calendar"})]})]}),e.jsx(I,{checked:s,onCheckedChange:u,disabled:r,className:"flex-shrink-0 ml-4"})]}),!s&&e.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-semibold text-amber-900 mb-2",children:"Google Verification in Progress"}),e.jsxs("p",{className:"text-sm text-amber-800 mb-2",children:["When connecting your Google Calendar, you may see a warning that says ",e.jsx("strong",{children:`"Google hasn't verified this app"`}),". This is normal and safe to proceed."]}),e.jsx("p",{className:"text-sm text-amber-800",children:e.jsx("strong",{children:"To continue:"})}),e.jsxs("ol",{className:"text-sm text-amber-800 ml-4 mt-1 space-y-1 list-decimal",children:[e.jsxs("li",{children:["Click ",e.jsx("strong",{children:'"Advanced"'})," at the bottom of the warning screen"]}),e.jsxs("li",{children:["Click ",e.jsx("strong",{children:'"Go to Nexscholar (unsafe)"'})]}),e.jsx("li",{children:"Grant calendar permissions"})]}),e.jsx("p",{className:"text-xs text-amber-700 mt-3 italic",children:"We're currently awaiting Google's verification approval. Once approved, this warning will no longer appear."})]})]})}),s&&e.jsxs(re,{open:m,onOpenChange:f,children:[e.jsx(ne,{className:"flex items-center gap-1 text-sm text-indigo-600 hover:text-indigo-700 font-medium transition-colors",children:m?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"w-4 h-4"}),"Hide details"]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"w-4 h-4"}),"Show details"]})}),e.jsxs(oe,{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Status"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Active"})]}),n&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Token Expires"}),e.jsx("span",{className:"font-medium text-gray-900",children:g(n)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Sync Enabled"}),e.jsx("span",{className:"font-medium text-gray-900",children:t?"Yes":"No"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(N,{variant:"outline",size:"sm",onClick:p,disabled:o||r,className:"flex items-center gap-2",children:[e.jsx(J,{className:`w-4 h-4 ${o?"animate-spin":""}`}),o?"Syncing...":"Sync Now"]}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>{confirm("Are you sure you want to disconnect Google Calendar?")&&c()},disabled:r,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:"Disconnect"})]}),e.jsx("div",{className:"text-xs text-gray-500 bg-blue-50 p-3 rounded-md",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," When you schedule a meeting through the supervision system, you'll be prompted to add it to your Google Calendar automatically."]})})]})]}),!s&&e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(C,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Connect Google Calendar"}),e.jsx("p",{className:"mt-1 text-sm text-blue-700",children:"Meetings will be automatically added to your calendar when scheduled. Sync your supervision meetings seamlessly across all your devices."}),e.jsxs(N,{variant:"link",size:"sm",onClick:x,disabled:r,className:"mt-2 text-blue-600 hover:text-blue-700 p-0 h-auto font-medium flex items-center gap-1",children:[e.jsx(K,{className:"w-4 h-4"}),"Connect Now"]})]})]})})]})}export{Ie as default};
