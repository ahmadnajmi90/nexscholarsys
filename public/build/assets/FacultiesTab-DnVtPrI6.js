import{r as s,a as v,j as e,y as T}from"./app-ETHwI688.js";import{V as o}from"./index-CF9Lwyje.js";import L from"./FacultyFormModal-KoEinP6b.js";import Q from"./ConfirmationModal-YGjJ6Yhx.js";import{P as V}from"./Pagination-DAIxOyMY.js";import{h as R,F as q,r as z,s as B}from"./index-UAxDRkHo.js";import"./chevron-left-COnkCxkp.js";import"./createLucideIcon-DHzLncyx.js";import"./chevron-right-D_M3zdFc.js";import"./iconBase-DxAoyyl3.js";function se(){const[N,w]=s.useState([]),[c,h]=s.useState({data:[],meta:{}}),[f,y]=s.useState(!0),[p,_]=s.useState(""),[a,F]=s.useState(""),[i,d]=s.useState({current_page:1,per_page:10,total:0,last_page:1}),[S,m]=s.useState(!1),[k,x]=s.useState(!1),[l,g]=s.useState(null),[C,b]=s.useState("create");s.useEffect(()=>{M()},[]),s.useEffect(()=>{a?u():h({data:[],meta:{from:0}})},[a,i.current_page,p]);const M=async()=>{try{const t=await v.get("/api/v1/app/universities",{params:{per_page:100}});w(t.data.data)}catch(t){console.error("Error fetching universities:",t),o.error("Failed to load universities")}},u=async()=>{if(a){y(!0);try{const t=await v.get("/api/v1/app/faculties",{params:{university_id:a,page:i.current_page,per_page:i.per_page,search:p||void 0,with_university:!0}});h({data:t.data.data,meta:t.data.meta}),d({current_page:t.data.meta.current_page,per_page:t.data.meta.per_page,total:t.data.meta.total,last_page:t.data.meta.last_page})}catch(t){console.error("Error fetching faculties:",t),o.error("Failed to load faculties")}finally{y(!1)}}},E=t=>{F(t.target.value),d(r=>({...r,current_page:1}))},P=t=>{d(r=>({...r,current_page:t}))},U=t=>{t.preventDefault(),d(r=>({...r,current_page:1}))},A=()=>{g(null),b("create"),m(!0)},D=t=>{g(t),b("edit"),m(!0)},O=t=>{g(t),x(!0)},I=()=>{if(!l)return;(async()=>{var r,j;try{T.delete(`/admin/data-management/faculties/${l.id}`),o.success("Faculty deleted successfully!"),u()}catch(n){n.response?n.response.status===404?(o.error("Faculty not found. It may have been already deleted."),u()):(r=n.response.data)!=null&&r.error?o.error(n.response.data.error):(j=n.response.data)!=null&&j.message?o.error(n.response.data.message):o.error(`Error (${n.response.status}): Unable to delete faculty.`):o.error("Network error or server not responding."),console.error("Error deleting faculty:",n)}finally{x(!1)}})()},$=()=>{m(!1),u()};return e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Faculties"}),e.jsxs("button",{onClick:()=>{a&&A()},disabled:!a,className:`inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest ${a?"hover:bg-blue-700 active:bg-blue-900":"opacity-50 cursor-not-allowed"} focus:outline-none focus:border-blue-900 focus:ring ring-blue-300`,children:[e.jsx(R,{className:"mr-2"})," Add Faculty"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"university",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select University"}),e.jsxs("select",{id:"university",value:a,onChange:E,className:"block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select a university"}),N.map(t=>e.jsx("option",{value:t.id,children:t.full_name},t.id))]})]}),a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6",children:e.jsxs("form",{onSubmit:U,className:"flex",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(q,{className:"text-gray-400"})}),e.jsx("input",{type:"text",value:p,onChange:t=>_(t.target.value),placeholder:"Search faculties...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsx("button",{type:"submit",className:"ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Search"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Academicians"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Postgraduates"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Undergraduates"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center",children:"Loading..."})}):c.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center",children:"No faculties found"})}):c.data.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:c.meta.from+r}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.academicians_count||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.postgraduates_count||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.undergraduates_count||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsxs("button",{onClick:()=>D(t),className:"text-blue-600 hover:text-blue-900 mr-4",children:[e.jsx(z,{className:"inline"})," Edit"]}),e.jsxs("button",{onClick:()=>O(t),className:"text-red-600 hover:text-red-900",children:[e.jsx(B,{className:"inline"})," Delete"]})]})]},t.id))})]})}),!f&&c.data.length>0&&e.jsx("div",{className:"mt-6",children:e.jsx(V,{currentPage:i.current_page,totalPages:i.last_page,onPageChange:P})})]}),e.jsx(L,{isOpen:S,onClose:$,faculty:l,universityId:a||null,mode:C}),e.jsx(Q,{isOpen:k,title:"Delete Faculty",message:`Are you sure you want to delete ${l==null?void 0:l.name}? This action cannot be undone.`,onConfirm:I,onCancel:()=>x(!1)})]})}export{se as default};
