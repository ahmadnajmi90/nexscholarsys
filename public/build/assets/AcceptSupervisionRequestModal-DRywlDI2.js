import{r as l,j as e,a as W}from"./app-DycluJDi.js";import{M as G}from"./Modal-B5RxEfWL.js";import{B as I}from"./button-DrpbBg5w.js";import{L as i}from"./label-DymNAe9a.js";import{T as $}from"./textarea-CSq6H5gP.js";import{C as D}from"./checkbox-Cy0T5o2F.js";import{S as h,a as x,b as p,c as u,d as j}from"./select-CATK_wLT.js";import{A as z,a as J}from"./alert-DSLdBZdj.js";import{c as B}from"./index-CRoFkAwq.js";import{l as K}from"./logError-D4ezqrCx.js";import{C as Y}from"./circle-check-DBw7ke1n.js";import{U as Q}from"./user-round-D0HJxKcP.js";import{L as X}from"./lightbulb-ClojK8Oe.js";import{L as Z}from"./loader-circle-DBMiS7kS.js";import"./dialog-BhLoydV6.js";import"./transition-CPF_n0Aj.js";import"./utils-D-KgF5mV.js";import"./index-Cyyfgiou.js";import"./index-CGrAONsN.js";import"./index-CQUljECt.js";import"./index-C_G9iF1W.js";import"./index-DbGR7Odn.js";import"./index-DygBQkXJ.js";import"./check-B8VjmKe5.js";import"./createLucideIcon-D0KJwFBT.js";import"./index-BdQq_4o_.js";import"./index-3QGgbkx-.js";import"./index-D7eWovwz.js";import"./index-CjkJyM6P.js";import"./index-TfP-1Own.js";import"./index-BsSxmoif.js";import"./tslib.es6-CmEaCU22.js";import"./index-DhTYVmtt.js";import"./index-MS7JGIS8.js";import"./floating-ui.dom-eiE65J5j.js";import"./index-Bf3MYqwD.js";import"./chevron-down-CWxqwc3h.js";import"./chevron-up-Ba7z8PNf.js";const q=[{value:"March",label:"March"},{value:"September",label:"September"}],N=new Date().getFullYear(),ee=Array.from({length:21},(f,t)=>N-10+t),se=[{value:"weekly",label:"Weekly meetings"},{value:"biweekly",label:"Bi-weekly meetings (every 2 weeks)"},{value:"monthly",label:"Monthly meetings"},{value:"flexible",label:"Flexible (as needed)"}],H=[{id:"enrollment",label:"Complete enrollment paperwork",checked:!0},{id:"orientation",label:"Attend graduate school orientation",checked:!0},{id:"accounts",label:"Set up university accounts and access",checked:!0},{id:"meetings",label:"Join research group meetings",checked:!0},{id:"ethics",label:"Complete ethics training",checked:!0},{id:"timeline",label:"Discuss research timeline and milestones",checked:!0}];function Pe({isOpen:f,request:t,onClose:r,onAccepted:g}){var F;const[c,S]=l.useState(""),[n,k]=l.useState(N.toString()),[b,C]=l.useState(""),[y,w]=l.useState(""),[_,M]=l.useState(!0),[T,R]=l.useState(H),[o,L]=l.useState(!1),v=((t==null?void 0:t.student)||{}).full_name||"Student";(F=t==null?void 0:t.postgraduate_program)!=null&&F.name;const P=(t==null?void 0:t.proposal_title)||"Research Topic",A=c&&n&&b,E=c&&n?`${c} ${n}`:"",V=s=>{R(m=>m.map(a=>a.id===s?{...a,checked:!a.checked}:a))},U=async()=>{var s,m;if(!(!A||o)){L(!0);try{const a={cohort_start_term:E,supervision_role:"main_supervisor",meeting_cadence:b,welcome_message:y.trim()||null,create_scholarlab:_,onboarding_checklist:T.filter(d=>d.checked).map(d=>({task:d.label,completed:!1}))};await W.post(route("supervision.requests.accept",t.id),a),B.success("Supervision offer sent to student"),g==null||g(),r==null||r()}catch(a){K(a,"AcceptSupervisionRequestModal handleSubmit");const d=((m=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:m.message)||"Failed to accept supervision request";B.error(d)}finally{L(!1)}}},O=()=>{o||(S(""),k(N.toString()),C(""),w(""),M(!0),R(H),r==null||r())};return e.jsx(G,{show:f,onClose:O,maxWidth:"2xl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Y,{className:"h-6 w-6 text-green-600"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Accept Supervision Request"})]}),e.jsxs("p",{className:"text-sm text-slate-600",children:["Confirm your decision to supervise ",v," and set up the supervision parameters."]})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("section",{className:"rounded-lg border border-slate-200 bg-slate-50 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Student Details"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Q,{className:"h-4 w-4 text-slate-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Student Name"}),e.jsx("div",{className:"text-sm font-medium text-slate-900",children:v})]})]})}),e.jsxs("div",{className:"mt-3 flex items-start gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Research Topic"}),e.jsx("div",{className:"text-sm text-slate-900",children:P})]})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h3",{className:"text-base font-semibold text-slate-900",children:"Supervision Setup"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(i,{className:"mb-2 block",children:["Cohort/Start Term ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs(h,{value:c,onValueChange:S,children:[e.jsx(x,{id:"cohortMonth",children:e.jsx(p,{placeholder:"Select month"})}),e.jsx(u,{children:q.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})}),e.jsx("div",{className:"space-y-2",children:e.jsxs(h,{value:n,onValueChange:k,children:[e.jsx(x,{id:"cohortYear",children:e.jsx(p,{placeholder:"Select year"})}),e.jsx(u,{children:ee.map(s=>e.jsx(j,{value:s.toString(),children:s},s))})]})})]}),c&&n&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Selected: ",e.jsx("span",{className:"font-medium",children:E})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"role",children:"Supervision Role"}),e.jsxs(h,{value:"main_supervisor",disabled:!0,children:[e.jsx(x,{id:"role",children:e.jsx(p,{})}),e.jsx(u,{children:e.jsx(j,{value:"main_supervisor",children:"Main Supervisor"})})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Co-supervisor assignment available in supervision panel"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"cadence",children:["Expected Meeting Cadence ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(h,{value:b,onValueChange:C,children:[e.jsx(x,{id:"cadence",children:e.jsx(p,{placeholder:"Select meeting frequency"})}),e.jsx(u,{children:se.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"message",children:"Custom Message to Student (Optional)"}),e.jsx($,{id:"message",rows:4,value:y,onChange:s=>w(s.target.value),placeholder:"Add a personal message to welcome the student...",className:"resize-none"})]})]}),e.jsxs("section",{className:"space-y-3",children:[e.jsx("h3",{className:"text-base font-semibold text-slate-900",children:"Integration Setup"}),e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx(D,{id:"scholarlab",checked:_,onCheckedChange:M,className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(i,{htmlFor:"scholarlab",className:"text-sm font-medium text-slate-900 cursor-pointer",children:"Create NexLab Supervision Board"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Automatically create a shared board in NexLab with default lists for supervision tasks, deliverables, meetings, and paper workstreams."})]})]})]}),e.jsxs("section",{className:"space-y-3",children:[e.jsx("h3",{className:"text-base font-semibold text-slate-900",children:"Onboarding Checklist Preview"}),e.jsx("p",{className:"text-sm text-slate-600",children:"These items will be added to the student's onboarding checklist:"}),e.jsx("div",{className:"space-y-2",children:T.map(s=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border border-slate-200 bg-white",children:[e.jsx(D,{id:s.id,checked:s.checked,onCheckedChange:()=>V(s.id),className:"mt-0.5"}),e.jsx(i,{htmlFor:s.id,className:"text-sm text-slate-700 cursor-pointer",children:s.label})]},s.id))})]}),e.jsxs(z,{className:"bg-green-50 border-green-200",children:[e.jsx(Y,{className:"h-4 w-4 text-green-600"}),e.jsxs(J,{className:"text-sm text-green-900",children:[e.jsx("strong",{className:"font-semibold",children:"Ready to Accept"}),e.jsxs("p",{className:"mt-1",children:["By accepting, you agree to supervise ",v,". The student will be notified immediately, and supervision records will be created after the student accepts your offer."]})]})]})]})}),e.jsxs("div",{className:"mt-6 pt-4 border-t flex items-center justify-end gap-3",children:[e.jsx(I,{variant:"outline",onClick:O,disabled:o,children:"Cancel"}),e.jsxs(I,{onClick:U,disabled:!A||o,className:"bg-green-600 hover:bg-green-700",children:[o&&e.jsx(Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirm & Notify Student"]})]})]})})}export{Pe as default};
