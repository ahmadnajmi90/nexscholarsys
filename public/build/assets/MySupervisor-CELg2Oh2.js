import{r as i,R as U,j as t,Y as E,b as x}from"./app-A8xQkvSk.js";import{M as _}from"./MainLayout-CjLgp52Q.js";import{T as F,a as V,b as v,c as h}from"./tabs-Cbyzn-fX.js";import{c as A}from"./index-Km-vM6Jb.js";import{l as Y}from"./logError-D4ezqrCx.js";import k from"./PotentialSupervisorList-Dt6tKm1a.js";import z from"./RequestStatusList-DzvBQq4n.js";import B from"./RequestDetailCard-BCfln0Rn.js";import G from"./ManageSupervisorPanel-C9f_InVP.js";import H from"./ProposalModal-DJ2-O5wZ.js";import J from"./RelationshipDetailModal-EloczgIN.js";import K from"./ForceUnbindRequestModal-voLLYZ6N.js";import"./house-DIYSl52k.js";import"./createLucideIcon-DPzobtnR.js";import"./zap-Dak04NKO.js";import"./users-BaMPipud.js";import"./folder-open-Bj-Qb-PO.js";import"./settings-CbyQhbcQ.js";import"./useRoles-DnA4fsnD.js";import"./chevron-left-BruLJFfn.js";import"./proxy-CKd5URLT.js";import"./user-round-CEZUuFcg.js";import"./clipboard-list-BtJRjBIa.js";import"./log-out-BebSIB5g.js";import"./dollar-sign-Bq2kjMHF.js";import"./calendar-EpaZ4Aad.js";import"./file-text-BfC4OSQU.js";import"./message-square-C9nAneZj.js";import"./graduation-cap-the7C-yQ.js";import"./building-NTAK_MKf.js";import"./sparkles-CGG6vdsp.js";import"./building-2-BCJzFzaK.js";import"./database-DpVHQPSB.js";import"./shield-D8lNzSRy.js";import"./index-B4VpFx6V.js";import"./Dropdown-DkOdv60-.js";import"./transition-Bvb6H6Z4.js";import"./analytics-BQ374C1C.js";import"./Modal-D_n_zj3N.js";import"./dialog-BkDQGxoj.js";import"./PrimaryButton-Dxc_ynbL.js";import"./SecondaryButton-BW8D4TTl.js";import"./x-vL7g-LuD.js";import"./briefcase-CfUq1pnR.js";import"./user-yqODNyIj.js";import"./index-BEzQHz4a.js";import"./index-7Qlnuq3l.js";import"./index-CG1gsK_f.js";import"./index-DwuY8lh1.js";import"./index-OrEFxIKi.js";import"./index-DMPy21CI.js";import"./index-B0SlzLk6.js";import"./utils-CIsb_jhR.js";import"./clsx-B-dksMZM.js";import"./card-DyHgWaPU.js";import"./button-Dz_rydmG.js";import"./ConfirmationModal-C-j5S7kM.js";import"./triangle-alert-BND9SWEh.js";import"./formatDistanceToNow-GKXiLTrL.js";import"./constructNow-DtVD-0hX.js";import"./en-US-DNUEYIb-.js";import"./book-open-BGEy-0ob.js";import"./folder-kanban-B_adFrTw.js";import"./user-plus-e-4IYQ9U.js";import"./eye-B05lsJ9f.js";import"./send-CXXTO7CN.js";import"./circle-check-ddCD_g9w.js";import"./loader-circle-DkpR38mE.js";import"./trash-2-XEAf-v5f.js";import"./badge-CFoP9Krf.js";import"./index-Dp3B9jqt.js";import"./separator-B59s4oDI.js";import"./clock-3-C_DEcbhV.js";import"./message-circle-BHBy_nP-.js";import"./circle-x-R0AwPcda.js";import"./format-hTuirObu.js";import"./avatar-CbIr_OjG.js";import"./scroll-area-COMlVIOb.js";import"./ThreadPane-CPpSuURI.js";import"./AttachmentPreviewModal-CXErbNPv.js";import"./download-CMnE0euH.js";import"./AcceptSupervisorOfferModal-CGntPWdr.js";import"./label-BcrT7TVM.js";import"./checkbox-DDgIuOJc.js";import"./index-rTP0VXgG.js";import"./index-Db3xrL5F.js";import"./check-BeDd_wJ7.js";import"./alert-BBFXwXFc.js";import"./circle-alert-CPnO62Yc.js";import"./video-DL3IJgDp.js";import"./mail-Dtimj1fp.js";import"./phone-D1xIudn-.js";import"./calendar-clock-BwBj7N73.js";import"./StudentRelationshipDetailModal-B0PYuNue.js";import"./ResearchTab-B4EYMRFM.js";import"./input-D2p8biwd.js";import"./textarea-DGdKxzUN.js";import"./plus-BqbQZKPX.js";import"./circle-eov79Dsa.js";import"./DocumentsTab-B11iV4A2.js";import"./select-BBDf1Ygo.js";import"./index-BlKfbGK4.js";import"./Combination-Bf5eV4ml.js";import"./tslib.es6-CmEaCU22.js";import"./index-Cp2nhW7C.js";import"./floating-ui.dom-eiE65J5j.js";import"./chevron-down-qnEAqpL2.js";import"./chevron-up-hxgrcUwj.js";import"./DocumentPreviewModal-CPJtZlTY.js";import"./upload-DLfp_NaM.js";import"./chevron-right-Mpml_Nmb.js";import"./history-BxBz3cCN.js";import"./ScheduleMeetingDialog-C9eLZHwe.js";import"./StudentOverviewTab-B7N66E49.js";import"./UnbindRequestModal-2eYhJEIj.js";import"./tooltip-Oo0Wz_lE.js";import"./external-link-RAq8nM7x.js";import"./UniversityLetterUploadModal-CgNwqMmA.js";import"./dialog-Bzt3rBy_.js";import"./lightbulb-CqLRSIqT.js";import"./cloud-upload-znqQn_dB.js";import"./paperclip-DJjI9uOh.js";import"./RejectUnbindModal-DQez5DeH.js";import"./clock-CrVAeSun.js";function ui(){const[S,g]=i.useState(()=>sessionStorage.getItem("openRequestId")?"status":"potential"),[y,N]=i.useState([]),[f,w]=i.useState([]),[a,I]=i.useState([]),[n,R]=i.useState(!0),[M,m]=i.useState(!1),[P,l]=i.useState(null),[u,o]=i.useState(null),[d,p]=i.useState(null),[j,D]=i.useState(()=>{const e=sessionStorage.getItem("openRequestId");return e?(sessionStorage.removeItem("openRequestId"),e):null}),s=async()=>{R(!0);try{const[e,r,O]=await Promise.all([x.get(route("supervision.shortlist.index")),x.get(route("supervision.requests.index")),x.get(route("supervision.relationships.index"))]),b=r.data.data||[];if(N(e.data.data||[]),w(b),I(O.data.data||[]),j){const q=b.find(C=>String(C.id)===String(j));q&&o(q),D(null)}}catch(e){Y(e,"Supervision loadData"),A.error("Failed to load supervision data")}finally{R(!1)}};i.useEffect(()=>{s()},[]);const L=a.some(e=>e.status==="active"),T=a.find(e=>e.status==="active")||null,c=U.useMemo(()=>{for(const e of a){const r=e.activeUnbindRequest||e.active_unbind_request;if(r&&r.status==="pending"&&r.initiated_by==="supervisor")return{unbindRequest:r,relationship:e}}return null},[a]);return t.jsxs(_,{title:"My Supervisor",children:[t.jsx(E,{title:"My Supervisor"}),t.jsxs("div",{className:"max-w-7xl mx-auto pb-6",children:[L?t.jsx(G,{relationships:a,reload:s,onOpenDetail:e=>{p(e),o(null)},onOpenMeetings:e=>{p(e),o(null)}}):t.jsxs(F,{value:S,onValueChange:g,className:"w-full space-y-4",children:[t.jsxs(V,{className:"grid w-full grid-cols-2 md:grid-cols-3 bg-gray-100 p-1 rounded-lg h-12",children:[t.jsx(v,{value:"potential",className:"data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm data-[state=inactive]:text-gray-600 rounded-md transition-all py-2",children:"Potential Supervisors"}),t.jsx(v,{value:"status",className:"data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm data-[state=inactive]:text-gray-600 rounded-md transition-all py-2",children:"Proposal Status"}),t.jsx(v,{value:"manage",disabled:!0,className:"data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm data-[state=inactive]:text-gray-400 rounded-md transition-all py-2",children:"Manage Supervisor"})]}),t.jsx(h,{value:"potential",children:n?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center space-y-3",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),t.jsx("p",{className:"text-sm text-slate-600",children:"Loading potential supervisors..."})]})}):t.jsx(k,{shortlist:y,requests:f,activeRelationship:T,reload:s,isLoading:n,onRequestSupervisor:e=>{l(e),m(!0)},onViewRequest:e=>{o(e),p(null),g("status")}})}),t.jsx(h,{value:"status",children:n?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center space-y-3",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),t.jsx("p",{className:"text-sm text-slate-600",children:"Loading your requests..."})]})}):t.jsx(z,{requests:f,reload:s,onOpenDetail:e=>{o(e),p(null)}})}),t.jsx(h,{value:"manage",children:t.jsx("div",{className:"bg-white shadow rounded-lg p-6 text-center text-gray-500",children:"No supervisors yet."})})]}),t.jsx(H,{isOpen:M,onClose:()=>{m(!1),l(null)},supervisor:P,onSubmitted:()=>{m(!1),l(null),s()}}),u&&!d&&t.jsx(B,{request:u,onClose:()=>{o(null)},onUpdated:s}),d&&t.jsx(J,{request:u,relationship:d,onClose:()=>{o(null),p(null)},onUpdated:s}),c&&t.jsx(K,{unbindRequest:c.unbindRequest,relationship:c.relationship,onResponse:s,userRole:"student"})]})]})}export{ui as default};
