import{q as he,r as o,a as C,j as e}from"./app-BrPd_5NA.js";import{c as _}from"./index-BBpOhVGp.js";import{T as pe,a as ue,b as w,c as y}from"./tabs-VnPkUC9E.js";import{B as m}from"./button-D_c8cCUP.js";import{B as be}from"./badge-C-rv9uJ4.js";import{A as fe,a as je}from"./avatar-HuhwrEH0.js";import"./separator-BkyD_kuE.js";import{S}from"./scroll-area-9ivrOSrd.js";import{T as z}from"./textarea-D5wt2kvG.js";import"./tooltip-Do508To7.js";import{T as ve,a as Ne}from"./ThreadPane-BDKDZsV9.js";import ge from"./AcceptSupervisorOfferModal--Ozt2tW7.js";import we from"./AcceptSupervisionRequestModal-Dv8MdheJ.js";import ye from"./DeclineSupervisionRequestModal-SzNgyvmx.js";import _e from"./ScheduleMeetingDialog-CB3CwR2j.js";import{l as T}from"./logError-BloCzXDJ.js";import{O as Ae,S as ke}from"./modalAnimations-CCENKliM.js";import{g as Se,f as ae,a as Ce,h as Te}from"./supervisionHelpers-EJT0WNFw.js";import{A as Me}from"./index-65ttqxxV.js";import{m as K}from"./proxy-DqGN9o1W.js";import{X as Y}from"./x-CWW5msPO.js";import{C as Z}from"./circle-check-C8NnlNDG.js";import{M as De}from"./message-square-Ba9o6uXG.js";import{C as Q}from"./calendar-g0DizSmb.js";import{V as q}from"./video-B9y2Pr0J.js";import{U as Oe}from"./user-round-CmjIdno-.js";import{B as Ee}from"./briefcase-DUAxgeVE.js";import{M as ee}from"./mail-XASeurjZ.js";import{P as se}from"./phone-FyFqrHxg.js";import{G as Pe}from"./globe-fzlAyqNM.js";import{G as F}from"./graduation-cap-BVpuDxYd.js";import{L as M}from"./loader-circle-DSxVtQi0.js";import{F as le}from"./file-text-D7d1fAn0.js";import{S as te}from"./sticky-note-BA6L03Kq.js";import{T as Ie}from"./trash-2-DrYXxk5a.js";import{f as L}from"./format-BOijCLBA.js";import"./index-BINPKaee.js";import"./index-CfSCNicO.js";import"./index-B8zdXgNA.js";import"./index-D7NdPX5u.js";import"./index-DDsMp2PF.js";import"./index-CbW9dcCk.js";import"./index-trzRZPTl.js";import"./index-BsS7Hkv-.js";import"./index-sCVn0dxs.js";import"./utils-CBfrqCZ4.js";import"./index-CdJFUDDL.js";import"./index-BdQq_4o_.js";import"./index-CbgwQkER.js";import"./index-Bg98LDa9.js";import"./floating-ui.dom-D5EC_49c.js";import"./index-CG9XqnVQ.js";import"./index-cpcYRf8f.js";import"./Modal-RZHZPq1U.js";import"./dialog-C-QKEJiA.js";import"./transition-C1LRY1ul.js";import"./download-BR6OYre6.js";import"./createLucideIcon-BuUp2DP1.js";import"./isSameDay-BHs4V-zU.js";import"./en-US-DIdCsyf3.js";import"./label-BfkwUhKT.js";import"./checkbox-C_eDCeAt.js";import"./index-Bf7zMkfS.js";import"./check-Z2_kxFvT.js";import"./alert-DBAharqk.js";import"./circle-alert-CpcUkcJ4.js";import"./select-8_l01y6v.js";import"./index-Be2_8SSR.js";import"./chevron-down-CyOkOypn.js";import"./chevron-up-E7xn4Z9S.js";import"./lightbulb-D2xCnmP-.js";import"./input-CTQwd9Zb.js";import"./supervisionConstants-BuM5-H5X.js";import"./circle-x-CFWUSJzQ.js";import"./users-Bm8PtVb1.js";import"./building-2-BO21CEE8.js";import"./search-D1RvesB3.js";import"./useGoogleCalendar-C3GvL7sq.js";import"./external-link-BT9Iv05v.js";function xt({request:s,onClose:t,onUpdated:a,userRole:l}){const{auth:d}=he().props,[p,x]=o.useState("overview"),[u,i]=o.useState(!1),[f,j]=o.useState(!1),[D,b]=o.useState(!1),[A,v]=o.useState(!1),[N,k]=o.useState([]),[n,B]=o.useState(""),[H,U]=o.useState(!1),[V,G]=o.useState(null),[ie,W]=o.useState(null),re=15*1024*1024,O=s?.relationship&&s.relationship.id?s.relationship:null;o.useEffect(()=>{l==="supervisor"&&s?.id&&ne()},[l,s?.id]);const ne=async()=>{if(s?.id)try{const r=await C.get(route("supervision.requests.notes.index",s.id));k(r.data.data||[])}catch(r){T(r,"UnifiedRequestDetailCard loadNotes")}},ce=async()=>{if(!(!n.trim()||H)){U(!0);try{const r=await C.post(route("supervision.requests.notes.store",s.id),{note:n.trim()});k([r.data.data,...N]),B(""),_.success("Note added")}catch(r){T(r,"UnifiedRequestDetailCard handleAddNote"),_.error("Failed to add note")}finally{U(!1)}}},de=async r=>{if(!V){G(r);try{await C.delete(route("supervision.requests.notes.destroy",{request:s.id,note:r})),k(N.filter(I=>I.id!==r)),_.success("Note deleted")}catch(I){T(I,"UnifiedRequestDetailCard handleDeleteNote"),_.error("Failed to delete note")}finally{G(null)}}},$=r=>{Te(r,W,re)};if(!s)return null;const g=l==="student"?s?.academician??{}:s?.student??{},E=g.full_name??(l==="student"?"Supervisor":"Student"),oe=l==="student"?g.current_position??"":null,J=g.profile_picture?`/storage/${g.profile_picture}`:null,R=l==="student"?g.university?.name??"":null,c=s.status??"pending",X=s?.conversation_id,P=c==="pending"||c==="pending_student_acceptance",me=Se(E),xe=ae(c);return e.jsxs(e.Fragment,{children:[e.jsx(Me,{children:e.jsx(K.div,{...Ae,className:"fixed inset-0 z-40 flex items-center justify-end bg-black/50",onClick:t,children:e.jsxs(K.div,{...ke,className:"w-full max-w-3xl h-full bg-white shadow-xl overflow-hidden flex flex-col",onClick:r=>r.stopPropagation(),children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx(fe,{className:"h-12 w-12",children:J?e.jsx("img",{src:J,alt:E,className:"h-full w-full object-cover"}):e.jsx(je,{className:"bg-indigo-100 text-indigo-700 text-sm font-semibold",children:me})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:E}),l==="student"?R&&e.jsx("span",{className:"text-sm text-slate-600",children:R}):e.jsx("p",{className:"text-sm text-slate-600",children:"Student"}),e.jsx("div",{className:"mt-2 flex items-center gap-3 flex-wrap",children:e.jsx(be,{className:`${Ce(c)} border`,children:xe})})]})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(Y,{className:"h-5 w-5 text-slate-500"})})]})}),e.jsx("div",{className:"px-6 py-4 border-b bg-slate-50",children:l==="student"?e.jsxs(e.Fragment,{children:[c==="pending_student_acceptance"&&e.jsx("div",{className:"mb-3",children:e.jsxs(m,{onClick:()=>i(!0),className:"w-full bg-emerald-600 hover:bg-emerald-700",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Accept Supervisor Offer"]})}),P&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{variant:"outline",className:"flex-1",onClick:()=>x("chat"),children:[e.jsx(De,{className:"mr-2 h-4 w-4"}),"Chat"]}),e.jsxs(m,{variant:"outline",className:"flex-1",disabled:!0,title:"Only supervisors can schedule meetings",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Schedule"]}),e.jsxs(m,{className:"flex-1 bg-slate-900 hover:bg-slate-800",disabled:!s?.meetings||s.meetings.length===0||!s.meetings[0]?.location_link,onClick:()=>{const r=s?.meetings?.[0];r?.location_link&&window.open(r.location_link,"_blank","noopener,noreferrer")},children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Join Meeting"]})]}),!P&&c!=="pending_student_acceptance"&&e.jsxs("div",{className:"text-sm text-slate-600 text-center py-2",children:[c==="pending"&&"Waiting for supervisor response...",c==="accepted"&&"This request has been accepted",c==="rejected"&&"This request was not accepted",(c==="cancelled"||c==="auto_cancelled")&&"This request has been cancelled"]})]}):e.jsxs(e.Fragment,{children:[c==="pending"&&e.jsxs("div",{className:"flex gap-3 mb-3",children:[e.jsxs(m,{onClick:()=>j(!0),className:"flex-1 bg-emerald-600 hover:bg-emerald-700",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Accept Request"]}),e.jsxs(m,{variant:"outline",onClick:()=>b(!0),className:"flex-1 border-red-300 text-red-700 hover:bg-red-50",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Decline Request"]})]}),(c==="pending"||c==="pending_student_acceptance")&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{variant:"outline",onClick:()=>v(!0),className:"flex-1",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Schedule Meeting"]}),e.jsxs(m,{className:"flex-1 bg-slate-900 hover:bg-slate-800",disabled:!s?.meetings||s.meetings.length===0||!s.meetings[0]?.location_link,onClick:()=>{const r=s?.meetings?.[0];r?.location_link&&window.open(r.location_link,"_blank","noopener,noreferrer")},children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Join Meeting"]})]}),c==="pending_student_acceptance"&&e.jsx("div",{className:"mt-3 text-sm text-blue-700 bg-blue-50 border border-blue-200 rounded p-3 text-center",children:"Waiting for student to accept your offer"}),c==="accepted"&&e.jsx("div",{className:"text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded p-3 text-center",children:"✓ Request accepted - Supervision relationship is active"}),c==="rejected"&&e.jsx("div",{className:"text-sm text-slate-600 text-center py-2",children:"This request was declined"}),(c==="cancelled"||c==="auto_cancelled")&&e.jsx("div",{className:"text-sm text-slate-600 text-center py-2",children:"This request was cancelled by the student"})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(pe,{value:p,onValueChange:x,className:"h-full flex flex-col",children:[e.jsxs(ue,{className:"px-6 bg-gray-100 w-full justify-start rounded-none h-auto p-0 gap-0",children:[e.jsx(w,{value:"overview",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Overview"}),e.jsx(w,{value:"proposal",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Proposal"}),e.jsx(w,{value:"documents",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Documents"}),e.jsx(w,{value:"chat",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Chat"}),l==="supervisor"&&e.jsx(w,{value:"notes",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Notes"}),e.jsx(w,{value:"history",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"History"})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx(y,{value:"overview",className:"mt-0 h-full",children:e.jsx(S,{className:"h-full",children:e.jsx(Fe,{request:s,person:g,userRole:l,currentPosition:oe})})}),e.jsx(y,{value:"proposal",className:"mt-0 h-full",children:e.jsx(S,{className:"h-full",children:e.jsx(ze,{request:s,onAttachmentClick:$,userRole:l})})}),e.jsx(y,{value:"documents",className:"mt-0 h-full",children:e.jsx(S,{className:"h-full",children:e.jsx(Le,{request:s,onAttachmentClick:$})})}),e.jsx(y,{value:"chat",className:"mt-0 h-full",children:X?e.jsx("div",{className:"p-6 h-full",children:e.jsx("div",{className:"border border-slate-200 rounded-lg bg-white shadow-sm h-full overflow-hidden",children:e.jsx(ve,{conversationId:X,auth:d,onConversationRead:()=>{},onConversationIncrementUnread:()=>{},onAfterSend:()=>a?.()})})}):e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:e.jsx("p",{className:"text-sm text-slate-500",children:"No conversation available yet."})})})}),l==="supervisor"&&e.jsx(y,{value:"notes",className:"mt-0 h-full",children:e.jsx(S,{className:"h-full",children:e.jsx(Be,{notesList:N,newNote:n,setNewNote:B,isAddingNote:H,isDeletingNoteId:V,onAddNote:ce,onDeleteNote:de,isReadOnly:!P})})}),e.jsx(y,{value:"history",className:"mt-0 h-full",children:e.jsx(S,{className:"h-full",children:e.jsx(He,{request:s})})})]})]})})]})})}),e.jsx(Ne,{file:ie,onClose:()=>W(null)}),l==="student"&&e.jsx(ge,{request:s,isOpen:u,onClose:()=>i(!1),onAccepted:()=>{i(!1),a?.(),t?.()}}),l==="supervisor"&&e.jsxs(e.Fragment,{children:[e.jsx(we,{request:s,isOpen:f,onClose:()=>j(!1),onAccepted:()=>{j(!1),a?.()}}),e.jsx(ye,{request:s,isOpen:D,onClose:()=>b(!1),onDeclined:()=>{b(!1),a?.(),t?.()}}),e.jsx(_e,{request:A&&!O?s:null,relationship:A&&O?O:null,onClose:()=>v(!1),onScheduled:()=>{v(!1),a?.()},userRole:"supervisor"})]})]})}function Fe({request:s,person:t,userRole:a,currentPosition:l}){const d=s?.submitted_at?L(new Date(s.submitted_at),"dd/MM/yyyy HH:mm"):"—";return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:a==="student"?"Supervisor Profile":"Student Profile"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(h,{icon:Oe,label:"Full Name",value:t.full_name||"—"}),a==="student"?e.jsxs(e.Fragment,{children:[l&&e.jsx(h,{icon:Ee,label:"Position",value:l}),e.jsx(h,{icon:ee,label:"Email",value:t.email||"—"}),e.jsx(h,{icon:se,label:"Phone",value:t.phone_number||"—"})]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{icon:ee,label:"Email",value:t.email||t.user?.email||"—"}),e.jsx(h,{icon:se,label:"Phone",value:t.phone_number||"—"}),e.jsx(h,{icon:Pe,label:"Nationality",value:t.nationality||"—"})]})]}),a==="student"&&(t.university||t.faculty||t.department)&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("h4",{className:"text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4 text-slate-500"}),"Institution"]}),e.jsxs("div",{className:"space-y-2",children:[t.university&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-slate-700",children:"University: "}),e.jsx("span",{className:"text-slate-600",children:t.university.name||t.university.full_name||"—"})]}),t.faculty&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-slate-700",children:"Faculty: "}),e.jsx("span",{className:"text-slate-600",children:t.faculty.name||"—"})]}),t.department&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-slate-700",children:"Department: "}),e.jsx("span",{className:"text-slate-600",children:t.department})]})]})]}),a==="student"&&t.research_areas&&Array.isArray(t.research_areas)&&t.research_areas.length>0&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Research Expertise"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.research_areas.slice(0,3).map((p,x)=>e.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full bg-indigo-50 text-indigo-700 border border-indigo-200",children:p},x)),t.research_areas.length>3&&e.jsxs("span",{className:"px-2.5 py-1 text-xs rounded-full bg-slate-100 text-slate-600",children:["+",t.research_areas.length-3," more"]})]})]}),a==="student"&&t.bio&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Bio"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed line-clamp-3 break-words max-w-full",children:t.bio})]}),a==="supervisor"&&t.university_details&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx(h,{icon:F,label:"University",value:t.university_details.full_name||"—"}),t.faculty&&e.jsx(h,{icon:F,label:"Faculty",value:t.faculty.name||"—"})]})]})]}),e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Request Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Proposal Title"}),e.jsx("div",{className:"text-sm text-slate-700 font-medium break-words max-w-full",children:s.proposal_title||"—"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(h,{label:"Submitted",value:d}),e.jsx(h,{label:"Status",value:ae(s.status)})]})]})]})]})}function ze({request:s,onAttachmentClick:t,userRole:a}){const l=s?.attachments??[],[d,p]=o.useState(null),[x,u]=o.useState(!1),[i,f]=o.useState(""),[j,D]=o.useState(!0),[b,A]=o.useState(!1);o.useEffect(()=>{v()},[s.id]);const v=async()=>{try{const n=await C.get(route("supervision.requests.abstract.show",s.id));p(n.data.data),f(n.data.data?.abstract||"")}catch(n){T(n,"ProposalTab loadAbstract")}finally{D(!1)}},N=async()=>{A(!0);try{await C.put(route("supervision.requests.abstract.update",s.id),{abstract:i}),_.success("Abstract saved successfully"),u(!1),await v()}catch(n){T(n,"ProposalTab handleSaveAbstract"),_.error(n.response?.data?.message||"Failed to save abstract")}finally{A(!1)}},k=()=>{u(!x),x||f(d?.abstract||"")};return e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm w-[720px]",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Research Proposal"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Title"}),e.jsx("p",{className:"text-base text-slate-900 break-words max-w-full",children:s.proposal_title??"Untitled"})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide",children:"Abstract"}),a==="student"&&s.status==="pending"&&!j&&e.jsx(m,{size:"sm",variant:"outline",onClick:k,children:x?"Cancel":"Edit"})]}),j?e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(M,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm",children:"Loading abstract..."})]}):d?.extraction_status==="failed"?e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-yellow-800 mb-2",children:"Could not extract abstract automatically. Please enter it manually."}),d.extraction_error&&e.jsx("p",{className:"text-xs text-yellow-600 mb-3",children:d.extraction_error}),a==="student"&&s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(z,{value:i,onChange:n=>f(n.target.value),placeholder:"Enter your abstract here (minimum 50 characters)...",rows:6,className:"mb-2"}),e.jsxs(m,{onClick:N,disabled:b||i.length<50,size:"sm",children:[b&&e.jsx(M,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Abstract"]})]})]}):x?e.jsxs("div",{children:[e.jsx(z,{value:i,onChange:n=>f(n.target.value),rows:8,className:"mb-2",placeholder:"Enter your abstract here (minimum 50 characters)..."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{onClick:N,disabled:b||i.length<50,size:"sm",children:[b&&e.jsx(M,{className:"mr-2 h-4 w-4 animate-spin"}),"Save"]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>u(!1),children:"Cancel"})]}),i.length<50&&i.length>0&&e.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:["Abstract must be at least 50 characters (",i.length,"/50)"]})]}):e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed whitespace-pre-line break-words",children:d?.abstract?.trim()||"No abstract available"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Motivation"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed whitespace-pre-wrap break-words max-w-full overflow-hidden",children:s.motivation??"No motivation provided."})]}),s.research_area&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Research Area"}),e.jsx("p",{className:"text-sm text-slate-600 break-words max-w-full",children:s.research_area})]}),s.proposal_summary&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Summary"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed whitespace-pre-wrap break-words max-w-full overflow-hidden",children:s.proposal_summary})]}),s.methodology&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Methodology"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed whitespace-pre-wrap break-words max-w-full overflow-hidden",children:s.methodology})]}),s.expected_outcomes&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Expected Outcomes"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed whitespace-pre-wrap break-words max-w-full overflow-hidden",children:s.expected_outcomes})]}),l.length>0&&e.jsxs("div",{className:"pt-4 border-t border-slate-100",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-3",children:"Attachments"}),e.jsx("div",{className:"space-y-2",children:l.map(n=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"p-2 bg-indigo-50 rounded-md",children:e.jsx(le,{className:"h-5 w-5 text-indigo-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 truncate",children:n.original_name||"Attachment"}),e.jsx("p",{className:"text-xs text-slate-500 capitalize",children:n.type?.replace("_"," ")||"Document"})]})]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>t(n),children:"View File"})]},n.id))})]})]})]})})}function Le({request:s,onAttachmentClick:t}){const a=s?.attachments||[],l=a.length>0;return e.jsx("div",{className:"p-6",children:e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:["Attached Documents (",a.length,")"]}),l?e.jsx("div",{className:"space-y-2",children:a.map((d,p)=>e.jsxs("button",{onClick:()=>t(d),className:"w-full flex items-center gap-3 p-3 rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors text-left",children:[e.jsx(le,{className:"h-5 w-5 text-slate-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900 truncate",children:d.original_name||"Attachment"}),e.jsx("div",{className:"text-xs text-slate-500",children:d.size_formatted||`${(d.size/1024).toFixed(1)} KB`})]})]},d.id||p))}):e.jsx("div",{className:"text-sm text-slate-500 text-center py-8",children:"No documents attached"})]})})}function Be({notesList:s,newNote:t,setNewNote:a,isAddingNote:l,isDeletingNoteId:d,onAddNote:p,onDeleteNote:x,isReadOnly:u=!1}){return e.jsxs("div",{className:"p-6 space-y-6",children:[!u&&e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(te,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Add Private Note"})]}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"These notes are private and only visible to you. Students cannot see them."}),e.jsx(z,{rows:4,value:t,onChange:i=>a(i.target.value),placeholder:"Write your note here...",className:"mb-3"}),e.jsxs(m,{onClick:p,disabled:!t.trim()||l,children:[l&&e.jsx(M,{className:"mr-2 h-4 w-4 animate-spin"}),"Add Note"]})]}),e.jsxs("section",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900",children:["All Notes (",s.length,")"]}),s.length===0?e.jsxs("div",{className:"border border-slate-200 rounded-lg p-6 bg-slate-50 text-center",children:[e.jsx(te,{className:"h-8 w-8 text-slate-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-slate-500",children:u?"No notes for this request.":"No notes yet. Add your first note above."})]}):e.jsx("div",{className:"space-y-3",children:s.map(i=>e.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"text-xs text-slate-500",children:i.created_at?L(new Date(i.created_at),"dd/MM/yyyy HH:mm"):"Just now"})}),!u&&e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>x(i.id),disabled:d===i.id,className:"h-8 w-8 p-0 hover:bg-red-50 hover:text-red-600",children:d===i.id?e.jsx(M,{className:"h-4 w-4 animate-spin"}):e.jsx(Ie,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-sm text-slate-700 whitespace-pre-wrap leading-relaxed break-words max-w-full overflow-hidden",children:i.note})]},i.id))})]})]})}function He({request:s}){const t=[];if(s?.submitted_at&&t.push({id:1,title:"Request Submitted",date:s.submitted_at,status:"completed"}),s?.decision_at){const a=s.status==="accepted"||s.status==="pending_student_acceptance";t.push({id:2,title:a?"Offer Extended":"Request Declined",date:s.decision_at,status:"completed"})}return s?.status==="accepted"&&s?.decision_at&&t.push({id:3,title:"Offer Accepted by Student",date:s.updated_at,status:"completed"}),e.jsx("div",{className:"p-6",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Timeline"}),t.length===0?e.jsx("div",{className:"text-sm text-slate-500 text-center py-8",children:"No timeline events yet"}):e.jsx("div",{className:"space-y-4",children:t.map((a,l)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${a.status==="completed"?"bg-green-500":"bg-slate-300"}`}),l<t.length-1&&e.jsx("div",{className:"w-0.5 h-full bg-slate-200 mt-2"})]}),e.jsxs("div",{className:"flex-1 pb-8",children:[e.jsx("h4",{className:"font-medium text-slate-900",children:a.title}),e.jsx("p",{className:"text-sm text-slate-500",children:a.date?L(new Date(a.date),"dd/MM/yyyy HH:mm"):"TBD"})]})]},a.id))})]})})}function h({icon:s,label:t,value:a}){return e.jsxs("div",{className:"flex items-start gap-2",children:[s&&e.jsx(s,{className:"mt-0.5 h-4 w-4 text-slate-400 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:t}),e.jsx("div",{className:"text-sm text-slate-700 break-words max-w-full",children:a||"—"})]})]})}export{xt as default};
