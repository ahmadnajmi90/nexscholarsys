import{r as a,j as e,a as B}from"./app-BBTReE8F.js";import{P as h}from"./index-KeQiB4QO.js";import{I as Fe}from"./InputLabel-ZjYmnJcF.js";import{I as Be}from"./InputError-B9TNnRFB.js";function $e({selectedSkills:g=[],skillDetails:j={},onRemoveSkill:z,showCounts:_=!0,showRemoveButtons:X=!0,className:Z=""}){const[E,W]=a.useState(new Set);a.useEffect(()=>{if(g.length>0&&Object.keys(j).length>0){const r=new Set;g.forEach(x=>{var d,i;const n=j[x];(i=(d=n==null?void 0:n.subdomain)==null?void 0:d.domain)!=null&&i.name&&r.add(n.subdomain.domain.name)}),W(r)}},[g,j]);const D=a.useMemo(()=>{const r={};return g.forEach(x=>{var v;const n=j[x];if(!n||!((v=n.subdomain)!=null&&v.domain))return;const d=n.subdomain.domain.name,i=n.subdomain.name;r[d]||(r[d]={domain:n.subdomain.domain,subdomains:{},totalSkills:0}),r[d].subdomains[i]||(r[d].subdomains[i]={subdomain:n.subdomain,skills:[]}),r[d].subdomains[i].skills.push(n),r[d].totalSkills++}),r},[g,j]),N=g.length,C=Object.keys(D).length,L=r=>{const x=new Set(E);x.has(r)?x.delete(r):x.add(r),W(x)};return N===0?null:e.jsxs("div",{className:`mt-2 mb-3 ${Z}`,children:[e.jsx("div",{className:"mb-4 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm font-medium text-blue-900",children:["✨ You selected ",N," skill",N!==1?"s":""," across ",C," domain",C!==1?"s":""]}),e.jsx("div",{className:"flex items-center space-x-2 text-xs text-blue-700",children:e.jsx("span",{children:"💡 Click domains to expand/collapse"})})]})}),e.jsx("div",{className:"space-y-3",children:Object.entries(D).map(([r,x])=>{const n=E.has(r),d=Object.entries(x.subdomains);return e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>L(r),className:"w-full px-4 py-3 bg-gray-50 hover:bg-gray-100 text-left flex items-center justify-between transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-inset",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`transform transition-transform ${n?"rotate-0":"rotate-90"}`,children:e.jsx("svg",{className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:r}),_&&e.jsxs("div",{className:"text-sm text-gray-500",children:[x.totalSkills," skill",x.totalSkills!==1?"s":""," • ",d.length," subdomain",d.length!==1?"s":""]})]})]}),e.jsx("div",{className:"text-xs text-gray-400",children:n?"Click to expand":"Click to collapse"})]}),!n&&e.jsx("div",{className:"border-t border-gray-200",children:d.map(([i,v])=>e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"font-medium text-gray-700 text-sm",children:["📁 ",i]}),_&&e.jsxs("div",{className:"text-xs text-gray-500",children:[v.skills.length," skill",v.skills.length!==1?"s":""]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:v.skills.map(u=>e.jsxs("div",{className:"group relative inline-flex items-center",children:[e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-indigo-100 text-indigo-800 hover:bg-indigo-200 transition-colors cursor-help",title:`${r} → ${i} → ${u.name}`,children:[e.jsx("span",{className:"mr-1",children:"🔧"}),e.jsx("span",{className:"font-medium",children:u.name}),X&&e.jsxs("button",{type:"button",onClick:w=>{w.stopPropagation(),z==null||z(u.id)},className:"ml-2 flex-shrink-0 rounded-full inline-flex items-center justify-center h-4 w-4 text-indigo-400 hover:bg-indigo-300 hover:text-indigo-600 focus:outline-none focus:bg-indigo-500 focus:text-white transition-colors","aria-label":`Remove ${u.name}`,children:[e.jsx("span",{className:"sr-only",children:"Remove skill"}),e.jsx("svg",{className:"h-2 w-2",stroke:"currentColor",fill:"none",viewBox:"0 0 8 8",children:e.jsx("path",{strokeLinecap:"round",strokeWidth:"1.5",d:"m1 1 6 6m0-6-6 6"})})]})]}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10 whitespace-nowrap hidden md:block",children:[e.jsx("div",{className:"font-medium",children:r}),e.jsxs("div",{className:"text-gray-300",children:["→ ",i]}),e.jsxs("div",{className:"text-gray-300",children:["→ ",u.name]}),u.description&&e.jsx("div",{className:"text-gray-400 text-xs mt-1 max-w-xs truncate",children:u.description}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]},u.id))})]},i))})]},r)})}),e.jsx("div",{className:"mt-3 text-xs text-gray-500 md:hidden",children:"💡 Tap and hold skill badges to see full hierarchy"})]})}$e.propTypes={selectedSkills:h.arrayOf(h.number).isRequired,skillDetails:h.object.isRequired,onRemoveSkill:h.func,showCounts:h.bool,showRemoveButtons:h.bool,className:h.string};$e.defaultProps={selectedSkills:[],skillDetails:{},onRemoveSkill:null,showCounts:!0,showRemoveButtons:!0,className:""};function ze({value:g=[],onChange:j,error:z=null,required:_=!1,label:X="Skills",placeholder:Z="Select skills..."}){const[E,W]=a.useState([]),[D,N]=a.useState([]),[C,L]=a.useState([]),[r,x]=a.useState(""),[n,d]=a.useState(""),[i,v]=a.useState(g||[]),[u,w]=a.useState({domains:!1,subdomains:!1,skills:!1}),[ee,T]=a.useState(!1),[q,re]=a.useState(""),[P,se]=a.useState(""),[K,U]=a.useState(""),[p,$]=a.useState(""),[b,S]=a.useState([]),[te,ae]=a.useState(!1),[R,G]=a.useState(-1),[Q,me]=a.useState(!1),[m,k]=a.useState(1),[ne,I]=a.useState(!1),[he,F]=a.useState({});a.useEffect(()=>{ge();const s=()=>{me(window.innerWidth<768)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),a.useEffect(()=>{g&&g.length>0&&(v(g),fe(g))},[g]),a.useEffect(()=>{if(!p.trim()){S([]);return}const s=setTimeout(()=>{je(p)},300);return()=>clearTimeout(s)},[p]);const ge=async()=>{w(s=>({...s,domains:!0}));try{const s=await B.get("/api/v1/app/skills/domains");W(s.data.data||[])}catch(s){console.error("Error fetching domains:",s)}finally{w(s=>({...s,domains:!1}))}},de=async s=>{if(!s){N([]);return}w(t=>({...t,subdomains:!0}));try{const t=await B.get(`/api/v1/app/skills/domains/${s}/subdomains`);N(t.data.data||[])}catch(t){console.error("Error fetching subdomains:",t),N([])}finally{w(t=>({...t,subdomains:!1}))}},ce=async s=>{if(!s){L([]);return}w(t=>({...t,skills:!0}));try{const t=await B.get(`/api/v1/app/skills/subdomains/${s}/skills`);L(t.data.data||[])}catch(t){console.error("Error fetching skills:",t),L([])}finally{w(t=>({...t,skills:!1}))}},fe=async s=>{if(!s||s.length===0){F({});return}try{const t=await B.post("/api/v1/app/skills/details",{skill_ids:s}),l={};t.data.data.forEach(o=>{l[o.id]=o}),F(l)}catch(t){console.error("Error fetching skill details:",t)}},le=s=>{x(s),d(""),N([]),L([]),se(""),U(""),s&&de(s)},ie=s=>{d(s),L([]),U(""),s&&ce(s)},be=a.useMemo(()=>E.filter(s=>{const t=q.toLowerCase();return s.name.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t)}),[E,q]),pe=a.useMemo(()=>D.filter(s=>{const t=P.toLowerCase();return s.name.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t)}),[D,P]),ye=a.useMemo(()=>C.filter(s=>{const t=K.toLowerCase();return s.name.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t)||s.full_name&&s.full_name.toLowerCase().includes(t)}),[C,K]),Y=be,H=pe,J=ye,oe=s=>{const t=i.includes(s.id);let l;t?l=i.filter(o=>o!==s.id):l=[...i,s.id],v(l),j(l),t||F(o=>({...o,[s.id]:s}))},ve=s=>{const t=i.filter(l=>l!==s);v(t),j(t),F(l=>{const o={...l};return delete o[s],o})},je=async s=>{if(!s.trim()){S([]);return}if(!(s.length<2)){ae(!0);try{const o=((await B.get("/api/v1/app/skills/search",{params:{q:s,limit:20},timeout:5e3})).data.data||[]).sort((c,y)=>{const f=c.name.toLowerCase()===s.toLowerCase(),V=y.name.toLowerCase()===s.toLowerCase();return f&&!V?-1:!f&&V?1:c.name.length-y.name.length});S(o)}catch(t){console.error("Error performing global search:",t),S([]),t.code==="ECONNABORTED"&&console.warn("Search request timed out")}finally{ae(!1)}}},A=s=>{var t,l,o;if(!i.includes(s.id)){const c=[...i,s.id];v(c),j(c),F(y=>({...y,[s.id]:s}))}(l=(t=s.subdomain)==null?void 0:t.domain)!=null&&l.id&&((o=s.subdomain)!=null&&o.id)&&(x(s.subdomain.domain.id),de(s.subdomain.domain.id),setTimeout(()=>{d(s.subdomain.id),ce(s.subdomain.id),Q&&k(3)},100)),$(""),S([]),G(-1),I(!1)},xe=a.useCallback(s=>{if(b.length!==0)switch(s.key){case"ArrowDown":s.preventDefault(),G(t=>t<b.length-1?t+1:0);break;case"ArrowUp":s.preventDefault(),G(t=>t>0?t-1:b.length-1);break;case"Enter":s.preventDefault(),R>=0&&R<b.length&&A(b[R]);break;case"Escape":s.preventDefault(),$(""),S([]),G(-1);break}},[b,R,A]);a.useEffect(()=>{G(-1)},[b]);const Ne=()=>{m===1&&r?k(2):m===2&&n&&k(3)},we=()=>{m>1&&k(m-1)},Se=()=>{T(!1),k(1),I(!1),$(""),S([])},ke=()=>{T(!1),k(1),I(!1),$(""),S([])},Ce=s=>{le(s),k(2)},ue=s=>{ie(s),k(3)},M=a.useMemo(()=>r?n?3:2:1,[r,n]),O=a.useCallback((s,t)=>{if(!t||!s)return s;const l=new RegExp(`(${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return s.split(l).map((c,y)=>l.test(c)?e.jsx("mark",{className:"bg-yellow-200 text-gray-900",children:c},y):c)},[]),Le=a.useCallback((s,t="",l=-1)=>{var c,y,f;const o=l===R;return e.jsxs("button",{type:"button",onClick:()=>A(s),className:`w-full text-left px-3 py-2 focus:outline-none text-sm border-b border-gray-100 last:border-b-0 transition-colors ${o?"bg-indigo-100 border-indigo-300":"hover:bg-indigo-50 focus:bg-indigo-50"}`,"aria-selected":o,role:"option",children:[e.jsx("div",{className:"font-medium text-gray-900",children:O(s.name,t)}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(y=(c=s.subdomain)==null?void 0:c.domain)==null?void 0:y.name," - ",(f=s.subdomain)==null?void 0:f.name]}),s.description&&e.jsx("div",{className:"text-xs text-gray-400 mt-1 line-clamp-2",children:O(s.description,t)}),i.includes(s.id)&&e.jsx("div",{className:"text-xs text-green-600 mt-1 font-medium",children:"✓ Already selected"})]},s.id)},[i,O,A,R]),Re=()=>m===1?e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search domains...",value:q,onChange:s=>re(s.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-base"})}),e.jsx("div",{className:"space-y-2",children:u.domains?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):Y.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No domains found"}):Y.map(s=>e.jsx("button",{type:"button",onClick:()=>Ce(s.id),className:`w-full text-left p-4 min-h-[48px] border rounded-lg transition-colors ${r===s.id?"bg-indigo-50 border-indigo-500 text-indigo-900":"border-gray-200 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:s.name}),r===s.id&&e.jsx("svg",{className:"h-5 w-5 text-indigo-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},s.id))})]}):m===2?e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search subdomains...",value:P,onChange:s=>se(s.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-base"})}),e.jsx("div",{className:"space-y-2",children:u.subdomains?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):H.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No subdomains found"}):H.map(s=>e.jsx("button",{type:"button",onClick:()=>ue(s.id),className:`w-full text-left p-4 min-h-[48px] border rounded-lg transition-colors ${n===s.id?"bg-indigo-50 border-indigo-500 text-indigo-900":"border-gray-200 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:s.name}),n===s.id&&e.jsx("svg",{className:"h-5 w-5 text-indigo-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},s.id))})]}):m===3?e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search skills...",value:K,onChange:s=>U(s.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-base"})}),e.jsx("div",{className:"space-y-2",children:u.skills?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):J.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:C.length===0?"No skills available":"No skills found matching your search"}):J.map(s=>{const t=i.includes(s.id);return e.jsx("button",{type:"button",onClick:()=>oe(s),className:`w-full text-left p-4 min-h-[48px] border rounded-lg transition-colors ${t?"bg-green-50 border-green-500 text-green-900":"border-gray-200 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium",children:s.name}),s.description&&e.jsx("div",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:s.description})]}),t&&e.jsx("svg",{className:"h-5 w-5 text-green-600 ml-3 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},s.id)})})]}):null;return e.jsxs("div",{className:"w-full",children:[e.jsx(Fe,{htmlFor:"skills-selector",value:e.jsxs(e.Fragment,{children:[X," ",_&&e.jsx("span",{className:"text-red-600",children:"*"})]}),required:_}),e.jsx($e,{selectedSkills:i,skillDetails:he,onRemoveSkill:ve,showCounts:!0,showRemoveButtons:!0}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>T(!ee),className:`mt-1 block w-full border border-gray-300 rounded-md shadow-sm bg-white text-left focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${Q?"px-4 py-3 text-base":"px-3 py-2"}`,children:[e.jsx("span",{className:"block truncate text-gray-500",children:Z}),e.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pointer-events-none pr-2",children:e.jsx("svg",{className:`text-gray-400 transition-transform ${ee?"rotate-180":""} ${Q?"h-6 w-6":"h-5 w-5"}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),ee&&(Q?e.jsx("div",{className:"fixed inset-0 z-50 bg-white",children:e.jsxs("div",{className:"h-screen flex flex-col",children:[e.jsxs("div",{className:"border-b border-gray-200 bg-gray-50 px-4 py-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[m>1&&e.jsx("button",{type:"button",onClick:we,className:"p-1 hover:bg-gray-200 rounded","aria-label":"Go back",children:e.jsx("svg",{className:"h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:m===1?"Select Domain":m===2?"Select Subdomain":"Select Skills"})]}),e.jsx("button",{type:"button",onClick:()=>I(!ne),className:"p-2 hover:bg-gray-200 rounded-full","aria-label":"Search",children:e.jsx("svg",{className:"h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex space-x-1 flex-1",children:[1,2,3].map(s=>e.jsx("div",{className:`h-2 flex-1 rounded ${s<=m?"bg-indigo-600":"bg-gray-300"}`},s))}),e.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["Step ",m," of 3"]})]})]}),ne&&e.jsxs("div",{className:"border-b border-gray-200 p-4 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search all skills...",value:p,onChange:s=>$(s.target.value),onKeyDown:xe,className:"w-full px-3 py-3 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-base","aria-label":"Search skills globally"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),te&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-indigo-500 border-t-transparent rounded-full"})})]}),b.length>0&&e.jsx("div",{className:"mt-3 max-h-60 overflow-y-auto border border-gray-200 rounded-lg",children:b.map((s,t)=>{var l,o,c;return e.jsxs("button",{type:"button",onClick:()=>A(s),className:`w-full text-left p-4 border-b border-gray-100 last:border-b-0 transition-colors ${t===R?"bg-indigo-100":"hover:bg-gray-50"}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:O(s.name,p)}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[(o=(l=s.subdomain)==null?void 0:l.domain)==null?void 0:o.name," - ",(c=s.subdomain)==null?void 0:c.name]}),s.description&&e.jsx("div",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:O(s.description,p)}),i.includes(s.id)&&e.jsx("div",{className:"text-sm text-green-600 mt-1 font-medium",children:"✓ Already selected"})]},s.id)})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:Re()}),e.jsx("div",{className:"border-t border-gray-200 bg-white p-4 flex-shrink-0",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:Se,className:"flex-1 px-4 py-3 text-base font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),m<3?e.jsx("button",{type:"button",onClick:Ne,disabled:m===1?!r:!n,className:"flex-1 px-4 py-3 text-base font-medium text-white bg-indigo-600 border border-transparent rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"}):e.jsxs("button",{type:"button",onClick:ke,className:"flex-1 px-4 py-3 text-base font-medium text-white bg-indigo-600 border border-transparent rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:["Done (",i.length,")"]})]})})]})}):e.jsxs("div",{className:"absolute z-20 mt-1 w-full bg-white shadow-xl border border-gray-200 rounded-lg overflow-hidden",style:{minWidth:"600px"},children:[e.jsxs("div",{className:"border-b border-gray-200 bg-gray-50 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Select Skills"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${M>=1?"bg-indigo-600":"bg-gray-300"}`}),e.jsx("div",{className:`w-2 h-2 rounded-full ${M>=2?"bg-indigo-600":"bg-gray-300"}`}),e.jsx("div",{className:`w-2 h-2 rounded-full ${M>=3?"bg-indigo-600":"bg-gray-300"}`})]})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["Step ",M," of 3: ",M===1?"Select Domain":M===2?"Select Subdomain":"Select Skills"]})]}),e.jsxs("div",{className:"border-b border-gray-200 p-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search all skills globally...",value:p,onChange:s=>$(s.target.value),onKeyDown:xe,className:"w-full px-3 py-2 pl-10 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm","aria-label":"Search skills globally","aria-describedby":"global-search-help"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),te&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-indigo-500 border-t-transparent rounded-full"})})]}),b.length>0&&e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md",role:"listbox","aria-label":"Search results",children:b.map((s,t)=>Le(s,p,t))}),p.trim()&&e.jsx("div",{id:"global-search-help",className:"mt-1 text-xs text-gray-500",children:"Use ↑↓ to navigate, Enter to select, Esc to clear"}),p.trim()&&!te&&b.length===0&&e.jsxs("div",{className:"mt-2 p-3 text-sm text-gray-500 text-center border border-gray-200 rounded-md",children:['No skills found for "',p,'"']})]}),e.jsxs("div",{className:"flex",style:{height:"300px"},children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-200 flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-gray-200 bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Domains"}),e.jsx("input",{type:"text",placeholder:"Search domains...",value:q,onChange:s=>re(s.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:u.domains?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Loading..."}):Y.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"No domains found"}):Y.map(s=>e.jsx("button",{type:"button",onClick:()=>le(s.id),className:`w-full text-left px-3 py-3 hover:bg-gray-50 focus:outline-none border-b border-gray-100 text-sm ${r===s.id?"bg-indigo-50 border-l-4 border-l-indigo-500 text-indigo-900 font-medium":"text-gray-700"}`,children:s.name},s.id))})]}),e.jsxs("div",{className:"w-1/3 border-r border-gray-200 flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-gray-200 bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Subdomains"}),r&&e.jsx("input",{type:"text",placeholder:"Search subdomains...",value:P,onChange:s=>se(s.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:r?u.subdomains?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Loading..."}):H.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"No subdomains found"}):H.map(s=>e.jsx("button",{type:"button",onClick:()=>ie(s.id),className:`w-full text-left px-3 py-3 hover:bg-gray-50 focus:outline-none border-b border-gray-100 text-sm ${n===s.id?"bg-indigo-50 border-l-4 border-l-indigo-500 text-indigo-900 font-medium":"text-gray-700"}`,children:s.name},s.id)):e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Select a domain first"})})]}),e.jsxs("div",{className:"w-1/3 flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-gray-200 bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Skills"}),n&&e.jsx("input",{type:"text",placeholder:"Search skills...",value:K,onChange:s=>U(s.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:n?u.skills?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Loading..."}):J.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:C.length===0?"No skills available":"No skills found matching your search"}):J.map(s=>{const t=i.includes(s.id);return e.jsx("button",{type:"button",onClick:()=>oe(s),className:`w-full text-left px-3 py-3 hover:bg-gray-50 focus:outline-none border-b border-gray-100 text-sm transition-colors ${t?"bg-green-50 border-l-4 border-l-green-500":"text-gray-700"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`font-medium ${t?"text-green-900":"text-gray-900"}`,children:s.name}),s.description&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:s.description})]}),t&&e.jsx("div",{className:"ml-2 flex-shrink-0",children:e.jsx("svg",{className:"h-4 w-4 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})},s.id)}):e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Select a subdomain first"})})]})]}),e.jsx("div",{className:"border-t border-gray-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[i.length," skill",i.length!==1?"s":""," selected"]}),e.jsx("button",{type:"button",onClick:()=>T(!1),className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Done"})]})})]}))]}),e.jsx(Be,{className:"mt-2",message:z})]})}ze.propTypes={value:h.arrayOf(h.number),onChange:h.func.isRequired,error:h.string,required:h.bool,label:h.string,placeholder:h.string};ze.defaultProps={value:[],error:null,required:!1,label:"Skills",placeholder:"Select skills..."};function Me({selectedResearchAreas:g=[],researchAreaDetails:j={},onRemoveResearchArea:z,showCounts:_=!0,showRemoveButtons:X=!0,className:Z=""}){const[E,W]=a.useState(new Set);a.useState(new Set),a.useEffect(()=>{if(g.length>0&&Object.keys(j).length>0){const r=new Set;g.forEach(x=>{var d,i;const n=j[x];(i=(d=n==null?void 0:n.area)==null?void 0:d.field)!=null&&i.name&&r.add(n.area.field.name)}),W(r)}},[g,j]);const D=a.useMemo(()=>{const r={};return g.forEach(x=>{const n=j[x];if(!n||!n.area||!n.area.field)return;n.area.field.id;const d=n.area.field.name;n.area.id;const i=n.area.name;r[d]||(r[d]={field:n.area.field,areas:{},totalCount:0}),r[d].areas[i]||(r[d].areas[i]={area:n.area,niches:[]}),r[d].areas[i].niches.push({id:x,name:n.name,description:n.description}),r[d].totalCount++}),r},[g,j]),N=g.length,C=Object.keys(D).length,L=r=>{const x=new Set(E);x.has(r)?x.delete(r):x.add(r),W(x)};return N===0?null:e.jsxs("div",{className:`mt-2 mb-3 ${Z}`,children:[e.jsx("div",{className:"mb-4 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm font-medium text-blue-900",children:["✨ You selected ",N," research area",N!==1?"s":""," across ",C," field",C!==1?"s":""]}),e.jsx("div",{className:"flex items-center space-x-2 text-xs text-blue-700",children:e.jsx("span",{children:"💡 Click fields to expand/collapse"})})]})}),e.jsx("div",{className:"space-y-3",children:Object.entries(D).map(([r,x])=>{const n=E.has(r),d=Object.entries(x.areas);return e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>L(r),className:"w-full px-4 py-3 bg-gray-50 hover:bg-gray-100 text-left flex items-center justify-between transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-inset",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`transform transition-transform ${n?"rotate-0":"rotate-90"}`,children:e.jsx("svg",{className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:r}),_&&e.jsxs("div",{className:"text-sm text-gray-500",children:[x.totalCount," research area",x.totalCount!==1?"s":""," • ",d.length," area",d.length!==1?"s":""]})]})]}),e.jsx("div",{className:"text-xs text-gray-400",children:n?"Click to expand":"Click to collapse"})]}),!n&&e.jsx("div",{className:"border-t border-gray-200",children:d.map(([i,v])=>e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"font-medium text-gray-700 text-sm",children:["📁 ",i]}),_&&e.jsxs("div",{className:"text-xs text-gray-500",children:[v.niches.length," niche",v.niches.length!==1?"s":""]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:v.niches.map(u=>e.jsxs("div",{className:"group relative inline-flex items-center",children:[e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-indigo-100 text-indigo-800 hover:bg-indigo-200 transition-colors cursor-help",title:`${r} → ${i} → ${u.name}`,children:[e.jsx("span",{className:"mr-1",children:"🔬"}),e.jsx("span",{className:"font-medium",children:u.name}),X&&e.jsxs("button",{type:"button",onClick:w=>{w.stopPropagation(),z==null||z(u.id)},className:"ml-2 flex-shrink-0 rounded-full inline-flex items-center justify-center h-4 w-4 text-indigo-400 hover:bg-indigo-300 hover:text-indigo-600 focus:outline-none focus:bg-indigo-500 focus:text-white transition-colors","aria-label":`Remove ${u.name}`,children:[e.jsx("span",{className:"sr-only",children:"Remove research area"}),e.jsx("svg",{className:"h-2 w-2",stroke:"currentColor",fill:"none",viewBox:"0 0 8 8",children:e.jsx("path",{strokeLinecap:"round",strokeWidth:"1.5",d:"m1 1 6 6m0-6-6 6"})})]})]}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10 whitespace-nowrap hidden md:block",children:[e.jsx("div",{className:"font-medium",children:r}),e.jsxs("div",{className:"text-gray-300",children:["→ ",i]}),e.jsxs("div",{className:"text-gray-300",children:["→ ",u.name]}),u.description&&e.jsx("div",{className:"text-gray-400 text-xs mt-1 max-w-xs truncate",children:u.description}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]},u.id))})]},i))})]},r)})}),e.jsx("div",{className:"mt-3 text-xs text-gray-500 md:hidden",children:"💡 Tap and hold research area badges to see full hierarchy"})]})}Me.propTypes={selectedResearchAreas:h.arrayOf(h.string).isRequired,researchAreaDetails:h.object.isRequired,onRemoveResearchArea:h.func,showCounts:h.bool,showRemoveButtons:h.bool,className:h.string};Me.defaultProps={selectedResearchAreas:[],researchAreaDetails:{},onRemoveResearchArea:null,showCounts:!0,showRemoveButtons:!0,className:""};function _e({value:g=[],onChange:j,error:z=null,required:_=!1,label:X="Research Areas",placeholder:Z="Select research areas..."}){const[E,W]=a.useState([]),[D,N]=a.useState([]),[C,L]=a.useState([]),[r,x]=a.useState(""),[n,d]=a.useState(""),[i,v]=a.useState(g||[]),[u,w]=a.useState({fields:!1,areas:!1,niches:!1}),[ee,T]=a.useState(!1),[q,re]=a.useState(""),[P,se]=a.useState(""),[K,U]=a.useState(""),[p,$]=a.useState(""),[b,S]=a.useState([]),[te,ae]=a.useState(!1),[R,G]=a.useState(-1),[Q,me]=a.useState(!1),[m,k]=a.useState(1),[ne,I]=a.useState(!1),[he,F]=a.useState({});a.useEffect(()=>{ge();const s=()=>{me(window.innerWidth<768)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),a.useEffect(()=>{g&&g.length>0?(v(g),fe(g)):(v([]),F({}))},[g]),a.useEffect(()=>{if(!p.trim()){S([]);return}const s=setTimeout(()=>{je(p)},300);return()=>clearTimeout(s)},[p]);const ge=async()=>{w(s=>({...s,fields:!0}));try{const s=await B.get("/api/v1/app/fields-of-research");W(s.data.data||[])}catch{}finally{w(s=>({...s,fields:!1}))}},de=async s=>{if(!s){N([]);return}w(t=>({...t,areas:!0}));try{const t="/api/v1/app/research-areas",l={field_of_research_id:s},o=await B.get(t,{params:l});N(o.data.data||[])}catch{N([])}finally{w(t=>({...t,areas:!1}))}},ce=async s=>{if(!s){L([]);return}w(t=>({...t,niches:!0}));try{const t="/api/v1/app/niche-domains",l={research_area_id:s},o=await B.get(t,{params:l});L(o.data.data||[])}catch{L([])}finally{w(t=>({...t,niches:!1}))}},fe=async s=>{if(!s||s.length===0){F({});return}try{const t={};for(const l of s){const o=l.split("-");if(o.length===3){const[c,y,f]=o;try{const[V,Ee,De]=await Promise.all([B.get(`/api/v1/app/fields-of-research/${c}`),B.get(`/api/v1/app/research-areas/${y}`),B.get(`/api/v1/app/niche-domains/${f}`)]);t[l]={id:l,name:De.data.data.name,description:De.data.data.description||"",area:{id:Ee.data.data.id,name:Ee.data.data.name,field:{id:V.data.data.id,name:V.data.data.name}}}}catch{t[l]={id:l,name:`Research Area ${l}`,description:"",area:{id:y,name:"Unknown Area",field:{id:c,name:"Unknown Field"}}}}}}F(t)}catch{}},le=s=>{x(s),d(""),N([]),L([]),se(""),U(""),s&&de(s)},ie=s=>{d(s),L([]),U(""),s&&ce(s)},be=a.useMemo(()=>E.filter(s=>{const t=q.toLowerCase();return s.name.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t)}),[E,q]),pe=a.useMemo(()=>D.filter(s=>{const t=P.toLowerCase();return s.name.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t)}),[D,P]),ye=a.useMemo(()=>C.filter(s=>{const t=K.toLowerCase();return s.name.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t)}),[C,K]),Y=be,H=pe,J=ye,oe=s=>{const t=`${r}-${n}-${s.id}`,l=i.includes(t);let o;if(l?o=i.filter(c=>c!==t):o=[...i,t],v(o),j(o),!l){const c=E.find(f=>f.id==r),y=D.find(f=>f.id==n);F(f=>({...f,[t]:{id:t,name:s.name,description:s.description||"",area:{id:y.id,name:y.name,field:{id:c.id,name:c.name}}}}))}},ve=s=>{const t=i.filter(l=>l!==s);v(t),j(t),F(l=>{const o={...l};return delete o[s],o})},je=async s=>{if(!s.trim()){S([]);return}if(!(s.length<2)){ae(!0);try{const t="/api/v1/app/niche-domains",l={search:s,per_page:15,with_area:!0},y=((await B.get(t,{params:l})).data.data||[]).filter(f=>!!f.research_area).map(f=>({id:`${f.research_area.field_of_research_id}-${f.research_area_id}-${f.id}`,name:f.name,description:f.description,area:{id:f.research_area_id,name:f.research_area.name,field:{id:f.research_area.field_of_research_id,name:"Field"}}})).slice(0,20);S(y)}catch{S([])}finally{ae(!1)}}},A=s=>{if(!i.includes(s.id)){const t=[...i,s.id];v(t),j(t),F(l=>({...l,[s.id]:s}))}$(""),S([]),G(-1),I(!1)},xe=()=>{m===1&&r?k(2):m===2&&n&&k(3)},Ne=()=>{m>1&&k(m-1)},we=()=>{T(!1),k(1),I(!1),$(""),S([])},Se=()=>{T(!1),k(1),I(!1),$(""),S([])},ke=s=>{le(s),k(2)},Ce=s=>{ie(s),k(3)},ue=a.useCallback(s=>{if(b.length!==0)switch(s.key){case"ArrowDown":s.preventDefault(),G(t=>t<b.length-1?t+1:0);break;case"ArrowUp":s.preventDefault(),G(t=>t>0?t-1:b.length-1);break;case"Enter":s.preventDefault(),R>=0&&R<b.length&&A(b[R]);break;case"Escape":s.preventDefault(),$(""),S([]),G(-1);break}},[b,R,A]);a.useEffect(()=>{G(-1)},[b]);const M=a.useMemo(()=>r?n?3:2:1,[r,n]),O=a.useCallback((s,t)=>{if(!t||!s)return s;const l=new RegExp(`(${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return s.split(l).map((c,y)=>l.test(c)?e.jsx("mark",{className:"bg-yellow-200 text-gray-900",children:c},y):c)},[]),Le=a.useCallback((s,t="",l=-1)=>{var c,y,f;const o=l===R;return e.jsxs("button",{type:"button",onClick:()=>A(s),className:`w-full text-left px-3 py-2 focus:outline-none text-sm border-b border-gray-100 last:border-b-0 transition-colors ${o?"bg-indigo-100 border-indigo-300":"hover:bg-indigo-50 focus:bg-indigo-50"}`,"aria-selected":o,role:"option",children:[e.jsx("div",{className:"font-medium text-gray-900",children:O(s.name,t)}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(y=(c=s.area)==null?void 0:c.field)==null?void 0:y.name," - ",(f=s.area)==null?void 0:f.name]}),s.description&&e.jsx("div",{className:"text-xs text-gray-400 mt-1 line-clamp-2",children:O(s.description,t)}),i.includes(s.id)&&e.jsx("div",{className:"text-xs text-green-600 mt-1 font-medium",children:"✓ Already selected"})]},s.id)},[i,O,A,R]),Re=()=>m===1?e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search fields...",value:q,onChange:s=>re(s.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-base"})}),e.jsx("div",{className:"space-y-2",children:u.fields?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):Y.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No fields found"}):Y.map(s=>e.jsx("button",{type:"button",onClick:()=>ke(s.id),className:`w-full text-left p-4 min-h-[48px] border rounded-lg transition-colors ${r===s.id?"bg-indigo-50 border-indigo-500 text-indigo-900":"border-gray-200 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:s.name}),r===s.id&&e.jsx("svg",{className:"h-5 w-5 text-indigo-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},s.id))})]}):m===2?e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search areas...",value:P,onChange:s=>se(s.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-base"})}),e.jsx("div",{className:"space-y-2",children:u.areas?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):H.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No areas found"}):H.map(s=>e.jsx("button",{type:"button",onClick:()=>Ce(s.id),className:`w-full text-left p-4 min-h-[48px] border rounded-lg transition-colors ${n===s.id?"bg-indigo-50 border-indigo-500 text-indigo-900":"border-gray-200 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:s.name}),n===s.id&&e.jsx("svg",{className:"h-5 w-5 text-indigo-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},s.id))})]}):m===3?e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search niches...",value:K,onChange:s=>U(s.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-base"})}),e.jsx("div",{className:"space-y-2",children:u.niches?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):J.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:C.length===0?"No niches available":"No niches found matching your search"}):J.map(s=>{const t=`${r}-${n}-${s.id}`,l=i.includes(t);return e.jsx("button",{type:"button",onClick:()=>oe(s),className:`w-full text-left p-4 min-h-[48px] border rounded-lg transition-colors ${l?"bg-green-50 border-green-500 text-green-900":"border-gray-200 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium",children:s.name}),s.description&&e.jsx("div",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:s.description})]}),l&&e.jsx("svg",{className:"h-5 w-5 text-green-600 ml-3 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},s.id)})})]}):null;return e.jsxs("div",{className:"w-full",children:[e.jsx(Fe,{htmlFor:"research-area-selector",value:e.jsxs(e.Fragment,{children:[X," ",_&&e.jsx("span",{className:"text-red-600",children:"*"})]}),required:_}),e.jsx(Me,{selectedResearchAreas:i,researchAreaDetails:he,onRemoveResearchArea:ve,showCounts:!0,showRemoveButtons:!0}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>T(!ee),className:`mt-1 block w-full border border-gray-300 rounded-md shadow-sm bg-white text-left focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 ${Q?"px-4 py-3 text-base":"px-3 py-2"}`,children:[e.jsx("span",{className:"block truncate text-gray-500",children:Z}),e.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pointer-events-none pr-2",children:e.jsx("svg",{className:`text-gray-400 transition-transform ${ee?"rotate-180":""} ${Q?"h-6 w-6":"h-5 w-5"}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),ee&&(Q?e.jsx("div",{className:"fixed inset-0 z-50 bg-white",children:e.jsxs("div",{className:"h-screen flex flex-col",children:[e.jsxs("div",{className:"border-b border-gray-200 bg-gray-50 px-4 py-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[m>1&&e.jsx("button",{type:"button",onClick:Ne,className:"p-1 hover:bg-gray-200 rounded","aria-label":"Go back",children:e.jsx("svg",{className:"h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:m===1?"Select Field":m===2?"Select Area":"Select Niches"})]}),e.jsx("button",{type:"button",onClick:()=>I(!ne),className:"p-2 hover:bg-gray-200 rounded-full","aria-label":"Search",children:e.jsx("svg",{className:"h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex space-x-1 flex-1",children:[1,2,3].map(s=>e.jsx("div",{className:`h-2 flex-1 rounded ${s<=m?"bg-indigo-600":"bg-gray-300"}`},s))}),e.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["Step ",m," of 3"]})]})]}),ne&&e.jsxs("div",{className:"border-b border-gray-200 p-4 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search all research areas...",value:p,onChange:s=>$(s.target.value),onKeyDown:ue,className:"w-full px-3 py-3 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-base","aria-label":"Search research areas globally"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),te&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-indigo-500 border-t-transparent rounded-full"})})]}),b.length>0&&e.jsx("div",{className:"mt-3 max-h-60 overflow-y-auto border border-gray-200 rounded-lg",children:b.map((s,t)=>{var l,o,c;return e.jsxs("button",{type:"button",onClick:()=>A(s),className:`w-full text-left p-4 border-b border-gray-100 last:border-b-0 transition-colors ${t===R?"bg-indigo-100":"hover:bg-gray-50"}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:O(s.name,p)}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[(o=(l=s.area)==null?void 0:l.field)==null?void 0:o.name," - ",(c=s.area)==null?void 0:c.name]}),s.description&&e.jsx("div",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:O(s.description,p)}),i.includes(s.id)&&e.jsx("div",{className:"text-sm text-green-600 mt-1 font-medium",children:"✓ Already selected"})]},s.id)})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:Re()}),e.jsx("div",{className:"border-t border-gray-200 bg-white p-4 flex-shrink-0",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:we,className:"flex-1 px-4 py-3 text-base font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),m<3?e.jsx("button",{type:"button",onClick:xe,disabled:m===1?!r:!n,className:"flex-1 px-4 py-3 text-base font-medium text-white bg-indigo-600 border border-transparent rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"}):e.jsxs("button",{type:"button",onClick:Se,className:"flex-1 px-4 py-3 text-base font-medium text-white bg-indigo-600 border border-transparent rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:["Done (",i.length,")"]})]})})]})}):e.jsxs("div",{className:"absolute z-20 mt-1 w-full bg-white shadow-xl border border-gray-200 rounded-lg overflow-hidden",style:{minWidth:"600px"},children:[e.jsxs("div",{className:"border-b border-gray-200 bg-gray-50 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Select Research Areas"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${M>=1?"bg-indigo-600":"bg-gray-300"}`}),e.jsx("div",{className:`w-2 h-2 rounded-full ${M>=2?"bg-indigo-600":"bg-gray-300"}`}),e.jsx("div",{className:`w-2 h-2 rounded-full ${M>=3?"bg-indigo-600":"bg-gray-300"}`})]})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["Step ",M," of 3: ",M===1?"Select Field":M===2?"Select Area":"Select Niches"]})]}),e.jsxs("div",{className:"border-b border-gray-200 p-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search all research areas globally...",value:p,onChange:s=>$(s.target.value),onKeyDown:ue,className:"w-full px-3 py-2 pl-10 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm","aria-label":"Search research areas globally","aria-describedby":"global-search-help"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),te&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-indigo-500 border-t-transparent rounded-full"})})]}),b.length>0&&e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md",role:"listbox","aria-label":"Search results",children:b.map((s,t)=>Le(s,p,t))}),p.trim()&&e.jsx("div",{id:"global-search-help",className:"mt-1 text-xs text-gray-500",children:"Use ↑↓ to navigate, Enter to select, Esc to clear"}),p.trim()&&!te&&b.length===0&&e.jsxs("div",{className:"mt-2 p-3 text-sm text-gray-500 text-center border border-gray-200 rounded-md",children:['No research areas found for "',p,'"']})]}),e.jsxs("div",{className:"flex",style:{height:"300px"},children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-200 flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-gray-200 bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Fields"}),e.jsx("input",{type:"text",placeholder:"Search fields...",value:q,onChange:s=>re(s.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:u.fields?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Loading..."}):Y.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"No fields found"}):Y.map(s=>e.jsx("button",{type:"button",onClick:()=>le(s.id),className:`w-full text-left px-3 py-3 hover:bg-gray-50 focus:outline-none border-b border-gray-100 text-sm ${r===s.id?"bg-indigo-50 border-l-4 border-l-indigo-500 text-indigo-900 font-medium":"text-gray-700"}`,children:s.name},s.id))})]}),e.jsxs("div",{className:"w-1/3 border-r border-gray-200 flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-gray-200 bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Areas"}),r&&e.jsx("input",{type:"text",placeholder:"Search areas...",value:P,onChange:s=>se(s.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:r?u.areas?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Loading..."}):H.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"No areas found"}):H.map(s=>e.jsx("button",{type:"button",onClick:()=>ie(s.id),className:`w-full text-left px-3 py-3 hover:bg-gray-50 focus:outline-none border-b border-gray-100 text-sm ${n===s.id?"bg-indigo-50 border-l-4 border-l-indigo-500 text-indigo-900 font-medium":"text-gray-700"}`,children:s.name},s.id)):e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Select a field first"})})]}),e.jsxs("div",{className:"w-1/3 flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-gray-200 bg-gray-50",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Niches"}),n&&e.jsx("input",{type:"text",placeholder:"Search niches...",value:K,onChange:s=>U(s.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-indigo-500"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:n?u.niches?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Loading..."}):J.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:C.length===0?"No niches available":"No niches found matching your search"}):J.map(s=>{const t=`${r}-${n}-${s.id}`,l=i.includes(t);return e.jsx("button",{type:"button",onClick:()=>oe(s),className:`w-full text-left px-3 py-3 hover:bg-gray-50 focus:outline-none border-b border-gray-100 text-sm ${l?"bg-green-50 border-l-4 border-l-green-500 text-green-900 font-medium":"text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium",children:s.name}),s.description&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:s.description})]}),l&&e.jsx("svg",{className:"h-4 w-4 text-green-600 ml-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},s.id)}):e.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Select an area first"})})]})]}),e.jsx("div",{className:"border-t border-gray-200 bg-white p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[i.length," research area",i.length!==1?"s":""," selected"]}),e.jsx("button",{type:"button",onClick:()=>T(!1),className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Done"})]})})]}))]}),e.jsx(Be,{className:"mt-2",message:z})]})}_e.propTypes={value:h.arrayOf(h.string),onChange:h.func.isRequired,error:h.string,required:h.bool,label:h.string,placeholder:h.string};_e.defaultProps={value:[],error:null,required:!1,label:"Research Areas",placeholder:"Select research areas..."};export{_e as R,ze as S};
