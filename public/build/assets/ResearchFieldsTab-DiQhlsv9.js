import{r as o,a as k,j as s,y as M}from"./app-CxJcie6X.js";import{V as n}from"./index-Be4FYkdk.js";import ne from"./FieldOfResearchFormModal-C8UXU3UA.js";import ie from"./ResearchAreaFormModal-B5N9YDr0.js";import ce from"./NicheDomainFormModal-DgBpVh4D.js";import E from"./ConfirmationModal-CKHyCCxH.js";import{b as _,h as $,m as R,n as P}from"./index-Bo4JNGWa.js";import"./iconBase-Dgfn16JF.js";function ge(){const[O,H]=o.useState([]),[T,L]=o.useState([]),[I,Q]=o.useState([]),[j,f]=o.useState({fields:!0,areas:!1,domains:!1}),[t,V]=o.useState(null),[l,y]=o.useState(null),[c,q]=o.useState({fields:"",areas:"",domains:""}),[x,r]=o.useState({fieldForm:!1,areaForm:!1,domainForm:!1,fieldDelete:!1,areaDelete:!1,domainDelete:!1}),[u,v]=o.useState(null),[h,N]=o.useState(null),[p,F]=o.useState(null),[D,b]=o.useState({field:"create",area:"create",domain:"create"});o.useEffect(()=>{w()},[c.fields]),o.useEffect(()=>{t?S():(L([]),y(null))},[t,c.areas]),o.useEffect(()=>{l?C():Q([])},[l,c.domains]);const w=async()=>{f(e=>({...e,fields:!0}));try{const e=await k.get("/api/v1/app/fields-of-research",{params:{per_page:100,search:c.fields||void 0}});H(e.data.data)}catch(e){console.error("Error fetching fields of research:",e),n.error("Failed to load fields of research")}finally{f(e=>({...e,fields:!1}))}},S=async()=>{if(t){f(e=>({...e,areas:!0}));try{const e=await k.get("/api/v1/app/research-areas",{params:{field_of_research_id:t.id,per_page:100,search:c.areas||void 0}});L(e.data.data)}catch(e){console.error("Error fetching research areas:",e),n.error("Failed to load research areas")}finally{f(e=>({...e,areas:!1}))}}},C=async()=>{if(l){f(e=>({...e,domains:!0}));try{const e=await k.get("/api/v1/app/niche-domains",{params:{research_area_id:l.id,per_page:100,search:c.domains||void 0}});Q(e.data.data)}catch(e){console.error("Error fetching niche domains:",e),n.error("Failed to load niche domains")}finally{f(e=>({...e,domains:!1}))}}},z=e=>{V(e),y(null)},B=e=>{y(e)},A=(e,a)=>{q(i=>({...i,[e]:a}))},G=()=>{v(null),b(e=>({...e,field:"create"})),r(e=>({...e,fieldForm:!0}))},J=e=>{v(e),b(a=>({...a,field:"edit"})),r(a=>({...a,fieldForm:!0}))},K=e=>{v(e),r(a=>({...a,fieldDelete:!0}))},U=()=>{r(e=>({...e,fieldForm:!1})),w()},W=()=>{u&&M.delete(`/admin/data-management/fields-of-research/${u.id}`,{preserveScroll:!0,onSuccess:e=>{var a,i,d,m;(i=(a=e.props)==null?void 0:a.flash)!=null&&i.success&&n.success(e.props.flash.success),(m=(d=e.props)==null?void 0:d.flash)!=null&&m.error&&n.error(e.props.flash.error),r(g=>({...g,fieldDelete:!1})),t&&t.id===u.id&&V(null),w()},onError:e=>{n.error("A client-side error occurred. Please try again."),console.error(e)}})},X=()=>{N(null),b(e=>({...e,area:"create"})),r(e=>({...e,areaForm:!0}))},Y=e=>{N(e),b(a=>({...a,area:"edit"})),r(a=>({...a,areaForm:!0}))},Z=e=>{N(e),r(a=>({...a,areaDelete:!0}))},ee=()=>{r(e=>({...e,areaForm:!1})),S()},se=()=>{h&&M.delete(`/admin/data-management/research-areas/${h.id}`,{preserveScroll:!0,onSuccess:e=>{var a,i,d,m;(i=(a=e.props)==null?void 0:a.flash)!=null&&i.success&&n.success(e.props.flash.success),(m=(d=e.props)==null?void 0:d.flash)!=null&&m.error&&n.error(e.props.flash.error),r(g=>({...g,areaDelete:!1})),l&&l.id===h.id&&y(null),S()},onError:e=>{n.error("A client-side error occurred. Please try again."),console.error(e)}})},ae=()=>{F(null),b(e=>({...e,domain:"create"})),r(e=>({...e,domainForm:!0}))},re=e=>{F(e),b(a=>({...a,domain:"edit"})),r(a=>({...a,domainForm:!0}))},te=e=>{F(e),r(a=>({...a,domainDelete:!0}))},le=()=>{r(e=>({...e,domainForm:!1})),C()},oe=()=>{p&&M.delete(`/admin/data-management/niche-domains/${p.id}`,{preserveScroll:!0,onSuccess:e=>{var a,i,d,m;(i=(a=e.props)==null?void 0:a.flash)!=null&&i.success&&n.success(e.props.flash.success),(m=(d=e.props)==null?void 0:d.flash)!=null&&m.error&&n.error(e.props.flash.error),r(g=>({...g,domainDelete:!1})),C()},onError:e=>{n.error("A client-side error occurred. Please try again."),console.error(e)}})};return s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Research Fields Hierarchy"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Fields of Research"}),s.jsxs("button",{onClick:G,className:"inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",children:[s.jsx(_,{className:"mr-1"})," Add"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx($,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:c.fields,onChange:e=>A("fields",e.target.value),placeholder:"Search fields...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:j.fields?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):O.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No fields found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:O.map(e=>s.jsxs("li",{className:`py-3 px-2 cursor-pointer hover:bg-gray-50 ${t&&t.id===e.id?"bg-blue-50":""}`,onClick:()=>z(e),children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:a=>{a.stopPropagation(),J(e)},className:"text-blue-600 hover:text-blue-900",children:s.jsx(R,{})}),s.jsx("button",{onClick:a=>{a.stopPropagation(),K(e)},className:"text-red-600 hover:text-red-900",children:s.jsx(P,{})})]})]}),s.jsxs("span",{className:"block text-xs text-gray-500",children:[e.research_areas_count||0," research areas"]})]},e.id))})})]}),s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Research Areas"}),s.jsxs("button",{onClick:()=>{t&&X()},disabled:!t,className:`inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest ${t?"hover:bg-blue-700 active:bg-blue-900":"opacity-50 cursor-not-allowed"} focus:outline-none focus:border-blue-900 focus:ring ring-blue-300`,children:[s.jsx(_,{className:"mr-1"})," Add Area"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx($,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:c.areas,onChange:e=>A("areas",e.target.value),placeholder:"Search areas...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",disabled:!t})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:t?j.areas?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):T.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No research areas found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:T.map(e=>s.jsxs("li",{className:`py-3 px-2 cursor-pointer hover:bg-gray-50 ${l&&l.id===e.id?"bg-blue-50":""}`,onClick:()=>B(e),children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:a=>{a.stopPropagation(),Y(e)},className:"text-blue-600 hover:text-blue-900",children:s.jsx(R,{})}),s.jsx("button",{onClick:a=>{a.stopPropagation(),Z(e)},className:"text-red-600 hover:text-red-900",children:s.jsx(P,{})})]})]}),s.jsxs("span",{className:"block text-xs text-gray-500",children:[e.niche_domains_count||0," niche domains"]})]},e.id))}):s.jsx("p",{className:"text-center py-4 text-gray-500",children:"Select a field to view research areas"})})]}),s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Niche Domains"}),s.jsxs("button",{onClick:()=>{l&&ae()},disabled:!l,className:`inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest ${l?"hover:bg-blue-700 active:bg-blue-900":"opacity-50 cursor-not-allowed"} focus:outline-none focus:border-blue-900 focus:ring ring-blue-300`,children:[s.jsx(_,{className:"mr-1"})," Add Domain"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx($,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:c.domains,onChange:e=>A("domains",e.target.value),placeholder:"Search domains...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",disabled:!l})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:l?j.domains?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):I.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No niche domains found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:I.map(e=>s.jsx("li",{className:"py-3 px-2 hover:bg-gray-50",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>re(e),className:"text-blue-600 hover:text-blue-900",children:s.jsx(R,{})}),s.jsx("button",{onClick:()=>te(e),className:"text-red-600 hover:text-red-900",children:s.jsx(P,{})})]})]})},e.id))}):s.jsx("p",{className:"text-center py-4 text-gray-500",children:"Select a research area to view niche domains"})})]})]}),s.jsx(ne,{isOpen:x.fieldForm,onClose:U,field:u,mode:D.field}),s.jsx(ie,{isOpen:x.areaForm,onClose:ee,area:h,fieldId:t?t.id:null,mode:D.area}),s.jsx(ce,{isOpen:x.domainForm,onClose:le,domain:p,areaId:l?l.id:null,mode:D.domain}),s.jsx(E,{isOpen:x.fieldDelete,title:"Delete Field of Research",message:`Are you sure you want to delete "${u==null?void 0:u.name}"? This action cannot be undone.`,onConfirm:W,onCancel:()=>r(e=>({...e,fieldDelete:!1}))}),s.jsx(E,{isOpen:x.areaDelete,title:"Delete Research Area",message:`Are you sure you want to delete "${h==null?void 0:h.name}"? This action cannot be undone.`,onConfirm:se,onCancel:()=>r(e=>({...e,areaDelete:!1}))}),s.jsx(E,{isOpen:x.domainDelete,title:"Delete Niche Domain",message:`Are you sure you want to delete "${p==null?void 0:p.name}"? This action cannot be undone.`,onConfirm:oe,onCancel:()=>r(e=>({...e,domainDelete:!1}))})]})}export{ge as default};
