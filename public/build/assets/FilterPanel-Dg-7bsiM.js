import{r as v,j as e}from"./app-6KcAPae7.js";import{S as g}from"./react-select.esm-Caq7p8aY.js";import{f as R,F as A,g as F}from"./index-Ce5Il87X.js";import"./index-JAD3o4sP.js";import"./floating-ui.dom-D5EC_49c.js";import"./iconBase-n0Q-2a7D.js";function B({searchType:i,searchResults:o,universities:E,faculties:P,researchOptions:S,skills:y,selectedArea:x,setSelectedArea:j,selectedUniversity:f,setSelectedUniversity:N,selectedAvailability:h,setSelectedAvailability:w,selectedSkills:b,setSelectedSkills:_,isOpen:c=!1,onClose:l}){const p=v.useRef(null);if(v.useEffect(()=>{function s(t){p.current&&!p.current.contains(t.target)&&c&&l&&l()}return c&&(document.addEventListener("mousedown",s),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",s),document.body.style.overflow="unset"}},[c,l]),v.useEffect(()=>{function s(t){t.key==="Escape"&&c&&l&&l()}return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[c,l]),!c)return null;const d=(()=>{if(!o||!o.matches)return{researchAreas:[],universities:[],skills:[]};const s=new Set,t=new Set;o.matches.forEach(r=>{const a=r.academician||r.student||{},n=i==="supervisor"||i==="collaborators"&&r.result_type==="academician"?a.research_expertise:a.student_type==="postgraduate"?a.field_of_research:a.research_preference;Array.isArray(n)&&n.forEach(u=>{s.add(u)}),Array.isArray(a.skills)&&a.skills.forEach(u=>{u&&u.id&&t.add(u.id)})});const m=(Array.isArray(y)?y:[]).filter(r=>t.has(r.id)).map(r=>{let a=r.name;return r.subdomain&&r.subdomain.domain?a=`${r.subdomain.domain.name} - ${r.subdomain.name} - ${r.name}`:r.full_name?a=r.full_name:a=r.name,{value:r.id,label:a}}),$=Array.from(s).map(r=>{const a=S.find(n=>`${n.field_of_research_id}-${n.research_area_id}-${n.niche_domain_id}`===r);return a?{value:r,label:`${a.field_of_research_name} - ${a.research_area_name} - ${a.niche_domain_name}`}:{value:r,label:`${r}`}}),k=new Set;o.matches.forEach(r=>{const a=r.academician||r.student||{};a.university&&k.add(a.university.toString())});const L=Array.from(k).map(r=>{const a=E.find(n=>n.id.toString()===r);return{value:r,label:a?a.short_name:"Unknown University"}});return{researchAreas:$,universities:L,skills:m}})(),C=()=>{if(i==="supervisor")return"Available for Supervision";if(i==="students")return"Looking for Supervision";if(i==="collaborators"){const s=o?.matches?.some(m=>m.result_type==="academician"),t=o?.matches?.some(m=>m.result_type!=="academician");return s&&!t?"Available for Collaboration":!s&&t?"Looking for Supervision":"Availability"}return"Availability"};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-50 animate-fadeIn",onClick:l,"aria-hidden":"true"}),e.jsxs("div",{ref:p,className:`fixed top-0 right-0 h-full w-full sm:w-[420px] md:w-[480px] lg:w-[520px] 
                   bg-white shadow-2xl z-50 animate-slideInRight flex flex-col
                   safe-area-inset-right`,role:"dialog","aria-modal":"true","aria-labelledby":"filter-modal-title",children:[e.jsx("div",{className:"relative bg-gradient-to-r from-blue-600 to-purple-600 px-4 sm:px-6 py-4 sm:py-5 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h2",{id:"filter-modal-title",className:"text-xl sm:text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(R,{className:"text-lg sm:text-xl flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Filters"})]}),e.jsx("p",{className:"text-blue-100 text-xs sm:text-sm mt-1 truncate",children:"Refine your search results"})]}),e.jsx("button",{onClick:l,className:`p-2 sm:p-2.5 rounded-lg bg-white/20 hover:bg-white/30 active:bg-white/40 
                       text-white transition-all duration-200 hover:scale-110 active:scale-95 
                       flex-shrink-0 touch-manipulation`,"aria-label":"Close filters",children:e.jsx(A,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 sm:py-6 space-y-5 sm:space-y-6",children:[(x.length>0||f.length>0||b?.length>0||h)&&e.jsxs("div",{className:`bg-blue-50 border border-blue-200 rounded-xl px-3 sm:px-4 py-2.5 sm:py-3 
                          flex items-center gap-2 shadow-sm`,children:[e.jsx(F,{className:"text-blue-600 flex-shrink-0"}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium text-blue-900",children:[x.length+f.length+(b?.length||0)+(h?1:0)," filter(s) active"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-900",children:"Research Area"}),e.jsx(g,{isMulti:!0,name:"researchAreas",options:d.researchAreas,value:d.researchAreas.filter(s=>x.includes(s.value)),onChange:s=>j(s?s.map(t=>t.value):[]),placeholder:"Select research areas...",className:"basic-multi-select",classNamePrefix:"select",isSearchable:!0,styles:{control:s=>({...s,borderRadius:"0.75rem",borderColor:"#e5e7eb","&:hover":{borderColor:"#3b82f6"}})}})]}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-900",children:"University"}),e.jsx(g,{isMulti:!0,name:"universities",options:d.universities,value:d.universities.filter(s=>f.includes(s.value)),onChange:s=>N(s?s.map(t=>t.value):[]),placeholder:"Select universities...",className:"basic-multi-select",classNamePrefix:"select",isSearchable:!0,styles:{control:s=>({...s,borderRadius:"0.75rem",borderColor:"#e5e7eb","&:hover":{borderColor:"#3b82f6"}})}})]}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})})}),(i==="students"||i==="collaborators")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-900",children:"Skills"}),e.jsx(g,{isMulti:!0,name:"skills",options:d.skills,value:d.skills.filter(s=>b?.includes(s.value)),onChange:s=>_(s?s.map(t=>t.value):[]),placeholder:"Select skills...",className:"basic-multi-select",classNamePrefix:"select",isSearchable:!0,styles:{control:s=>({...s,borderRadius:"0.75rem",borderColor:"#e5e7eb","&:hover":{borderColor:"#3b82f6"}})}})]}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})})})]}),i!=="collaborators"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-900",children:C()}),e.jsxs("select",{className:`mt-1 block w-full px-4 py-3 text-base border-gray-300 
                            focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 
                            rounded-xl shadow-sm transition-all duration-200 bg-white hover:border-blue-400`,value:h,onChange:s=>w(s.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"1",children:"Yes"}),e.jsx("option",{value:"0",children:"No"})]})]}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})})})]})]}),e.jsxs("div",{className:`border-t border-gray-200 px-4 sm:px-6 py-3 sm:py-4 bg-gray-50 space-y-2.5 sm:space-y-3 
                      shadow-lg sm:shadow-xl`,children:[e.jsxs("button",{className:`w-full px-4 sm:px-5 py-3 sm:py-3.5 
                     bg-white border-2 border-gray-300 hover:border-gray-400 active:border-gray-500
                     rounded-xl text-xs sm:text-sm font-semibold text-gray-700 
                     transition-all duration-200 hover:shadow-md active:scale-98
                     flex items-center justify-center gap-2 
                     touch-manipulation`,onClick:()=>{j([]),N([]),w(""),_([])},children:[e.jsx(A,{className:"text-gray-500 flex-shrink-0"}),e.jsx("span",{children:"Reset All Filters"})]}),e.jsxs("button",{className:`w-full px-4 sm:px-5 py-3 sm:py-3.5 
                     bg-gradient-to-r from-blue-600 to-purple-600 
                     hover:from-blue-700 hover:to-purple-700
                     active:from-blue-800 active:to-purple-800
                     rounded-xl text-xs sm:text-sm font-semibold text-white 
                     transition-all duration-200 hover:shadow-lg active:scale-98
                     flex items-center justify-center gap-2
                     touch-manipulation`,onClick:l,children:[e.jsx(F,{className:"flex-shrink-0"}),e.jsx("span",{children:"Apply Filters"})]})]})]})]})}export{B as default};
