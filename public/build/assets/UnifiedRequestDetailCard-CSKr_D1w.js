import{q as fe,r as o,a as O,j as e}from"./app-Doi1BfNX.js";import{c as S}from"./index-dbiIR3J5.js";import{T as je,a as ve,b as A,c as k}from"./tabs-BgtJ-Aqh.js";import{B as m}from"./button-KPEq8PdI.js";import{B as Ne}from"./badge-Be2D36dO.js";import{A as ue,a as ge}from"./avatar-D-ohjjtQ.js";import"./separator-C2wGlHlc.js";import{S as D}from"./scroll-area-Du06xGgY.js";import{T as H}from"./textarea-B9-sF3_G.js";import"./tooltip-CJCiABJO.js";import{T as we,a as ye}from"./ThreadPane-B5BIAZi7.js";import _e from"./AcceptSupervisorOfferModal-BnXkbeDb.js";import Ae from"./AcceptSupervisionRequestModal-DVOKaibd.js";import ke from"./DeclineSupervisionRequestModal-DBvfCr7_.js";import Se from"./ScheduleMeetingDialog-Bg9sEkOz.js";import{l as E}from"./logError-D4ezqrCx.js";import{O as Ce,S as Te}from"./modalAnimations-CCENKliM.js";import{g as Me,f as ce,a as De,h as Oe}from"./supervisionHelpers-EJT0WNFw.js";import{A as Ee}from"./index-CvKzrQIm.js";import{m as U}from"./proxy-BUFhk0Wh.js";import{X as q}from"./x-DrXySrr5.js";import{C as ee}from"./circle-check-CXM40yk7.js";import{M as Pe}from"./message-square-THXDma7t.js";import{C as se}from"./calendar-CBO9yeE8.js";import{V as ae}from"./video-CabzSFea.js";import{U as Ie}from"./user-round-B_eanpyP.js";import{B as Fe}from"./briefcase-Cs22VvWr.js";import{M as te}from"./mail-7f1JiwhA.js";import{P as le}from"./phone-CDfQ_U-X.js";import{G as ze}from"./globe-CO-0Byd6.js";import{G as B}from"./graduation-cap-BiSIS5Fh.js";import{L as P}from"./loader-circle-D1uCPtBJ.js";import{F as re}from"./file-text-CjHuEEW2.js";import{S as ie}from"./sticky-note-DvxZmfS-.js";import{T as Le}from"./trash-2-DurOfiw5.js";import{f as V}from"./format-Dv9Rm441.js";import"./index-B_QUZuO0.js";import"./index-FRhtyj0h.js";import"./index-BGtqCWya.js";import"./index-Ct-Jk4RI.js";import"./index-Be4Hbpsc.js";import"./index-BdR5mO0l.js";import"./index-CkAoBwhz.js";import"./index-Bb94jkfk.js";import"./utils-D-KgF5mV.js";import"./index-CGrAONsN.js";import"./index-BdQq_4o_.js";import"./index-CZA6k5rr.js";import"./index-BkPy3AN8.js";import"./floating-ui.dom-eiE65J5j.js";import"./index-CJzlUPP7.js";import"./index-BvLvCl4J.js";import"./Modal-BjJ_nX2Q.js";import"./dialog-DYcl7DcC.js";import"./transition-Dk-vnbkR.js";import"./download-Xk6ccwe6.js";import"./createLucideIcon-BIWf6Fgr.js";import"./isSameDay-Dm-A-V7S.js";import"./en-US-DNUEYIb-.js";import"./label-BYlrvoGV.js";import"./checkbox-BrU7e3lW.js";import"./index-B-eZM3ov.js";import"./check-C48ewYru.js";import"./alert-DlfG3K4y.js";import"./circle-alert-DIrS-PEp.js";import"./select-Cp2fArvv.js";import"./index-CU8Rt2qH.js";import"./tslib.es6-CmEaCU22.js";import"./chevron-down-CmfXf0xW.js";import"./chevron-up-CiTpBnra.js";import"./lightbulb-BlRd1Itp.js";import"./input-yCRxI6tt.js";import"./supervisionConstants-BuM5-H5X.js";import"./circle-x-CHFI4rOT.js";import"./users-CJk5icQ6.js";import"./building-2-DoFw0cmv.js";import"./search-FGZFllxI.js";import"./useGoogleCalendar-BXh9FXme.js";import"./external-link-DYFIg7ks.js";function ba({request:s,onClose:a,onUpdated:t,userRole:l}){var Y,Z,Q;const{auth:c}=fe().props,[f,h]=o.useState("overview"),[p,r]=o.useState(!1),[N,u]=o.useState(!1),[I,v]=o.useState(!1),[C,g]=o.useState(!1),[w,T]=o.useState([]),[y,d]=o.useState(""),[x,M]=o.useState(!1),[G,W]=o.useState(null),[ne,$]=o.useState(null),de=15*1024*1024,F=s!=null&&s.relationship&&s.relationship.id?s.relationship:null;o.useEffect(()=>{l==="supervisor"&&(s!=null&&s.id)&&oe()},[l,s==null?void 0:s.id]);const oe=async()=>{if(s!=null&&s.id)try{const i=await O.get(route("supervision.requests.notes.index",s.id));T(i.data.data||[])}catch(i){E(i,"UnifiedRequestDetailCard loadNotes")}},me=async()=>{if(!(!y.trim()||x)){M(!0);try{const i=await O.post(route("supervision.requests.notes.store",s.id),{note:y.trim()});T([i.data.data,...w]),d(""),S.success("Note added")}catch(i){E(i,"UnifiedRequestDetailCard handleAddNote"),S.error("Failed to add note")}finally{M(!1)}}},xe=async i=>{if(!G){W(i);try{await O.delete(route("supervision.requests.notes.destroy",{request:s.id,note:i})),T(w.filter(j=>j.id!==i)),S.success("Note deleted")}catch(j){E(j,"UnifiedRequestDetailCard handleDeleteNote"),S.error("Failed to delete note")}finally{W(null)}}},J=i=>{Oe(i,$,de)};if(!s)return null;const _=l==="student"?(s==null?void 0:s.academician)??{}:(s==null?void 0:s.student)??{},z=_.full_name??(l==="student"?"Supervisor":"Student"),he=l==="student"?_.current_position??"":null,R=_.profile_picture?`/storage/${_.profile_picture}`:null,X=l==="student"?((Y=_.university)==null?void 0:Y.name)??"":null,n=s.status??"pending",K=s==null?void 0:s.conversation_id,L=n==="pending"||n==="pending_student_acceptance",pe=Me(z),be=ce(n);return e.jsxs(e.Fragment,{children:[e.jsx(Ee,{children:e.jsx(U.div,{...Ce,className:"fixed inset-0 z-40 flex items-center justify-end bg-black/50",onClick:a,children:e.jsxs(U.div,{...Te,className:"w-full max-w-3xl h-full bg-white shadow-xl overflow-hidden flex flex-col",onClick:i=>i.stopPropagation(),children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx(ue,{className:"h-12 w-12",children:R?e.jsx("img",{src:R,alt:z,className:"h-full w-full object-cover"}):e.jsx(ge,{className:"bg-indigo-100 text-indigo-700 text-sm font-semibold",children:pe})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:z}),l==="student"?X&&e.jsx("span",{className:"text-sm text-slate-600",children:X}):e.jsx("p",{className:"text-sm text-slate-600",children:"Student"}),e.jsx("div",{className:"mt-2 flex items-center gap-3 flex-wrap",children:e.jsx(Ne,{className:`${De(n)} border`,children:be})})]})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(q,{className:"h-5 w-5 text-slate-500"})})]})}),e.jsx("div",{className:"px-6 py-4 border-b bg-slate-50",children:l==="student"?e.jsxs(e.Fragment,{children:[n==="pending_student_acceptance"&&e.jsx("div",{className:"mb-3",children:e.jsxs(m,{onClick:()=>r(!0),className:"w-full bg-emerald-600 hover:bg-emerald-700",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Accept Supervisor Offer"]})}),L&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{variant:"outline",className:"flex-1",onClick:()=>h("chat"),children:[e.jsx(Pe,{className:"mr-2 h-4 w-4"}),"Chat"]}),e.jsxs(m,{variant:"outline",className:"flex-1",disabled:!0,title:"Only supervisors can schedule meetings",children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Schedule"]}),e.jsxs(m,{className:"flex-1 bg-slate-900 hover:bg-slate-800",disabled:!(s!=null&&s.meetings)||s.meetings.length===0||!((Z=s.meetings[0])!=null&&Z.location_link),onClick:()=>{var j;const i=(j=s==null?void 0:s.meetings)==null?void 0:j[0];i!=null&&i.location_link&&window.open(i.location_link,"_blank","noopener,noreferrer")},children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Join Meeting"]})]}),!L&&n!=="pending_student_acceptance"&&e.jsxs("div",{className:"text-sm text-slate-600 text-center py-2",children:[n==="pending"&&"Waiting for supervisor response...",n==="accepted"&&"This request has been accepted",n==="rejected"&&"This request was not accepted",(n==="cancelled"||n==="auto_cancelled")&&"This request has been cancelled"]})]}):e.jsxs(e.Fragment,{children:[n==="pending"&&e.jsxs("div",{className:"flex gap-3 mb-3",children:[e.jsxs(m,{onClick:()=>u(!0),className:"flex-1 bg-emerald-600 hover:bg-emerald-700",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Accept Request"]}),e.jsxs(m,{variant:"outline",onClick:()=>v(!0),className:"flex-1 border-red-300 text-red-700 hover:bg-red-50",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Decline Request"]})]}),(n==="pending"||n==="pending_student_acceptance")&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{variant:"outline",onClick:()=>g(!0),className:"flex-1",children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Schedule Meeting"]}),e.jsxs(m,{className:"flex-1 bg-slate-900 hover:bg-slate-800",disabled:!(s!=null&&s.meetings)||s.meetings.length===0||!((Q=s.meetings[0])!=null&&Q.location_link),onClick:()=>{var j;const i=(j=s==null?void 0:s.meetings)==null?void 0:j[0];i!=null&&i.location_link&&window.open(i.location_link,"_blank","noopener,noreferrer")},children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Join Meeting"]})]}),n==="pending_student_acceptance"&&e.jsx("div",{className:"mt-3 text-sm text-blue-700 bg-blue-50 border border-blue-200 rounded p-3 text-center",children:"Waiting for student to accept your offer"}),n==="accepted"&&e.jsx("div",{className:"text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded p-3 text-center",children:"✓ Request accepted - Supervision relationship is active"}),n==="rejected"&&e.jsx("div",{className:"text-sm text-slate-600 text-center py-2",children:"This request was declined"}),(n==="cancelled"||n==="auto_cancelled")&&e.jsx("div",{className:"text-sm text-slate-600 text-center py-2",children:"This request was cancelled by the student"})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(je,{value:f,onValueChange:h,className:"h-full flex flex-col",children:[e.jsxs(ve,{className:"px-6 bg-gray-100 w-full justify-start rounded-none h-auto p-0 gap-0",children:[e.jsx(A,{value:"overview",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Overview"}),e.jsx(A,{value:"proposal",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Proposal"}),e.jsx(A,{value:"documents",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Documents"}),e.jsx(A,{value:"chat",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Chat"}),l==="supervisor"&&e.jsx(A,{value:"notes",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Notes"}),e.jsx(A,{value:"history",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"History"})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx(k,{value:"overview",className:"mt-0 h-full",children:e.jsx(D,{className:"h-full",children:e.jsx(Be,{request:s,person:_,userRole:l,currentPosition:he})})}),e.jsx(k,{value:"proposal",className:"mt-0 h-full",children:e.jsx(D,{className:"h-full",children:e.jsx(He,{request:s,onAttachmentClick:J,userRole:l})})}),e.jsx(k,{value:"documents",className:"mt-0 h-full",children:e.jsx(D,{className:"h-full",children:e.jsx(Ve,{request:s,onAttachmentClick:J})})}),e.jsx(k,{value:"chat",className:"mt-0 h-full",children:K?e.jsx("div",{className:"p-6 h-full",children:e.jsx("div",{className:"border border-slate-200 rounded-lg bg-white shadow-sm h-full overflow-hidden",children:e.jsx(we,{conversationId:K,auth:c,onConversationRead:()=>{},onConversationIncrementUnread:()=>{},onAfterSend:()=>t==null?void 0:t()})})}):e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:e.jsx("p",{className:"text-sm text-slate-500",children:"No conversation available yet."})})})}),l==="supervisor"&&e.jsx(k,{value:"notes",className:"mt-0 h-full",children:e.jsx(D,{className:"h-full",children:e.jsx(Ge,{notesList:w,newNote:y,setNewNote:d,isAddingNote:x,isDeletingNoteId:G,onAddNote:me,onDeleteNote:xe,isReadOnly:!L})})}),e.jsx(k,{value:"history",className:"mt-0 h-full",children:e.jsx(D,{className:"h-full",children:e.jsx(We,{request:s})})})]})]})})]})})}),e.jsx(ye,{file:ne,onClose:()=>$(null)}),l==="student"&&e.jsx(_e,{request:s,isOpen:p,onClose:()=>r(!1),onAccepted:()=>{r(!1),t==null||t(),a==null||a()}}),l==="supervisor"&&e.jsxs(e.Fragment,{children:[e.jsx(Ae,{request:s,isOpen:N,onClose:()=>u(!1),onAccepted:()=>{u(!1),t==null||t()}}),e.jsx(ke,{request:s,isOpen:I,onClose:()=>v(!1),onDeclined:()=>{v(!1),t==null||t(),a==null||a()}}),e.jsx(Se,{request:C&&!F?s:null,relationship:C&&F?F:null,onClose:()=>g(!1),onScheduled:()=>{g(!1),t==null||t()},userRole:"supervisor"})]})]})}function Be({request:s,person:a,userRole:t,currentPosition:l}){var f;const c=s!=null&&s.submitted_at?V(new Date(s.submitted_at),"dd/MM/yyyy HH:mm"):"—";return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:t==="student"?"Supervisor Profile":"Student Profile"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(b,{icon:Ie,label:"Full Name",value:a.full_name||"—"}),t==="student"?e.jsxs(e.Fragment,{children:[l&&e.jsx(b,{icon:Fe,label:"Position",value:l}),e.jsx(b,{icon:te,label:"Email",value:a.email||"—"}),e.jsx(b,{icon:le,label:"Phone",value:a.phone_number||"—"})]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{icon:te,label:"Email",value:a.email||((f=a.user)==null?void 0:f.email)||"—"}),e.jsx(b,{icon:le,label:"Phone",value:a.phone_number||"—"}),e.jsx(b,{icon:ze,label:"Nationality",value:a.nationality||"—"})]})]}),t==="student"&&(a.university||a.faculty||a.department)&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("h4",{className:"text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4 text-slate-500"}),"Institution"]}),e.jsxs("div",{className:"space-y-2",children:[a.university&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-slate-700",children:"University: "}),e.jsx("span",{className:"text-slate-600",children:a.university.name||a.university.full_name||"—"})]}),a.faculty&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-slate-700",children:"Faculty: "}),e.jsx("span",{className:"text-slate-600",children:a.faculty.name||"—"})]}),a.department&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-slate-700",children:"Department: "}),e.jsx("span",{className:"text-slate-600",children:a.department})]})]})]}),t==="student"&&a.research_areas&&Array.isArray(a.research_areas)&&a.research_areas.length>0&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Research Expertise"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.research_areas.slice(0,3).map((h,p)=>e.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full bg-indigo-50 text-indigo-700 border border-indigo-200",children:h},p)),a.research_areas.length>3&&e.jsxs("span",{className:"px-2.5 py-1 text-xs rounded-full bg-slate-100 text-slate-600",children:["+",a.research_areas.length-3," more"]})]})]}),t==="student"&&a.bio&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Bio"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed line-clamp-3 break-words max-w-full",children:a.bio})]}),t==="supervisor"&&a.university_details&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx(b,{icon:B,label:"University",value:a.university_details.full_name||"—"}),a.faculty&&e.jsx(b,{icon:B,label:"Faculty",value:a.faculty.name||"—"})]})]})]}),e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Request Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Proposal Title"}),e.jsx("div",{className:"text-sm text-slate-700 font-medium break-words max-w-full",children:s.proposal_title||"—"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(b,{label:"Submitted",value:c}),e.jsx(b,{label:"Status",value:ce(s.status)})]})]})]})]})}function He({request:s,onAttachmentClick:a,userRole:t}){var y;const l=(s==null?void 0:s.attachments)??[],[c,f]=o.useState(null),[h,p]=o.useState(!1),[r,N]=o.useState(""),[u,I]=o.useState(!0),[v,C]=o.useState(!1);o.useEffect(()=>{g()},[s.id]);const g=async()=>{var d;try{const x=await O.get(route("supervision.requests.abstract.show",s.id));f(x.data.data),N(((d=x.data.data)==null?void 0:d.abstract)||"")}catch(x){E(x,"ProposalTab loadAbstract")}finally{I(!1)}},w=async()=>{var d,x;C(!0);try{await O.put(route("supervision.requests.abstract.update",s.id),{abstract:r}),S.success("Abstract saved successfully"),p(!1),await g()}catch(M){E(M,"ProposalTab handleSaveAbstract"),S.error(((x=(d=M.response)==null?void 0:d.data)==null?void 0:x.message)||"Failed to save abstract")}finally{C(!1)}},T=()=>{p(!h),h||N((c==null?void 0:c.abstract)||"")};return e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm w-[720px]",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Research Proposal"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Title"}),e.jsx("p",{className:"text-base text-slate-900 break-words max-w-full",children:s.proposal_title??"Untitled"})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide",children:"Abstract"}),t==="student"&&s.status==="pending"&&!u&&e.jsx(m,{size:"sm",variant:"outline",onClick:T,children:h?"Cancel":"Edit"})]}),u?e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(P,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm",children:"Loading abstract..."})]}):(c==null?void 0:c.extraction_status)==="failed"?e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-yellow-800 mb-2",children:"Could not extract abstract automatically. Please enter it manually."}),c.extraction_error&&e.jsx("p",{className:"text-xs text-yellow-600 mb-3",children:c.extraction_error}),t==="student"&&s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{value:r,onChange:d=>N(d.target.value),placeholder:"Enter your abstract here (minimum 50 characters)...",rows:6,className:"mb-2"}),e.jsxs(m,{onClick:w,disabled:v||r.length<50,size:"sm",children:[v&&e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Abstract"]})]})]}):h?e.jsxs("div",{children:[e.jsx(H,{value:r,onChange:d=>N(d.target.value),rows:8,className:"mb-2",placeholder:"Enter your abstract here (minimum 50 characters)..."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{onClick:w,disabled:v||r.length<50,size:"sm",children:[v&&e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),"Save"]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>p(!1),children:"Cancel"})]}),r.length<50&&r.length>0&&e.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:["Abstract must be at least 50 characters (",r.length,"/50)"]})]}):e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed whitespace-pre-line break-words",children:((y=c==null?void 0:c.abstract)==null?void 0:y.trim())||"No abstract available"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Motivation"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed whitespace-pre-wrap break-words max-w-full overflow-hidden",children:s.motivation??"No motivation provided."})]}),s.research_area&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Research Area"}),e.jsx("p",{className:"text-sm text-slate-600 break-words max-w-full",children:s.research_area})]}),s.proposal_summary&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Summary"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed whitespace-pre-wrap break-words max-w-full overflow-hidden",children:s.proposal_summary})]}),s.methodology&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Methodology"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed whitespace-pre-wrap break-words max-w-full overflow-hidden",children:s.methodology})]}),s.expected_outcomes&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-2",children:"Expected Outcomes"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed whitespace-pre-wrap break-words max-w-full overflow-hidden",children:s.expected_outcomes})]}),l.length>0&&e.jsxs("div",{className:"pt-4 border-t border-slate-100",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-3",children:"Attachments"}),e.jsx("div",{className:"space-y-2",children:l.map(d=>{var x;return e.jsxs("div",{className:"flex items-center justify-between p-3 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"p-2 bg-indigo-50 rounded-md",children:e.jsx(re,{className:"h-5 w-5 text-indigo-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 truncate",children:d.original_name||"Attachment"}),e.jsx("p",{className:"text-xs text-slate-500 capitalize",children:((x=d.type)==null?void 0:x.replace("_"," "))||"Document"})]})]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>a(d),children:"View File"})]},d.id)})})]})]})]})})}function Ve({request:s,onAttachmentClick:a}){const t=(s==null?void 0:s.attachments)||[],l=t.length>0;return e.jsx("div",{className:"p-6",children:e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:["Attached Documents (",t.length,")"]}),l?e.jsx("div",{className:"space-y-2",children:t.map((c,f)=>e.jsxs("button",{onClick:()=>a(c),className:"w-full flex items-center gap-3 p-3 rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors text-left",children:[e.jsx(re,{className:"h-5 w-5 text-slate-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900 truncate",children:c.original_name||"Attachment"}),e.jsx("div",{className:"text-xs text-slate-500",children:c.size_formatted||`${(c.size/1024).toFixed(1)} KB`})]})]},c.id||f))}):e.jsx("div",{className:"text-sm text-slate-500 text-center py-8",children:"No documents attached"})]})})}function Ge({notesList:s,newNote:a,setNewNote:t,isAddingNote:l,isDeletingNoteId:c,onAddNote:f,onDeleteNote:h,isReadOnly:p=!1}){return e.jsxs("div",{className:"p-6 space-y-6",children:[!p&&e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ie,{className:"h-5 w-5 text-indigo-600"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Add Private Note"})]}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"These notes are private and only visible to you. Students cannot see them."}),e.jsx(H,{rows:4,value:a,onChange:r=>t(r.target.value),placeholder:"Write your note here...",className:"mb-3"}),e.jsxs(m,{onClick:f,disabled:!a.trim()||l,children:[l&&e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),"Add Note"]})]}),e.jsxs("section",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900",children:["All Notes (",s.length,")"]}),s.length===0?e.jsxs("div",{className:"border border-slate-200 rounded-lg p-6 bg-slate-50 text-center",children:[e.jsx(ie,{className:"h-8 w-8 text-slate-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-slate-500",children:p?"No notes for this request.":"No notes yet. Add your first note above."})]}):e.jsx("div",{className:"space-y-3",children:s.map(r=>e.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"text-xs text-slate-500",children:r.created_at?V(new Date(r.created_at),"dd/MM/yyyy HH:mm"):"Just now"})}),!p&&e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>h(r.id),disabled:c===r.id,className:"h-8 w-8 p-0 hover:bg-red-50 hover:text-red-600",children:c===r.id?e.jsx(P,{className:"h-4 w-4 animate-spin"}):e.jsx(Le,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-sm text-slate-700 whitespace-pre-wrap leading-relaxed break-words max-w-full overflow-hidden",children:r.note})]},r.id))})]})]})}function We({request:s}){const a=[];if(s!=null&&s.submitted_at&&a.push({id:1,title:"Request Submitted",date:s.submitted_at,status:"completed"}),s!=null&&s.decision_at){const t=s.status==="accepted"||s.status==="pending_student_acceptance";a.push({id:2,title:t?"Offer Extended":"Request Declined",date:s.decision_at,status:"completed"})}return(s==null?void 0:s.status)==="accepted"&&(s!=null&&s.decision_at)&&a.push({id:3,title:"Offer Accepted by Student",date:s.updated_at,status:"completed"}),e.jsx("div",{className:"p-6",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Timeline"}),a.length===0?e.jsx("div",{className:"text-sm text-slate-500 text-center py-8",children:"No timeline events yet"}):e.jsx("div",{className:"space-y-4",children:a.map((t,l)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t.status==="completed"?"bg-green-500":"bg-slate-300"}`}),l<a.length-1&&e.jsx("div",{className:"w-0.5 h-full bg-slate-200 mt-2"})]}),e.jsxs("div",{className:"flex-1 pb-8",children:[e.jsx("h4",{className:"font-medium text-slate-900",children:t.title}),e.jsx("p",{className:"text-sm text-slate-500",children:t.date?V(new Date(t.date),"dd/MM/yyyy HH:mm"):"TBD"})]})]},t.id))})]})})}function b({icon:s,label:a,value:t}){return e.jsxs("div",{className:"flex items-start gap-2",children:[s&&e.jsx(s,{className:"mt-0.5 h-4 w-4 text-slate-400 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:a}),e.jsx("div",{className:"text-sm text-slate-700 break-words max-w-full",children:t||"—"})]})]})}export{ba as default};
