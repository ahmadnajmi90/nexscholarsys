import{j as e,a as g,q as N,r as h,Y as v}from"./app-H2P91pfC.js";import{A as w}from"./ApplicationLogo-wUWMeTdA.js";import{D as d}from"./Dropdown--PlPZnns.js";import{R as k}from"./quill.snow-B6OGvosE.js";import"./transition-B0ij4f3f.js";function L({active:l=!1,className:o="",children:i,...r}){return e.jsx(g,{...r,className:"inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium leading-5 transition duration-150 ease-in-out focus:outline-none "+(l?"border-indigo-400 text-gray-900 focus:border-indigo-700":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 focus:border-gray-300 focus:text-gray-700")+o,children:i})}function u({active:l=!1,className:o="",children:i,...r}){return e.jsx(g,{...r,className:`flex w-full items-start border-l-4 py-2 pe-4 ps-3 ${l?"border-indigo-400 bg-indigo-50 text-indigo-700 focus:border-indigo-700 focus:bg-indigo-100 focus:text-indigo-800":"border-transparent text-gray-600 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-800 focus:border-gray-300 focus:bg-gray-50 focus:text-gray-800"} text-base font-medium transition duration-150 ease-in-out focus:outline-none ${o}`,children:i})}function C({header:l,children:o}){const i=N().props.auth.user,[r,m]=h.useState(!1);return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsxs("nav",{className:"border-b border-gray-100 bg-white",children:[e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex h-16 justify-between",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex shrink-0 items-center",children:e.jsx(g,{href:"/",children:e.jsx(w,{className:"block h-9 w-auto fill-current text-gray-800"})})}),e.jsx("div",{className:"hidden space-x-8 sm:-my-px sm:ms-10 sm:flex",children:e.jsx(L,{href:route("dashboard"),active:route().current("dashboard"),children:"Dashboard"})})]}),e.jsx("div",{className:"hidden sm:ms-6 sm:flex sm:items-center",children:e.jsx("div",{className:"relative ms-3",children:e.jsxs(d,{children:[e.jsx(d.Trigger,{children:e.jsx("span",{className:"inline-flex rounded-md",children:e.jsxs("button",{type:"button",className:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none",children:[i.name,e.jsx("svg",{className:"-me-0.5 ms-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})}),e.jsxs(d.Content,{children:[e.jsx(d.Link,{href:route("profile.edit"),children:"Profile"}),e.jsx(d.Link,{href:route("logout"),method:"post",as:"button",children:"Log Out"})]})]})})}),e.jsx("div",{className:"-me-2 flex items-center sm:hidden",children:e.jsx("button",{onClick:()=>m(x=>!x),className:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 transition duration-150 ease-in-out hover:bg-gray-100 hover:text-gray-500 focus:bg-gray-100 focus:text-gray-500 focus:outline-none",children:e.jsxs("svg",{className:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("path",{className:r?"hidden":"inline-flex",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"}),e.jsx("path",{className:r?"inline-flex":"hidden",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})]})})})]})}),e.jsxs("div",{className:(r?"block":"hidden")+" sm:hidden",children:[e.jsx("div",{className:"space-y-1 pb-3 pt-2",children:e.jsx(u,{href:route("dashboard"),active:route().current("dashboard"),children:"Dashboard"})}),e.jsxs("div",{className:"border-t border-gray-200 pb-1 pt-4",children:[e.jsxs("div",{className:"px-4",children:[e.jsx("div",{className:"text-base font-medium text-gray-800",children:i.name}),e.jsx("div",{className:"text-sm font-medium text-gray-500",children:i.email})]}),e.jsxs("div",{className:"mt-3 space-y-1",children:[e.jsx(u,{href:route("profile.edit"),children:"Profile"}),e.jsx(u,{method:"post",href:route("logout"),as:"button",children:"Log Out"})]})]})]})]}),l&&e.jsx("header",{className:"bg-white shadow",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:l})}),e.jsx("main",{children:o})]})}const S=({isOpen:l})=>l?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Sending Email..."}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Please wait while your email is being sent."})]})}):null;function $({auth:l,to:o,replyTo:i}){const[r,m]=h.useState([]),[x,p]=h.useState(!1),[c,f]=h.useState({to:o,subject:"",message:""}),b=async n=>{n.preventDefault(),p(!0);const s=new FormData;s.append("to",c.to),s.append("subject",c.subject),s.append("message",c.message),r.length>0&&(console.log("Number of attachments:",r.length),r.forEach((t,a)=>{console.log(`Attaching file ${a+1}:`,{name:t.name,size:t.size,type:t.type}),s.append(`attachments[${a}]`,t)})),console.log("FormData entries:");for(let[t,a]of s.entries())a instanceof File?console.log(`${t}: File: ${a.name} (${a.size} bytes)`):console.log(`${t}: ${a}`);try{const a=await(await fetch("/email/send",{method:"POST",body:s,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"},credentials:"same-origin"})).json();if(a.success)console.log("Email sent successfully:",a),window.alert(a.message||"Email sent successfully!"),console.log("Alert shown, navigating back..."),window.history.back();else throw new Error(a.message||"Failed to send email")}catch(t){console.error("Error sending email:",t),window.alert(t.message||"Failed to send email. Please try again.")}finally{p(!1)}},j=n=>{const s=Array.from(n.target.files);console.log("Files selected:",s.map(t=>({name:t.name,size:t.size,type:t.type}))),m(t=>[...t,...s])},y=n=>{m(s=>s.filter((t,a)=>a!==n))};return e.jsxs(C,{user:l.user,children:[e.jsx(v,{title:"Compose Email"}),e.jsx(S,{isOpen:x}),e.jsx("div",{className:"max-w-7xl mx-auto p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Compose Message"}),e.jsx("hr",{className:"my-4 border-gray-200"}),e.jsx("form",{onSubmit:b,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center py-2",children:[e.jsx("label",{className:"w-20 text-gray-600",children:"To:"}),e.jsx("input",{type:"email",value:c.to,readOnly:!0,className:"flex-1 outline-none bg-transparent"})]}),e.jsx("hr",{className:"border-gray-200"}),e.jsxs("div",{className:"flex items-center py-2",children:[e.jsx("label",{className:"w-20 text-gray-600",children:"Reply-To:"}),e.jsx("input",{type:"email",value:i,readOnly:!0,className:"flex-1 outline-none bg-transparent"})]}),e.jsx("hr",{className:"border-gray-200"}),e.jsxs("div",{className:"flex items-center py-2",children:[e.jsx("label",{className:"w-20 text-gray-600",children:"Subject:"}),e.jsx("input",{type:"text",value:c.subject,onChange:n=>f(s=>({...s,subject:n.target.value})),className:"flex-1 outline-none",required:!0})]}),e.jsx("hr",{className:"border-gray-200"}),e.jsx("div",{className:"py-2",children:e.jsx("label",{className:"text-gray-600",children:"Message:"})}),e.jsx("div",{className:"min-h-[400px]",children:e.jsx(k,{theme:"snow",value:c.message,onChange:n=>f(s=>({...s,message:n})),placeholder:"Type your message here...",style:{height:"300px",maxHeight:"300px"}})}),e.jsx("hr",{className:"border-gray-200 mt-8"}),e.jsxs("div",{className:"py-4",children:[e.jsx("label",{className:"block text-gray-600 mb-2",children:"Attachments:"}),e.jsx("input",{type:"file",onChange:j,multiple:!0,className:`block w-full text-sm text-gray-500
                                            file:mr-4 file:py-2 file:px-4
                                            file:rounded-full file:border-0
                                            file:text-sm file:font-semibold
                                            file:bg-blue-50 file:text-blue-700
                                            hover:file:bg-blue-100`}),r.length>0&&e.jsx("div",{className:"mt-2 space-y-2",children:r.map((n,s)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[n.name," (",(n.size/1024/1024).toFixed(2)," MB)"]}),e.jsx("button",{type:"button",onClick:()=>y(s),className:"text-red-500 hover:text-red-700",children:"Ã—"})]},s))})]}),e.jsx("hr",{className:"border-gray-200"}),e.jsx("div",{className:"flex items-center space-x-4 pt-4",children:e.jsxs("button",{type:"submit",disabled:x,className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 flex items-center space-x-2 disabled:opacity-50",children:[e.jsx("span",{children:"Send"}),e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 10l7-7m0 0l7 7m-7-7v18"})})]})})]})})]})})})]})}export{$ as default};
