import{q as h,W as g,r as x,j as e,a as j}from"./app-DSgzlffV.js";import{M as f}from"./MainLayout-C1zfh-rR.js";import{R as y}from"./quill.snow-DVz_fq6q.js";import{u as v}from"./useRoles-DGClRxfd.js";import"./index-C33SYT6r.js";function b({tags:o,setTags:s}){const[l,n]=x.useState(""),d=t=>{if(t.key==="Enter"||t.key===","){t.preventDefault();const i=l.trim();i&&!o.includes(i)&&s([...o,i]),n("")}else t.key==="Backspace"&&!l.length&&o.length&&s(o.slice(0,o.length-1))},m=t=>{s(o.filter((i,u)=>u!==t))};return e.jsxs("div",{className:"flex flex-wrap items-center border rounded-lg p-2",children:[o.map((t,i)=>e.jsxs("div",{className:"bg-blue-200 text-blue-800 rounded-full px-3 py-1 m-1 flex items-center",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button",onClick:()=>m(i),className:"ml-2 text-sm text-blue-800",children:"Ã—"})]},i)),e.jsx("input",{type:"text",value:l,onChange:t=>n(t.target.value),onKeyDown:d,className:"flex-grow outline-none p-1",placeholder:"Type a tag and press enter"})]})}function R(){const{auth:o,post:s}=h().props;v();const{data:l,setData:n,post:d,processing:m,errors:t}=g({title:s.title||"",url:s.url||"",content:s.content||"",category:s.category||"",tags:s.tags||[],images:null,featured_image:null,attachment:null,status:s.status||"published"}),i=a=>{n("tags",a)},[u,N]=x.useState([]);function p(a){a.preventDefault();const c=new FormData;Object.keys(l).forEach(r=>{r==="tags"?c.append(r,JSON.stringify(l[r])):(l[r]instanceof File,c.append(r,l[r]))}),u.forEach(r=>{c.append("delete_images[]",r)}),d(route("create-posts.update",s.id),{data:c,headers:{"Content-Type":"multipart/form-data"},onSuccess:()=>{alert("Post updated successfully.")},onError:r=>{console.error("Error updating Post:",r),alert("Failed to update the Post. Please try again.")}})}return e.jsx(f,{children:e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:p,className:"bg-white p-6 rounded-lg max-w-7xl mx-auto space-y-6",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-700 text-center",children:"Edit Post"}),e.jsxs("div",{className:"grid grid-cols-10 gap-8",children:[e.jsxs("div",{className:"col-span-7",children:[e.jsxs("label",{className:"block text-gray-700 font-medium",children:["Post Title",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:l.title,onChange:a=>n("title",a.target.value),className:"mt-1 w-full rounded-lg border-gray-200 p-4 text-sm",placeholder:"Enter Post Title"}),t.title&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.title})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Category"}),e.jsxs("select",{id:"category",name:"category",value:l.category,onChange:a=>n("category",a.target.value),className:"mt-1 w-full rounded-lg border-gray-200 p-4 text-sm",children:[e.jsx("option",{value:"",disabled:!0,hidden:!0,children:"Select Category"}),e.jsx("option",{value:"General Discussion",children:"General Discussion"}),e.jsx("option",{value:"Academic Research",children:"Academic Research"}),e.jsx("option",{value:"Student Life",children:"Student Life"}),e.jsx("option",{value:"Career Opportunities",children:"Career Opportunities"}),e.jsx("option",{value:"News",children:"News"}),e.jsx("option",{value:"Startup",children:"Startup"}),e.jsx("option",{value:"Technology",children:"Technology"}),e.jsx("option",{value:"Research Methodology",children:"Research Methodology"}),e.jsx("option",{value:"Research Paradigm",children:"Research Paradigm"}),e.jsx("option",{value:"Science & Technology",children:"Science & Technology"}),e.jsx("option",{value:"Social Science",children:"Social Science"}),e.jsx("option",{value:"Community",children:"Community"}),e.jsx("option",{value:"Award",children:"Award"}),e.jsx("option",{value:"Achievement",children:"Achievement"}),e.jsx("option",{value:"Business",children:"Business"}),e.jsx("option",{value:"Economy",children:"Economy"}),e.jsx("option",{value:"Health",children:"Health"}),e.jsx("option",{value:"Science",children:"Science"}),e.jsx("option",{value:"Sport",children:"Sport"}),e.jsx("option",{value:"Corporate Social Responsibility",children:"Corporate Social Responsibility"}),e.jsx("option",{value:"Knowledge Transfer Program",children:"Knowledge Transfer Program"})]}),t.category&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.category})]})]}),e.jsxs("div",{className:"grid grid-cols-10 gap-8",children:[e.jsxs("div",{className:"col-span-7",children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Post URL"}),e.jsx("input",{type:"url",value:l.url,disabled:!0,onChange:a=>n("url",a.target.value),className:"mt-1 w-full rounded-lg border-gray-200 p-4 bg-gray-100 text-sm cursor-not-allowed",placeholder:"Auto-generated from title"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Tags"}),e.jsx(b,{tags:l.tags,setTags:i}),t.tags&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.tags})]})]}),e.jsxs("div",{className:"grid grid-cols-10 gap-8",children:[e.jsxs("div",{className:"col-span-7",children:[e.jsxs("label",{className:"block text-gray-700 font-medium",children:["Content ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"mt-1 w-full rounded-lg border border-gray-200",style:{height:"300px",overflowY:"auto"},children:e.jsx(y,{theme:"snow",value:l.content,onChange:a=>n("content",a),placeholder:"Enter content",style:{height:"300px",maxHeight:"300px"}})}),t.content&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.content})]}),e.jsxs("div",{className:"col-span-3 flex flex-col space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Upload Images (Multiple Allowed)"}),e.jsx("p",{className:"text-sm text-gray-500",children:"(Upload new images will delete all existed images)"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:a=>{n("images",Array.from(a.target.files))},className:"mt-1 w-full rounded-lg border-gray-200 p-2 text-sm"}),s.images&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Images:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:JSON.parse(s.images).map((a,c)=>e.jsxs("a",{href:`/storage/${a}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:["Image ",c+1]},c))})]}),t.images&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.images})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Upload Featured Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:a=>n("featured_image",a.target.files[0]),className:"mt-1 w-full rounded-lg border-gray-200 p-2 text-sm"}),s.featured_image&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Featured Image:"}),e.jsx("a",{href:`/storage/${s.featured_image}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:"View Featured Image"})]}),t.featured_image&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.featured_image})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Upload Attachment"}),e.jsx("input",{type:"file",onChange:a=>n("attachment",a.target.files[0]),className:"mt-1 w-full rounded-lg border-gray-200 p-2 text-sm"}),s.attachment&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Attachment:"}),e.jsx("a",{href:`/storage/${s.attachment}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:"View Attachment"})]}),t.attachment&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.attachment})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"submit",disabled:m,className:"inline-block rounded-lg bg-blue-500 px-5 py-3 text-sm font-medium text-white hover:bg-blue-600",children:"Update"}),e.jsx(j,{href:route("create-posts.index"),className:"inline-block rounded-lg bg-gray-300 px-5 py-3 text-sm font-medium text-gray-700 hover:bg-gray-400",children:"Cancel"})]})]})})})}export{R as default};
