import{r,j as e,a as E}from"./app-CRunKGlS.js";import{c as p}from"./index-BP2IIEZc.js";import{M as L}from"./Modal-B6Xe6uPJ.js";import{B as T}from"./button-CvHeaofT.js";import{I as h}from"./input-DIt0dFL2.js";import{T as _}from"./textarea-B-DGX93a.js";import{L as u}from"./label-BXs4LQ9L.js";import{A as q,a as B}from"./alert-DLMX4gfy.js";import{l as I}from"./logError-D4ezqrCx.js";import{X as H}from"./x-D71_YNlz.js";import{L as U}from"./loader-circle-CA_94cJH.js";import"./dialog-6F-BmcU5.js";import"./transition-Bs7yPu4Z.js";import"./utils-D-KgF5mV.js";import"./index-B_k58LZM.js";import"./index-CGrAONsN.js";import"./createLucideIcon-Cn5nLR87.js";function ae({meeting:a,onClose:i,onRescheduled:g}){const[x,j]=r.useState(""),[f,S]=r.useState(""),[v,y]=r.useState(""),[b,N]=r.useState(""),[d,M]=r.useState(!1),[$,m]=r.useState(null);r.useEffect(()=>{if(a){j(a.title||"");const t=new Date(a.scheduled_for),n=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),c=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0");S(`${n}-${o}-${l}T${c}:${s}`),y(a.location_link||""),N(a.agenda||""),m(null)}},[a]);const k=async t=>{var n,o,l,c;if(t.preventDefault(),!(!a||d)){M(!0),m(null);try{const s=f.replace("T"," ")+":00";await E.put(route("supervision.meetings.update",a.id),{title:x,scheduled_for:s,location_link:v,agenda:b}),p.success("Meeting rescheduled"),g==null||g(),i==null||i()}catch(s){I(s,"Reschedule meeting");const w=((o=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:o.message)||"Failed to reschedule meeting",D=(c=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:c.errors;if(D){const F=Object.values(D).flat().join(", ");m(F),p.error(F)}else m(w),p.error(w)}finally{M(!1)}}},A=()=>{const t=new Date,n=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),c=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0");return`${n}-${o}-${l}T${c}:${s}`};return e.jsx(L,{show:!!a,onClose:i,maxWidth:"lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Reschedule meeting"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Update the meeting time or details"})]}),e.jsx("button",{onClick:i,className:"rounded-md text-gray-400 hover:text-gray-500",children:e.jsx(H,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[$&&e.jsx(q,{variant:"destructive",children:e.jsx(B,{children:$})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"meeting-title",children:"Meeting title"}),e.jsx(h,{id:"meeting-title",value:x,onChange:t=>j(t.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"meeting-datetime",children:"Scheduled for"}),e.jsx(h,{id:"meeting-datetime",type:"datetime-local",value:f,onChange:t=>S(t.target.value),min:A(),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"meeting-location",children:"Meeting link / location"}),e.jsx(h,{id:"meeting-location",value:v,onChange:t=>y(t.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"meeting-agenda",children:"Agenda / notes"}),e.jsx(_,{id:"meeting-agenda",rows:4,value:b,onChange:t=>N(t.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(T,{type:"button",variant:"outline",onClick:i,disabled:d,children:"Cancel"}),e.jsxs(T,{type:"submit",disabled:d,children:[d&&e.jsx(U,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Meeting"]})]})]})]})})}export{ae as default};
