import{r as i,j as e,Y,a as E}from"./app-BfGWvB7w.js";import{M as H,B as Q}from"./MainLayout-4268IGPQ.js";import"./index-BJH3I2kF.js";import{T as z,a as J,b as B,c as F}from"./tabs-CRJsscDC.js";import{C as p,a as x,b,c as u,d as w}from"./card-D-wjmK2K.js";import{B as N}from"./badge-CZPp8yh3.js";import{B as v}from"./button-Cq3fupve.js";import{A as L,a as $}from"./avatar-DBW4jV_K.js";import{S as K}from"./separator-BtMPuOoi.js";import{A as O,a as X}from"./alert-D8ZQ_e9E.js";import Z from"./RelationshipDetailModal-CChWAvT1.js";import q from"./ScheduleMeetingDialog-D4tJM_7e.js";import ee from"./SupervisorRequestDetailCard-Bx66PnoY.js";import{l as se}from"./logError-D4ezqrCx.js";import{C as te}from"./clock-3-dZD22k7L.js";import{F as ae}from"./file-text-kQD_s7cs.js";import{M as I}from"./message-square-D2KqPL-R.js";import{C as re}from"./circle-check-CnmNGI3n.js";import{C as ie}from"./calendar-clock-DZUDxLpr.js";import{f as le}from"./AttachmentPreviewModal-BiCcSrvb.js";import{f as oe}from"./formatDistanceToNow-GKXiLTrL.js";import"./house-NZyoQ2Gd.js";import"./createLucideIcon-Czp2GFly.js";import"./zap-Cw9F8qzn.js";import"./users-ZGU2Nc7F.js";import"./folder-open-D5Fqauh0.js";import"./settings-Brw_LBzQ.js";import"./useRoles-DTgiufjA.js";import"./chevron-left-CA2Vc_Fb.js";import"./proxy-BK-7vKaj.js";import"./user-round-RE_N2eX7.js";import"./clipboard-list-BYkGs1br.js";import"./dollar-sign-D41u08oN.js";import"./calendar-CbxFMwGp.js";import"./graduation-cap-Di4TbpZt.js";import"./building-MPGUl8Te.js";import"./Dropdown-CjvO5Ia5.js";import"./transition-Da2sQ5nr.js";import"./sparkles-DqVAnQpQ.js";import"./building-2-B342a_fD.js";import"./database-BK3F8EUr.js";import"./shield-ykj2ZmOn.js";import"./index-D0QXYS-s.js";import"./analytics-BQ374C1C.js";import"./Modal-DFFVucdS.js";import"./dialog-CgKOv2f-.js";import"./PrimaryButton-DpeW9_ss.js";import"./SecondaryButton-h1KnshBt.js";import"./x-D1Znm3Ot.js";import"./briefcase-CMlBsN0j.js";import"./user-B0PU8Qxt.js";import"./index-ateNRHzS.js";import"./index-YHrrFQIB.js";import"./index-0yfP_vfc.js";import"./index-DtFdHnhw.js";import"./index-KEiRbh2J.js";import"./utils-CIsb_jhR.js";import"./clsx-B-dksMZM.js";import"./index-Dp3B9jqt.js";import"./dialog-7Smu-saY.js";import"./index-Dm_a-pHP.js";import"./Combination-dxNIfu4q.js";import"./tslib.es6-CmEaCU22.js";import"./scroll-area-DKiTudyr.js";import"./ThreadPane-C6vXaian.js";import"./history-Bc5xRMrp.js";import"./en-US-DNUEYIb-.js";import"./input-B-f-1RUn.js";import"./textarea-D8NeQnrM.js";import"./label-Bp8WiQ9s.js";import"./loader-circle-DpHWmCNd.js";import"./tooltip-1N_s-dpo.js";import"./index-DrCL8tui.js";import"./floating-ui.dom-eiE65J5j.js";import"./index-CHD9kPCG.js";import"./AcceptSupervisionRequestModal-C7VIxpLQ.js";import"./checkbox-D8L0p47e.js";import"./check-BlTRIq3i.js";import"./select-DYp6yFZb.js";import"./chevron-down-rR8Dnucu.js";import"./chevron-up-kVMysCLK.js";import"./lightbulb-CQ0SCZKL.js";import"./DeclineSupervisionRequestModal-BxfdMTAs.js";import"./circle-x-D2tUwjYy.js";import"./circle-alert-BWui1FBz.js";import"./video-Bu4bIDXU.js";import"./mail-wwsldmQc.js";import"./globe-DVFq3ZLA.js";import"./trash-2-CDx9I4PU.js";import"./constructNow-DtVD-0hX.js";const ne=[{key:"pending",label:"Pending",badge:"pending"},{key:"accepted",label:"Accepted",badge:"accepted"},{key:"rejected",label:"Rejected",badge:"rejected"}];function qs(){const[s,a]=i.useState("requests"),[r,t]=i.useState([]),[o,n]=i.useState([]),[d,h]=i.useState(null),[g,j]=i.useState(null),[y,m]=i.useState(null),[C,R]=i.useState(null),[_,k]=i.useState(!0),[V,A]=i.useState(!1),[T,D]=i.useState(null),[f,G]=i.useState("pending"),M=async()=>{try{D(null),k(!0);const[l,c]=await Promise.all([E.get(route("supervision.requests.index")),E.get(route("supervision.relationships.index"))]);t(l.data.data||[]),n((c.data.data||[]).filter(W=>W.status==="active"))}catch(l){se(l,"Supervision fetchData"),D("Unable to load supervision data right now.")}finally{k(!1)}},S=async()=>{V||(A(!0),await M(),A(!1))};i.useEffect(()=>{M()},[]);const U=i.useMemo(()=>r.filter(l=>l.status===f),[r,f]);return e.jsxs(H,{title:"Supervisor Dashboard",children:[e.jsx(Y,{title:"Supervisor Dashboard"}),e.jsxs("div",{className:"max-w-7xl mx-auto pb-6 space-y-6",children:[T&&e.jsx(O,{variant:"destructive",children:e.jsx(X,{children:T})}),e.jsxs(z,{value:s,onValueChange:a,className:"space-y-6",children:[e.jsxs(J,{className:"grid w-full grid-cols-2 bg-gray-100 p-1 rounded-lg h-12",children:[e.jsx(B,{value:"requests",className:"data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm data-[state=inactive]:text-gray-600 rounded-md transition-all py-2",children:"Manage Requests"}),e.jsx(B,{value:"students",className:"data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm data-[state=inactive]:text-gray-600 rounded-md transition-all py-2",children:"My Students"})]}),e.jsxs(F,{value:"requests",className:"space-y-4",children:[e.jsx(ce,{filter:f,onChange:G,requests:r}),_?e.jsx(he,{}):U.length===0?e.jsx(xe,{status:f}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:U.map(l=>e.jsx(de,{request:l,onOpenDetail:c=>R(c)},l.id))})]}),e.jsx(F,{value:"students",children:_?e.jsx(je,{}):o.length===0?e.jsx(ue,{}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:o.map(l=>e.jsx(pe,{relationship:l,onOpenDetail:c=>{c.preferred_tab?j(c):j(l),h(null)},onScheduleMeeting:c=>m(c)},l.id))})})]}),e.jsx(Z,{request:d,relationship:g,onClose:()=>{h(null),j(null)},onUpdated:S}),e.jsx(q,{relationship:y,onClose:()=>m(null),onScheduled:S}),C&&e.jsx(ee,{request:C,onClose:()=>R(null),onUpdated:S})]})]})}function ce({filter:s,onChange:a,requests:r}){return e.jsx("div",{className:"flex flex-wrap items-center gap-3",children:ne.map(t=>{const o=r.filter(n=>n.status===t.badge).length;return e.jsxs(v,{variant:s===t.badge?"default":"outline",onClick:()=>a(t.badge),className:"flex items-center gap-2",children:[t.label,e.jsx(N,{variant:s===t.badge?"secondary":"outline",children:o})]},t.key)})})}function de({request:s,onOpenDetail:a}){const r=s==null?void 0:s.student,t=(r==null?void 0:r.full_name)??"Student",o=r!=null&&r.profile_picture?`/storage/${r.profile_picture}`:null,n=s!=null&&s.submitted_at?le(new Date(s.submitted_at),"PPP"):"—",d=s!=null&&s.submitted_at?oe(new Date(s.submitted_at),{addSuffix:!0}):null,h=(s==null?void 0:s.status)??"pending",g={pending:"bg-amber-50 text-amber-700 border-none",accepted:"bg-emerald-50 text-emerald-700 border-none",rejected:"bg-rose-50 text-rose-700 border-none"},j=g[h]??g.pending,y=h.split("_").map(m=>m.charAt(0).toUpperCase()+m.slice(1)).join(" ");return e.jsxs(p,{className:"shadow-sm hover:shadow-md transition-shadow cursor-pointer",onClick:()=>a(s),children:[e.jsxs(x,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx(L,{className:"h-10 w-10",children:o?e.jsx("img",{src:o,alt:t,className:"h-full w-full object-cover"}):e.jsx($,{className:"bg-indigo-50 text-indigo-600",children:t.slice(0,2).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-slate-800",children:t}),d&&e.jsxs("div",{className:"text-xs text-slate-500",children:["Submitted ",d]})]})]}),e.jsx(N,{className:j,children:y})]}),e.jsx("div",{className:"mt-3",children:e.jsx(b,{className:"text-base font-semibold text-slate-900 line-clamp-2",children:(s==null?void 0:s.proposal_title)??"Supervision request"})})]}),e.jsxs(u,{className:"space-y-4 text-sm text-slate-600",children:[e.jsx(K,{}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(P,{icon:te,label:"Submitted on",value:n}),e.jsx(P,{icon:ae,label:"Motivation",value:me(s==null?void 0:s.motivation,100)})]})]}),e.jsxs(w,{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{className:"flex gap-2 text-xs text-slate-500",children:e.jsxs(N,{variant:"outline",className:"border-slate-200 text-slate-500",children:[e.jsx(I,{className:"mr-1 h-3.5 w-3.5"}),"Conversation ready"]})}),e.jsxs(v,{className:"sm:w-36",onClick:m=>{m.stopPropagation(),a(s)},children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"View details"]})]})]})}function P({icon:s,label:a,value:r}){return e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(s,{className:"mt-0.5 h-4 w-4 text-slate-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:a}),e.jsx("div",{className:"text-sm text-slate-700",children:r||"—"})]})]})}function me(s,a){return!s||s.length<=a?s:`${s.slice(0,a)}…`}function pe({relationship:s,onOpenDetail:a,onScheduleMeeting:r}){var n,d;const t=s.student,o=t!=null&&t.profile_picture?`/storage/${t.profile_picture}`:null;return e.jsxs(p,{className:"flex h-full flex-col justify-between",children:[e.jsxs(x,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{className:"h-12 w-12",children:o?e.jsx("img",{src:o,alt:t==null?void 0:t.full_name,className:"h-full w-full object-cover"}):e.jsx($,{className:"bg-indigo-50 text-indigo-600",children:((d=(n=t==null?void 0:t.full_name)==null?void 0:n.slice(0,2))==null?void 0:d.toUpperCase())??"PG"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx(b,{className:"text-base font-semibold text-slate-900",children:t==null?void 0:t.full_name}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Accepted ",s!=null&&s.accepted_at?new Date(s.accepted_at).toLocaleDateString():"—"]})]})]}),e.jsx(N,{variant:"secondary",className:"bg-emerald-50 text-emerald-700 border-none w-fit",children:s.role==="main"?"Main supervisor":"Co-supervisor"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border border-slate-200 p-3",children:[e.jsxs("h4",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:[e.jsx(Q,{className:"h-4 w-4 text-indigo-500"}),"Meeting cadence"]}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:s.meeting_cadence||"Not specified yet"})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 p-3",children:[e.jsxs("h4",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-slate-500",children:[e.jsx(GaugeCircle,{className:"h-4 w-4 text-indigo-500"}),"ScholarLab workspace"]}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:s.scholarlab_board_id?"Workspace activated":"Not provisioned yet"})]})]}),e.jsxs(w,{className:"flex flex-col gap-2",children:[e.jsxs(v,{variant:"outline",onClick:()=>a==null?void 0:a({...s,preferred_tab:"overview"}),children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Open student details"]}),e.jsxs(v,{onClick:()=>r==null?void 0:r(s),children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Schedule meeting"]})]})]})}function xe({status:s}){const a={pending:{title:"No pending requests",description:"You do not have any new supervision proposals right now. Students will appear here when they submit a request."},accepted:{title:"No accepted requests yet",description:"Accepted proposals appear here. When you approve a student, they will transition to the My Students tab."},rejected:{title:"No rejected requests",description:"Rejected proposals will appear here for reference."}}[s]||{title:"No requests found",description:"Try selecting another status filter."};return e.jsxs(p,{className:"border-dashed border-slate-200",children:[e.jsx(x,{children:e.jsx(b,{className:"text-lg font-semibold text-slate-800",children:a.title})}),e.jsx(u,{className:"text-sm text-slate-600",children:a.description})]})}function ue(){return e.jsxs(p,{className:"border-dashed border-slate-200",children:[e.jsx(x,{children:e.jsx(b,{className:"text-lg font-semibold text-slate-800",children:"No supervisees yet"})}),e.jsx(u,{className:"text-sm text-slate-600",children:"Once you accept a student, they will appear here for ongoing management. Use the Manage Requests tab to approve new proposals."})]})}function he(){return e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:Array.from({length:4}).map((s,a)=>e.jsxs(p,{className:"border-dashed animate-pulse",children:[e.jsxs(x,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-200"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-32 rounded bg-slate-200"}),e.jsx("div",{className:"h-3 w-20 rounded bg-slate-100"})]})]}),e.jsx("div",{className:"h-5 w-24 rounded bg-slate-100"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsx("div",{className:"h-14 w-full rounded bg-slate-100"}),e.jsx("div",{className:"h-10 w-full rounded bg-slate-100"})]}),e.jsxs(w,{className:"space-y-2",children:[e.jsx("div",{className:"h-10 w-full rounded bg-slate-200"}),e.jsx("div",{className:"h-10 w-full rounded bg-slate-200"})]})]},`request-skeleton-${a}`))})}function je(){return e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:Array.from({length:4}).map((s,a)=>e.jsxs(p,{className:"border-dashed animate-pulse",children:[e.jsxs(x,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-200"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-32 rounded bg-slate-200"}),e.jsx("div",{className:"h-3 w-20 rounded bg-slate-100"})]})]}),e.jsx("div",{className:"h-5 w-24 rounded bg-slate-100"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsx("div",{className:"h-14 w-full rounded bg-slate-100"}),e.jsx("div",{className:"h-10 w-full rounded bg-slate-100"})]}),e.jsx(w,{className:"space-y-2",children:e.jsx("div",{className:"h-10 w-full rounded bg-slate-200"})})]},`student-skeleton-${a}`))})}export{qs as default};
