import{r as l,R as m,c as se,j as o,a as le,y as oe}from"./app-ETHwI688.js";import{M as ie}from"./Modal-DdL8ceJq.js";import{P as ce}from"./PrimaryButton-BMiO6RDn.js";import{S as ue}from"./SecondaryButton-j6tpFNOi.js";import{c as E}from"./index-CF9Lwyje.js";import{c as w}from"./clsx-B-dksMZM.js";import{Q as de,K as fe,u as me,I as pe,$ as he,a as ge,w as xe,e as be,r as ve}from"./use-resolve-button-type-DO-OEoAL.js";import{o as $,p as U,m as ye,K as je,L as R,y as Se,_ as Ne}from"./transition-DGRM8zTR.js";import{d as A,s as B,H as $e,w as Ee,c as we,U as ke,o as I}from"./dialog-CUxpe5IQ.js";function Pe(t,r,e){let[a,s]=l.useState(e),i=t!==void 0,d=l.useRef(i),u=l.useRef(!1),p=l.useRef(!1);return i&&!d.current&&!u.current?(u.current=!0,d.current=i,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!i&&d.current&&!p.current&&(p.current=!0,d.current=i,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[i?t:a,$(h=>(i||s(h),r==null?void 0:r(h)))]}function Ce(t){let[r]=l.useState(t);return r}function L(t={},r=null,e=[]){for(let[a,s]of Object.entries(t))_(e,O(r,a),s);return e}function O(t,r){return t?t+"["+r+"]":r}function _(t,r,e){if(Array.isArray(e))for(let[a,s]of e.entries())_(t,O(r,a.toString()),s);else e instanceof Date?t.push([r,e.toISOString()]):typeof e=="boolean"?t.push([r,e?"1":"0"]):typeof e=="string"?t.push([r,e]):typeof e=="number"?t.push([r,`${e}`]):e==null?t.push([r,""]):L(e,r,t)}function Te(t){var r,e;let a=(r=t==null?void 0:t.form)!=null?r:t.closest("form");if(a){for(let s of a.elements)if(s!==t&&(s.tagName==="INPUT"&&s.type==="submit"||s.tagName==="BUTTON"&&s.type==="submit"||s.nodeName==="INPUT"&&s.type==="image")){s.click();return}(e=a.requestSubmit)==null||e.call(a)}}let Fe=l.createContext(null);function Me({children:t}){let r=l.useContext(Fe);if(!r)return m.createElement(m.Fragment,null,t);let{target:e}=r;return e?se.createPortal(m.createElement(m.Fragment,null,t),e):null}function De({data:t,form:r,disabled:e,onReset:a,overrides:s}){let[i,d]=l.useState(null),u=U();return l.useEffect(()=>{if(a&&i)return u.addEventListener(i,"reset",a)},[i,r,a]),m.createElement(Me,null,m.createElement(Ie,{setForm:d,formId:r}),L(t).map(([p,h])=>m.createElement(A,{features:B.Hidden,...ye({key:p,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:r,disabled:e,name:p,value:h,...s})})))}function Ie({setForm:t,formId:r}){return l.useEffect(()=>{if(r){let e=document.getElementById(r);e&&t(e)}},[t,r]),r?null:m.createElement(A,{features:B.Hidden,as:"input",type:"hidden",hidden:!0,readOnly:!0,ref:e=>{if(!e)return;let a=e.closest("form");a&&t(a)}})}let k=l.createContext(null);k.displayName="GroupContext";let Ue=l.Fragment;function Re(t){var r;let[e,a]=l.useState(null),[s,i]=fe(),[d,u]=Ee(),p=l.useMemo(()=>({switch:e,setSwitch:a}),[e,a]),h={},b=t,v=R();return m.createElement(u,{name:"Switch.Description",value:d},m.createElement(i,{name:"Switch.Label",value:s,props:{htmlFor:(r=p.switch)==null?void 0:r.id,onClick(n){e&&(n.currentTarget instanceof HTMLLabelElement&&n.preventDefault(),e.click(),e.focus({preventScroll:!0}))}}},m.createElement(k.Provider,{value:p},v({ourProps:h,theirProps:b,slot:{},defaultTag:Ue,name:"Switch.Group"}))))}let Ae="button";function Be(t,r){var e;let a=l.useId(),s=me(),i=we(),{id:d=s||`headlessui-switch-${a}`,disabled:u=i||!1,checked:p,defaultChecked:h,onChange:b,name:v,value:n,form:c,autoFocus:f=!1,...y}=t,x=l.useContext(k),[H,K]=l.useState(null),G=l.useRef(null),q=Se(G,r,x===null?null:x.setSwitch,K),j=Ce(h),[S,N]=Pe(p,b,j??!1),V=U(),[P,C]=l.useState(!1),T=$(()=>{C(!0),N==null||N(!S),V.nextFrame(()=>{C(!1)})}),W=$(g=>{if(ve(g.currentTarget))return g.preventDefault();g.preventDefault(),T()}),z=$(g=>{g.key===I.Space?(g.preventDefault(),T()):g.key===I.Enter&&Te(g.currentTarget)}),J=$(g=>g.preventDefault()),Q=pe(),X=ke(),{isFocusVisible:F,focusProps:Y}=he({autoFocus:f}),{isHovered:M,hoverProps:Z}=ge({isDisabled:u}),{pressed:D,pressProps:ee}=xe({disabled:u}),te=l.useMemo(()=>({checked:S,disabled:u,hover:M,focus:F,active:D,autofocus:f,changing:P}),[S,M,F,D,u,P,f]),re=Ne({id:d,ref:q,role:"switch",type:be(t,H),tabIndex:t.tabIndex===-1?0:(e=t.tabIndex)!=null?e:0,"aria-checked":S,"aria-labelledby":Q,"aria-describedby":X,disabled:u||void 0,autoFocus:f,onClick:W,onKeyUp:z,onKeyPress:J},Y,Z,ee),ne=l.useCallback(()=>{if(j!==void 0)return N==null?void 0:N(j)},[N,j]),ae=R();return m.createElement(m.Fragment,null,v!=null&&m.createElement(De,{disabled:u,data:{[v]:n||"on"},overrides:{type:"checkbox",checked:S},form:c,onReset:ne}),ae({ourProps:re,theirProps:y,slot:te,defaultTag:Ae,name:"Switch"}))}let Le=je(Be),Oe=Re,_e=de,He=$e,Ke=Object.assign(Le,{Group:Oe,Label:_e,Description:He});function Ze({show:t,onClose:r,board:e,workspaceMembers:a}){const[s,i]=l.useState([]),[d,u]=l.useState(!1);l.useEffect(()=>{t&&e&&e.members&&i(e.members.map(n=>n.id))},[t,e]);const p=n=>{i(c=>c.includes(n)?c.filter(f=>f!==n):[...c,n])},h=n=>{n.preventDefault(),u(!0),le.post(route("project-hub.boards.sync-members",e.id),{user_ids:s}).then(c=>{E.success("Board access updated successfully"),oe.reload({preserveScroll:!0,onSuccess:()=>{r()},onError:()=>{r(),E.error("Changes saved but page refresh failed. Please reload the page.")}})}).catch(c=>{var y,x;const f=((x=(y=c.response)==null?void 0:y.data)==null?void 0:x.message)||"Failed to update board access";E.error(f),u(!1)})},b=n=>{if(!n)return"Unknown User";const c=n.academician||n.postgraduate||n.undergraduate;return(c==null?void 0:c.full_name)||n.name},v=n=>{var f,y,x;if(!n)return null;const c=((f=n.academician)==null?void 0:f.profile_picture)||((y=n.postgraduate)==null?void 0:y.profile_picture)||((x=n.undergraduate)==null?void 0:x.profile_picture);return c?`/storage/${c}`:null};return o.jsx(ie,{show:t,onClose:r,maxWidth:"md",children:o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Manage Board Access"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1 mb-4",children:"Use the toggle to grant or revoke board access for each member."}),o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsx("div",{className:"bg-gray-50 rounded-lg p-2 max-h-80 overflow-y-auto",children:a&&a.length>0?o.jsx("div",{className:"space-y-3",children:a.map(n=>{var c,f;return o.jsxs("div",{className:w("flex justify-between items-center p-3 rounded-lg transition-colors duration-200",s.includes(n.id)?"bg-indigo-50 border border-indigo-200":"bg-white border border-gray-100"),children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:v(n)?o.jsx("img",{src:v(n),alt:b(n),className:"h-full w-full object-cover"}):o.jsx("span",{className:"text-gray-500 text-sm",children:b(n).charAt(0)})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:b(n)}),o.jsx("p",{className:"text-xs text-gray-500",children:(((c=n.pivot)==null?void 0:c.role)||"Member").charAt(0).toUpperCase()+(((f=n.pivot)==null?void 0:f.role)||"Member").slice(1)})]})]}),o.jsx(Ke,{checked:s.includes(n.id),onChange:()=>p(n.id),disabled:d,className:w("relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",s.includes(n.id)?"bg-indigo-600":"bg-gray-200"),children:o.jsx("span",{"aria-hidden":"true",className:w("pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",s.includes(n.id)?"translate-x-5":"translate-x-0")})})]},n.id)})}):o.jsx("div",{className:"text-center p-4",children:o.jsx("p",{className:"text-gray-500",children:"No members available to manage."})})}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx(ue,{onClick:r,disabled:d,children:"Cancel"}),o.jsx(ce,{type:"submit",disabled:d,children:d?"Saving...":"Save Changes"})]})]})]})})}export{Ze as M};
