import{r as x,j as e}from"./app-BleoWbnu.js";import{q as p,O as u,H as v,I as d,M as b,P as w,N as y}from"./index-D5FiVgnt.js";const P=({totalUsers:c,topViewedAcademicians:r,analyticsData:s})=>{const[a,o]=x.useState(!1);x.useEffect(()=>{const l=s&&typeof s=="object"&&"activeUsers"in s&&"avgSessionDuration"in s&&"topPages"in s&&"pageViewsOverTime"in s;o(l),s&&!l&&console.warn("Analytics data has an unexpected format",s)},[s]);const m=()=>s?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-500",children:"ACTIVE USERS NOW"}),e.jsx("p",{className:"text-3xl font-bold",children:s.activeUsers||0})]}),e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(p,{className:"text-blue-500 text-xl"})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-500",children:"AVG. SESSION"}),e.jsxs("p",{className:"text-3xl font-bold",children:[s.avgSessionDuration||0,"s"]})]}),e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(u,{className:"text-green-500 text-xl"})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-500",children:"REGISTERED USERS"}),e.jsx("p",{className:"text-3xl font-bold",children:c})]}),e.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:e.jsx(v,{className:"text-purple-500 text-xl"})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-500",children:"TOP PROFILE VIEWS"}),e.jsx("p",{className:"text-3xl font-bold",children:r&&r.length>0?r[0].total_views:0})]}),e.jsx("div",{className:"bg-yellow-100 p-3 rounded-full",children:e.jsx(d,{className:"text-yellow-500 text-xl"})})]})]}):e.jsx("div",{className:"bg-red-50 text-red-500 p-4 rounded-lg",children:e.jsx("p",{children:"Unable to load Google Analytics data. Please check your configuration."})}),h=({academicians:l})=>e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Top Viewed Academicians"}),e.jsx(b,{className:"text-indigo-500"})]}),e.jsx("div",{className:"space-y-3 max-h-[350px] overflow-y-auto",children:l&&l.length>0?l.map((t,i)=>e.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-indigo-500 font-bold",children:i+1})}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-cover bg-center mr-2",style:{backgroundImage:`url(${encodeURI(t.profile_picture?`/storage/${t.profile_picture}`:"/storage/profile_pictures/default.jpg")})`}}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm truncate max-w-[150px]",title:t.full_name||"Unknown",children:t.full_name||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-500 truncate max-w-[150px]",title:t.current_position||"No position",children:t.current_position||"No position"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(d,{className:"w-3 h-3 text-indigo-500 mr-1"}),e.jsx("span",{className:"text-sm font-medium",children:t.total_views})]})]},t.id)):e.jsx("p",{className:"text-sm text-gray-500",children:"No view data available"})})]}),j=({pages:l})=>e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 h-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Top Pages"}),e.jsx(w,{className:"text-indigo-500"})]}),l&&l.length>0?e.jsx("div",{className:"space-y-3",children:l.map((t,i)=>e.jsxs("div",{className:"border-b pb-2",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center mr-2",children:e.jsx("span",{className:"text-indigo-500 font-bold text-xs",children:i+1})}),e.jsx("p",{className:"font-medium text-sm truncate max-w-[400px]",title:t.title,children:t.title||"Untitled Page"})]}),e.jsxs("div",{className:"flex justify-between text-xs pl-8",children:[e.jsx("span",{className:"text-gray-500",children:t.path}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(d,{className:"w-3 h-3 text-indigo-500 mr-1"}),e.jsx("span",{className:"font-medium",children:t.views})]})]})]},i))}):e.jsx("div",{className:"flex items-center justify-center h-[280px] bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No page view data available"})})]}),g=({pageViewsData:l})=>{const t=l&&l.length>0?Math.max(...l.map(i=>i.views)):100;return e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 h-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Page Views (Last 30 Days)"}),e.jsx(y,{className:"text-indigo-500"})]}),l&&l.length>0?e.jsx("div",{className:"h-[280px] flex items-end space-x-1",children:l.map((i,n)=>{const f=n%5===0,N=i.views/t*100+"%";return e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:"w-full bg-indigo-100 hover:bg-indigo-200 transition-all rounded-t",style:{height:N},title:`${i.date}: ${i.views} views`}),f&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1 rotate-45 origin-left whitespace-nowrap",children:[i.date.substring(5)," "]})]},n)})}):e.jsx("div",{className:"flex items-center justify-center h-[280px] bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No page view data available"})})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"text-sm text-gray-500",children:a?e.jsx("span",{className:"text-green-500",children:"✓ Google Analytics connected"}):e.jsx("span",{className:"text-yellow-500",children:"⟳ Loading analytics..."})})}),m(),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 mt-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(h,{academicians:r})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(g,{pageViewsData:(s==null?void 0:s.pageViewsOverTime)||[]}),e.jsx(j,{pages:(s==null?void 0:s.topPages)||[]})]})})]})]})};export{P as A};
