import{r as o,j as e,y as H,a as z,b as K}from"./app-Ba9NEla_.js";import{c as w}from"./index-DW2eQRph.js";import{l as Y}from"./logError-D4ezqrCx.js";import{C as Z,b as R,c as q,a as V,d as ee}from"./card-CqrB6JdE.js";import{B as M}from"./button-BEWen7a0.js";import{T as se,a as ae,b as re,c as te}from"./tooltip-DP5RCaPk.js";import{D as ne,a as ie,b as le,c as O}from"./dropdown-menu-BuSgLLKm.js";import{C as oe}from"./ConfirmationModal-DQzZobgJ.js";import{C as ce}from"./chevron-down-jOf7eNbN.js";import{S as de}from"./sparkles-BUu_m5kF.js";import{G as me}from"./graduation-cap-CaNWWPpW.js";import{f as xe}from"./formatDistanceToNow-GKXiLTrL.js";import{U as J}from"./user-round-CFmIIlMD.js";import{c as ue}from"./createLucideIcon-D9Xjp5kf.js";import{B as he}from"./book-open-DPAO_xgJ.js";import{F as pe}from"./folder-kanban-tY3ET3td.js";import{U as D}from"./user-plus-CAe95gky.js";import{E as fe}from"./eye-CydtdkBi.js";import{S as ge}from"./send-CGZEDnBs.js";import{C as je}from"./circle-check-CP6uzsMx.js";import{L as ve}from"./loader-circle-BzQWx5Qr.js";import{T as we}from"./trash-2-C8aFz6xs.js";import"./utils-D-KgF5mV.js";import"./index-B75IAngf.js";import"./index-CDEssc61.js";import"./index-15aMhqW_.js";import"./index-xQoiVGlk.js";import"./index-edx9cnCL.js";import"./index-BnwPfEVg.js";import"./floating-ui.dom-eiE65J5j.js";import"./index-doDk9rCk.js";import"./index-DKkZd806.js";import"./index-D4cTQj6_.js";import"./index-BAWFi-Zq.js";import"./index-C_0yBoYj.js";import"./index-7e-v4Twm.js";import"./tslib.es6-CmEaCU22.js";import"./index-C1WBEj0V.js";import"./chevron-right-hyKbPlMM.js";import"./check-DFql7rMx.js";import"./circle-hgcLUKF4.js";import"./triangle-alert-DYyWJnzT.js";import"./x-DVH-fLs-.js";import"./constructNow-DtVD-0hX.js";import"./en-US-DNUEYIb-.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M16 10h.01",key:"1m94wz"}]],Q=ue("MessageSquareMore",be),W={default:{title:"No potential supervisors yet",description:"Start by adding supervisors from your recommendations list to keep track of who you want to approach."},search:{title:"No matches found",description:"Try adjusting your search filters or browse the full list."}};function hs({shortlist:a=[],requests:p=[],activeRelationship:S=null,isLoading:c=!1,reload:b,onRequestSupervisor:N,onViewRequest:y,onRemoveSuccess:f,emptyState:P="default"}){var _;const[r,g]=o.useState(null),[E,d]=o.useState(!1),[i,j]=o.useState(null),U=o.useMemo(()=>Array.isArray(p)?p.reduce((s,t)=>{if(!["cancelled","auto_cancelled","rejected"].includes(t.status)){const m=String(t.academician_id??"");m&&(s[m]=t)}return s},{}):{},[p]),B=s=>{j(s),d(!0)},h=async()=>{var t,m,x;if(!i)return;const s=(t=i==null?void 0:i.academician)==null?void 0:t.academician_id;if(!s){w.error("Unable to identify supervisor to remove"),d(!1),j(null);return}g(s),d(!1);try{await z.delete(route("supervision.shortlist.destroy",s)),w.success("Removed from your potential supervisor list"),f==null||f(i),b==null||b()}catch(u){Y(u,"Supervision handleRemove");const v=((x=(m=u==null?void 0:u.response)==null?void 0:m.data)==null?void 0:x.message)||"Failed to remove supervisor";w.error(v)}finally{g(null),j(null)}},C=!c&&(!Array.isArray(a)||a.length===0),{title:n,description:L}=o.useMemo(()=>W[P]??W.default,[P]);return c?e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:Array.from({length:4}).map((s,t)=>e.jsxs("div",{className:"border border-dashed rounded-xl p-4 sm:p-5 bg-white shadow-sm animate-pulse min-h-[320px] sm:min-h-[340px] flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-1.5 sm:space-y-2 min-w-0",children:[e.jsx("div",{className:"h-3.5 sm:h-4 w-28 sm:w-32 rounded bg-slate-200"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-20 sm:w-24 rounded bg-slate-100"})]})]}),e.jsx("div",{className:"h-2.5 sm:h-3 w-16 sm:w-20 rounded bg-slate-100 flex-shrink-0"})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-3 sm:gap-4 flex-wrap",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-20 sm:w-24 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-24 sm:w-28 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-16 sm:w-20 rounded bg-slate-100"})]}),e.jsxs("div",{className:"mt-3 flex-1",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-24 sm:w-32 rounded bg-slate-100 mb-2"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("div",{className:"h-5 sm:h-6 w-28 sm:w-32 rounded-full bg-slate-100"}),e.jsx("div",{className:"h-5 sm:h-6 w-16 sm:w-20 rounded-full bg-slate-100"})]}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"h-5 sm:h-6 w-12 sm:w-16 rounded-full bg-slate-100"})})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex flex-col xs:flex-row items-stretch xs:items-center gap-2 pt-3 sm:pt-4 border-t border-slate-200",children:[e.jsx("div",{className:"h-9 sm:h-10 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-9 sm:h-10 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-9 sm:h-10 w-full xs:w-10 rounded bg-slate-200"})]})]},`potential-skeleton-${t}`))}):C?e.jsxs(Z,{className:"border-dashed border-slate-200",children:[e.jsx(R,{children:e.jsx(q,{className:"text-lg font-semibold text-slate-800",children:n})}),e.jsx(V,{className:"text-sm text-slate-600",children:L}),e.jsx(ee,{children:e.jsxs(ne,{children:[e.jsx(ie,{asChild:!0,children:e.jsxs(M,{variant:"outline",className:"gap-2",children:["Find supervisors",e.jsx(ce,{className:"w-4 h-4"})]})}),e.jsxs(le,{align:"start",className:"w-56",children:[e.jsxs(O,{onSelect:()=>H.visit(route("ai.matching.index")),className:"gap-2 cursor-pointer",children:[e.jsx(de,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{children:"AI Matching"})]}),e.jsxs(O,{onSelect:()=>H.visit(route("postgraduate-recommendations.index")),className:"gap-2 cursor-pointer",children:[e.jsx(me,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:"Postgraduate Program Recommendations"})]})]})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:a.map(s=>{var u,v,k,T,I,F,A;const t=(s==null?void 0:s.academician_id)??((k=(v=(u=s==null?void 0:s.academician)==null?void 0:u.user)==null?void 0:v.academician)==null?void 0:k.academician_id)??((T=s==null?void 0:s.academician)==null?void 0:T.academician_id)??((F=(I=s==null?void 0:s.academician)==null?void 0:I.user)==null?void 0:F.academician_id),m=t?U[String(t)]:null,x=(A=s==null?void 0:s.academician)==null?void 0:A.academician_id;return e.jsx(Ne,{item:s,existingRequest:m,activeRelationship:S,onRemove:B,onRequest:N,onViewRequest:y,isRemoving:r===x},s.id)})}),e.jsx(oe,{show:E,onClose:()=>{d(!1),j(null)},onConfirm:h,title:"Remove from Potential Supervisors",message:`Are you sure you want to remove ${((_=i==null?void 0:i.academician)==null?void 0:_.full_name)||"this supervisor"} from your potential supervisor list? You can always add them back later.`,confirmButtonText:"Yes, Remove"})]})}function Ne({item:a,onRemove:p,onRequest:S,onViewRequest:c,isRemoving:b,existingRequest:N,activeRelationship:y=null}){var A,$,G;const[f,P]=o.useState(!1),r=(a==null?void 0:a.academician)??{},g=r.full_name??"Supervisor",E=r.availability_as_supervisor,d=r.profile_picture?`/storage/${r.profile_picture}`:null,i=a!=null&&a.saved_at?xe(new Date(a.saved_at),{addSuffix:!0}):null,j=((A=r.university)==null?void 0:A.name)||"",U=r.publications_count??0,B=r.projects_count??0,h=r.research_areas||[],C=r.url||null,n=r==null?void 0:r.user,L=f?h:h.slice(0,1),_=a==null?void 0:a.academician_id,s=o.useMemo(()=>!y||!_?!1:String(y.academician_id)===String(_),[y,_]),t=!!y,[m,x]=o.useState(!1),[u,v]=o.useState((($=n==null?void 0:n.connection_status_with_auth_user)==null?void 0:$.status)||"not_connected"),[k,T]=o.useState(((G=n==null?void 0:n.connection_status_with_auth_user)==null?void 0:G.connection_id)||null),I=async()=>{if(n!=null&&n.id){x(!0);try{const l=await z.post(route("api.app.connections.store",n.id));l.data&&l.data.connection&&(v("pending_sent"),T(l.data.connection.id),w.success("Connection request sent"))}catch(l){Y(l,"PotentialSupervisorCard connect"),w.error("Failed to send connection request")}finally{x(!1)}}},F=async()=>{if(k){x(!0);try{await z.patch(route("api.app.connections.accept",k)),v("connected"),w.success("Connection request accepted")}catch(l){Y(l,"PotentialSupervisorCard acceptRequest"),w.error("Failed to accept connection")}finally{x(!1)}}};return e.jsxs("div",{className:"border rounded-xl p-4 sm:p-5 bg-white shadow-sm hover:shadow-md transition-shadow min-h-[320px] sm:min-h-[340px] flex flex-col",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 min-w-0",children:[C?e.jsx(K,{href:route("academicians.show",C),className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center overflow-hidden hover:ring-2 hover:ring-indigo-300 transition-all cursor-pointer",children:d?e.jsx("img",{src:d,alt:g,className:"w-full h-full object-cover rounded-full"}):e.jsx(J,{className:"w-5 h-5 text-indigo-600"})})}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center overflow-hidden flex-shrink-0",children:d?e.jsx("img",{src:d,alt:g,className:"w-full h-full object-cover rounded-full"}):e.jsx(J,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[C?e.jsx(K,{href:route("academicians.show",C),children:e.jsx("h3",{className:"text-sm sm:text-[1.05rem] font-semibold text-gray-900 leading-snug truncate hover:text-indigo-600 transition-colors cursor-pointer",children:g})}):e.jsx("h3",{className:"text-sm sm:text-[1.05rem] font-semibold text-gray-900 leading-snug truncate",children:g}),j&&e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate font-normal",children:j})]})]}),i&&e.jsxs("div",{className:"text-[10px] sm:text-xs text-slate-500 flex-shrink-0",children:["Saved ",i]})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center flex-wrap gap-x-3 sm:gap-x-4 gap-y-2 text-xs sm:text-sm text-gray-600",children:[E&&e.jsxs("div",{className:"inline-flex items-center gap-1.5 text-green-700",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"Accepting Students"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(he,{className:"w-4 h-4 mr-1.5 text-gray-400"}),e.jsxs("span",{children:[U," Publications"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(pe,{className:"w-4 h-4 mr-1.5 text-gray-400"}),e.jsxs("span",{children:[B," Projects"]})]})]}),Array.isArray(h)&&h.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-gray-800 text-sm font-medium mb-2",children:"Research Areas:"}),e.jsx(se,{delayDuration:300,children:e.jsx("div",{className:"flex flex-wrap gap-2",children:L.map((l,X)=>e.jsxs(ae,{children:[e.jsx(re,{asChild:!0,children:e.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full bg-gray-100 text-gray-700 border border-gray-200 line-clamp-1 truncate max-w-[350px] cursor-help",children:l})}),e.jsx(te,{side:"top",className:"max-w-xs",children:e.jsx("p",{className:"text-xs",children:l})})]},X))})}),e.jsx("div",{className:"mt-2",children:h.length>1?e.jsx("button",{onClick:()=>P(!f),className:"px-2.5 py-1 text-xs rounded-full bg-indigo-50 text-indigo-700 border border-indigo-200 hover:bg-indigo-100 transition-colors",children:f?"Show less":`+${h.length-1} more`}):e.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full bg-slate-50 text-slate-500 border border-slate-200",children:"1 area"})})]})]}),e.jsxs("div",{className:"flex flex-col xs:flex-row items-stretch xs:items-center gap-2 pt-3 sm:pt-4 border-t",children:[(()=>{if(m)return e.jsx("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-gray-400 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:"Processing..."});switch(u){case"connected":return e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Connected"]});case"pending_sent":return e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-gray-400 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Pending"]});case"pending_received":return e.jsxs("button",{onClick:F,className:"inline-flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700 flex-1",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Accept"]});case"not_connected":default:return e.jsxs("button",{onClick:I,className:"inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 flex-1",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Connect"]})}})(),t?s?e.jsxs(M,{className:"flex-1 border-2 border-green-500 bg-green-50 text-green-700 hover:bg-green-100",onClick:()=>c==null?void 0:c(N),children:[e.jsx(je,{className:"mr-2 h-4 w-4 fill-current"}),"Your Current Supervisor"]}):e.jsxs(M,{className:"flex-1",variant:"outline",disabled:!0,children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Request"]}):e.jsx(M,{className:"flex-1 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50",variant:"ghost",onClick:()=>N?c==null?void 0:c(N):S==null?void 0:S(a),children:N?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"mr-2 h-4 w-4"}),"View Request"]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),"Request"]})}),e.jsx(M,{type:"button",variant:"outline",size:"icon",disabled:b,onClick:()=>p==null?void 0:p(a),className:"h-10 w-10",children:b?e.jsx(ve,{className:"h-4 w-4 animate-spin"}):e.jsx(we,{className:"h-4 w-4"})})]})]})}export{hs as default};
