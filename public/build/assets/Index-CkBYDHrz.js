import{W as B,j as e,b as k,q as R,r as m,y as _}from"./app-2J6gIzrR.js";import{B as N,M as H}from"./MainLayout-DNVdqjTz.js";import{T as J}from"./TextInput-nc6Ta6ex.js";import{I as S}from"./InputError-BCkVXdvi.js";import{I as D}from"./InputLabel-CKdohjwg.js";import{P as x}from"./PrimaryButton-uUvya1yC.js";import{S as F}from"./SecondaryButton-DwZgvLcT.js";import{M as K}from"./Modal-C7lODnBm.js";import{S as Q}from"./react-select.esm-C8IAEeWH.js";import{U as C,a as V,M as X}from"./ManageCollaboratorsModal-tQHIHJ6y.js";import{C as O}from"./ConfirmationModal-Cm4nrmbV.js";import"./purify.es-B2xYLbnv.js";import{P as T,T as I}from"./trash-2-DmGea_sY.js";import{C as A}from"./clock-SYhdqwHG.js";import"./index-C55dKRcW.js";import"./useRoles-Bk4S_rmi.js";import"./analytics-BQ374C1C.js";import"./index-BD3jv0Z2.js";import"./transition-7LiKQJUu.js";function Z({isOpen:l,onClose:t}){const{data:i,setData:h,post:u,processing:c,errors:n,reset:p}=B({name:"",description:""}),d=o=>{o.preventDefault(),u(route("project-hub.workspaces.store"),{onSuccess:()=>{p(),t()}})};return l?e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:t}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md relative z-10",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Workspace"}),e.jsxs("form",{onSubmit:d,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(D,{htmlFor:"name",value:"Workspace Name"}),e.jsx(J,{id:"name",type:"text",className:"mt-1 block w-full",value:i.name,onChange:o=>h("name",o.target.value),required:!0}),e.jsx(S,{message:n.name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(D,{htmlFor:"description",value:"Description (Optional)"}),e.jsx("textarea",{id:"description",className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",value:i.description,onChange:o=>h("description",o.target.value),rows:"3"}),e.jsx(S,{message:n.description,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(F,{onClick:t,disabled:c,children:"Cancel"}),e.jsx(x,{type:"submit",disabled:c,children:c?"Creating...":"Create Workspace"})]})]})]})]}):null}function ee({show:l,onClose:t,linkableProjects:i=[]}){const{data:h,setData:u,post:c,processing:n,errors:p,reset:d}=B({post_project_id:""}),o=r=>{r.preventDefault(),c(route("project-hub.projects.store"),{onSuccess:()=>{d(),t()}})};return e.jsx(K,{show:l,onClose:t,maxWidth:"md",children:e.jsxs("form",{onSubmit:o,className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create Workspace from Project"}),e.jsxs("div",{className:"mb-6",children:[e.jsx(D,{htmlFor:"post_project_id",value:"Select a Project to Create a Workspace For",className:"mb-2"}),i.length>0?e.jsxs(e.Fragment,{children:[e.jsx(Q,{id:"post_project_id",options:i.map(r=>({value:r.id,label:r.title})),onChange:r=>u("post_project_id",r?r.value:""),className:"w-full",classNamePrefix:"select",placeholder:"Select a project...",required:!0}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"The workspace will inherit the title and description from the selected project."})]}):e.jsxs("div",{className:"text-amber-600 py-4 px-3 bg-amber-50 border border-amber-200 rounded-md",children:[e.jsx("p",{className:"mb-3",children:"You don't have any projects available for linking. Please create a project first."}),e.jsx(k,{href:route("post-projects.create"),className:"inline-flex items-center px-4 py-2 bg-amber-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-amber-700 focus:bg-amber-700 active:bg-amber-900 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 transition ease-in-out duration-150",children:"Create Project"})]}),e.jsx(S,{message:p.post_project_id,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx(F,{onClick:t,className:"mr-2",children:"Cancel"}),e.jsx(x,{type:"submit",disabled:n||i.length===0,children:"Create Workspace"})]})]})})}function se({workspaces:l,projects:t,linkableProjects:i,connections:h}){const u=Array.isArray(l)?l:(l==null?void 0:l.data)||[],c=Array.isArray(t)?t:(t==null?void 0:t.data)||[],{auth:n}=R().props,[p,d]=m.useState(!1),[o,r]=m.useState(!1),[j,w]=m.useState(null),[g,v]=m.useState(null),[L,P]=m.useState(!1),[z,M]=m.useState(null),[q,W]=m.useState(null),y=n.user.academician!==null,E=(s,a)=>{s.preventDefault(),s.stopPropagation(),w(a)},U=()=>{j&&_.delete(route("workspaces.destroy",j.id),{onSuccess:()=>{w(null)}})},Y=(s,a)=>{s.preventDefault(),s.stopPropagation(),v(a)},$=()=>{g&&_.delete(route("project-hub.projects.destroy",g.id),{onSuccess:()=>{v(null)}})},G=(s,a,f)=>{s.preventDefault(),s.stopPropagation(),M(a),W(f),P(!0)};return e.jsxs("div",{className:"space-y-8 lg:mt-2 mt-20",children:[e.jsxs("div",{className:"space-y-6 lg:mx-0 mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 pl-2",children:"Your Workspaces"}),e.jsx("div",{className:"space-x-2",children:e.jsxs(x,{onClick:()=>d(!0),children:[e.jsx(T,{className:"w-4 h-4 mr-2"})," New Workspace"]})})]}),u.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"mx-auto bg-gray-100 rounded-full w-16 h-16 flex items-center justify-center",children:e.jsx(C,{className:"w-8 h-8 text-gray-500"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No workspaces yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first workspace to start organizing your projects."}),e.jsxs("div",{className:"space-x-2",children:[y&&e.jsxs(x,{onClick:()=>r(!0),children:[e.jsx(N,{className:"w-4 h-4 mr-2"})," Create Project"]}),e.jsxs(x,{onClick:()=>d(!0),children:[e.jsx(T,{className:"w-4 h-4 mr-2"})," Create Workspace"]})]})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(s=>{const a=s.owner.academician||s.owner.postgraduate||s.owner.undergraduate,f=(a==null?void 0:a.full_name)||s.owner.name;return e.jsxs("div",{className:"relative bg-white shadow rounded-lg hover:shadow-md transition-shadow duration-200",children:[e.jsxs(k,{href:route("project-hub.workspaces.show",s.id),className:"block p-5",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1 truncate pr-12",children:s.name}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mt-3",children:[e.jsxs("div",{className:"flex items-center mr-4 truncate",children:[e.jsx(C,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{children:["Owner: ",f]})]}),e.jsxs("div",{className:"flex items-center ml-auto",children:[e.jsx(A,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString("en-GB")})]})]})]}),e.jsx("div",{className:"absolute top-2 right-2 flex space-x-1",children:n.user.id===s.owner_id&&e.jsx("button",{onClick:b=>E(b,s),className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-gray-100 rounded-full",title:"Delete workspace",children:e.jsx(I,{className:"w-4 h-4"})})})]},s.id)})})]}),e.jsxs("div",{className:"space-y-6 lg:mx-0 mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 pl-2",children:"Your Projects"}),e.jsx("div",{className:"space-x-2",children:y&&e.jsxs(x,{onClick:()=>r(!0),children:[e.jsx(N,{className:"w-4 h-4 mr-2"})," New Project"]})})]}),c.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"mx-auto bg-gray-100 rounded-full w-16 h-16 flex items-center justify-center",children:e.jsx(N,{className:"w-8 h-8 text-gray-500"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No projects yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first project to start organizing your research."}),e.jsx("div",{className:"space-x-2",children:y&&e.jsxs(x,{onClick:()=>r(!0),children:[e.jsx(N,{className:"w-4 h-4 mr-2"})," Create Project"]})})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(s=>{const a=s.owner.academician||s.owner.postgraduate||s.owner.undergraduate,f=(a==null?void 0:a.full_name)||s.owner.name;return e.jsxs("div",{className:"relative bg-blue-50 shadow rounded-lg hover:shadow-md transition-shadow duration-200",children:[e.jsxs(k,{href:route("project-hub.projects.show",s.id),className:"block p-5",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1 truncate pr-12",children:s.name}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mt-3",children:[e.jsxs("div",{className:"flex items-center mr-4 truncate",children:[e.jsx(C,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{children:["Owner: ",f]})]}),e.jsxs("div",{className:"flex items-center ml-auto",children:[e.jsx(A,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString("en-GB")})]})]})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex space-x-1",children:[n.user.id===s.owner_id&&e.jsx("button",{onClick:b=>G(b,s,"project"),className:"p-1.5 text-gray-400 hover:text-blue-500 hover:bg-blue-100 rounded-full",title:"Manage members",children:e.jsx(V,{className:"w-4 h-4"})}),n.user.id===s.owner_id&&e.jsx("button",{onClick:b=>Y(b,s),className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-blue-100 rounded-full",title:"Delete project",children:e.jsx(I,{className:"w-4 h-4"})})]})]},s.id)})})]}),e.jsx(Z,{isOpen:p,onClose:()=>d(!1)}),e.jsx(ee,{show:o,onClose:()=>r(!1),linkableProjects:i||[]}),e.jsx(X,{show:L,onClose:()=>{P(!1),M(null),W(null)},context:z,contextType:q,connections:h||[]}),e.jsx(O,{show:!!j,onClose:()=>w(null),onConfirm:U,title:"Delete Workspace",message:j?`Are you sure you want to delete the workspace "${j.name}"? This action cannot be undone and will delete all boards and tasks within this workspace.`:""}),e.jsx(O,{show:!!g,onClose:()=>v(null),onConfirm:$,title:"Delete Project",message:g?`Are you sure you want to delete the project "${g.name}"? This action cannot be undone and will delete all boards and tasks within this project.`:""})]})}se.layout=l=>e.jsx(H,{title:"Scholar Lab",children:l,TopMenuOpen:!1});export{se as default};
