import{j as e,a as g,q as E,r as h,W as T,Y as z,y as B}from"./app-BR0IGn4V.js";import{A as P}from"./ApplicationLogo-BKztJp0-.js";import{D as x}from"./Dropdown-CFeQSfYS.js";import{R as O}from"./quill.snow-BBaKvx-P.js";import"./transition-Bw7UO5Rk.js";function W({active:l=!1,className:i="",children:n,...a}){return e.jsx(g,{...a,className:"inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium leading-5 transition duration-150 ease-in-out focus:outline-none "+(l?"border-indigo-400 text-gray-900 focus:border-indigo-700":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 focus:border-gray-300 focus:text-gray-700")+i,children:n})}function p({active:l=!1,className:i="",children:n,...a}){return e.jsx(g,{...a,className:`flex w-full items-start border-l-4 py-2 pe-4 ps-3 ${l?"border-indigo-400 bg-indigo-50 text-indigo-700 focus:border-indigo-700 focus:bg-indigo-100 focus:text-indigo-800":"border-transparent text-gray-600 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-800 focus:border-gray-300 focus:bg-gray-50 focus:text-gray-800"} text-base font-medium transition duration-150 ease-in-out focus:outline-none ${i}`,children:n})}function $({header:l,children:i}){const n=E().props.auth.user,[a,d]=h.useState(!1);return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsxs("nav",{className:"border-b border-gray-100 bg-white",children:[e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex h-16 justify-between",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex shrink-0 items-center",children:e.jsx(g,{href:"/",children:e.jsx(P,{className:"block h-9 w-auto fill-current text-gray-800"})})}),e.jsx("div",{className:"hidden space-x-8 sm:-my-px sm:ms-10 sm:flex",children:e.jsx(W,{href:route("dashboard"),active:route().current("dashboard"),children:"Dashboard"})})]}),e.jsx("div",{className:"hidden sm:ms-6 sm:flex sm:items-center",children:e.jsx("div",{className:"relative ms-3",children:e.jsxs(x,{children:[e.jsx(x.Trigger,{children:e.jsx("span",{className:"inline-flex rounded-md",children:e.jsxs("button",{type:"button",className:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none",children:[n.name,e.jsx("svg",{className:"-me-0.5 ms-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})}),e.jsxs(x.Content,{children:[e.jsx(x.Link,{href:route("profile.edit"),children:"Profile"}),e.jsx(x.Link,{href:route("logout"),method:"post",as:"button",children:"Log Out"})]})]})})}),e.jsx("div",{className:"-me-2 flex items-center sm:hidden",children:e.jsx("button",{onClick:()=>d(o=>!o),className:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 transition duration-150 ease-in-out hover:bg-gray-100 hover:text-gray-500 focus:bg-gray-100 focus:text-gray-500 focus:outline-none",children:e.jsxs("svg",{className:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("path",{className:a?"hidden":"inline-flex",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"}),e.jsx("path",{className:a?"inline-flex":"hidden",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})]})})})]})}),e.jsxs("div",{className:(a?"block":"hidden")+" sm:hidden",children:[e.jsx("div",{className:"space-y-1 pb-3 pt-2",children:e.jsx(p,{href:route("dashboard"),active:route().current("dashboard"),children:"Dashboard"})}),e.jsxs("div",{className:"border-t border-gray-200 pb-1 pt-4",children:[e.jsxs("div",{className:"px-4",children:[e.jsx("div",{className:"text-base font-medium text-gray-800",children:n.name}),e.jsx("div",{className:"text-sm font-medium text-gray-500",children:n.email})]}),e.jsxs("div",{className:"mt-3 space-y-1",children:[e.jsx(p,{href:route("profile.edit"),children:"Profile"}),e.jsx(p,{method:"post",href:route("logout"),as:"button",children:"Log Out"})]})]})]})]}),l&&e.jsx("header",{className:"bg-white shadow",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:l})}),e.jsx("main",{children:i})]})}function G({auth:l,to:i,replyTo:n}){const[a,d]=h.useState([]),[o,u]=h.useState(null),{data:c,setData:f,post:S,processing:j,errors:b,reset:D}=T({to:i,subject:"",message:""});h.useEffect(()=>{if(o){const t=setTimeout(()=>{u(null)},5e3);return()=>clearTimeout(t)}},[o]);const A=t=>{t.preventDefault();const r=new FormData;r.append("to",c.to),r.append("subject",c.subject),r.append("message",c.message),console.log("Number of attachments:",a.length),a.forEach((s,m)=>{console.log(`Attaching file ${m+1}:`,{name:s.name,size:s.size,type:s.type}),r.append("attachments[]",s)}),console.log("FormData entries:");for(let s of r.entries())console.log(s[0],s[1]);S(route("email.send"),{data:r,forceFormData:!0,preserveScroll:!0,preserveState:!0,headers:{Accept:"application/json"},onBefore:()=>{console.log("Preparing to send...")},onSuccess:s=>{var v,N,w,k,L,C;console.log("Success response:",s);const m=(N=(v=s.props)==null?void 0:v.flash)==null?void 0:N.success,R=(k=(w=s.props)==null?void 0:w.flash)==null?void 0:k.error,y=(C=(L=s.props)==null?void 0:L.flash)==null?void 0:C.message;m?(o("Email sent successfully."),u({type:"success",message:y}),d([]),D("subject","message"),setTimeout(()=>{B.reload()},2e3)):R&&u({type:"error",message:y})},onError:s=>{console.error("Form errors:",s),o("Failed to send email. Please check your input and try again."),u({type:"error",message:"Failed to send email. Please check your input and try again."})},onFinish:()=>{console.log("Request finished")}})},F=t=>{const r=Array.from(t.target.files);console.log("Files selected:",r.map(s=>({name:s.name,size:s.size,type:s.type}))),d(s=>[...s,...r])},M=t=>{d(r=>r.filter((s,m)=>m!==t))};return e.jsxs($,{user:l.user,children:[e.jsx(z,{title:"Compose Email"}),e.jsxs("div",{className:"max-w-7xl mx-auto p-4",children:[o&&e.jsx("div",{className:`mb-4 p-4 rounded-lg ${o.type==="success"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:o.message}),e.jsx("div",{className:"bg-white rounded-lg shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Compose Message"}),e.jsx("hr",{className:"my-4 border-gray-200"}),e.jsx("form",{onSubmit:A,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center py-2",children:[e.jsx("label",{className:"w-20 text-gray-600",children:"To:"}),e.jsx("input",{type:"email",value:c.to,readOnly:!0,className:"flex-1 outline-none bg-transparent"})]}),e.jsx("hr",{className:"border-gray-200"}),e.jsxs("div",{className:"flex items-center py-2",children:[e.jsx("label",{className:"w-20 text-gray-600",children:"Reply-To:"}),e.jsx("input",{type:"email",value:n,readOnly:!0,className:"flex-1 outline-none bg-transparent"})]}),e.jsx("hr",{className:"border-gray-200"}),e.jsxs("div",{className:"flex items-center py-2",children:[e.jsx("label",{className:"w-20 text-gray-600",children:"Subject:"}),e.jsx("input",{type:"text",value:c.subject,onChange:t=>f("subject",t.target.value),className:"flex-1 outline-none",required:!0})]}),e.jsx("hr",{className:"border-gray-200"}),e.jsx("div",{className:"py-2",children:e.jsx("label",{className:"text-gray-600",children:"Message:"})}),e.jsx("div",{className:"min-h-[400px]",children:e.jsx(O,{theme:"snow",value:c.message,onChange:t=>f("message",t),placeholder:"Type your message here...",style:{height:"300px",maxHeight:"300px"}})}),e.jsx("hr",{className:"border-gray-200 mt-8"}),e.jsxs("div",{className:"py-4",children:[e.jsx("label",{className:"block text-gray-600 mb-2",children:"Attachments:"}),e.jsx("input",{type:"file",onChange:F,multiple:!0,className:`block w-full text-sm text-gray-500
                                            file:mr-4 file:py-2 file:px-4
                                            file:rounded-full file:border-0
                                            file:text-sm file:font-semibold
                                            file:bg-blue-50 file:text-blue-700
                                            hover:file:bg-blue-100`}),b.attachments&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:b.attachments}),a.length>0&&e.jsx("div",{className:"mt-2 space-y-2",children:a.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[t.name," (",(t.size/1024/1024).toFixed(2)," MB)"]}),e.jsx("button",{type:"button",onClick:()=>M(r),className:"text-red-500 hover:text-red-700",children:"Ã—"})]},r))})]}),e.jsx("hr",{className:"border-gray-200"}),e.jsx("div",{className:"flex items-center space-x-4 pt-4",children:e.jsxs("button",{type:"submit",disabled:j,className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 flex items-center space-x-2",children:[e.jsx("span",{children:j?"Sending...":"Send"}),e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 10l7-7m0 0l7 7m-7-7v18"})})]})})]})})]})})]})]})}export{G as default};
