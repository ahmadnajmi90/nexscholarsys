import{r as a,a as x,j as s}from"./app-Dr9IfFf8.js";import{I as A}from"./InputLabel-BHKwTOwE.js";import{I as G}from"./InputError-Cuo1V5BZ.js";function P({value:o=[],onChange:g,error:N=null,required:p=!1,label:w="Skills",placeholder:C="Select skills..."}){const[D,E]=a.useState([]),[L,m]=a.useState([]),[b,c]=a.useState([]),[j,R]=a.useState(""),[y,v]=a.useState(""),[i,h]=a.useState(o||[]),[d,r]=a.useState({domains:!1,subdomains:!1,skills:!1}),[f,S]=a.useState(!1),[$,u]=a.useState({});a.useEffect(()=>{z()},[]),a.useEffect(()=>{o&&o.length>0&&(h(o),M(o))},[o]);const z=async()=>{r(e=>({...e,domains:!0}));try{const e=await x.get("/api/v1/app/skills/domains");E(e.data.data||[])}catch(e){console.error("Error fetching domains:",e)}finally{r(e=>({...e,domains:!1}))}},B=async e=>{if(!e){m([]);return}r(t=>({...t,subdomains:!0}));try{const t=await x.get(`/api/v1/app/skills/domains/${e}/subdomains`);m(t.data.data||[])}catch(t){console.error("Error fetching subdomains:",t),m([])}finally{r(t=>({...t,subdomains:!1}))}},F=async e=>{if(!e){c([]);return}r(t=>({...t,skills:!0}));try{const t=await x.get(`/api/v1/app/skills/subdomains/${e}/skills`);c(t.data.data||[])}catch(t){console.error("Error fetching skills:",t),c([])}finally{r(t=>({...t,skills:!1}))}},M=async e=>{if(!e||e.length===0){u({});return}try{const t=await x.post("/api/v1/app/skills/details",{skill_ids:e}),l={};t.data.data.forEach(n=>{l[n.id]=n}),u(l)}catch(t){console.error("Error fetching skill details:",t)}},O=e=>{R(e),v(""),m([]),c([]),e&&B(e)},T=e=>{v(e),c([]),e&&F(e)},W=e=>{const t=i.includes(e.id);let l;t?l=i.filter(n=>n!==e.id):l=[...i,e.id],h(l),g(l),t||u(n=>({...n,[e.id]:e}))},_=e=>{const t=i.filter(l=>l!==e);h(t),g(t),u(l=>{const n={...l};return delete n[e],n})};return s.jsxs("div",{className:"w-full",children:[s.jsx(A,{htmlFor:"skills-selector",value:s.jsxs(s.Fragment,{children:[w," ",p&&s.jsx("span",{className:"text-red-600",children:"*"})]}),required:p}),i.length>0&&s.jsx("div",{className:"mt-2 mb-3",children:s.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(e=>{var l,n,k;const t=$[e];return t?s.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[s.jsxs("span",{className:"mr-2",children:[(n=(l=t.subdomain)==null?void 0:l.domain)==null?void 0:n.name," → ",(k=t.subdomain)==null?void 0:k.name," → ",t.name]}),s.jsxs("button",{type:"button",onClick:()=>_(e),className:"flex-shrink-0 ml-1 h-4 w-4 rounded-full inline-flex items-center justify-center text-blue-400 hover:bg-blue-200 hover:text-blue-600 focus:outline-none focus:bg-blue-500 focus:text-white",children:[s.jsx("span",{className:"sr-only",children:"Remove skill"}),s.jsx("svg",{className:"h-2 w-2",stroke:"currentColor",fill:"none",viewBox:"0 0 8 8",children:s.jsx("path",{strokeLinecap:"round",strokeWidth:"1.5",d:"m1 1 6 6m0-6-6 6"})})]})]},e):null})})}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{type:"button",onClick:()=>S(!f),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white text-left focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[s.jsx("span",{className:"block truncate text-gray-500",children:C}),s.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:s.jsx("svg",{className:`h-5 w-5 text-gray-400 transition-transform ${f?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),f&&s.jsxs("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-96 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm",children:[s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Domain"}),s.jsxs("select",{value:j,onChange:e=>O(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",disabled:d.domains,children:[s.jsx("option",{value:"",children:"Choose a domain..."}),D.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),d.domains&&s.jsx("div",{className:"mt-1 text-xs text-gray-500",children:"Loading domains..."})]}),j&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Subdomain"}),s.jsxs("select",{value:y,onChange:e=>T(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",disabled:d.subdomains,children:[s.jsx("option",{value:"",children:"Choose a subdomain..."}),L.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),d.subdomains&&s.jsx("div",{className:"mt-1 text-xs text-gray-500",children:"Loading subdomains..."})]}),y&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Skills (Multiple)"}),d.skills?s.jsx("div",{className:"text-sm text-gray-500",children:"Loading skills..."}):s.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-300 rounded-md",children:b.length===0?s.jsx("div",{className:"p-3 text-sm text-gray-500",children:"No skills available in this subdomain"}):b.map(e=>{const t=i.includes(e.id);return s.jsxs("label",{className:`flex items-center p-3 hover:bg-gray-50 cursor-pointer ${t?"bg-blue-50":""}`,children:[s.jsx("input",{type:"checkbox",checked:t,onChange:()=>W(e),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),s.jsxs("span",{className:"ml-3 text-sm",children:[e.name,e.description&&s.jsx("span",{className:"block text-xs text-gray-500 mt-1",children:e.description})]})]},e.id)})})]})]}),s.jsx("div",{className:"border-t border-gray-200 p-3",children:s.jsx("button",{type:"button",onClick:()=>S(!1),className:"w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Done"})})]})]}),s.jsx(G,{className:"mt-2",message:N}),i.length>0&&s.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:[i.length," skill",i.length!==1?"s":""," selected"]})]})}export{P as S};
