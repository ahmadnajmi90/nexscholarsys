import{r as h,j as e,y as q}from"./app-A8xQkvSk.js";import{C as L,a as I,b as z,c as R}from"./card-DyHgWaPU.js";import{B as E}from"./badge-CFoP9Krf.js";import{B as N}from"./button-Dz_rydmG.js";import{A as G,a as J}from"./avatar-CbIr_OjG.js";import"./separator-B59s4oDI.js";import{A as K,a as Q}from"./alert-BBFXwXFc.js";import V from"./StudentRelationshipDetailModal-B0PYuNue.js";import W from"./UniversityLetterUploadModal-CgNwqMmA.js";import X from"./ScheduleMeetingDialog-C9eLZHwe.js";import"./index-Km-vM6Jb.js";import{c as Z}from"./createLucideIcon-DPzobtnR.js";import{U as D}from"./users-BaMPipud.js";import{C as H}from"./calendar-clock-BwBj7N73.js";import{C as O}from"./clipboard-list-BtJRjBIa.js";import{F as Y}from"./file-text-BfC4OSQU.js";import{U as ee}from"./upload-DLfp_NaM.js";import{M as te}from"./message-circle-BHBy_nP-.js";import{S as se}from"./settings-CbyQhbcQ.js";import"./utils-CIsb_jhR.js";import"./clsx-B-dksMZM.js";import"./index-Dp3B9jqt.js";import"./index-7Qlnuq3l.js";import"./tabs-Cbyzn-fX.js";import"./index-BEzQHz4a.js";import"./index-CG1gsK_f.js";import"./index-DwuY8lh1.js";import"./index-OrEFxIKi.js";import"./index-DMPy21CI.js";import"./index-B0SlzLk6.js";import"./scroll-area-COMlVIOb.js";import"./ResearchTab-B4EYMRFM.js";import"./input-D2p8biwd.js";import"./textarea-DGdKxzUN.js";import"./logError-D4ezqrCx.js";import"./loader-circle-DkpR38mE.js";import"./plus-BqbQZKPX.js";import"./trash-2-XEAf-v5f.js";import"./circle-check-ddCD_g9w.js";import"./circle-eov79Dsa.js";import"./calendar-EpaZ4Aad.js";import"./format-hTuirObu.js";import"./en-US-DNUEYIb-.js";import"./DocumentsTab-B11iV4A2.js";import"./select-BBDf1Ygo.js";import"./index-BlKfbGK4.js";import"./Combination-Bf5eV4ml.js";import"./tslib.es6-CmEaCU22.js";import"./index-Cp2nhW7C.js";import"./floating-ui.dom-eiE65J5j.js";import"./index-Db3xrL5F.js";import"./index-rTP0VXgG.js";import"./chevron-down-qnEAqpL2.js";import"./chevron-up-hxgrcUwj.js";import"./check-BeDd_wJ7.js";import"./Modal-D_n_zj3N.js";import"./dialog-BkDQGxoj.js";import"./transition-Bvb6H6Z4.js";import"./DocumentPreviewModal-CPJtZlTY.js";import"./download-CMnE0euH.js";import"./x-vL7g-LuD.js";import"./chevron-right-Mpml_Nmb.js";import"./folder-open-Bj-Qb-PO.js";import"./eye-B05lsJ9f.js";import"./history-BxBz3cCN.js";import"./ThreadPane-CPpSuURI.js";import"./AttachmentPreviewModal-CXErbNPv.js";import"./StudentOverviewTab-B7N66E49.js";import"./user-round-CEZUuFcg.js";import"./briefcase-CfUq1pnR.js";import"./mail-Dtimj1fp.js";import"./phone-D1xIudn-.js";import"./graduation-cap-the7C-yQ.js";import"./UnbindRequestModal-2eYhJEIj.js";import"./triangle-alert-BND9SWEh.js";import"./tooltip-Oo0Wz_lE.js";import"./video-DL3IJgDp.js";import"./external-link-RAq8nM7x.js";import"./label-BcrT7TVM.js";import"./circle-alert-CPnO62Yc.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],oe=Z("UserCheck",re);function Pt({relationships:t=[],reload:s,onOpenDetail:k,onOpenMeetings:d}){const[n,m]=h.useState(null),[i,v]=h.useState("overview"),[f,p]=h.useState(!1),a=h.useMemo(()=>Array.isArray(t)?t.filter(c=>c.status==="active"):[],[t]),x=h.useMemo(()=>{const c=a.filter(o=>o.role==="main").length,j=a.filter(o=>o.role==="co"||o.role==="co-supervisor").length,w=new Date,A=w.getMonth(),T=w.getFullYear(),P=a.reduce((o,l)=>{if(l.meetings&&Array.isArray(l.meetings)){const g=l.meetings.filter(u=>{if(!u.scheduled_for)return!1;const b=new Date(u.scheduled_for);return b.getMonth()===A&&b.getFullYear()===T});return o+g.length}return o},0),F=a.reduce((o,l)=>{if(l.onboarding_checklist_items&&Array.isArray(l.onboarding_checklist_items)){const g=l.onboarding_checklist_items.filter(u=>!u.completed);return o+g.length}return o},0);return{primaryCount:c,coSupervisorCount:j,meetingsThisMonth:P,pendingTasks:F}},[a]),S=(c,j="overview")=>{m(c),v(j)},_=()=>{m(null),v("overview")},C=()=>{s==null||s()},y=()=>{p(!1)},U=()=>{p(!1),m(null),s==null||s()};return a.length?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(M,{value:x.primaryCount,label:"Primary Supervisors",icon:oe,iconColor:"text-indigo-600",bgColor:"bg-indigo-50"}),e.jsx(M,{value:x.coSupervisorCount,label:"Co-supervisors",icon:D,iconColor:"text-blue-600",bgColor:"bg-blue-50"}),e.jsx(M,{value:x.meetingsThisMonth,label:"Meetings this Month",icon:H,iconColor:"text-green-600",bgColor:"bg-green-50"}),e.jsx(M,{value:x.pendingTasks,label:"Pending Tasks",icon:O,iconColor:"text-amber-600",bgColor:"bg-amber-50"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map(c=>e.jsx(ae,{relationship:c,onOpenDetail:S,onOpenMeetings:d,reload:s},c.id))}),n&&e.jsx(V,{relationship:n,onClose:_,onUpdated:C,defaultTab:i}),f&&n&&e.jsx(X,{relationship:n,onClose:y,onScheduled:U,userRole:"student"})]}):e.jsxs(L,{className:"border-dashed border-slate-200",children:[e.jsx(I,{children:e.jsx(z,{className:"text-lg font-semibold text-slate-800",children:"You do not have an active supervisor yet"})}),e.jsx(R,{className:"text-sm text-slate-600",children:"Once a supervisor accepts your proposal, their details will appear here and the management tools will unlock."})]})}function M({value:t,label:s,icon:k,iconColor:d,bgColor:n}){return e.jsx(L,{className:"border-slate-200 shadow-sm",children:e.jsx(R,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-slate-900",children:t}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:s})]}),e.jsx("div",{className:`${n} p-3 rounded-lg`,children:e.jsx(k,{className:`h-6 w-6 ${d}`})})]})})})}function ae({relationship:t,onOpenDetail:s,onOpenMeetings:k,reload:d}){var l,g,u,b,$,B;const[n,m]=h.useState(!1),i=(t==null?void 0:t.academician)??{},v=i.profile_picture?`/storage/${i.profile_picture}`:null,f=i.full_name??"Supervisor",p=((l=i.university)==null?void 0:l.name)||((g=i.university)==null?void 0:g.full_name)||"",a=i.department||"",x=((u=i.research_domains)==null?void 0:u[0])||"",S=(t==null?void 0:t.role)==="main"?"Main":"Co-supervisor",_="Accepted by Student",C=(t==null?void 0:t.cohort)||"",y=t!=null&&t.meeting_cadence?t.meeting_cadence.charAt(0).toUpperCase()+t.meeting_cadence.slice(1):"",U=!!(t!=null&&t.university_letter_path),c=f.split(" ").map(r=>r[0]).join("").toUpperCase().slice(0,3),j=((b=t==null?void 0:t.meetings)==null?void 0:b.length)||0,w=(($=t==null?void 0:t.onboarding_checklist_items)==null?void 0:$.filter(r=>!r.completed).length)||0,A=((B=t==null?void 0:t.documents)==null?void 0:B.length)||0,T=()=>{t!=null&&t.conversation_id&&(s==null||s(t,"chat"))},P=()=>{s==null||s(t,"overview"),setTimeout(()=>{m(!1);const r=new CustomEvent("open-schedule-meeting",{detail:{relationship:t}});window.dispatchEvent(r)},100)},F=()=>{s==null||s(t,"documents")},o=()=>{q.visit(route("supervision.relationships.show",t.id))};return e.jsxs(e.Fragment,{children:[e.jsxs(L,{className:"shadow-sm hover:shadow-md transition-shadow cursor-pointer",onClick:()=>s==null?void 0:s(t,"overview"),children:[e.jsx(I,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx(G,{className:"h-14 w-14 border-2 border-slate-200",children:v?e.jsx("img",{src:v,alt:f,className:"h-full w-full object-cover"}):e.jsx(J,{className:"bg-indigo-100 text-indigo-700 font-semibold text-sm",children:c})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 truncate mb-1",children:f}),e.jsx("p",{className:"text-sm text-slate-600 truncate",children:p&&a?`${p} • ${a}`:p||a||"University"}),x&&e.jsx("p",{className:"text-xs text-slate-500 mt-1.5 line-clamp-1",children:x})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1.5 flex-shrink-0",children:[e.jsx(E,{className:"bg-slate-900 text-white border-none hover:bg-slate-800 px-3 py-1",children:S}),e.jsx(E,{className:"bg-green-50 text-green-700 border-green-200 border px-3 py-1",children:_}),C&&y&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[C," • ",y]})]})]})}),e.jsxs(R,{className:"space-y-5 pb-5",children:[!U&&e.jsxs(K,{className:"bg-blue-50 border-blue-200",children:[e.jsx(Y,{className:"h-4 w-4 text-blue-600"}),e.jsx(Q,{className:"text-sm",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold mb-1 text-blue-900",children:"University Letter"}),e.jsx("p",{className:"text-blue-700 text-xs",children:"Upload your official university offer/appointment letter to complete validation."}),e.jsx("p",{className:"text-sm text-slate-900 mt-2 font-medium",children:"No letter uploaded yet"})]}),e.jsx("div",{children:e.jsxs(N,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",onClick:r=>{r.stopPropagation(),m(!0)},children:[e.jsx(ee,{className:"mr-1.5 h-3 w-3"}),"Upload Letter"]})})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-slate-50",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:j}),e.jsx("div",{className:"text-xs text-slate-600 mt-1.5",children:"Meetings"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-slate-50",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:w}),e.jsx("div",{className:"text-xs text-slate-600 mt-1.5",children:"Tasks"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-slate-50",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:A}),e.jsx("div",{className:"text-xs text-slate-600 mt-1.5",children:"Documents"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(N,{variant:"outline",className:"w-full",onClick:r=>{r.stopPropagation(),P()},children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Schedule Meeting"]}),e.jsxs(N,{variant:"outline",className:"w-full",onClick:r=>{r.stopPropagation(),T()},children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Chat"]}),e.jsxs(N,{variant:"outline",className:"w-full",onClick:r=>{r.stopPropagation(),F()},children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Share Document"]}),e.jsxs(N,{variant:"outline",className:"w-full",onClick:r=>{r.stopPropagation(),o()},children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Manage"]})]})]})]}),e.jsx(W,{isOpen:n,relationship:t,onClose:()=>m(!1),onUploaded:()=>{m(!1),d==null||d()}})]})}export{Pt as default};
