import{r as j,j as e,b as S}from"./app-A8xQkvSk.js";import{c as m}from"./index-Km-vM6Jb.js";import{M as w}from"./Modal-D_n_zj3N.js";import{B as b}from"./button-Dz_rydmG.js";import{T as R}from"./textarea-DGdKxzUN.js";import{A as M,a as q}from"./alert-BBFXwXFc.js";import{l as C}from"./logError-D4ezqrCx.js";import{c as _}from"./createLucideIcon-DPzobtnR.js";import{T as k}from"./triangle-alert-BND9SWEh.js";import{L as T}from"./loader-circle-DkpR38mE.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],D=_("UserMinus",A);function L({isOpen:f,relationship:s,onClose:v,onUnbindInitiated:c,userRole:N="supervisor"}){const[t,x]=j.useState(""),[r,u]=j.useState(!1),o=()=>{r||(x(""),v())},g=async()=>{var n,p;if(!t.trim()||t.trim().length<10){m.error("Please provide a detailed reason (at least 10 characters)");return}u(!0);try{const a=await S.post(route("supervision.relationships.unbind.initiate",s.id),{reason:t.trim()});a.data.success&&(m.success(a.data.message),c==null||c(),o())}catch(a){C(a,"UnbindRequestModal handleSubmit");const y=((p=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:p.message)||"Failed to initiate unbind request";m.error(y)}finally{u(!1)}};if(!s)return null;const l=N==="supervisor",d=l?s==null?void 0:s.student:s==null?void 0:s.academician,h=(d==null?void 0:d.full_name)||(l?"Student":"Supervisor"),i=l?"student":"supervisor";return e.jsx(w,{show:f,onClose:o,maxWidth:"2xl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"p-3 bg-red-50 rounded-full",children:e.jsx(D,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Remove Supervision Relationship"}),e.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:["Initiate an unbind request with ",h]})]})]}),e.jsxs(M,{className:"mb-6 border-amber-200 bg-amber-50",children:[e.jsx(k,{className:"h-4 w-4 text-amber-600"}),e.jsx(q,{className:"text-amber-800",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-semibold",children:"Important Information:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsxs("li",{children:["The ",i," must approve this request before the relationship is terminated"]}),e.jsxs("li",{children:["If the ",i," rejects, you'll need to wait 30 days before requesting again"]}),e.jsxs("li",{children:["After 3 rejected attempts, the relationship will be force-terminated without ",i," approval"]})]})]})})]}),e.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Relationship Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[l?"Student":"Supervisor",":"]}),e.jsx("span",{className:"ml-2 font-medium text-slate-900",children:h})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Role:"}),e.jsx("span",{className:"ml-2 font-medium text-slate-900",children:s.role==="main"?"Main Supervisor":"Co-Supervisor"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Started:"}),e.jsx("span",{className:"ml-2 font-medium text-slate-900",children:s.accepted_at?new Date(s.accepted_at).toLocaleDateString("en-GB"):"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500",children:"Cohort:"}),e.jsx("span",{className:"ml-2 font-medium text-slate-900",children:s.cohort||"—"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Reason for Unbinding ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(R,{rows:5,value:t,onChange:n=>x(n.target.value),placeholder:`Please provide a detailed explanation for why you want to end this supervision relationship. This will be shared with the ${i}.`,className:"resize-none",disabled:r}),e.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:[t.length,"/1000 characters · Minimum 10 characters required"]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(b,{variant:"outline",onClick:o,disabled:r,children:"Cancel"}),e.jsxs(b,{onClick:g,disabled:r||!t.trim()||t.trim().length<10,className:"bg-red-600 hover:bg-red-700 text-white",children:[r&&e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Send Unbind Request"]})]})]})})}const H=Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"}));export{D as U,L as a,H as b};
