import{q as Te,W as Ue,r as d,a as N,j as e,R as Ee}from"./app-BUFdZL-v.js";import{T as j,I as u}from"./TextInput-DiKs7My7.js";import{I as m}from"./InputLabel-BjS1i7qA.js";import{P as Re}from"./PrimaryButton-DjqEJ0Es.js";import{S as ae}from"./react-select.esm-CWTBDCFA.js";import Ae from"./CVPreviewModal-3X4aZoA_.js";import{z as S}from"./transition-CyxB6SPY.js";function He({className:le="",researchOptions:B,aiGenerationInProgress:F,aiGenerationMethod:O,generatedProfileData:p}){var Z;const l=Te().props.academician,{data:r,setData:i,post:P,errors:c,processing:re,recentlySuccessful:oe}=Ue({phone_number:(l==null?void 0:l.phone_number)||"",full_name:(l==null?void 0:l.full_name)||"",profile_picture:(l==null?void 0:l.profile_picture)||"",research_expertise:typeof(l==null?void 0:l.research_expertise)=="string"?JSON.parse(l==null?void 0:l.research_expertise):l==null?void 0:l.research_expertise,field_of_study:(l==null?void 0:l.field_of_study)||"",highest_degree:(l==null?void 0:l.highest_degree)||"",personal_website:(l==null?void 0:l.personal_website)||(l==null?void 0:l.website)||"",institution_website:(l==null?void 0:l.institution_website)||"",linkedin:(l==null?void 0:l.linkedin)||"",google_scholar:(l==null?void 0:l.google_scholar)||"",researchgate:(l==null?void 0:l.researchgate)||"",bio:(l==null?void 0:l.bio)||"",current_position:(l==null?void 0:l.current_position)||"",department:(l==null?void 0:l.department)||"",availability_as_supervisor:(l==null?void 0:l.availability_as_supervisor)||!1,style_of_supervision:(l==null?void 0:l.style_of_supervision)||"",background_image:(l==null?void 0:l.background_image)||"",CV_file:(l==null?void 0:l.CV_file)||""}),[ie,M]=d.useState(!1),[T,ne]=d.useState("auto"),[U,q]=d.useState([""]),[C,x]=d.useState(!1),[de,E]=d.useState(!1),[W,R]=d.useState(!1),[X,H]=d.useState(!1);d.useState(!1);const[Le,ce]=d.useState(null),[ze,ue]=d.useState(null),[Ie,me]=d.useState(!1),w=d.useRef(!1);d.useEffect(()=>{p&&!w.current&&(console.log("Applying generated profile data:",p),i(s=>({...s,full_name:r.full_name,phone_number:p.phone_number||s.phone_number,bio:p.bio||s.bio,current_position:p.current_position||s.current_position,department:p.department||s.department,highest_degree:p.highest_degree||s.highest_degree,field_of_study:p.field_of_study||s.field_of_study,research_expertise:p.research_expertise||s.research_expertise})),w.current=!0,window._profileSuccessShown||(window._profileSuccessShown=!0,alert("Profile successfully generated! Please review and save the changes.")))},[p]),d.useEffect(()=>{const t=new URLSearchParams(window.location.search).get("generation_initiated")==="true";if(console.log("Checking if automatic generation should be triggered:",{aiGenerationInProgress:F,aiGenerationMethod:O,generationTriggeredRef:w.current,isGenerating:C,generatedProfileData:!!p,generationInitiated:t,location:window.location.href}),p){console.log("Generated profile data already available, skipping generation");return}if((t||F)&&!w.current&&!C){console.log("Generation in progress or initiated, checking status"),J();return}},[F,O,C,p]);const J=()=>{var t;if(w.current)return;x(!0),console.log("Checking generation status");const s=(t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content");N.get(route("ai.status"),{headers:{"X-CSRF-TOKEN":s,Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}).then(a=>{if(console.log("Status check response:",a.data),a.data.status==="in_progress")setTimeout(J,3e3);else if(a.data.status==="error")x(!1),alert("Profile generation failed: "+a.data.message);else if(a.data.status==="completed"||a.data.data||typeof a.data=="object"&&a.data.full_name){x(!1);let n=a.data;a.data.data?n=a.data.data:a.data.response&&(n=a.data.response),n&&(k(n),w.current=!0,window._profileSuccessShown||(window._profileSuccessShown=!0,alert("Profile successfully generated! Please review and save the changes.")))}else console.log("Unexpected status format, checking cache directly"),x(!1)}).catch(a=>{var n,h;console.error("Error checking generation status:",a),console.log("Error details:",{message:a.message,response:(n=a.response)==null?void 0:n.data,status:(h=a.response)==null?void 0:h.status}),x(!1)})};d.useEffect(()=>{r.google_scholar&&he()},[r.google_scholar]);const he=()=>{N.get("/api/scholar/status").then(s=>{s.data.success&&(ce(s.data),me(s.data.can_update),s.data.profile&&ue(s.data.profile.last_updated_human))}).catch(s=>{console.error("Error fetching Google Scholar status:",s)})},pe=(s,t)=>{const a=[...U];a[s]=t,q(a)},ge=()=>{q([...U,""])},fe=async()=>{x(!0),b("Generating...");try{const s=await N.post(route("academician.generateProfile"),{mode:"auto"});if(s.status===200){const t=s.data;k(t),b("Profile generated successfully!"),setTimeout(()=>{b("")},3e3)}}catch(s){console.error("Error generating profile:",s),b("Error generating profile. Please try again.")}finally{x(!1)}},xe=async()=>{var s,t,a,n,h,v;if(r.CV_file&&typeof r.CV_file=="string"){x(!0),b("Generating profile from existing CV...");try{const o=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"),y=new FormData;console.log("Attempting CV generation with existing CV file"),console.log("CSRF Token:",o),console.log("Using existing CV:",r.CV_file);const g={"X-CSRF-TOKEN":o,Accept:"application/json"},f=await N.post(route("ai.generate.cv"),y,{headers:g});console.log("CV generation successful:",f.data),f.data&&(f.data.CV_file&&(console.log("Updating CV file path from response:",f.data.CV_file),i(V=>({...V,CV_file:f.data.CV_file}))),k(f.data),b("Profile generated successfully!"),x(!1))}catch(o){console.error("Error generating profile from CV:",o),console.log("Error details:",{message:o.message,response:(t=o.response)==null?void 0:t.data,status:(a=o.response)==null?void 0:a.status,statusText:(n=o.response)==null?void 0:n.statusText,headers:(h=o.response)==null?void 0:h.headers}),b(`Error (${((v=o.response)==null?void 0:v.status)||"unknown"}): ${o.message}`),x(!1)}}else L(!0)},[_,A]=d.useState(null),[be,L]=d.useState(!1),[z,I]=d.useState(!1),ve=s=>{A(s.target.files[0])},_e=async()=>{var s,t,a,n,h,v;if(_){I(!0),b("Uploading CV and generating profile...");try{const o=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"),y=new FormData;if(y.append("CV_file",_,_.name),console.log("CV File details:",{name:_.name,size:_.size,type:_.type,lastModified:new Date(_.lastModified).toISOString()}),_.size>5*1024*1024)throw new Error("File size exceeds 5MB. Please upload a smaller file.");const g=await N.post(route("ai.generate.cv"),y,{headers:{"X-CSRF-TOKEN":o,Accept:"application/json","Content-Type":"multipart/form-data"},responseType:"json",timeout:6e4});console.log("CV generation successful:",g.data),g.data&&(L(!1),A(null),g.data.CV_file&&(console.log("Updating CV file path:",g.data.CV_file),i(f=>({...f,CV_file:g.data.CV_file}))),k(g.data),b("Profile generated successfully!"),I(!1))}catch(o){console.error("Error uploading CV:",o),console.log("Error details:",{message:o.message,response:(t=o.response)==null?void 0:t.data,status:(a=o.response)==null?void 0:a.status,statusText:(n=o.response)==null?void 0:n.statusText,headers:(h=o.response)==null?void 0:h.headers}),b(`Error (${((v=o.response)==null?void 0:v.status)||"unknown"}): ${o.message}`),I(!1)}}},je=s=>{if(s.preventDefault(),!r.profile_picture){alert("Please select a profile picture.");return}const t=new FormData;t.append("profile_picture",r.profile_picture),P(route("role.updateProfilePicture"),{data:t,headers:{"Content-Type":"multipart/form-data"},onSuccess:()=>{alert("Profile picture updated successfully."),Y(),window.location.reload()},onError:a=>{console.error("Error updating profile picture:",a),alert("Failed to update the profile picture. Please try again.")}})},we=s=>{if(s.preventDefault(),!r.background_image){alert("Please select a background image.");return}const t=new FormData;t.append("background_image",r.background_image),P(route("role.updateBackgroundImage"),{data:t,headers:{"Content-Type":"multipart/form-data"},onSuccess:()=>{alert("Background image updated successfully."),G(!1),window.location.reload()},onError:a=>{console.error("Error updating background image:",a),alert("Failed to update the background image. Please try again.")}})},ye=s=>{s.preventDefault();const t=new FormData;Object.keys(r).forEach(a=>{a!=="profile_picture"&&a!=="background_image"&&a!=="CV_file"&&(a==="research_expertise"?t.append(a,JSON.stringify(r[a])):a==="availability_as_supervisor"?t.append(a,r[a]===!0?1:0):Array.isArray(r[a])?t.append(a,JSON.stringify(r[a])):t.append(a,r[a]))}),r.CV_file&&typeof r.CV_file!="string"?t.append("CV_file",r.CV_file):r.CV_file===""&&t.append("CV_file",""),P(route("role.update"),{data:t,onSuccess:()=>{alert("Profile updated successfully.")},onError:a=>{console.error("Error updating profile:",a),alert("Failed to update the profile. Please try again.")}})},[Ne,K]=d.useState(!1),Ce=()=>K(!0),Y=()=>K(!1),[Se,G]=d.useState(!1),[$,ke]=d.useState("profiles"),Ve=s=>{R(!0),N.post(route("role.generateCV"),{customized_cv:s},{responseType:"blob"}).then(t=>{const a=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=a,n.setAttribute("download","cv.docx"),document.body.appendChild(n),n.click(),n.remove(),R(!1),E(!1)}).catch(t=>{console.error("CV generation failed:",t),alert("Failed to generate CV. Please try again."),R(!1)})},Fe=()=>{H(!1),E(!0)},Pe=()=>{w.current=!1},Q=()=>{Pe(),M(!0)},[Me,b]=d.useState(""),k=s=>{i(t=>({...t,full_name:s.full_name||t.full_name,phone_number:s.phone_number||t.phone_number,bio:s.bio||t.bio,current_position:s.current_position||t.current_position,department:s.department||t.department,highest_degree:s.highest_degree||t.highest_degree,field_of_study:s.field_of_study||t.field_of_study,research_expertise:s.research_expertise&&s.research_expertise.length>0?s.research_expertise:t.research_expertise,personal_website:s.personal_website||t.personal_website,institution_website:s.institution_website||t.institution_website,linkedin:s.linkedin||t.linkedin,google_scholar:s.google_scholar||t.google_scholar,researchgate:s.researchgate||t.researchgate,CV_file:t.CV_file||s.CV_file}))};return e.jsxs("div",{className:"pb-8",children:[e.jsxs("div",{className:"w-full bg-white pb-12 shadow-md relative mb-4",children:[e.jsxs("div",{className:"relative w-full h-48 overflow-hidden",children:[e.jsx("img",{src:`/storage/${r.background_image||"default-background.jpg"}`,alt:"Background",className:"w-full h-full object-cover"}),e.jsx("button",{onClick:()=>G(!0),className:"absolute top-4 right-4 bg-blue-500 p-2 rounded-full shadow-lg text-white hover:bg-blue-600","aria-label":"Edit Background Image",children:"✏️"})]}),e.jsxs("div",{className:"relative flex flex-col items-center -mt-16 z-10",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`/storage/${r.profile_picture||"default-profile.jpg"}`,alt:"Profile",className:"w-32 h-32 rounded-full border-4 border-white shadow-lg object-cover"}),e.jsx("button",{onClick:Ce,className:"absolute bottom-0 right-0 bg-blue-500 p-2 rounded-full shadow-lg text-white hover:bg-blue-600","aria-label":"Edit Profile Picture",children:"✏️"})]}),e.jsxs("div",{className:"text-center mt-4",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-800",children:r.full_name}),r.highest_degree&&e.jsxs("p",{className:"text-gray-500",children:[r.highest_degree," in ",r.field_of_study]}),e.jsx("p",{className:"text-gray-500",children:r.current_position})]})]})]}),Se&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-11/12 max-w-lg",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Update Background Image"}),e.jsxs("form",{onSubmit:we,children:[e.jsx("input",{type:"file",accept:"image/*",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",onChange:s=>i("background_image",s.target.files[0])}),e.jsxs("div",{className:"mt-4 flex justify-end",children:[e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 mr-2",children:"Save"}),e.jsx("button",{type:"button",onClick:()=>G(!1),className:"px-4 py-2 bg-gray-300 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]})]})}),Ne&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-11/12 max-w-lg",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Update Profile Picture"}),e.jsxs("form",{onSubmit:je,children:[e.jsx("input",{type:"file",accept:"image/*",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",onChange:s=>i("profile_picture",s.target.files[0])}),e.jsxs("div",{className:"mt-4 flex justify-end",children:[e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 mr-2",children:"Save"}),e.jsx("button",{type:"button",onClick:Y,className:"px-4 py-2 bg-gray-300 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]})]})}),e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-8xl mx-auto flex md:space-x-12 space-x-4 px-4 sm:px-8",children:["Profiles","Publications"].map(s=>e.jsx("button",{className:`py-4 px-3 md:text-lg text-base font-semibold ${$.toLowerCase()===s.toLowerCase()?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>{s.toLowerCase()==="publications"?window.location.href=route("role.publications"):ke(s.toLowerCase())},children:s},s))})}),C&&e.jsx(S,{show:C,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[e.jsx("p",{className:"text-lg font-medium",children:Me}),e.jsxs("svg",{className:"animate-spin h-8 w-8 mt-4 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})]})})}),e.jsx(S,{show:ie,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>M(!1),children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",onClick:s=>s.stopPropagation(),children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Generation Method"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Choose method:"}),e.jsxs("select",{className:"block w-full border-gray-300 rounded-md shadow-sm",value:T,onChange:s=>ne(s.target.value),children:[e.jsx("option",{value:"auto",children:"Auto search from Internet"}),e.jsx("option",{value:"url",children:"Use my provided URL(s)"}),e.jsx("option",{value:"cv",children:"Generate from CV"})]})]}),T==="url"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"The system will use the Website, LinkedIn, Google Scholar, and ResearchGate fields from your profile. You can also add extra URL(s) below if you wish."}),U.map((s,t)=>e.jsx("input",{type:"text",className:"block w-full border-gray-300 rounded-md shadow-sm p-2 mb-2",value:s,onChange:a=>pe(t,a.target.value),placeholder:"https://example.com/extra-info"},t)),e.jsx("button",{type:"button",onClick:ge,className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-800",children:"Add URL"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>{M(!1),T==="cv"?xe():fe()},className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-800",children:"Submit"})})]})})}),e.jsxs("div",{className:"w-full px-4 py-8",children:[$==="profiles"&&e.jsxs("section",{className:le,children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsxs("header",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Personal Information"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Update your personal information."})]}),e.jsx("div",{className:"hidden sm:flex space-x-2 absolute top-0 right-0 mt-2 mr-2",children:e.jsx("button",{type:"button",onClick:Q,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-800",children:"AI Generated Profile"})}),e.jsx("div",{className:"sm:hidden mt-4",children:e.jsx("button",{type:"button",onClick:Q,className:"w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-800",children:"AI Generated Profile"})})]}),e.jsxs("form",{onSubmit:ye,className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 w-full",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(m,{htmlFor:"full_name",value:"Full Name (Without Salutation)",required:!0}),e.jsx(j,{id:"full_name",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.full_name,onChange:s=>i("full_name",s.target.value),required:!0,isFocused:!0,autoComplete:"full_name"}),e.jsx(u,{className:"mt-2",message:c.full_name})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(m,{htmlFor:"phone_number",value:"Phone Number",required:!0}),e.jsx(j,{id:"phone_number",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.phone_number,onChange:s=>i("phone_number",s.target.value),autoComplete:"tel"}),e.jsx(u,{className:"mt-2",message:c.phone_number})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 w-full",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(m,{htmlFor:"highest_degree",value:"Highest Degree",required:!0}),e.jsxs("select",{id:"highest_degree",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.highest_degree||"",onChange:s=>i("highest_degree",s.target.value),children:[e.jsx("option",{value:"",hidden:!0,children:"Select your Highest Degree"}),e.jsx("option",{value:"Certificate",children:"Certificate"}),e.jsx("option",{value:"Diploma",children:"Diploma"}),e.jsx("option",{value:"Bachelor's Degree",children:"Bachelor's Degree"}),e.jsx("option",{value:"Master's Degree",children:"Master's Degree"}),e.jsx("option",{value:"Ph.D.",children:"Ph.D."}),e.jsx("option",{value:"Postdoctoral",children:"Postdoctoral"})]}),e.jsx(u,{className:"mt-2",message:c.highest_degree})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(m,{htmlFor:"field_of_study",value:"Field of Study",required:!0}),e.jsx(j,{id:"field_of_study",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.field_of_study,onChange:s=>i("field_of_study",s.target.value)}),e.jsx(u,{className:"mt-2",message:c.field_of_study})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(m,{htmlFor:"CV_file",value:"Upload CV (Max 5MB)"}),e.jsx("input",{type:"file",id:"CV_file",accept:".pdf,.doc,.docx",className:"mt-1 block w-full border-gray-300 rounded-md py-2",onChange:s=>{const t=s.target.files[0];t&&(t.size<=5*1024*1024?i("CV_file",t):alert("File size exceeds 5MB. Please upload a smaller file."))}}),r.CV_file&&e.jsxs("div",{className:"mt-2",children:[typeof r.CV_file=="string"?e.jsxs("a",{href:`/storage/${r.CV_file}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-500 hover:underline",children:["View Current File: ",r.CV_file.split("/").pop()]}):e.jsxs("p",{className:"text-sm text-gray-500",children:["File Selected: ",r.CV_file.name]}),e.jsx("button",{type:"button",onClick:()=>i("CV_file",""),className:"ml-3 text-xs text-red-600 hover:text-red-800",children:"Remove"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Upload your CV to enable CV-based profile generation and enhance your academic profile."}),e.jsx(u,{className:"mt-2",message:c.CV_file})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6 w-full",children:e.jsxs("div",{className:"w-full",children:[e.jsx(m,{htmlFor:"bio",value:"Short Bio"}),e.jsx("textarea",{id:"bio",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.bio,onChange:s=>i("bio",s.target.value),rows:4}),e.jsx(u,{className:"mt-2",message:c.bio})]})}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{htmlFor:"research_expertise",className:"block text-sm font-medium text-gray-700",children:"Field of Research (Multiple Selection) Structure : Field of Research - Research Area - Niche Domain"}),e.jsx(ae,{id:"research_expertise",isMulti:!0,options:B.map(s=>({value:`${s.field_of_research_id}-${s.research_area_id}-${s.niche_domain_id}`,label:`${s.field_of_research_name} - ${s.research_area_name} - ${s.niche_domain_name}`})),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",classNamePrefix:"select",menuPortalTarget:document.body,hideSelectedOptions:!1,closeMenuOnSelect:!1,styles:{valueContainer:s=>({...s,maxWidth:"100%"}),multiValueLabel:s=>({...s,maxWidth:250,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),menuPortal:s=>({...s,zIndex:9999}),option:(s,{data:t,isSelected:a,isFocused:n,isDisabled:h})=>({...s,backgroundColor:a?"#2563EB":n?"#F3F4F6":"white",color:a?"white":"#374151",paddingLeft:a?"25px":s.paddingLeft,position:"relative",":before":a?{content:'"✓"',position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"white"}:void 0})},value:(Z=r.research_expertise)==null?void 0:Z.map(s=>{const t=B.find(a=>`${a.field_of_research_id}-${a.research_area_id}-${a.niche_domain_id}`===s);return{value:s,label:t?`${t.field_of_research_name} - ${t.research_area_name} - ${t.niche_domain_name}`:s}}),onChange:s=>{const t=s.map(a=>a.value);i("research_expertise",t)},placeholder:"Select field of research...",filterOption:(s,t)=>!0,components:{MenuList:s=>{const t=Ee.Children.toArray(s.children),a=r.research_expertise||[],n=t.sort((h,v)=>{var V,D,ee,se,te;if(!h||!v||!h.props||!v.props)return 0;const o=(V=h.props.data)==null?void 0:V.value,y=(D=v.props.data)==null?void 0:D.value,g=a.includes(o),f=a.includes(y);return g&&!f?-1:!g&&f?1:((te=(ee=h.props.data)==null?void 0:ee.label)==null?void 0:te.localeCompare((se=v.props.data)==null?void 0:se.label))||0});return e.jsx("div",{className:"react-select__menu-list",...s.innerProps,style:{maxHeight:"215px",overflowY:"auto",padding:"5px 0"},children:n})}}})]}),l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 w-full",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(m,{htmlFor:"current_position",value:"Current Position",required:!0}),e.jsxs("select",{id:"current_position",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.current_position,onChange:s=>i("current_position",s.target.value),children:[e.jsx("option",{value:"",hidden:!0,children:"Select Position"}),e.jsx("option",{value:"Lecturer",children:"Lecturer"}),e.jsx("option",{value:"Senior Lecturer",children:"Senior Lecturer"}),e.jsx("option",{value:"Assoc. Prof.",children:"Associate Professor"}),e.jsx("option",{value:"Professor",children:"Professor"}),e.jsx("option",{value:"Postdoctoral Researcher",children:"Postdoctoral Researcher"}),e.jsx("option",{value:"Researcher",children:"Researcher"})]}),e.jsx(u,{className:"mt-2",message:c.current_position})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(m,{htmlFor:"department",value:"Department",required:!0}),e.jsx(j,{id:"department",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.department,onChange:s=>i("department",s.target.value)}),e.jsx(u,{className:"mt-2",message:c.department})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 w-full",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(m,{htmlFor:"availability_as_supervisor",value:"Availability as Supervisor",required:!0}),e.jsxs("select",{id:"availability_as_supervisor",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.availability_as_supervisor?"true":"false",onChange:s=>i("availability_as_supervisor",s.target.value==="true"),children:[e.jsx("option",{value:"true",children:"Available"}),e.jsx("option",{value:"false",children:"Not Available"})]}),e.jsx(u,{className:"mt-2",message:c.availability_as_supervisor})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{htmlFor:"style_of_supervision",value:"Style of Supervision"}),e.jsxs("div",{className:"group relative",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-gray-500 hover:text-gray-700 cursor-help",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})}),e.jsxs("div",{className:"absolute left-0 w-80 p-4 bg-gray-800 text-white text-sm rounded-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 -translate-x-1/2 translate-y-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Directive:"})," Structured approach with active guidance and regular monitoring"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Facilitative:"})," Supportive approach encouraging student independence"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Coaching:"})," Focuses on personal development and academic growth"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Adaptive:"})," Flexible support based on student's changing needs"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Participatory:"})," Collaborative approach with shared decision-making"]})]}),e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-2",children:e.jsx("div",{className:"border-8 border-transparent border-b-gray-800"})})]})]})]}),e.jsx(ae,{id:"style_of_supervision",isMulti:!0,options:[{value:"Directive Supervision",label:"Directive Supervision"},{value:"Facilitative Supervision",label:"Facilitative Supervision"},{value:"Coaching Supervision",label:"Coaching Supervision"},{value:"Adaptive Supervision",label:"Adaptive Supervision"},{value:"Participatory Supervision",label:"Participatory Supervision"}],className:"mt-1 block w-full",classNamePrefix:"select",value:Array.isArray(r.style_of_supervision)?r.style_of_supervision.map(s=>({value:s,label:s})):[],onChange:s=>{const t=s?s.map(a=>a.value):[];i("style_of_supervision",t)},menuPortalTarget:document.body,styles:{menuPortal:s=>({...s,zIndex:9999})}}),e.jsx(u,{className:"mt-2",message:c.style_of_supervision})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 w-full",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"personal_website",value:"Personal Website"}),e.jsx(j,{id:"personal_website",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.personal_website,onChange:s=>i("personal_website",s.target.value),autoComplete:"url"}),e.jsx(u,{className:"mt-2",message:c.personal_website})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"institution_website",value:"Institutional Website"}),e.jsx(j,{id:"institution_website",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.institution_website,onChange:s=>i("institution_website",s.target.value),autoComplete:"url"}),e.jsx(u,{className:"mt-2",message:c.institution_website})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 w-full",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"linkedin",value:"LinkedIn"}),e.jsx(j,{id:"linkedin",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.linkedin,onChange:s=>i("linkedin",s.target.value),autoComplete:"url"}),e.jsx(u,{className:"mt-2",message:c.linkedin})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"google_scholar",value:"Google Scholar"}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx(j,{id:"google_scholar",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.google_scholar,onChange:s=>i("google_scholar",s.target.value),autoComplete:"url"}),e.jsx(u,{className:"mt-2",message:c.google_scholar})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"researchgate",value:"ResearchGate"}),e.jsx(j,{id:"researchgate",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",value:r.researchgate,onChange:s=>i("researchgate",s.target.value),autoComplete:"url"}),e.jsx(u,{className:"mt-2",message:c.researchgate})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Re,{disabled:re,children:"Save"}),e.jsx(S,{show:oe,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Saved."})})]})]})]}),$==="projects"&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"})]}),de&&e.jsx(Ae,{onClose:()=>E(!1),onDownload:Ve}),W&&e.jsx(S,{show:W,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg text-center",children:[e.jsx("p",{className:"text-lg font-medium",children:"Downloading CV, please wait..."}),e.jsxs("svg",{className:"animate-spin h-8 w-8 mt-4 text-blue-500 mx-auto",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})]})})}),X&&e.jsx(S,{show:X,enter:"transition-opacity duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Reminder"}),e.jsx("p",{className:"text-sm text-gray-700 mb-4",children:'The "Generate CV" feature requires that your Website and Google Scholar fields are filled so that the system can extract data from those URLs.'}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{onClick:()=>H(!1),className:"mr-2 px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{onClick:Fe,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-700",children:"Proceed"})]})]})})}),be&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center overflow-x-hidden overflow-y-auto outline-none focus:outline-none",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50"}),e.jsx("div",{className:"relative w-auto my-6 mx-auto max-w-3xl z-50",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Upload CV for Profile Generation"}),e.jsx("p",{className:"mb-4 text-sm text-gray-600",children:"Upload your CV to generate your profile. We support PDF, DOCX, DOC, and image formats."}),e.jsx("input",{type:"file",className:"mb-4 p-2 border rounded w-full",onChange:ve,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.tiff"}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{className:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400",onClick:()=>{L(!1),A(null)},disabled:z,children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:_e,disabled:!_||z,children:z?"Uploading...":"Upload & Generate Profile"})]})]})})]})]})}export{He as default};
