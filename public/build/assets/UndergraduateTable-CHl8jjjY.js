import{r as m,j as e,y as D}from"./app-B3hmWniC.js";import{t as y,u as w,v as _,w as G,x as O,y as N}from"./index-_HqCLM-_.js";import{P as J}from"./Pagination-BJbmsSef.js";import"./iconBase-DWPlaU5a.js";import"./chevron-left-BOCbFaEI.js";import"./createLucideIcon-DbyzRx74.js";import"./chevron-right-D0YbAFW6.js";const V=({undergraduates:n,researchOptions:S,onSendReminder:C,onSendBatchReminder:F,pagination:x,currentTab:$,loading:A})=>{const[l,c]=m.useState({}),[r,h]=m.useState([]),[i,u]=m.useState(!1),[o,b]=m.useState(!1),[R,k]=m.useState({}),P=async t=>{c(s=>({...s,[t]:"sending"}));try{await C(t,"undergraduate"),c(s=>({...s,[t]:"sent"})),setTimeout(()=>{c(s=>{const a={...s};return delete a[t],a})},3e3)}catch{c(a=>({...a,[t]:"error"})),setTimeout(()=>{c(a=>{const d={...a};return delete d[t],d})},3e3)}},U=t=>{if(t.target.checked){const s=n.map(a=>a.id);h(s)}else h([])},E=t=>{h(s=>s.includes(t)?s.filter(a=>a!==t):[...s,t])},T=async()=>{if(r.length!==0){u(!0);try{await F(r,"undergraduate"),u(!1),b(!0),setTimeout(()=>{h([]),b(!1)},3e3)}catch{u(!1)}}},B=t=>{k(s=>({...s,[t]:!s[t]}))};return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"mb-5 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:r.length>0?e.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded-md bg-blue-50 text-blue-700",children:[r.length," undergraduate",r.length!==1?"s":""," selected"]}):e.jsx("span",{children:"No undergraduates selected"})}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{onClick:T,disabled:r.length===0||i||o,className:`inline-flex items-center justify-center rounded-md px-4 py-2 text-sm font-medium shadow-sm transition-colors ${r.length===0||i||o?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:[i&&e.jsx(y,{className:"animate-spin -ml-0.5 mr-2 h-4 w-4"}),o&&e.jsx(w,{className:"-ml-0.5 mr-2 h-4 w-4"}),!i&&!o?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Send Reminders to Selected"]}):i?"Sending Reminders...":"Reminders Sent!"]})})]}),e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{scope:"col",className:"relative w-12 px-4 sm:w-16 sm:px-6",children:e.jsx("input",{type:"checkbox",className:"absolute left-4 top-1/2 -mt-2 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 sm:left-6",checked:n&&n.length>0&&r.length===n.length,onChange:U})}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Undergraduate"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"University & Faculty"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Degree & Status"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Research Interest"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Profile Status"}),e.jsx("th",{scope:"col",className:"relative py-3.5 pl-3 pr-4 sm:pr-6",children:e.jsx("span",{className:"sr-only",children:"Actions"})})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:n&&n.length>0?n.map(t=>{var d,v;const s=t.undergraduate,a=R[t.id]||!1;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"relative w-12 px-4 sm:w-16 sm:px-6",children:e.jsx("input",{type:"checkbox",className:"absolute left-4 top-1/2 -mt-2 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 sm:left-6",checked:r.includes(t.id),onChange:()=>E(t.id)})}),e.jsx("td",{className:"whitespace-nowrap py-4 pl-3 pr-3 text-sm",children:e.jsx("div",{className:"flex items-start space-x-3",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900",children:(s==null?void 0:s.full_name)||t.name||"N/A"}),e.jsx("div",{className:"text-gray-500 mt-1",children:t.email})]})})}),e.jsx("td",{className:"px-3 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((d=s==null?void 0:s.university_details)==null?void 0:d.full_name)||"Not specified"}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:((v=s==null?void 0:s.faculty)==null?void 0:v.name)||"Faculty not specified"})]})}),e.jsx("td",{className:"px-3 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[(s==null?void 0:s.bachelor)||"Degree not specified",(s==null?void 0:s.CGPA_bachelor)&&` (CGPA: ${s.CGPA_bachelor})`]}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:(s==null?void 0:s.current_undergraduate_status)||"Status not specified"})]})}),e.jsx("td",{className:"px-3 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s!=null&&s.interested_do_research?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s!=null&&s.interested_do_research?"Interested in Research":"Not Interested in Research"})}),s!=null&&s.research_preference?e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>B(t.id),className:"flex items-center justify-between w-full text-left text-sm font-medium text-blue-600 hover:text-blue-800",children:[e.jsx("span",{children:Array.isArray(s.research_preference)?`${s.research_preference.length} preference${s.research_preference.length!==1?"s":""}`:"Research preference"}),a?e.jsx(G,{className:"h-4 w-4 ml-1"}):e.jsx(O,{className:"h-4 w-4 ml-1"})]}),a&&e.jsx("div",{className:"mt-2 bg-gray-50 p-2 rounded max-h-40 overflow-y-auto",children:e.jsx("div",{className:"space-y-1 text-sm",children:Array.isArray(s.research_preference)?s.research_preference.map((g,p)=>{const f=S.find(j=>`${j.field_of_research_id}-${j.research_area_id}-${j.niche_domain_id}`===g);return f?e.jsxs("div",{className:"text-gray-700 flex",children:[e.jsxs("span",{className:"text-gray-400 mr-1.5",children:[p+1,"."]}),e.jsxs("span",{children:[f.field_of_research_name," - ",f.research_area_name," - ",f.niche_domain_name]})]},p):e.jsxs("div",{className:"text-gray-700 flex",children:[e.jsxs("span",{className:"text-gray-400 mr-1.5",children:[p+1,"."]}),e.jsx("span",{children:typeof g=="string"?g:JSON.stringify(g)})]},p)}):e.jsx("div",{className:"text-gray-700",children:typeof s.research_preference=="string"?s.research_preference:JSON.stringify(s.research_preference)})})})]}):e.jsxs("div",{className:"flex items-center text-gray-500 italic",children:[e.jsx(N,{className:"text-yellow-500 mr-1.5 h-4 w-4"}),e.jsx("span",{children:"No research preferences specified"})]})]})}),e.jsx("td",{className:"px-3 py-4",children:e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(s==null?void 0:s.profile_status)==="Complete"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:(s==null?void 0:s.profile_status)||"Needs Update"})})}),e.jsx("td",{className:"whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6",children:e.jsx("button",{onClick:()=>P(t.id),disabled:l[t.id]==="sending"||l[t.id]==="sent",className:`inline-flex items-center rounded-md px-3 py-2 text-sm font-medium shadow-sm ${l[t.id]==="sending"||l[t.id]==="sent"?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-blue-600 hover:bg-blue-50 border border-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}`,children:l[t.id]==="sending"?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"animate-spin mr-1.5 -ml-0.5 h-4 w-4"}),"Sending..."]}):l[t.id]==="sent"?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"mr-1.5 -ml-0.5 h-4 w-4 text-green-500"}),"Sent"]}):l[t.id]==="error"?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"mr-1.5 -ml-0.5 h-4 w-4 text-red-500"}),"Error"]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"mr-1.5 -ml-0.5 h-4 w-4"}),"Send"]})})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"py-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500",children:[e.jsx(N,{className:"h-8 w-8 text-gray-400 mb-2"}),e.jsx("p",{children:"No undergraduates found"})]})})})})]})})}),A&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-10 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"animate-spin text-blue-500"}),e.jsx("span",{className:"text-gray-600",children:"Loading..."})]})}),x&&x.last_page>1&&e.jsx("div",{className:"mt-6",children:e.jsx(J,{currentPage:x.current_page||1,totalPages:x.last_page||1,onPageChange:t=>{D.get(`${window.location.pathname}?undergraduates_page=${t}&tab=${$}`,{preserveState:!0,replace:!0})}})})]})};export{V as default};
