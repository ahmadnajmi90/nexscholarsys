import{q as j,W as f,r as u,j as e,Y as b,b as N}from"./app-6KcAPae7.js";import{M as v}from"./MainLayout--yDNTBjU.js";import{R as y}from"./quill.snow-C4ll0zRD.js";import{u as w}from"./useRoles-TTN5TAPq.js";import{B as S}from"./BackButton-C6oNngz7.js";import"./house-MPKGRuPU.js";import"./createLucideIcon-Dg0NKHwN.js";import"./zap-Dc37O7Yf.js";import"./users-BAT0uBt8.js";import"./folder-open-BOmTEEi1.js";import"./settings-nBn8_I0z.js";import"./chevron-left-Dg3HzLsn.js";import"./proxy-6rU6RlCr.js";import"./user-round-Gn5hLxMS.js";import"./clipboard-list-CkK1RN7u.js";import"./dollar-sign-DG-1hJGs.js";import"./calendar-CKvWh2Fc.js";import"./file-text-CldtH22C.js";import"./message-square-DOAr_Oao.js";import"./graduation-cap-DsZZvawH.js";import"./building-BAo4hBJ-.js";import"./Dropdown-D9Vn_Uo-.js";import"./transition-CSwR4vyx.js";import"./sparkles-CxsEXFgy.js";import"./bookmark-CKOvIcZS.js";import"./folder-kanban-WJg5ri3Z.js";import"./building-2-BOmvfrGU.js";import"./database-CHeJJryD.js";import"./shield-Di9h5Q6c.js";import"./index-DaBARm37.js";import"./analytics-BQ374C1C.js";import"./index-DjCDrVl_.js";import"./iconBase-n0Q-2a7D.js";import"./index-Ce5Il87X.js";import"./supervisionConstants-BuM5-H5X.js";import"./utils-CBfrqCZ4.js";import"./ThreadPane-DyCNvQZd.js";import"./Modal-CJvMaQW5.js";import"./dialog-CwJFq24I.js";import"./index-JAD3o4sP.js";import"./scroll-area-CgKTi-4v.js";import"./index-C3-aQ1HP.js";import"./index-C_9bpbuH.js";import"./index-Kc-fmclX.js";import"./index-uYzWXxXP.js";import"./index-BdQq_4o_.js";import"./format-BOijCLBA.js";import"./en-US-DIdCsyf3.js";import"./button-CrdDRXAu.js";import"./download-BwAogcNS.js";import"./x-RVcZvC1Z.js";import"./isSameDay-BHs4V-zU.js";import"./constructNow-6bIQB1GK.js";import"./addDays-KHeCUDUr.js";import"./PrimaryButton-BDNKdwtj.js";import"./SecondaryButton-BMSD-Ano.js";import"./search-KJO1iUQT.js";import"./circle-check-big-DONTGj_Q.js";import"./chevron-right-BAu-tXgn.js";import"./tooltip-B6pzDCUw.js";import"./index-Cxfb7wM5.js";import"./index-4gt4wYEX.js";import"./index-CNVNpKw3.js";import"./floating-ui.dom-D5EC_49c.js";import"./index-CSjGVC7d.js";import"./index-CANaiMod.js";import"./index-Bby0leWS.js";import"./index-Chjiymov.js";import"./dialog-RPNwQkV0.js";import"./index-BT3GCukP.js";import"./index-D5o-Dx5T.js";import"./briefcase-SOOxWO71.js";import"./user-CAcetcbZ.js";import"./arrow-left-B4eG37Rt.js";function C({tags:c,setTags:s}){const[l,o]=u.useState(""),m=t=>{if(t.key==="Enter"||t.key===","){t.preventDefault();const n=l.trim();n&&!c.includes(n)&&s([...c,n]),o("")}else t.key==="Backspace"&&!l.length&&c.length&&s(c.slice(0,c.length-1))},d=t=>{s(c.filter((n,p)=>p!==t))};return e.jsxs("div",{className:"flex flex-wrap items-center border rounded-lg p-2",children:[c.map((t,n)=>e.jsxs("div",{className:"bg-blue-200 text-blue-800 rounded-full px-3 py-1 m-1 flex items-center",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button",onClick:()=>d(n),className:"ml-2 text-sm text-blue-800",children:"Ã—"})]},n)),e.jsx("input",{type:"text",value:l,onChange:t=>o(t.target.value),onKeyDown:m,className:"flex-grow outline-none p-1",placeholder:"Type a tag and press enter"})]})}function Ye(){const{auth:c,post:s}=j().props;w();const{data:l,setData:o,post:m,processing:d,errors:t}=f({title:s.title||"",url:s.url||"",content:s.content||"",category:s.category||"",tags:(()=>{try{return s.tags?JSON.parse(s.tags):[]}catch(r){return console.warn("Failed to parse tags JSON:",r),[]}})(),images:null,featured_image:null,attachment:null,status:s.status||"published"}),n=r=>{o("tags",r)},[p,E]=u.useState([]);function g(r){r.preventDefault();const i=new FormData;Object.keys(l).forEach(a=>{a==="tags"?i.append(a,JSON.stringify(l[a])):a==="images"&&Array.isArray(l[a])?l[a].forEach((x,h)=>{i.append(`images[${h}]`,x)}):(l[a]instanceof File,i.append(a,l[a]))}),p.forEach(a=>{i.append("delete_images[]",a)}),m(route("create-posts.update",s.id),{data:i,headers:{"Content-Type":"multipart/form-data"},preserveScroll:!0,onSuccess:()=>{alert("Post updated successfully.")},onError:a=>{console.error("Error updating Post:",a),alert("Failed to update the Post. Please check the form for errors.")}})}return e.jsxs(v,{children:[e.jsx(b,{title:"Edit Post"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx(S,{})}),e.jsxs("form",{onSubmit:g,className:"bg-white p-6 lg:p-0 rounded-lg max-w-7xl mx-auto space-y-6",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-700 text-center",children:"Edit Post"}),Object.keys(t).length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded relative",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Please fix the following errors:"}),e.jsx("ul",{className:"mt-2 list-disc list-inside",children:Object.entries(t).map(([r,i])=>e.jsx("li",{children:r==="images"?Object.entries(i).map(([a,x])=>e.jsxs("span",{children:["Image ",parseInt(a)+1,": ",x]},a)):i},r))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-10 gap-4 lg:gap-8",children:[e.jsxs("div",{className:"lg:col-span-7",children:[e.jsxs("label",{className:"block text-gray-700 font-medium",children:["Post Title ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",value:l.title,onChange:r=>o("title",r.target.value),className:"mt-1 w-full rounded-lg border-gray-200 p-4 text-sm",placeholder:"Enter Post Title"}),t.title&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.title})]}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("label",{className:"block text-gray-700 font-medium",children:["Category ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("select",{id:"category",name:"category",value:l.category,onChange:r=>o("category",r.target.value),className:"mt-1 w-full rounded-lg border-gray-200 p-4 text-sm",children:[e.jsx("option",{value:"",disabled:!0,hidden:!0,children:"Select Category"}),e.jsx("option",{value:"General Discussion",children:"General Discussion"}),e.jsx("option",{value:"Academic Research",children:"Academic Research"}),e.jsx("option",{value:"Student Life",children:"Student Life"}),e.jsx("option",{value:"Career Opportunities",children:"Career Opportunities"}),e.jsx("option",{value:"News",children:"News"}),e.jsx("option",{value:"Startup",children:"Startup"}),e.jsx("option",{value:"Technology",children:"Technology"}),e.jsx("option",{value:"Research Methodology",children:"Research Methodology"}),e.jsx("option",{value:"Research Paradigm",children:"Research Paradigm"}),e.jsx("option",{value:"Science & Technology",children:"Science & Technology"}),e.jsx("option",{value:"Social Science",children:"Social Science"}),e.jsx("option",{value:"Community",children:"Community"}),e.jsx("option",{value:"Award",children:"Award"}),e.jsx("option",{value:"Achievement",children:"Achievement"}),e.jsx("option",{value:"Business",children:"Business"}),e.jsx("option",{value:"Economy",children:"Economy"}),e.jsx("option",{value:"Health",children:"Health"}),e.jsx("option",{value:"Science",children:"Science"}),e.jsx("option",{value:"Sport",children:"Sport"}),e.jsx("option",{value:"Corporate Social Responsibility",children:"Corporate Social Responsibility"}),e.jsx("option",{value:"Knowledge Transfer Program",children:"Knowledge Transfer Program"})]}),t.category&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.category})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-10 gap-4 lg:gap-8",children:[e.jsxs("div",{className:"lg:col-span-7",children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Post URL"}),e.jsx("input",{type:"url",value:l.url,disabled:!0,onChange:r=>o("url",r.target.value),className:"mt-1 w-full rounded-lg border-gray-200 p-4 bg-gray-100 text-sm cursor-not-allowed",placeholder:"Auto-generated from title"}),t.url&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.url})]}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Tags"}),e.jsx(C,{tags:l.tags,setTags:n}),t.tags&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.tags})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-10 gap-4 lg:gap-8",children:[e.jsxs("div",{className:"lg:col-span-7",children:[e.jsxs("label",{className:"block text-gray-700 font-medium",children:["Content ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("div",{className:"mt-1 w-full rounded-lg border border-gray-200",style:{height:"300px",overflowY:"auto"},children:e.jsx(y,{theme:"snow",value:l.content,onChange:r=>o("content",r),placeholder:"Enter content",style:{height:"300px",maxHeight:"300px"}})}),t.content&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.content})]}),e.jsxs("div",{className:"lg:col-span-3 flex flex-col space-y-4 lg:space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Upload Images (Multiple Allowed)"}),e.jsx("p",{className:"text-sm text-gray-500",children:"(Upload new images will delete all existed images)"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:r=>{const i=Array.from(r.target.files);o("images",i)},className:"mt-1 w-full rounded-lg border-gray-200 p-2 text-sm"}),s.images&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Images:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:JSON.parse(s.images).map((r,i)=>e.jsxs("a",{href:`/storage/${r}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:["Image ",i+1]},i))})]}),t.images&&e.jsx("div",{className:"mt-1",children:Object.entries(t.images).map(([r,i])=>e.jsxs("p",{className:"text-red-500 text-xs",children:["Image ",parseInt(r)+1,": ",i]},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Upload Featured Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:r=>o("featured_image",r.target.files[0]),className:"mt-1 w-full rounded-lg border-gray-200 p-2 text-sm"}),s.featured_image&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Featured Image:"}),e.jsx("a",{href:`/storage/${s.featured_image}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:"View Featured Image"})]}),t.featured_image&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.featured_image})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Upload Attachment"}),e.jsx("input",{type:"file",onChange:r=>o("attachment",r.target.files[0]),className:"mt-1 w-full rounded-lg border-gray-200 p-2 text-sm"}),s.attachment&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Attachment:"}),e.jsx("a",{href:`/storage/${s.attachment}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:"View Attachment"})]}),t.attachment&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.attachment})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:space-x-4",children:[e.jsx("button",{type:"submit",disabled:d,className:"w-full sm:w-auto inline-block rounded-lg bg-blue-500 px-5 py-3 text-sm font-medium text-white hover:bg-blue-600",children:"Update"}),e.jsx(N,{href:route("create-posts.index"),className:"w-full sm:w-auto inline-block rounded-lg bg-gray-300 px-5 py-3 text-sm font-medium text-gray-700 hover:bg-gray-400 text-center",children:"Cancel"})]})]})]})]})}export{Ye as default};
