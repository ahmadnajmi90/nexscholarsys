import{q as U,W as $,r as c,j as e,y as j}from"./app-B7My-eC5.js";import{M as D}from"./MainLayout-DxnJRVdD.js";import{u as R}from"./useRoles-BoPaiDHT.js";import"./createLucideIcon-Ck371CVa.js";import"./proxy-B_Ef2pah.js";import"./sparkles-CL8Uzh8R.js";import"./index-B76GP1_w.js";import"./iconBase-DimdWEc9.js";import"./analytics-BQ374C1C.js";import"./index-CLpi5V0M.js";const Q=()=>{const{academicians:a,flash:n,universities:v,faculties:N,researchOptions:b}=U().props;R();const{post:O,processing:w}=$(),[S,k]=c.useState({}),[i,p]=c.useState({}),[d,u]=c.useState(!1),[l,o]=c.useState(!1);c.useEffect(()=>{const s={};a.forEach(t=>{s[t.id]=d}),p(s)},[a,d]);const _=s=>{j.post(route("faculty-admin.verify-academician",s),{},{onStart:()=>{console.log(`Starting verification for academician ID: ${s}`)},onSuccess:t=>{console.log(`Successfully verified academician ID: ${s}`),t.props.flash&&t.props.flash.success?alert(t.props.flash.success):alert("Academician verified successfully!")},onError:t=>{console.error(`Failed to verify academician ID: ${s}`,t),alert("Failed to verify academician.")}})},A=()=>{const s=Object.keys(i).filter(t=>i[t]).map(t=>parseInt(t,10));if(s.length===0){alert("Please select at least one academician to verify.");return}o(!0),console.log("Sending verification request for IDs:",s),j.post(route("faculty-admin.verify-academicians-batch"),{academician_ids:s},{onStart:()=>(console.log("Starting batch verification request"),!0),onSuccess:t=>{console.log("Verification success response:",t),t.props.flash&&t.props.flash.success?alert(t.props.flash.success):alert("Academicians verified successfully!"),p({}),u(!1),o(!1)},onError:t=>{console.error("Verification error:",t),o(!1),alert("Failed to verify academicians: "+(Object.values(t)[0]||"Unknown error"))},onFinish:()=>{console.log("Verification request finished"),o(!1)}})},I=s=>{const t={...i};t[s]=!i[s],p(t);const r=a.every(x=>t[x.id]===!0);u(r)},C=()=>{u(!d)},f=()=>Object.values(i).filter(Boolean).length,V=s=>{const t=v.find(r=>r.id===s);return t?t.full_name:"Unknown University"},E=s=>{const t=N.find(r=>r.id===s);return t?t.name:"Unknown Faculty"},B=s=>{k(t=>({...t,[s]:!t[s]}))},F=s=>s?e.jsx("span",{className:"px-3 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:"Verified"}):e.jsx("span",{className:"px-3 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800",children:"Not Verified"});return e.jsx(D,{title:"",children:e.jsxs("div",{className:"max-w-7xl mx-auto py-2 px-4",children:[e.jsxs("div",{className:"sm:flex sm:items-center sm:justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Verify Academicians"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Review and verify academicians in your faculty."})]}),a.length>0&&e.jsxs("div",{className:"mt-4 sm:mt-0 flex items-center space-x-3",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[f()," selected"]}),e.jsx("button",{className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white ${f()>0?"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500":"bg-gray-300 cursor-not-allowed"}`,onClick:A,disabled:f()===0||l,children:l?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Verifying..."]}):"Verify Selected"})]})]}),(n==null?void 0:n.success)&&e.jsx("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 mb-6 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-green-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-green-700",children:n.success})})]})}),e.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:a.length===0?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No academicians pending verification in your faculty."})}):e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",checked:d,onChange:C,disabled:l}),e.jsx("span",{className:"ml-2",children:"Select All"})]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Academician"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"University & Faculty"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department & Position"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Research Expertise"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(s=>{var x;const t=S[s.id]||!1,r=i[s.id]||!1;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",checked:r||!1,onChange:()=>I(s.id),disabled:l})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.full_name||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:((x=s.user)==null?void 0:x.email)||"N/A"})]})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900",children:V(s.university)}),e.jsx("div",{className:"text-sm text-gray-500",children:E(s.faculty)})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900",children:s.department||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:s.current_position||"N/A"})]}),e.jsx("td",{className:"px-6 py-4",children:s.research_expertise&&s.research_expertise.length>0?e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-900 font-medium",children:[s.research_expertise.length," area",s.research_expertise.length!==1?"s":""]}),e.jsx("button",{onClick:()=>B(s.id),className:"text-blue-600 hover:text-blue-800 text-sm",children:t?"Hide details":"Show details"})]}),t&&e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:s.research_expertise.map((g,m)=>{const h=b.find(y=>`${y.field_of_research_id}-${y.research_area_id}-${y.niche_domain_id}`===g);return h?e.jsxs("p",{className:"text-sm text-gray-700",children:[m+1,". ",h.field_of_research_name," - ",h.research_area_name," - ",h.niche_domain_name]},m):e.jsxs("p",{className:"text-sm text-gray-700",children:[m+1,". Unknown expertise (ID: ",g,")"]},m)})})})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"No research expertise specified"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:F(s.verified)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:!s.verified&&e.jsx("button",{className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>_(s.id),disabled:w||l,children:"Verify"})})]},s.id)})})]})})})]})})};export{Q as default};
