import{r as c,j as e,a as Y,b as K}from"./app-DycluJDi.js";import{c as w}from"./index-CRoFkAwq.js";import{l as $}from"./logError-D4ezqrCx.js";import{C as W,b as X,c as Z,a as V,d as q}from"./card--WzO-fcI.js";import{B as M}from"./button-DrpbBg5w.js";import{T as R,a as ee,b as se,c as ae}from"./tooltip-Bjh7jqzi.js";import{C as re}from"./ConfirmationModal-BHLx_4ig.js";import{f as te}from"./formatDistanceToNow-GKXiLTrL.js";import{U as O}from"./user-round-D0HJxKcP.js";import{c as ne}from"./createLucideIcon-D0KJwFBT.js";import{B as le}from"./book-open-BbG8qq9y.js";import{F as ie}from"./folder-kanban-DWpojK_X.js";import{U as E}from"./user-plus-DYe-3CX-.js";import{E as ce}from"./eye-Dwc4GoVS.js";import{S as oe}from"./send-COSqrCrt.js";import{C as de}from"./circle-check-DBw7ke1n.js";import{L as me}from"./loader-circle-DBMiS7kS.js";import{T as xe}from"./trash-2-B8Zt6fdt.js";import"./utils-D-KgF5mV.js";import"./index-CQUljECt.js";import"./index-Cyyfgiou.js";import"./index-CjkJyM6P.js";import"./index-TfP-1Own.js";import"./index-DhTYVmtt.js";import"./index-MS7JGIS8.js";import"./floating-ui.dom-eiE65J5j.js";import"./index-DygBQkXJ.js";import"./index-C_G9iF1W.js";import"./index-Bf3MYqwD.js";import"./triangle-alert-CJCKiVvc.js";import"./x-DMdqOVgw.js";import"./constructNow-DtVD-0hX.js";import"./en-US-DNUEYIb-.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M16 10h.01",key:"1m94wz"}]],G=ne("MessageSquareMore",he),J={default:{title:"No potential supervisors yet",description:"Start by adding supervisors from your recommendations list to keep track of who you want to approach."},search:{title:"No matches found",description:"Try adjusting your search filters or browse the full list."}};function We({shortlist:a=[],requests:f=[],activeRelationship:S=null,isLoading:o=!1,reload:N,onRequestSupervisor:d,onViewRequest:y,onRemoveSuccess:g,emptyState:T="default"}){var _;const[r,j]=c.useState(null),[U,m]=c.useState(!1),[l,b]=c.useState(null),B=c.useMemo(()=>Array.isArray(f)?f.reduce((s,t)=>{if(!["cancelled","auto_cancelled","rejected"].includes(t.status)){const x=String(t.academician_id??"");x&&(s[x]=t)}return s},{}):{},[f]),L=s=>{b(s),m(!0)},p=async()=>{var t,x,h;if(!l)return;const s=(t=l==null?void 0:l.academician)==null?void 0:t.academician_id;if(!s){w.error("Unable to identify supervisor to remove"),m(!1),b(null);return}j(s),m(!1);try{await Y.delete(route("supervision.shortlist.destroy",s)),w.success("Removed from your potential supervisor list"),g==null||g(l),N==null||N()}catch(u){$(u,"Supervision handleRemove");const v=((h=(x=u==null?void 0:u.response)==null?void 0:x.data)==null?void 0:h.message)||"Failed to remove supervisor";w.error(v)}finally{j(null),b(null)}},C=!o&&(!Array.isArray(a)||a.length===0),{title:n,description:z}=c.useMemo(()=>J[T]??J.default,[T]);return o?e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:Array.from({length:4}).map((s,t)=>e.jsxs("div",{className:"border border-dashed rounded-xl p-4 sm:p-5 bg-white shadow-sm animate-pulse min-h-[320px] sm:min-h-[340px] flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-1.5 sm:space-y-2 min-w-0",children:[e.jsx("div",{className:"h-3.5 sm:h-4 w-28 sm:w-32 rounded bg-slate-200"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-20 sm:w-24 rounded bg-slate-100"})]})]}),e.jsx("div",{className:"h-2.5 sm:h-3 w-16 sm:w-20 rounded bg-slate-100 flex-shrink-0"})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-3 sm:gap-4 flex-wrap",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-20 sm:w-24 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-24 sm:w-28 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-16 sm:w-20 rounded bg-slate-100"})]}),e.jsxs("div",{className:"mt-3 flex-1",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-24 sm:w-32 rounded bg-slate-100 mb-2"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("div",{className:"h-5 sm:h-6 w-28 sm:w-32 rounded-full bg-slate-100"}),e.jsx("div",{className:"h-5 sm:h-6 w-16 sm:w-20 rounded-full bg-slate-100"})]}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"h-5 sm:h-6 w-12 sm:w-16 rounded-full bg-slate-100"})})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex flex-col xs:flex-row items-stretch xs:items-center gap-2 pt-3 sm:pt-4 border-t border-slate-200",children:[e.jsx("div",{className:"h-9 sm:h-10 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-9 sm:h-10 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-9 sm:h-10 w-full xs:w-10 rounded bg-slate-200"})]})]},`potential-skeleton-${t}`))}):C?e.jsxs(W,{className:"border-dashed border-slate-200",children:[e.jsx(X,{children:e.jsx(Z,{className:"text-lg font-semibold text-slate-800",children:n})}),e.jsx(V,{className:"text-sm text-slate-600",children:z}),e.jsx(q,{children:e.jsx(M,{variant:"outline",onClick:()=>d==null?void 0:d(null),children:"Find supervisors"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:a.map(s=>{var u,v,k,P,F,I,A;const t=(s==null?void 0:s.academician_id)??((k=(v=(u=s==null?void 0:s.academician)==null?void 0:u.user)==null?void 0:v.academician)==null?void 0:k.academician_id)??((P=s==null?void 0:s.academician)==null?void 0:P.academician_id)??((I=(F=s==null?void 0:s.academician)==null?void 0:F.user)==null?void 0:I.academician_id),x=t?B[String(t)]:null,h=(A=s==null?void 0:s.academician)==null?void 0:A.academician_id;return e.jsx(ue,{item:s,existingRequest:x,activeRelationship:S,onRemove:L,onRequest:d,onViewRequest:y,isRemoving:r===h},s.id)})}),e.jsx(re,{show:U,onClose:()=>{m(!1),b(null)},onConfirm:p,title:"Remove from Potential Supervisors",message:`Are you sure you want to remove ${((_=l==null?void 0:l.academician)==null?void 0:_.full_name)||"this supervisor"} from your potential supervisor list? You can always add them back later.`,confirmButtonText:"Yes, Remove"})]})}function ue({item:a,onRemove:f,onRequest:S,onViewRequest:o,isRemoving:N,existingRequest:d,activeRelationship:y=null}){var A,D,H;const[g,T]=c.useState(!1),r=(a==null?void 0:a.academician)??{},j=r.full_name??"Supervisor",U=r.availability_as_supervisor,m=r.profile_picture?`/storage/${r.profile_picture}`:null,l=a!=null&&a.saved_at?te(new Date(a.saved_at),{addSuffix:!0}):null,b=((A=r.university)==null?void 0:A.name)||"",B=r.publications_count??0,L=r.projects_count??0,p=r.research_areas||[],C=r.url||null,n=r==null?void 0:r.user,z=g?p:p.slice(0,1),_=a==null?void 0:a.academician_id,s=c.useMemo(()=>!y||!_?!1:String(y.academician_id)===String(_),[y,_]),t=!!y,[x,h]=c.useState(!1),[u,v]=c.useState(((D=n==null?void 0:n.connection_status_with_auth_user)==null?void 0:D.status)||"not_connected"),[k,P]=c.useState(((H=n==null?void 0:n.connection_status_with_auth_user)==null?void 0:H.connection_id)||null),F=async()=>{if(n!=null&&n.id){h(!0);try{const i=await Y.post(route("api.app.connections.store",n.id));i.data&&i.data.connection&&(v("pending_sent"),P(i.data.connection.id),w.success("Connection request sent"))}catch(i){$(i,"PotentialSupervisorCard connect"),w.error("Failed to send connection request")}finally{h(!1)}}},I=async()=>{if(k){h(!0);try{await Y.patch(route("api.app.connections.accept",k)),v("connected"),w.success("Connection request accepted")}catch(i){$(i,"PotentialSupervisorCard acceptRequest"),w.error("Failed to accept connection")}finally{h(!1)}}};return e.jsxs("div",{className:"border rounded-xl p-4 sm:p-5 bg-white shadow-sm hover:shadow-md transition-shadow min-h-[320px] sm:min-h-[340px] flex flex-col",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 min-w-0",children:[C?e.jsx(K,{href:route("academicians.show",C),className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center overflow-hidden hover:ring-2 hover:ring-indigo-300 transition-all cursor-pointer",children:m?e.jsx("img",{src:m,alt:j,className:"w-full h-full object-cover rounded-full"}):e.jsx(O,{className:"w-5 h-5 text-indigo-600"})})}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center overflow-hidden flex-shrink-0",children:m?e.jsx("img",{src:m,alt:j,className:"w-full h-full object-cover rounded-full"}):e.jsx(O,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[C?e.jsx(K,{href:route("academicians.show",C),children:e.jsx("h3",{className:"text-sm sm:text-[1.05rem] font-semibold text-gray-900 leading-snug truncate hover:text-indigo-600 transition-colors cursor-pointer",children:j})}):e.jsx("h3",{className:"text-sm sm:text-[1.05rem] font-semibold text-gray-900 leading-snug truncate",children:j}),b&&e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate font-normal",children:b})]})]}),l&&e.jsxs("div",{className:"text-[10px] sm:text-xs text-slate-500 flex-shrink-0",children:["Saved ",l]})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center flex-wrap gap-x-3 sm:gap-x-4 gap-y-2 text-xs sm:text-sm text-gray-600",children:[U&&e.jsxs("div",{className:"inline-flex items-center gap-1.5 text-green-700",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:"Accepting Students"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"w-4 h-4 mr-1.5 text-gray-400"}),e.jsxs("span",{children:[B," Publications"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"w-4 h-4 mr-1.5 text-gray-400"}),e.jsxs("span",{children:[L," Projects"]})]})]}),Array.isArray(p)&&p.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-gray-800 text-sm font-medium mb-2",children:"Research Areas:"}),e.jsx(R,{delayDuration:300,children:e.jsx("div",{className:"flex flex-wrap gap-2",children:z.map((i,Q)=>e.jsxs(ee,{children:[e.jsx(se,{asChild:!0,children:e.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full bg-gray-100 text-gray-700 border border-gray-200 line-clamp-1 truncate max-w-[350px] cursor-help",children:i})}),e.jsx(ae,{side:"top",className:"max-w-xs",children:e.jsx("p",{className:"text-xs",children:i})})]},Q))})}),e.jsx("div",{className:"mt-2",children:p.length>1?e.jsx("button",{onClick:()=>T(!g),className:"px-2.5 py-1 text-xs rounded-full bg-indigo-50 text-indigo-700 border border-indigo-200 hover:bg-indigo-100 transition-colors",children:g?"Show less":`+${p.length-1} more`}):e.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full bg-slate-50 text-slate-500 border border-slate-200",children:"1 area"})})]})]}),e.jsxs("div",{className:"flex flex-col xs:flex-row items-stretch xs:items-center gap-2 pt-3 sm:pt-4 border-t",children:[(()=>{if(x)return e.jsx("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-gray-400 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:"Processing..."});switch(u){case"connected":return e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Connected"]});case"pending_sent":return e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-gray-400 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Pending"]});case"pending_received":return e.jsxs("button",{onClick:I,className:"inline-flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700 flex-1",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Accept"]});case"not_connected":default:return e.jsxs("button",{onClick:F,className:"inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 flex-1",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Connect"]})}})(),t?s?e.jsxs(M,{className:"flex-1 border-2 border-green-500 bg-green-50 text-green-700 hover:bg-green-100",onClick:()=>o==null?void 0:o(d),children:[e.jsx(de,{className:"mr-2 h-4 w-4 fill-current"}),"Your Current Supervisor"]}):e.jsxs(M,{className:"flex-1",variant:"outline",disabled:!0,children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Request"]}):e.jsx(M,{className:"flex-1 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50",variant:"ghost",onClick:()=>d?o==null?void 0:o(d):S==null?void 0:S(a),children:d?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"View Request"]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Request"]})}),e.jsx(M,{type:"button",variant:"outline",size:"icon",disabled:N,onClick:()=>f==null?void 0:f(a),className:"h-10 w-10",children:N?e.jsx(me,{className:"h-4 w-4 animate-spin"}):e.jsx(xe,{className:"h-4 w-4"})})]})]})}export{We as default};
