import{r as o,a as D,j as s,y as w}from"./app-DlrLkdql.js";import{V as n}from"./index-B_EXF9H_.js";import te from"./SkillsDomainFormModal-a91Mj84M.js";import re from"./SkillsSubdomainFormModal-DTCQkBEH.js";import oe from"./SkillFormModal-CmbJIEYY.js";import F from"./ConfirmationModal-CIxNaV8g.js";import{b as C,h as M,m as E,n as A}from"./index-C4Dw6-hd.js";import"./iconBase-CNX8JClf.js";function be(){const[_,I]=o.useState([]),[$,P]=o.useState([]),[T,O]=o.useState([]),[h,d]=o.useState({domains:!0,subdomains:!1,skills:!1}),[t,L]=o.useState(null),[r,p]=o.useState(null),[i,Q]=o.useState({domains:"",subdomains:"",skills:""}),[c,a]=o.useState({domainForm:!1,subdomainForm:!1,skillForm:!1,domainDelete:!1,subdomainDelete:!1,skillDelete:!1}),[u,f]=o.useState(null),[x,g]=o.useState(null),[b,y]=o.useState(null),[j,m]=o.useState({domain:"create",subdomain:"create",skill:"create"});o.useEffect(()=>{k()},[i.domains]),o.useEffect(()=>{t?v():(P([]),p(null))},[t,i.subdomains]),o.useEffect(()=>{r?N():O([])},[r,i.skills]);const k=async()=>{d(e=>({...e,domains:!0}));try{const e=await D.get("/api/v1/app/skills-domains",{params:{per_page:100,search:i.domains||void 0}});I(e.data.data)}catch(e){console.error("Error fetching skills domains:",e),n.error("Failed to load skills domains")}finally{d(e=>({...e,domains:!1}))}},v=async()=>{if(t){d(e=>({...e,subdomains:!0}));try{const e=await D.get("/api/v1/app/skills-subdomains",{params:{skills_domain_id:t.id,per_page:100,search:i.subdomains||void 0,with_domain:!0}});P(e.data.data)}catch(e){console.error("Error fetching skills subdomains:",e),n.error("Failed to load skills subdomains")}finally{d(e=>({...e,subdomains:!1}))}}},N=async()=>{if(r){d(e=>({...e,skills:!0}));try{const e=await D.get("/api/v1/app/skills",{params:{skills_subdomain_id:r.id,per_page:100,search:i.skills||void 0,with_hierarchy:!0}});O(e.data.data)}catch(e){console.error("Error fetching skills:",e),n.error("Failed to load skills")}finally{d(e=>({...e,skills:!1}))}}},V=e=>{L(e),p(null)},H=e=>{p(e)},S=(e,l)=>{Q(ae=>({...ae,[e]:l}))},R=()=>{f(null),m(e=>({...e,domain:"create"})),a(e=>({...e,domainForm:!0}))},q=e=>{f(e),m(l=>({...l,domain:"edit"})),a(l=>({...l,domainForm:!0}))},z=e=>{f(e),a(l=>({...l,domainDelete:!0}))},B=()=>{a(e=>({...e,domainForm:!1})),k()},G=()=>{u&&w.delete(`/admin/data-management/skills-domains/${u.id}`,{preserveScroll:!0,onSuccess:e=>{e.props?.flash?.success&&n.success(e.props.flash.success),e.props?.flash?.error&&n.error(e.props.flash.error),a(l=>({...l,domainDelete:!1})),t&&t.id===u.id&&L(null),k()},onError:e=>{n.error("A client-side error occurred. Please try again."),console.error(e)}})},J=()=>{g(null),m(e=>({...e,subdomain:"create"})),a(e=>({...e,subdomainForm:!0}))},K=e=>{g(e),m(l=>({...l,subdomain:"edit"})),a(l=>({...l,subdomainForm:!0}))},U=e=>{g(e),a(l=>({...l,subdomainDelete:!0}))},W=()=>{a(e=>({...e,subdomainForm:!1})),v()},X=()=>{x&&w.delete(`/admin/data-management/skills-subdomains/${x.id}`,{preserveScroll:!0,onSuccess:e=>{e.props?.flash?.success&&n.success(e.props.flash.success),e.props?.flash?.error&&n.error(e.props.flash.error),a(l=>({...l,subdomainDelete:!1})),r&&r.id===x.id&&p(null),v()},onError:e=>{n.error("A client-side error occurred. Please try again."),console.error(e)}})},Y=()=>{y(null),m(e=>({...e,skill:"create"})),a(e=>({...e,skillForm:!0}))},Z=e=>{y(e),m(l=>({...l,skill:"edit"})),a(l=>({...l,skillForm:!0}))},ee=e=>{y(e),a(l=>({...l,skillDelete:!0}))},se=()=>{a(e=>({...e,skillForm:!1})),N()},le=()=>{b&&w.delete(`/admin/data-management/skills/${b.id}`,{preserveScroll:!0,onSuccess:e=>{e.props?.flash?.success&&n.success(e.props.flash.success),e.props?.flash?.error&&n.error(e.props.flash.error),a(l=>({...l,skillDelete:!1})),N()},onError:e=>{n.error("A client-side error occurred. Please try again."),console.error(e)}})};return s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Skills Taxonomy Hierarchy"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Skills Domains"}),s.jsxs("button",{onClick:R,className:"inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",children:[s.jsx(C,{className:"mr-1"})," Add"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(M,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:i.domains,onChange:e=>S("domains",e.target.value),placeholder:"Search domains...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:h.domains?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):_.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No domains found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:_.map(e=>s.jsxs("li",{className:`py-3 px-2 cursor-pointer hover:bg-gray-50 ${t&&t.id===e.id?"bg-blue-50":""}`,onClick:()=>V(e),children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:l=>{l.stopPropagation(),q(e)},className:"text-blue-600 hover:text-blue-900",children:s.jsx(E,{})}),s.jsx("button",{onClick:l=>{l.stopPropagation(),z(e)},className:"text-red-600 hover:text-red-900",children:s.jsx(A,{})})]})]}),s.jsxs("span",{className:"block text-xs text-gray-500",children:[e.subdomains_count||0," subdomains"]})]},e.id))})})]}),s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Skills Subdomains"}),s.jsxs("button",{onClick:()=>{t&&J()},disabled:!t,className:`inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest ${t?"hover:bg-blue-700 active:bg-blue-900":"opacity-50 cursor-not-allowed"} focus:outline-none focus:border-blue-900 focus:ring ring-blue-300`,children:[s.jsx(C,{className:"mr-1"})," Add Subdomain"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(M,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:i.subdomains,onChange:e=>S("subdomains",e.target.value),placeholder:"Search subdomains...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",disabled:!t})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:t?h.subdomains?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):$.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No subdomains found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:$.map(e=>s.jsxs("li",{className:`py-3 px-2 cursor-pointer hover:bg-gray-50 ${r&&r.id===e.id?"bg-blue-50":""}`,onClick:()=>H(e),children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:l=>{l.stopPropagation(),K(e)},className:"text-blue-600 hover:text-blue-900",children:s.jsx(E,{})}),s.jsx("button",{onClick:l=>{l.stopPropagation(),U(e)},className:"text-red-600 hover:text-red-900",children:s.jsx(A,{})})]})]}),s.jsxs("span",{className:"block text-xs text-gray-500",children:[e.skills_count||0," skills"]})]},e.id))}):s.jsx("p",{className:"text-center py-4 text-gray-500",children:"Select a domain to view subdomains"})})]}),s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Skills"}),s.jsxs("button",{onClick:()=>{r&&Y()},disabled:!r,className:`inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest ${r?"hover:bg-blue-700 active:bg-blue-900":"opacity-50 cursor-not-allowed"} focus:outline-none focus:border-blue-900 focus:ring ring-blue-300`,children:[s.jsx(C,{className:"mr-1"})," Add Skill"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(M,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:i.skills,onChange:e=>S("skills",e.target.value),placeholder:"Search skills...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",disabled:!r})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:r?h.skills?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):T.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No skills found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:T.map(e=>s.jsx("li",{className:"py-3 px-2 hover:bg-gray-50",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),e.description&&s.jsx("span",{className:"block text-xs text-gray-500 mt-1",children:e.description}),s.jsxs("span",{className:"block text-xs text-gray-400 mt-1",children:[e.users_count||0," users"]})]}),s.jsxs("div",{className:"flex space-x-2 ml-2",children:[s.jsx("button",{onClick:()=>Z(e),className:"text-blue-600 hover:text-blue-900",children:s.jsx(E,{})}),s.jsx("button",{onClick:()=>ee(e),className:"text-red-600 hover:text-red-900",children:s.jsx(A,{})})]})]})},e.id))}):s.jsx("p",{className:"text-center py-4 text-gray-500",children:"Select a subdomain to view skills"})})]})]}),s.jsx(te,{isOpen:c.domainForm,onClose:B,domain:u,mode:j.domain}),s.jsx(re,{isOpen:c.subdomainForm,onClose:W,subdomain:x,domainId:t?t.id:null,selectedDomain:t,mode:j.subdomain}),s.jsx(oe,{isOpen:c.skillForm,onClose:se,skill:b,subdomainId:r?r.id:null,selectedSubdomain:r,mode:j.skill}),s.jsx(F,{isOpen:c.domainDelete,title:"Delete Skills Domain",message:`Are you sure you want to delete "${u?.name}"? This action cannot be undone.`,onConfirm:G,onCancel:()=>a(e=>({...e,domainDelete:!1}))}),s.jsx(F,{isOpen:c.subdomainDelete,title:"Delete Skills Subdomain",message:`Are you sure you want to delete "${x?.name}"? This action cannot be undone.`,onConfirm:X,onCancel:()=>a(e=>({...e,subdomainDelete:!1}))}),s.jsx(F,{isOpen:c.skillDelete,title:"Delete Skill",message:`Are you sure you want to delete "${b?.name}"? This action cannot be undone.`,onConfirm:le,onCancel:()=>a(e=>({...e,skillDelete:!1}))})]})}export{be as default};
