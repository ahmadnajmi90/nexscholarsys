import{r as l,j as e,a as V,b as re}from"./app-6Mso6ff_.js";import{g as q,h as ne,i as le,j as oe,k as ce}from"./index-C5PP5upB.js";import de from"./RecommendationModal-DvkOt_Om.js";import me from"./RecommendationDisplay-Dwsg5tvK.js";import xe from"./ProfileCard-7kttGUYr.js";import{m as he}from"./proxy-DasNDpcU.js";import{S as Q}from"./sparkles-fdcrkbyY.js";function H({searchType:n,searchResults:r,universitiesList:y,faculties:I,researchOptions:g,users:C,skills:O,selectedArea:x,selectedUniversity:h,selectedAvailability:P,selectedSkills:N,onLoadMore:_,isLoadingMore:u,onShowInsight:$}){const[F,d]=l.useState(!1),[M,m]=l.useState(!1),[a,j]=l.useState(null),[J,B]=l.useState(!1),[ue,K]=l.useState(""),[X,A]=l.useState(!1),[W,Y]=l.useState(null),[T,z]=l.useState([]),[L,Z]=l.useState(!1),[E,D]=l.useState(!1),b=l.useRef(null);if(l.useEffect(()=>{D(!r)},[r]),l.useEffect(()=>{if(r&&r.matches){z([]);const s=r.matches.slice(0,6);if(z(s),r.matches.slice(6).length>0){const i=setTimeout(()=>{z(r.matches)},300);return()=>clearTimeout(i)}}},[r]),l.useEffect(()=>{const s=new IntersectionObserver(([t])=>{Z(t.isIntersecting)},{threshold:.1});return b.current&&s.observe(b.current),()=>{b.current&&s.unobserve(b.current)}},[b]),l.useEffect(()=>{L&&!u&&r&&r.has_more&&f.length>0&&_()},[L,u,r]),!r||!r.matches||r.matches.length===0)return null;const f=r.matches.filter(s=>{const t=s.academician||s.student||{};if(x&&x.length>0){const i=n==="supervisor"||n==="collaborators"&&s.result_type==="academician"?t.research_expertise:t.student_type==="postgraduate"?t.field_of_research:t.research_preference;if(!i||!Array.isArray(i)||!i.some(o=>x.includes(o)))return!1}if(h&&h.length>0&&(!t.university||!h.includes(t.university.toString()))||N&&N.length>0&&(!t.skills||!Array.isArray(t.skills)||!t.skills.some(i=>N.includes(i.id))))return!1;if(P){let i;n==="supervisor"?i="availability_as_supervisor":n==="students"?i="supervisorAvailability":n==="collaborators"&&(i=s.result_type==="academician"?"availability_as_supervisor":"supervisorAvailability");const o=t[i];if(o===void 0||o.toString()!==P)return!1}return!0}),U=s=>{m(!0),A(!0);let t=s.ai_insights||"";if(!t){const c=r.matches.find(v=>{const p=v.academician||v.student||{};return(p.id||p.academician_id||p.postgraduate_id||p.undergraduate_id)===(s.academician_id||s.postgraduate_id||s.undergraduate_id||s.id)});t=(c==null?void 0:c.ai_insights)||""}let i=t;if(t){const c=/\b(\d+-\d+-\d+)\b/g;(t.match(c)||[]).forEach(p=>{const S=g.find(k=>`${k.field_of_research_id}-${k.research_area_id}-${k.niche_domain_id}`===p);if(S){const k=`${S.field_of_research_name} - ${S.research_area_name} - ${S.niche_domain_name}`;i=i.replace(new RegExp(p,"g"),k)}})}const o={...s,ai_insights:t,processedInsights:i};console.log("Enhanced profile with insights:",o),j(o),K(i);const w=s.academician_id||s.result_type==="academician",ie=s.academician_id||s.postgraduate_id||s.undergraduate_id||s.id;w?re.get(route("academicians.quick-info",ie)).then(c=>{if(c.data&&c.data.academician){const v={...o,...c.data.academician,ai_insights:t,processedInsights:i,projects_count:c.data.projects_count||0,grants_count:c.data.grants_count||0,publications_count:c.data.publications_count||0};console.log("Final updatedProfile with insights preserved:",v),j(v)}d(!0),m(!1),A(!1)}).catch(c=>{console.error("Error fetching academician detail:",c),d(!0),m(!1),A(!1)}):(d(!0),m(!1),A(!1))},R=(s,t)=>{t.preventDefault(),Y(s),B(!0)},ee=()=>{B(!1)},se=()=>(a==null?void 0:a.grants_count)||0,ae=()=>(a==null?void 0:a.projects_count)||0,te=()=>(a==null?void 0:a.publications_count)||0;return e.jsxs("div",{className:"space-y-8",children:[E&&e.jsx(G,{isSearching:!0,searchQuery:(r==null?void 0:r.query)||"",showHeader:!0,visibleCount:6,universitiesList:y,faculties:I,users:C,researchOptions:g}),!E&&r&&r.matches&&f.length===0&&e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No results match your filters. Try adjusting your filter criteria."})}),!E&&r&&r.matches&&f.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 lg:gap-10",children:[f.slice(0,T.length).map((s,t)=>{const i=s.academician||s.student||{},o=i.id||i.academician_id||i.postgraduate_id||i.undergraduate_id||t;return e.jsx(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:t*.05,ease:"easeOut"},children:e.jsx(xe,{match:s,universitiesList:y,researchOptions:g,users:C,onQuickInfoClick:U,onRecommendClick:R,onShowInsight:$})},`${s.result_type}-${o}`)}),f.length>T.length&&e.jsx("div",{className:"col-span-full",children:e.jsx(G,{isSearching:!0,showHeader:!1,visibleCount:Math.min(3,f.length-T.length),universitiesList:y,faculties:I,users:C,researchOptions:g,searchQuery:"Loading more profiles..."})})]}),r.has_more&&e.jsx("div",{ref:b,className:"mt-12 text-center py-6",children:u?e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsxs("svg",{className:"animate-spin h-6 w-6 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e.jsx("span",{className:"text-gray-600 font-medium",children:"Loading more results..."})]}):e.jsxs("button",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white px-8 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1",onClick:_,children:[e.jsx(Q,{className:"h-5 w-5"}),e.jsx("span",{children:"Load More Results"})]})}),!r.has_more&&f.length>0&&e.jsx("div",{className:"mt-12 text-center py-6",children:e.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-400",children:[e.jsx("div",{className:"h-px w-12 bg-gray-300"}),e.jsx("span",{className:"text-sm font-medium",children:"End of results"}),e.jsx("div",{className:"h-px w-12 bg-gray-300"})]})})]}),!E&&r&&r.matches&&r.matches.length===0&&e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(q,{className:"text-gray-400 text-5xl mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-gray-700 mb-2",children:"No matching results found"}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"Try broadening your search terms or exploring different research areas."})]}),F&&a&&e.jsxs(e.Fragment,{children:[console.log("Modal opening with selectedProfile:",a),console.log("AI insights available:",a.ai_insights),e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>d(!1)}),e.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg p-6 w-11/12 max-w-lg max-h-[80vh] overflow-y-auto z-10",onClick:s=>s.stopPropagation(),children:[M?e.jsxs("div",{className:"flex flex-col items-center justify-center py-10",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-500 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e.jsx("p",{className:"text-gray-600",children:"Loading profile information..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-gray-800",children:a.full_name}),e.jsx("hr",{className:"border-t border-gray-800 mb-4"}),e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("h4",{className:"text-lg font-semibold text-blue-800 mb-2 flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"AI Match Insights"]}),console.log("Rendering AI insights section with:",{ai_insights:a.ai_insights,processedInsights:a.processedInsights}),X?e.jsxs("div",{className:"flex items-center justify-center p-4",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e.jsx("p",{className:"text-gray-600",children:"Generating detailed insights..."})]}):e.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:a.processedInsights||a.ai_insights||"No insights available for this profile."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Short Bio"}),e.jsx("p",{className:"text-gray-600 whitespace-pre-line",children:a.bio||"Not Provided"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:a.academician_id?"Research Expertise":"Research Interests"}),e.jsx("div",{className:"",children:(()=>{let s=[];return a.academician_id?s=a.research_expertise||[]:a.postgraduate_id||a.student_type==="postgraduate"?s=a.field_of_research||[]:s=a.research_preference||[],Array.isArray(s)&&s.length>0?e.jsx("div",{className:"space-y-2",children:s.map((t,i)=>{const o=g.find(w=>`${w.field_of_research_id}-${w.research_area_id}-${w.niche_domain_id}`===t);return o?e.jsxs("p",{className:"text-gray-600",children:[i+1,". ",o.field_of_research_name," - ",o.research_area_name," - ",o.niche_domain_name]},i):e.jsxs("p",{className:"text-gray-600",children:[i+1,". ",t]},i)})}):e.jsx("p",{className:"text-gray-600",children:"Not Provided"})})()})]}),a.academician_id&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Style of Supervision"}),e.jsx("div",{className:"space-y-2",children:Array.isArray(a.style_of_supervision)&&a.style_of_supervision.length>0?e.jsx("div",{className:"mt-2 text-normal text-gray-600",children:a.style_of_supervision.map((s,t)=>e.jsxs("div",{className:"mb-2",children:[e.jsxs("span",{className:"font-medium",children:[t+1,". ",s]}),e.jsxs("div",{className:"ml-4 text-sm",children:[s==="Directive Supervision"&&"Structured approach with active guidance and regular monitoring",s==="Facilitative Supervision"&&"Supportive approach encouraging student independence",s==="Coaching Supervision"&&"Focuses on personal development and academic growth",s==="Adaptive Supervision"&&"Flexible support based on student's changing needs",s==="Participatory Supervision"&&"Collaborative approach with shared decision-making"]})]},t))}):e.jsx("p",{className:"text-gray-600",children:"Not Specified"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Supervised Student"}),e.jsx("p",{className:"text-gray-600",children:a.supervised_students_count||"Not Provided"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Available Grant and Project"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("p",{className:"text-gray-600",children:[se()+ae()," Projects/Grants"]}),e.jsxs(V,{href:route("academicians.projects",a.url||a.academician_id),className:"mt-2 self-start text-xs px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition duration-200 flex items-center",children:[e.jsx("span",{children:"View Projects"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Publication"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("p",{className:"text-gray-600",children:[te()," Publications"]}),e.jsxs(V,{href:route("academicians.publications",a.url||a.academician_id),className:"mt-2 self-start text-xs px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition duration-200 flex items-center",children:[e.jsx("span",{children:"View Publications"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Recommendation by Others"}),e.jsx(me,{academicianId:a.academician_id||a.id})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Skills"}),Array.isArray(a.skills)&&a.skills.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:a.skills.map((s,t)=>{let i=s.name;return s.subdomain&&s.subdomain.domain?i=`${s.subdomain.domain.name} - ${s.subdomain.name} - ${s.name}`:s.full_name?i=s.full_name:i=s.name||`Skill #${t+1}`,e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:i},s.id||t)})}):e.jsx("p",{className:"text-gray-600",children:"No skills listed"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Connect via"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[a.google_scholar&&e.jsx("a",{href:a.google_scholar,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 text-lg hover:text-red-700",title:"Google Scholar",children:e.jsx(ne,{})}),a.personal_website&&e.jsx("a",{href:a.personal_website,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 text-lg hover:text-green-700",title:"Personal Website",children:e.jsx(le,{})}),a.institution_website&&e.jsx("a",{href:a.institution_website,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 text-lg hover:text-blue-700",title:"Institutional Website",children:e.jsx(oe,{})}),a.linkedin&&e.jsx("a",{href:a.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 text-lg hover:text-blue-800",title:"LinkedIn",children:e.jsx(ce,{})})]})]})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>d(!1),className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition duration-200",children:"Close"})})]})})]})]}),J&&W&&e.jsx(de,{academician:W,onClose:()=>B(!1),onSuccess:ee})]})}const _e=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"})),G=({searchResults:n,universitiesList:r,faculties:y,users:I,researchOptions:g,searchQuery:C,isSearching:O,isLoadingMore:x=!1,onLoadMore:h=()=>{},showHeader:P=!0,visibleCount:N=6})=>{const[_,u]=l.useState([]),[$,F]=l.useState(!1),d=l.useRef(null);l.useEffect(()=>{if(n&&n.matches){u([]);const m=n.matches.slice(0,6);if(u(m),n.matches.slice(6).length>0){const j=setTimeout(()=>{u(n.matches)},300);return()=>clearTimeout(j)}}},[n]),l.useEffect(()=>{const m=new IntersectionObserver(([a])=>{F(a.isIntersecting)},{threshold:.1});return d.current&&m.observe(d.current),()=>{d.current&&m.unobserve(d.current)}},[d]),l.useEffect(()=>{$&&!x&&n&&n.has_more&&_.length>0&&h()},[$,x,n,h]);const M=m=>Array(m).fill(null).map((a,j)=>e.jsx(ge,{},`skeleton-${j}`));return O&&(!n||!n.matches)?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6",children:M(N)}):n&&n.matches?e.jsxs("div",{children:[P&&e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:['Supervisor Matches for "',n.query,'"']}),e.jsxs("span",{className:"text-gray-500",children:[n.total," match",n.total!==1?"es":""," found"]})]}),e.jsx(H,{searchType:"supervisor",searchResults:{...n,matches:_},universitiesList:r,faculties:y,users:I,researchOptions:g,onLoadMore:h,isLoadingMore:x}),n.has_more&&e.jsx("div",{ref:d,className:"mt-8 text-center py-4",children:x?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Loading more results..."]}):e.jsx("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md",onClick:h,children:"Load more results"})}),n.total===0&&e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(q,{className:"text-gray-400 text-5xl mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-gray-700 mb-2",children:"No matching supervisors found"}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"Try broadening your search terms or exploring different research areas."})]})]}):null},ge=()=>e.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden relative animate-pulse",children:[e.jsx("div",{className:"h-32 bg-gray-200"}),e.jsx("div",{className:"flex justify-center -mt-12",children:e.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-300 border-4 border-white"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4 mx-auto mb-3"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6 mx-auto mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6 mx-auto mb-4"}),e.jsxs("div",{className:"mt-3 bg-gray-100 p-3 rounded-md",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full mb-1"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6 mb-1"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"})]}),e.jsxs("div",{className:"mt-4 flex justify-center gap-2",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-24"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-24"})]})]}),e.jsxs("div",{className:"mt-4 border-t border-gray-100 p-4 flex justify-around",children:[e.jsx("div",{className:"h-6 w-6 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-6 w-6 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-6 w-6 bg-gray-200 rounded-full"})]})]}),we=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"}));export{we as P,H as R,_e as a};
