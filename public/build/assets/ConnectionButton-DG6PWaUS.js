import{r as i,j as t,a as r}from"./app-CggFNCKr.js";import{t as m,E as h,G as C,H as y,d as w,B as k}from"./index-BXqcWhqw.js";const S=({user:e,onRemoveConnection:l})=>{var x,p;e&&!e.connection_status_with_auth_user&&console.warn("DATA MISSING: 'connection_status_with_auth_user' not found for user:",e.name||e.id);const[_,o]=i.useState(!1),[g,c]=i.useState(((x=e==null?void 0:e.connection_status_with_auth_user)==null?void 0:x.status)||"not_connected"),[s,a]=i.useState(((p=e==null?void 0:e.connection_status_with_auth_user)==null?void 0:p.connection_id)||null);if(!e||!e.connection_status_with_auth_user)return null;const u=async()=>{o(!0);try{const n=await r.post(route("api.app.connections.store",e.id));n.data&&n.data.connection&&(c("pending_sent"),a(n.data.connection.id))}catch(n){console.error("Error sending connection request:",n)}finally{o(!1)}},f=async()=>{o(!0);try{await r.patch(route("api.app.connections.accept",s)),c("connected")}catch(n){console.error("Error accepting connection request:",n)}finally{o(!1)}},j=async()=>{o(!0);try{await r.delete(route("api.app.connections.reject",s)),c("not_connected"),a(null)}catch(n){console.error("Error rejecting connection request:",n)}finally{o(!1)}},d=async()=>{if(l){l(e.connection_status_with_auth_user);return}o(!0);try{await r.delete(route("api.app.connections.destroy",s)),c("not_connected"),a(null)}catch(n){console.error("Error removing connection:",n)}finally{o(!1)}};if(_)return t.jsx("div",{className:"text-gray-500 text-lg cursor-wait",title:"Processing...",children:t.jsx(m,{className:"animate-spin"})});switch(g){case"not_connected":return t.jsx("button",{onClick:u,className:"text-gray-500 text-lg cursor-pointer hover:text-blue-700",title:"Connect",children:t.jsx(h,{})});case"pending_sent":return t.jsx("button",{onClick:d,className:"text-yellow-500 text-lg cursor-pointer hover:text-red-500",title:"Request Sent (Click to withdraw)",children:t.jsx(k,{})});case"pending_received":return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:f,className:"text-green-500 text-lg cursor-pointer hover:text-green-700",title:"Accept Request",children:t.jsx(y,{})}),t.jsx("button",{onClick:j,className:"text-red-500 text-lg cursor-pointer hover:text-red-700",title:"Reject Request",children:t.jsx(w,{})})]});case"connected":return t.jsx("button",{onClick:d,className:"text-green-600 text-lg cursor-pointer hover:text-red-600",title:"Connected (Click to remove)",children:t.jsx(C,{})});case"is_self":return null;default:return t.jsx("button",{onClick:u,className:"text-gray-500 text-lg cursor-pointer hover:text-blue-700",title:"Connect",children:t.jsx(h,{})})}};export{S as C};
