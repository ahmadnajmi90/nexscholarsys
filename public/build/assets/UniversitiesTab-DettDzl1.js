import{r,a as U,j as e,y as F}from"./app-xmIh42KO.js";import{V as a}from"./index-DjSnSkN9.js";import D from"./UniversityFormModal-B2vrvB0U.js";import E from"./ConfirmationModal-Cm9Dlown.js";import{P}from"./Pagination-BjA_hyeD.js";import{b as A,h as O,m as I,n as T}from"./index-D9eridZg.js";import"./NationalityForm-D20VvU6P.js";import"./InputError-BgseXp0P.js";import"./react-select.esm-D3B9IQQc.js";import"./index-CLSrQ3eM.js";import"./floating-ui.dom-D5EC_49c.js";import"./chevron-left-CugAg8G6.js";import"./createLucideIcon-DVFNR6_B.js";import"./chevron-right-W86pD0Cb.js";import"./iconBase-CmbK3yE2.js";function Z(){const[l,f]=r.useState([]),[u,h]=r.useState(!0),[c,y]=r.useState(""),[n,d]=r.useState({current_page:1,per_page:10,total:0,last_page:1}),[b,p]=r.useState(!1),[j,m]=r.useState(!1),[i,x]=r.useState(null),[v,g]=r.useState("create");r.useEffect(()=>{o()},[n.current_page,c]);const o=async()=>{h(!0);try{const t=await U.get("/api/v1/app/universities",{params:{page:n.current_page,per_page:n.per_page,search:c||void 0}});f(t.data.data),d({current_page:t.data.meta.current_page,per_page:t.data.meta.per_page,total:t.data.meta.total,last_page:t.data.meta.last_page})}catch(t){console.error("Error fetching universities:",t),a.error("Failed to load universities")}finally{h(!1)}},N=t=>{d(s=>({...s,current_page:t}))},w=t=>{t.preventDefault(),d(s=>({...s,current_page:1}))},_=()=>{x(null),g("create"),p(!0)},S=t=>{x(t),g("edit"),p(!0)},C=t=>{x(t),m(!0)},k=()=>{if(!i)return;(async()=>{try{F.delete(`/admin/data-management/universities/${i.id}`),a.success("University deleted successfully!"),o()}catch(s){s.response?s.response.status===404?(a.error("University not found. It may have been already deleted."),o()):s.response.status===409?a.error("Cannot delete university with existing faculties. Delete the faculties first."):s.response.data?.error?a.error(s.response.data.error):s.response.data?.message?a.error(s.response.data.message):a.error(`Error (${s.response.status}): Unable to delete university.`):a.error("Network error or server not responding."),console.error("Error deleting university:",s)}finally{m(!1)}})()},M=()=>{p(!1),o()};return e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Universities"}),e.jsxs("button",{onClick:_,className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",children:[e.jsx(A,{className:"mr-2"})," Add University"]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("form",{onSubmit:w,className:"flex",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(O,{className:"text-gray-400"})}),e.jsx("input",{type:"text",value:c,onChange:t=>y(t.target.value),placeholder:"Search universities...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsx("button",{type:"submit",className:"ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Search"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Short Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Country"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Faculties"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center",children:"Loading..."})}):l.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center",children:"No universities found"})}):l.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.full_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.short_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.country}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.faculties_count||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsxs("button",{onClick:()=>S(t),className:"text-blue-600 hover:text-blue-900 mr-4",children:[e.jsx(I,{className:"inline"})," Edit"]}),e.jsxs("button",{onClick:()=>C(t),className:"text-red-600 hover:text-red-900",children:[e.jsx(T,{className:"inline"})," Delete"]})]})]},t.id))})]})}),!u&&l.length>0&&e.jsx("div",{className:"mt-6",children:e.jsx(P,{currentPage:n.current_page,totalPages:n.last_page,onPageChange:N})}),e.jsx(D,{isOpen:b,onClose:M,university:i,mode:v}),e.jsx(E,{isOpen:j,title:"Delete University",message:`Are you sure you want to delete ${i?.full_name}? This action cannot be undone.`,onConfirm:k,onCancel:()=>m(!1)})]})}export{Z as default};
