import{r as u,j as e,a as x}from"./app-BL9WZyvk.js";import{c as j,I as y,J as _,a as v,K as w,p as N,L as f,M as C,A as k}from"./index-CHEHwucL.js";function F({academician:t,onClose:l,onSuccess:h}){const[n,p]=u.useState({academician_id:t.academician_id,communication_comment:"",support_comment:"",expertise_comment:"",responsiveness_comment:""}),[o,c]=u.useState({}),[i,m]=u.useState(!1),d=(s,r)=>{p({...n,[s]:r})},g=s=>{s.preventDefault(),m(!0),c({}),x.post(route("academicians.recommendations.store"),n).then(r=>{m(!1),h&&h()}).catch(r=>{m(!1),r.response&&r.response.data.errors?c(r.response.data.errors):r.response&&r.response.data.error?c({general:r.response.data.error}):c({general:"An error occurred while submitting your recommendation."})})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:l,children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-11/12 max-w-lg max-h-[90vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Recommend ",t.full_name]}),e.jsx("button",{onClick:l,className:"text-gray-500 hover:text-gray-700 focus:outline-none",children:e.jsx(j,{})})]}),o.general&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6",children:e.jsx("div",{className:"flex",children:e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:o.general})})})}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Share your experience working with ",t.full_name,". Your comments will help others make informed decisions."]}),e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(y,{className:"text-blue-500 mr-2 h-5 w-5"}),e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"Communication"})]}),e.jsx("textarea",{rows:"3",className:"shadow-sm block w-full focus:ring-blue-500 focus:border-blue-500 sm:text-sm border-gray-300 rounded-md",placeholder:"How effective is their communication style? Share your thoughts...",value:n.communication_comment,onChange:s=>d("communication_comment",s.target.value)}),o.communication_comment&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.communication_comment})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(_,{className:"text-pink-500 mr-2 h-5 w-5"}),e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"Supportiveness"})]}),e.jsx("textarea",{rows:"3",className:"shadow-sm block w-full focus:ring-blue-500 focus:border-blue-500 sm:text-sm border-gray-300 rounded-md",placeholder:"How supportive are they? Share your experience...",value:n.support_comment,onChange:s=>d("support_comment",s.target.value)}),o.support_comment&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.support_comment})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(v,{className:"text-yellow-500 mr-2 h-5 w-5"}),e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"Expertise & Knowledge"})]}),e.jsx("textarea",{rows:"3",className:"shadow-sm block w-full focus:ring-blue-500 focus:border-blue-500 sm:text-sm border-gray-300 rounded-md",placeholder:"How would you rate their expertise and knowledge? Share your insights...",value:n.expertise_comment,onChange:s=>d("expertise_comment",s.target.value)}),o.expertise_comment&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.expertise_comment})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(w,{className:"text-red-500 mr-2 h-5 w-5"}),e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"Responsiveness & Availability"})]}),e.jsx("textarea",{rows:"3",className:"shadow-sm block w-full focus:ring-blue-500 focus:border-blue-500 sm:text-sm border-gray-300 rounded-md",placeholder:"How responsive and available are they? Share your experience...",value:n.responsiveness_comment,onChange:s=>d("responsiveness_comment",s.target.value)}),o.responsiveness_comment&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.responsiveness_comment})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:i,className:`px-4 py-2 bg-blue-600 text-white rounded-md ${i?"opacity-70 cursor-not-allowed":"hover:bg-blue-700"}`,children:i?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Submitting..."]}):"Submit Recommendation"})]})]})]})})}const q=({user:t,onRemoveConnection:l})=>{var r,b;console.log("ConnectionButton rendered for user:",t==null?void 0:t.name,t),t&&!t.connection_status_with_auth_user&&console.warn("DATA MISSING: 'connection_status_with_auth_user' not found for user:",t.name||t.id);const[h,n]=u.useState(!1),[p,o]=u.useState(((r=t==null?void 0:t.connection_status_with_auth_user)==null?void 0:r.status)||"not_connected"),[c,i]=u.useState(((b=t==null?void 0:t.connection_status_with_auth_user)==null?void 0:b.connection_id)||null);if(!t||!t.connection_status_with_auth_user)return null;const m=async()=>{n(!0);try{const a=await x.post(route("connections.store",t.id));a.data&&a.data.connection&&(o("pending_sent"),i(a.data.connection.id))}catch(a){console.error("Error sending connection request:",a)}finally{n(!1)}},d=async()=>{n(!0);try{await x.patch(route("connections.accept",c)),o("connected")}catch(a){console.error("Error accepting connection request:",a)}finally{n(!1)}},g=async()=>{n(!0);try{await x.delete(route("connections.reject",c)),o("not_connected"),i(null)}catch(a){console.error("Error rejecting connection request:",a)}finally{n(!1)}},s=async()=>{if(l){l(t.connection_status_with_auth_user);return}n(!0);try{await x.delete(route("connections.destroy",c)),o("not_connected"),i(null)}catch(a){console.error("Error removing connection:",a)}finally{n(!1)}};if(h)return e.jsx("div",{className:"text-gray-500 text-lg cursor-wait",title:"Processing...",children:e.jsx(N,{className:"animate-spin"})});switch(p){case"not_connected":return e.jsx("button",{onClick:m,className:"text-gray-500 text-lg cursor-pointer hover:text-blue-700",title:"Connect",children:e.jsx(f,{})});case"pending_sent":return e.jsx("button",{onClick:s,className:"text-yellow-500 text-lg cursor-pointer hover:text-red-500",title:"Request Sent (Click to withdraw)",children:e.jsx(w,{})});case"pending_received":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:d,className:"text-green-500 text-lg cursor-pointer hover:text-green-700",title:"Accept Request",children:e.jsx(k,{})}),e.jsx("button",{onClick:g,className:"text-red-500 text-lg cursor-pointer hover:text-red-700",title:"Reject Request",children:e.jsx(j,{})})]});case"connected":return e.jsx("button",{onClick:s,className:"text-green-600 text-lg cursor-pointer hover:text-red-600",title:"Connected (Click to remove)",children:e.jsx(C,{})});case"is_self":return null;default:return e.jsx("button",{onClick:m,className:"text-gray-500 text-lg cursor-pointer hover:text-blue-700",title:"Connect",children:e.jsx(f,{})})}};export{q as C,F as R};
