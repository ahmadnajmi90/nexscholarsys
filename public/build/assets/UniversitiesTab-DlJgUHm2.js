import{r as a,a as D,j as e,y as E}from"./app-CRunKGlS.js";import{V as r}from"./index-BP2IIEZc.js";import P from"./UniversityFormModal-6bXRKLgO.js";import A from"./ConfirmationModal-Buy1puii.js";import{P as O}from"./Pagination-BuneWXqO.js";import{b as I,h as T,m as $,n as L}from"./index-NUkfhqlZ.js";import"./NationalityForm-vEAY2yns.js";import"./InputError-CC1k1aJi.js";import"./react-select.esm--OnMucC3.js";import"./floating-ui.dom-eiE65J5j.js";import"./chevron-left-Dzj93WX9.js";import"./createLucideIcon-Cn5nLR87.js";import"./chevron-right-CAiHk8VV.js";function Z(){const[c,b]=a.useState([]),[h,g]=a.useState(!0),[d,j]=a.useState(""),[i,p]=a.useState({current_page:1,per_page:10,total:0,last_page:1}),[v,m]=a.useState(!1),[N,x]=a.useState(!1),[n,u]=a.useState(null),[w,f]=a.useState("create");a.useEffect(()=>{l()},[i.current_page,d]);const l=async()=>{g(!0);try{const t=await D.get("/api/v1/app/universities",{params:{page:i.current_page,per_page:i.per_page,search:d||void 0}});b(t.data.data),p({current_page:t.data.meta.current_page,per_page:t.data.meta.per_page,total:t.data.meta.total,last_page:t.data.meta.last_page})}catch(t){console.error("Error fetching universities:",t),r.error("Failed to load universities")}finally{g(!1)}},_=t=>{p(o=>({...o,current_page:t}))},S=t=>{t.preventDefault(),p(o=>({...o,current_page:1}))},C=()=>{u(null),f("create"),m(!0)},k=t=>{u(t),f("edit"),m(!0)},M=t=>{u(t),x(!0)},F=()=>{if(!n)return;(async()=>{var o,y;try{E.delete(`/admin/data-management/universities/${n.id}`),r.success("University deleted successfully!"),l()}catch(s){s.response?s.response.status===404?(r.error("University not found. It may have been already deleted."),l()):s.response.status===409?r.error("Cannot delete university with existing faculties. Delete the faculties first."):(o=s.response.data)!=null&&o.error?r.error(s.response.data.error):(y=s.response.data)!=null&&y.message?r.error(s.response.data.message):r.error(`Error (${s.response.status}): Unable to delete university.`):r.error("Network error or server not responding."),console.error("Error deleting university:",s)}finally{x(!1)}})()},U=()=>{m(!1),l()};return e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Universities"}),e.jsxs("button",{onClick:C,className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",children:[e.jsx(I,{className:"mr-2"})," Add University"]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("form",{onSubmit:S,className:"flex",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(T,{className:"text-gray-400"})}),e.jsx("input",{type:"text",value:d,onChange:t=>j(t.target.value),placeholder:"Search universities...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsx("button",{type:"submit",className:"ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Search"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Short Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Country"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Faculties"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center",children:"Loading..."})}):c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center",children:"No universities found"})}):c.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.full_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.short_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.country}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.faculties_count||0}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsxs("button",{onClick:()=>k(t),className:"text-blue-600 hover:text-blue-900 mr-4",children:[e.jsx($,{className:"inline"})," Edit"]}),e.jsxs("button",{onClick:()=>M(t),className:"text-red-600 hover:text-red-900",children:[e.jsx(L,{className:"inline"})," Delete"]})]})]},t.id))})]})}),!h&&c.length>0&&e.jsx("div",{className:"mt-6",children:e.jsx(O,{currentPage:i.current_page,totalPages:i.last_page,onPageChange:_})}),e.jsx(P,{isOpen:v,onClose:U,university:n,mode:w}),e.jsx(A,{isOpen:N,title:"Delete University",message:`Are you sure you want to delete ${n==null?void 0:n.full_name}? This action cannot be undone.`,onConfirm:F,onCancel:()=>x(!1)})]})}export{Z as default};
