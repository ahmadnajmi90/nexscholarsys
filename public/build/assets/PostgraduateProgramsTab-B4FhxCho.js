import{r as a,a as y,j as e,y as G}from"./app-DVhy0H9p.js";import{V as n}from"./index-Bdu0quS4.js";import{F as H,h as J,r as K,s as W}from"./index-nCyfuPKn.js";import X from"./ConfirmationModal-twLb96kl.js";import Y from"./PostgraduateProgramFormModal-C4avWjpa.js";import{P as Z}from"./Pagination-Did7cf0Q.js";import"./iconBase-Dh95kHzK.js";import"./NationalityForm-Bcxs2WZI.js";import"./InputLabel-NfKQp3wA.js";import"./react-select.esm-ylmqkDPP.js";import"./floating-ui.dom-eiE65J5j.js";import"./InputError-BvKhrgOX.js";import"./dialog-DQyUbXkk.js";import"./transition-rj58jJaf.js";import"./chevron-left-BBhwx14X.js";import"./createLucideIcon-CXlRbZBu.js";import"./chevron-right-BcrJ3O0F.js";function fe(){const[c,_]=a.useState([]),[b,j]=a.useState(!0),[d,F]=a.useState(""),[o,l]=a.useState({current_page:1,per_page:10,total:0,last_page:1}),[r,S]=a.useState(""),[m,u]=a.useState(""),[p,w]=a.useState(""),[C,k]=a.useState([]),[M,v]=a.useState([]),[D]=a.useState(["Masters","PhD"]),[E,i]=a.useState(!1),[T,g]=a.useState(!1),[x,h]=a.useState(null),[A,N]=a.useState("create");a.useEffect(()=>{U()},[]),a.useEffect(()=>{r?O():(v([]),u(""))},[r]),a.useEffect(()=>{f()},[o.current_page,d,r,m,p]);const U=async()=>{try{const t=await y.get("/api/v1/app/universities",{params:{per_page:1e3}});k(t.data.data)}catch(t){console.error("Error fetching universities:",t),n.error("Failed to load universities")}},O=async()=>{if(r)try{const t=await y.get("/api/v1/app/faculties",{params:{university_id:r,per_page:1e3}});v(t.data.data)}catch(t){console.error("Error fetching faculties:",t),n.error("Failed to load faculties")}},f=async()=>{j(!0);try{const t=await y.get("/api/v1/app/postgraduate-programs",{params:{page:o.current_page,per_page:o.per_page,search:d||void 0,university_id:r||void 0,faculty_id:m||void 0,program_type:p||void 0}});_(t.data.data),l({current_page:t.data.meta.current_page,per_page:t.data.meta.per_page,total:t.data.meta.total,last_page:t.data.meta.last_page})}catch(t){console.error(t),n.error("Failed to load Postgraduate Programs")}finally{j(!1)}},I=()=>{h(null),N("create"),i(!0)},L=t=>{h(t),N("edit"),i(!0)},Q=t=>{h(t),g(!0)},V=async()=>{if(x)try{G.delete(`/admin/data-management/postgraduate-programs/${x.id}`),n.success("Postgraduate Program deleted"),g(!1),f()}catch(t){console.error(t),n.error("Delete failed")}},R=t=>l(s=>({...s,current_page:t})),$=t=>{t.preventDefault(),l(s=>({...s,current_page:1}))},q=t=>{S(t.target.value),u(""),l(s=>({...s,current_page:1}))},z=t=>{u(t.target.value),l(s=>({...s,current_page:1}))},B=t=>{w(t.target.value),l(s=>({...s,current_page:1}))};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 bg-gray-100 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filter Programs"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"university-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by University"}),e.jsxs("select",{id:"university-filter",value:r,onChange:q,className:"block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"All Universities"}),C.map(t=>e.jsx("option",{value:t.id,children:t.full_name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"faculty-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Faculty"}),e.jsxs("select",{id:"faculty-filter",value:m,onChange:z,disabled:!r,className:"block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",children:r?"All Faculties":"Select University First"}),M.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"program-type-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Program Type"}),e.jsxs("select",{id:"program-type-filter",value:p,onChange:B,className:"block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"All Program Types"}),D.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("form",{onSubmit:$,className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"border rounded-md py-2 pl-8 pr-3 w-64",placeholder:"Search programs...",value:d,onChange:t=>F(t.target.value)}),e.jsx(H,{className:"absolute left-2 top-3 text-gray-400"})]}),e.jsx("button",{type:"submit",className:"px-3 py-2 bg-blue-600 text-white rounded",children:"Search"})]}),e.jsxs("button",{onClick:I,className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",children:[e.jsx(J,{className:"mr-2"})," Add New Postgraduate Program"]})]}),e.jsx("div",{className:"overflow-x-auto border rounded",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Institution"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funding"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b?e.jsx("tr",{children:e.jsx("td",{className:"px-4 py-4",colSpan:"6",children:"Loading..."})}):c.length===0?e.jsx("tr",{children:e.jsx("td",{className:"px-4 py-4",colSpan:"6",children:"No programs found."})}):c.map(t=>{var s,P;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 align-top",children:t.name}),e.jsxs("td",{className:"px-4 py-2 text-sm align-top",children:[e.jsx("div",{className:"font-medium text-gray-900",children:((s=t.university)==null?void 0:s.full_name)||"-"}),e.jsx("div",{className:"text-xs text-gray-500",children:((P=t.faculty)==null?void 0:P.name)||"N/A Faculty"}),e.jsx("div",{className:"text-xs text-gray-500",children:t.country||""})]}),e.jsx("td",{className:"px-4 py-2 text-sm align-top",children:t.duration_years||"-"}),e.jsx("td",{className:"px-4 py-2 text-sm align-top",children:t.funding_info||"-"}),e.jsxs("td",{className:"px-4 py-2 text-sm align-top",children:[e.jsx("button",{onClick:()=>L(t),className:"inline-flex items-center px-2 py-1 text-blue-600",children:e.jsx(K,{})}),e.jsx("button",{onClick:()=>Q(t),className:"inline-flex items-center px-2 py-1 text-red-600",children:e.jsx(W,{})})]})]},t.id)})})]})}),!b&&c.length>0&&e.jsx("div",{className:"mt-6",children:e.jsx(Z,{currentPage:o.current_page,totalPages:o.last_page,onPageChange:R})}),e.jsx(Y,{isOpen:E,onClose:()=>i(!1),mode:A,currentProgram:x,onSuccess:()=>{i(!1),f()}}),e.jsx(X,{isOpen:T,title:"Delete Postgraduate Program",message:"Are you sure you want to delete this Postgraduate Program? This action cannot be undone.",onCancel:()=>g(!1),onConfirm:V})]})}export{fe as default};
