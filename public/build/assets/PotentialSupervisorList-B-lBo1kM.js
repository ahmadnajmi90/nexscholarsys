import{r as n,j as e,y as E,a as P,b as U}from"./app-D_isCBrZ.js";import{c as u}from"./index-S2oVNL1R.js";import{l as I}from"./logError-BloCzXDJ.js";import{C as O,b as V,c as J,a as Q,d as W}from"./card-D45-gtvy.js";import{B as b}from"./button-CvkXbyNI.js";import{T as X,a as Z,b as ee,c as se}from"./tooltip-CQVkmZ9i.js";import{D as te,a as ae,b as re,c as B}from"./dropdown-menu-DVqPq_ka.js";import{C as ie}from"./ConfirmationModal-DcSTE6QU.js";import{C as ne}from"./chevron-down-Ccqnoyn8.js";import{S as oe}from"./sparkles-DBHFI2EX.js";import{G as le}from"./graduation-cap-BDaXx5-Y.js";import{f as ce}from"./formatDistanceToNow-CZclDLe0.js";import{U as q}from"./user-round-DHB2rLfi.js";import{c as de}from"./createLucideIcon-BT85Csak.js";import{B as me}from"./book-open-Drq3OtfP.js";import{F as xe}from"./folder-kanban-YiDVfHbK.js";import{U as _}from"./user-plus-DBVpKWbN.js";import{E as ue}from"./eye-6RvFiSEB.js";import{S as he}from"./send-BrMxNhUT.js";import{C as pe}from"./circle-check-DHGBAWKG.js";import{L as fe}from"./loader-circle-CUkwbdmU.js";import{T as ge}from"./trash-2-CCAXz_vu.js";import"./utils-CBfrqCZ4.js";import"./index-CL6H2niU.js";import"./index-BxE-5CCQ.js";import"./index-BG6TJDBP.js";import"./index-CoKnqvF_.js";import"./index--9W6mpJI.js";import"./index-BSdNhmJ5.js";import"./index-8kpB6Eh5.js";import"./floating-ui.dom-D5EC_49c.js";import"./index-lKKoak1a.js";import"./index-Be7aubF8.js";import"./index-DKcCfogn.js";import"./index-4DfuBNxG.js";import"./index-DEX240OH.js";import"./index-BlbDubjO.js";import"./index-DD7f-jjb.js";import"./chevron-right-Be2Bs3JC.js";import"./check-Cn-yF-8e.js";import"./circle-oANRF4u5.js";import"./triangle-alert-Ekv-lfWL.js";import"./x-DHPN06jQ.js";import"./constructNow-6bIQB1GK.js";import"./en-US-DIdCsyf3.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M16 10h.01",key:"1m94wz"}]],L=de("MessageSquareMore",je),z={default:{title:"No potential supervisors yet",description:"Start by adding supervisors from your recommendations list to keep track of who you want to approach."},search:{title:"No matches found",description:"Try adjusting your search filters or browse the full list."}};function ms({shortlist:r=[],requests:j=[],activeRelationship:S=null,isLoading:v=!1,reload:N,onRequestSupervisor:h,onViewRequest:p,onRemoveSuccess:w,emptyState:y="default"}){const[a,d]=n.useState(null),[k,o]=n.useState(!1),[m,x]=n.useState(null),A=n.useMemo(()=>Array.isArray(j)?j.reduce((s,t)=>{if(!["cancelled","auto_cancelled","rejected"].includes(t.status)){const c=String(t.academician_id??"");c&&(s[c]=t)}return s},{}):{},[j]),M=s=>{x(s),o(!0)},l=async()=>{if(!m)return;const s=m?.academician?.academician_id;if(!s){u.error("Unable to identify supervisor to remove"),o(!1),x(null);return}d(s),o(!1);try{await P.delete(route("supervision.shortlist.destroy",s)),u.success("Removed from your potential supervisor list"),w?.(m),N?.()}catch(t){I(t,"Supervision handleRemove");const c=t?.response?.data?.message||"Failed to remove supervisor";u.error(c)}finally{d(null),x(null)}},f=!v&&(!Array.isArray(r)||r.length===0),{title:g,description:R}=n.useMemo(()=>z[y]??z.default,[y]);return v?e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:Array.from({length:4}).map((s,t)=>e.jsxs("div",{className:"border border-dashed rounded-xl p-4 sm:p-5 bg-white shadow-sm animate-pulse min-h-[320px] sm:min-h-[340px] flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-1.5 sm:space-y-2 min-w-0",children:[e.jsx("div",{className:"h-3.5 sm:h-4 w-28 sm:w-32 rounded bg-slate-200"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-20 sm:w-24 rounded bg-slate-100"})]})]}),e.jsx("div",{className:"h-2.5 sm:h-3 w-16 sm:w-20 rounded bg-slate-100 flex-shrink-0"})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-3 sm:gap-4 flex-wrap",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-20 sm:w-24 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-24 sm:w-28 rounded bg-slate-100"}),e.jsx("div",{className:"h-2.5 sm:h-3 w-16 sm:w-20 rounded bg-slate-100"})]}),e.jsxs("div",{className:"mt-3 flex-1",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-24 sm:w-32 rounded bg-slate-100 mb-2"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("div",{className:"h-5 sm:h-6 w-28 sm:w-32 rounded-full bg-slate-100"}),e.jsx("div",{className:"h-5 sm:h-6 w-16 sm:w-20 rounded-full bg-slate-100"})]}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"h-5 sm:h-6 w-12 sm:w-16 rounded-full bg-slate-100"})})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex flex-col xs:flex-row items-stretch xs:items-center gap-2 pt-3 sm:pt-4 border-t border-slate-200",children:[e.jsx("div",{className:"h-9 sm:h-10 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-9 sm:h-10 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-9 sm:h-10 w-full xs:w-10 rounded bg-slate-200"})]})]},`potential-skeleton-${t}`))}):f?e.jsxs(O,{className:"border-dashed border-slate-200",children:[e.jsx(V,{children:e.jsx(J,{className:"text-lg font-semibold text-slate-800",children:g})}),e.jsx(Q,{className:"text-sm text-slate-600",children:R}),e.jsx(W,{children:e.jsxs(te,{children:[e.jsx(ae,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:"gap-2",children:["Find supervisors",e.jsx(ne,{className:"w-4 h-4"})]})}),e.jsxs(re,{align:"start",className:"w-56",children:[e.jsxs(B,{onSelect:()=>E.visit(route("ai.matching.index")),className:"gap-2 cursor-pointer",children:[e.jsx(oe,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{children:"AI Matching"})]}),e.jsxs(B,{onSelect:()=>E.visit(route("postgraduate-recommendations.index")),className:"gap-2 cursor-pointer",children:[e.jsx(le,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:"Postgraduate Program Recommendations"})]})]})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:r.map(s=>{const t=s?.academician_id??s?.academician?.user?.academician?.academician_id??s?.academician?.academician_id??s?.academician?.user?.academician_id,c=t?A[String(t)]:null,T=s?.academician?.academician_id;return e.jsx(ve,{item:s,existingRequest:c,activeRelationship:S,onRemove:M,onRequest:h,onViewRequest:p,isRemoving:a===T},s.id)})}),e.jsx(ie,{show:k,onClose:()=>{o(!1),x(null)},onConfirm:l,title:"Remove from Potential Supervisors",message:`Are you sure you want to remove ${m?.academician?.full_name||"this supervisor"} from your potential supervisor list? You can always add them back later.`,confirmButtonText:"Yes, Remove"})]})}function ve({item:r,onRemove:j,onRequest:S,onViewRequest:v,isRemoving:N,existingRequest:h,activeRelationship:p=null}){const[w,y]=n.useState(!1),a=r?.academician??{},d=a.full_name??"Supervisor",k=a.availability_as_supervisor,o=a.profile_picture?`/storage/${a.profile_picture}`:null,m=r?.saved_at?ce(new Date(r.saved_at),{addSuffix:!0}):null,x=a.university?.name||"",A=a.publications_count??0,M=a.projects_count??0,l=a.research_areas||[],f=a.url||null,g=a?.user,R=w?l:l.slice(0,1),s=r?.academician_id,t=n.useMemo(()=>!p||!s?!1:String(p.academician_id)===String(s),[p,s]),c=!!p,[T,C]=n.useState(!1),[Y,F]=n.useState(g?.connection_status_with_auth_user?.status||"not_connected"),[D,$]=n.useState(g?.connection_status_with_auth_user?.connection_id||null),G=async()=>{if(g?.id){C(!0);try{const i=await P.post(route("api.app.connections.store",g.id));i.data&&i.data.connection&&(F("pending_sent"),$(i.data.connection.id),u.success("Connection request sent"))}catch(i){I(i,"PotentialSupervisorCard connect"),u.error("Failed to send connection request")}finally{C(!1)}}},H=async()=>{if(D){C(!0);try{await P.patch(route("api.app.connections.accept",D)),F("connected"),u.success("Connection request accepted")}catch(i){I(i,"PotentialSupervisorCard acceptRequest"),u.error("Failed to accept connection")}finally{C(!1)}}};return e.jsxs("div",{className:"border rounded-xl p-4 sm:p-5 bg-white shadow-sm hover:shadow-md transition-shadow min-h-[320px] sm:min-h-[340px] flex flex-col",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 min-w-0",children:[f?e.jsx(U,{href:route("academicians.show",f),className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center overflow-hidden hover:ring-2 hover:ring-indigo-300 transition-all cursor-pointer",children:o?e.jsx("img",{src:o,alt:d,className:"w-full h-full object-cover rounded-full"}):e.jsx(q,{className:"w-5 h-5 text-indigo-600"})})}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center overflow-hidden flex-shrink-0",children:o?e.jsx("img",{src:o,alt:d,className:"w-full h-full object-cover rounded-full"}):e.jsx(q,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[f?e.jsx(U,{href:route("academicians.show",f),children:e.jsx("h3",{className:"text-sm sm:text-[1.05rem] font-semibold text-gray-900 leading-snug truncate hover:text-indigo-600 transition-colors cursor-pointer",children:d})}):e.jsx("h3",{className:"text-sm sm:text-[1.05rem] font-semibold text-gray-900 leading-snug truncate",children:d}),x&&e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate font-normal",children:x})]})]}),m&&e.jsxs("div",{className:"text-[10px] sm:text-xs text-slate-500 flex-shrink-0",children:["Saved ",m]})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center flex-wrap gap-x-3 sm:gap-x-4 gap-y-2 text-xs sm:text-sm text-gray-600",children:[k&&e.jsxs("div",{className:"inline-flex items-center gap-1.5 text-green-700",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:"Accepting Students"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(me,{className:"w-4 h-4 mr-1.5 text-gray-400"}),e.jsxs("span",{children:[A," Publications"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(xe,{className:"w-4 h-4 mr-1.5 text-gray-400"}),e.jsxs("span",{children:[M," Projects"]})]})]}),Array.isArray(l)&&l.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-gray-800 text-sm font-medium mb-2",children:"Research Areas:"}),e.jsx(X,{delayDuration:300,children:e.jsx("div",{className:"flex flex-wrap gap-2",children:R.map((i,K)=>e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full bg-gray-100 text-gray-700 border border-gray-200 line-clamp-1 truncate max-w-[350px] cursor-help",children:i})}),e.jsx(se,{side:"top",className:"max-w-xs",children:e.jsx("p",{className:"text-xs",children:i})})]},K))})}),e.jsx("div",{className:"mt-2",children:l.length>1?e.jsx("button",{onClick:()=>y(!w),className:"px-2.5 py-1 text-xs rounded-full bg-indigo-50 text-indigo-700 border border-indigo-200 hover:bg-indigo-100 transition-colors",children:w?"Show less":`+${l.length-1} more`}):e.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full bg-slate-50 text-slate-500 border border-slate-200",children:"1 area"})})]})]}),e.jsxs("div",{className:"flex flex-col xs:flex-row items-stretch xs:items-center gap-2 pt-3 sm:pt-4 border-t",children:[(()=>{if(T)return e.jsx("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-gray-400 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:"Processing..."});switch(Y){case"connected":return e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Connected"]});case"pending_sent":return e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-gray-400 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Pending"]});case"pending_received":return e.jsxs("button",{onClick:H,className:"inline-flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700 flex-1",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Accept"]});case"not_connected":default:return e.jsxs("button",{onClick:G,className:"inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 flex-1",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Connect"]})}})(),c?t?e.jsxs(b,{className:"flex-1 border-2 border-green-500 bg-green-50 text-green-700 hover:bg-green-100",onClick:()=>v?.(h),children:[e.jsx(pe,{className:"mr-2 h-4 w-4 fill-current"}),"Your Current Supervisor"]}):e.jsxs(b,{className:"flex-1",variant:"outline",disabled:!0,children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Request"]}):e.jsx(b,{className:"flex-1 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50",variant:"ghost",onClick:()=>h?v?.(h):S?.(r),children:h?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"View Request"]}):e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"Request"]})}),e.jsx(b,{type:"button",variant:"outline",size:"icon",disabled:N,onClick:()=>j?.(r),className:"h-10 w-10",children:N?e.jsx(fe,{className:"h-4 w-4 animate-spin"}):e.jsx(ge,{className:"h-4 w-4"})})]})]})}export{ms as default};
