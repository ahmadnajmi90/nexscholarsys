import{r as l,j as e,b as Y,a as K}from"./app-A8xQkvSk.js";import{c as N}from"./index-Km-vM6Jb.js";import{l as $}from"./logError-D4ezqrCx.js";import{C as W,a as X,b as Z,c as V,d as q}from"./card-DyHgWaPU.js";import{B as M}from"./button-Dz_rydmG.js";import{C as R}from"./ConfirmationModal-C-j5S7kM.js";import{f as ee}from"./formatDistanceToNow-GKXiLTrL.js";import{U as O}from"./user-round-CEZUuFcg.js";import{c as se}from"./createLucideIcon-DPzobtnR.js";import{B as ae}from"./book-open-BGEy-0ob.js";import{F as re}from"./folder-kanban-B_adFrTw.js";import{U as T}from"./user-plus-e-4IYQ9U.js";import{E as te}from"./eye-B05lsJ9f.js";import{S as ne}from"./send-CXXTO7CN.js";import{C as ie}from"./circle-check-ddCD_g9w.js";import{L as le}from"./loader-circle-DkpR38mE.js";import{T as ce}from"./trash-2-XEAf-v5f.js";import"./utils-CIsb_jhR.js";import"./clsx-B-dksMZM.js";import"./triangle-alert-BND9SWEh.js";import"./x-vL7g-LuD.js";import"./constructNow-DtVD-0hX.js";import"./en-US-DNUEYIb-.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M16 10h.01",key:"1m94wz"}]],G=se("MessageSquareMore",oe),J={default:{title:"No potential supervisors yet",description:"Start by adding supervisors from your recommendations list to keep track of who you want to approach."},search:{title:"No matches found",description:"Try adjusting your search filters or browse the full list."}};function Te({shortlist:a=[],requests:p=[],activeRelationship:S=null,isLoading:c=!1,reload:y,onRequestSupervisor:o,onViewRequest:w,onRemoveSuccess:g,emptyState:P="default"}){var C;const[r,j]=l.useState(null),[U,d]=l.useState(!1),[i,b]=l.useState(null),B=l.useMemo(()=>Array.isArray(p)?p.reduce((s,t)=>{if(!["cancelled","auto_cancelled","rejected"].includes(t.status)){const m=String(t.academician_id??"");m&&(s[m]=t)}return s},{}):{},[p]),L=s=>{b(s),d(!0)},f=async()=>{var t,m,u;if(!i)return;const s=(t=i==null?void 0:i.academician)==null?void 0:t.academician_id;if(!s){N.error("Unable to identify supervisor to remove"),d(!1),b(null);return}j(s),d(!1);try{await Y.delete(route("supervision.shortlist.destroy",s)),N.success("Removed from your potential supervisor list"),g==null||g(i),y==null||y()}catch(x){$(x,"Supervision handleRemove");const v=((u=(m=x==null?void 0:x.response)==null?void 0:m.data)==null?void 0:u.message)||"Failed to remove supervisor";N.error(v)}finally{j(null),b(null)}},_=!c&&(!Array.isArray(a)||a.length===0),{title:n,description:z}=l.useMemo(()=>J[P]??J.default,[P]);return c?e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:Array.from({length:4}).map((s,t)=>e.jsxs("div",{className:"border border-dashed rounded-xl p-5 bg-white shadow-sm animate-pulse",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-32 rounded bg-slate-200"}),e.jsx("div",{className:"h-3 w-24 rounded bg-slate-100"})]})]}),e.jsx("div",{className:"h-3 w-20 rounded bg-slate-100"})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-3 w-24 rounded bg-slate-100"}),e.jsx("div",{className:"h-3 w-28 rounded bg-slate-100"}),e.jsx("div",{className:"h-3 w-20 rounded bg-slate-100"})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("div",{className:"h-3 w-32 rounded bg-slate-100"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-6 w-24 rounded-full bg-slate-100"}),e.jsx("div",{className:"h-6 w-20 rounded-full bg-slate-100"})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 pt-4 border-t",children:[e.jsx("div",{className:"h-10 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-10 flex-1 rounded bg-slate-200"}),e.jsx("div",{className:"h-10 w-10 rounded bg-slate-200"})]})]},`potential-skeleton-${t}`))}):_?e.jsxs(W,{className:"border-dashed border-slate-200",children:[e.jsx(X,{children:e.jsx(Z,{className:"text-lg font-semibold text-slate-800",children:n})}),e.jsx(V,{className:"text-sm text-slate-600",children:z}),e.jsx(q,{children:e.jsx(M,{variant:"outline",onClick:()=>o==null?void 0:o(null),children:"Find supervisors"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:a.map(s=>{var x,v,k,F,I,E,A;const t=(s==null?void 0:s.academician_id)??((k=(v=(x=s==null?void 0:s.academician)==null?void 0:x.user)==null?void 0:v.academician)==null?void 0:k.academician_id)??((F=s==null?void 0:s.academician)==null?void 0:F.academician_id)??((E=(I=s==null?void 0:s.academician)==null?void 0:I.user)==null?void 0:E.academician_id),m=t?B[String(t)]:null,u=(A=s==null?void 0:s.academician)==null?void 0:A.academician_id;return e.jsx(de,{item:s,existingRequest:m,activeRelationship:S,onRemove:L,onRequest:o,onViewRequest:w,isRemoving:r===u},s.id)})}),e.jsx(R,{show:U,onClose:()=>{d(!1),b(null)},onConfirm:f,title:"Remove from Potential Supervisors",message:`Are you sure you want to remove ${((C=i==null?void 0:i.academician)==null?void 0:C.full_name)||"this supervisor"} from your potential supervisor list? You can always add them back later.`,confirmButtonText:"Yes, Remove"})]})}function de({item:a,onRemove:p,onRequest:S,onViewRequest:c,isRemoving:y,existingRequest:o,activeRelationship:w=null}){var A,D,H;const[g,P]=l.useState(!1),r=(a==null?void 0:a.academician)??{},j=r.full_name??"Supervisor",U=r.availability_as_supervisor,d=r.profile_picture?`/storage/${r.profile_picture}`:null,i=a!=null&&a.saved_at?ee(new Date(a.saved_at),{addSuffix:!0}):null,b=((A=r.university)==null?void 0:A.name)||"",B=r.publications_count??0,L=r.projects_count??0,f=r.research_areas||[],_=r.url||null,n=r==null?void 0:r.user,z=g?f:f.slice(0,1),C=a==null?void 0:a.academician_id,s=l.useMemo(()=>!w||!C?!1:String(w.academician_id)===String(C),[w,C]),t=!!w,[m,u]=l.useState(!1),[x,v]=l.useState(((D=n==null?void 0:n.connection_status_with_auth_user)==null?void 0:D.status)||"not_connected"),[k,F]=l.useState(((H=n==null?void 0:n.connection_status_with_auth_user)==null?void 0:H.connection_id)||null),I=async()=>{if(n!=null&&n.id){u(!0);try{const h=await Y.post(route("api.app.connections.store",n.id));h.data&&h.data.connection&&(v("pending_sent"),F(h.data.connection.id),N.success("Connection request sent"))}catch(h){$(h,"PotentialSupervisorCard connect"),N.error("Failed to send connection request")}finally{u(!1)}}},E=async()=>{if(k){u(!0);try{await Y.patch(route("api.app.connections.accept",k)),v("connected"),N.success("Connection request accepted")}catch(h){$(h,"PotentialSupervisorCard acceptRequest"),N.error("Failed to accept connection")}finally{u(!1)}}};return e.jsxs("div",{className:"border rounded-xl p-5 bg-white shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0",children:[_?e.jsx(K,{href:route("academicians.show",_),className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center overflow-hidden hover:ring-2 hover:ring-indigo-300 transition-all cursor-pointer",children:d?e.jsx("img",{src:d,alt:j,className:"w-full h-full object-cover rounded-full"}):e.jsx(O,{className:"w-5 h-5 text-indigo-600"})})}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center overflow-hidden flex-shrink-0",children:d?e.jsx("img",{src:d,alt:j,className:"w-full h-full object-cover rounded-full"}):e.jsx(O,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[_?e.jsx(K,{href:route("academicians.show",_),children:e.jsx("h3",{className:"text-[1.05rem] font-semibold text-gray-900 leading-snug truncate hover:text-indigo-600 transition-colors cursor-pointer",children:j})}):e.jsx("h3",{className:"text-[1.05rem] font-semibold text-gray-900 leading-snug truncate",children:j}),b&&e.jsx("p",{className:"text-sm text-gray-600 truncate font-normal",children:b})]})]}),i&&e.jsxs("div",{className:"text-xs text-slate-500 flex-shrink-0",children:["Saved ",i]})]}),e.jsxs("div",{className:"mt-4 flex items-center flex-wrap gap-x-4 gap-y-2 text-sm text-gray-600",children:[U&&e.jsxs("div",{className:"inline-flex items-center gap-1.5 text-green-700",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:"Accepting Students"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"w-4 h-4 mr-1.5 text-gray-400"}),e.jsxs("span",{children:[B," Publications"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"w-4 h-4 mr-1.5 text-gray-400"}),e.jsxs("span",{children:[L," Projects"]})]})]}),Array.isArray(f)&&f.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-gray-800 text-sm font-medium mb-2",children:"Research Areas:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[z.map((h,Q)=>e.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full bg-gray-100 text-gray-700 border border-gray-200",children:h},Q)),f.length>1&&e.jsx("button",{onClick:()=>P(!g),className:"px-2.5 py-1 text-xs rounded-full bg-indigo-50 text-indigo-700 border border-indigo-200 hover:bg-indigo-100 transition-colors",children:g?"Show less":`+${f.length-1} more`})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 pt-4 border-t",children:[(()=>{if(m)return e.jsx("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-gray-400 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:"Processing..."});switch(x){case"connected":return e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Connected"]});case"pending_sent":return e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-gray-400 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Pending"]});case"pending_received":return e.jsxs("button",{onClick:E,className:"inline-flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700 flex-1",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Accept"]});case"not_connected":default:return e.jsxs("button",{onClick:I,className:"inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 flex-1",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Connect"]})}})(),t?s?e.jsxs(M,{className:"flex-1 border-2 border-green-500 bg-green-50 text-green-700 hover:bg-green-100",onClick:()=>c==null?void 0:c(o),children:[e.jsx(ie,{className:"mr-2 h-4 w-4 fill-current"}),"Your Current Supervisor"]}):e.jsxs(M,{className:"flex-1",variant:"outline",disabled:!0,children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Request Supervision"]}):e.jsx(M,{className:"flex-1 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50",variant:"ghost",onClick:()=>o?c==null?void 0:c(o):S==null?void 0:S(a),children:o?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"View Request"]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Request Supervision"]})}),e.jsx(M,{type:"button",variant:"outline",size:"icon",disabled:y,onClick:()=>p==null?void 0:p(a),className:"h-10 w-10",children:y?e.jsx(le,{className:"h-4 w-4 animate-spin"}):e.jsx(ce,{className:"h-4 w-4"})})]})]})}export{Te as default};
