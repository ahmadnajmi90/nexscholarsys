import{q as Te,r as h,j as e,a as H}from"./app-Doi1BfNX.js";import{T as Me,a as Ee,b as M,c as E}from"./tabs-BgtJ-Aqh.js";import{B as _}from"./button-KPEq8PdI.js";import{B}from"./badge-Be2D36dO.js";import{A as Oe,a as ze}from"./avatar-D-ohjjtQ.js";import{T as $e}from"./textarea-B9-sF3_G.js";import{S as O}from"./scroll-area-Du06xGgY.js";import{O as qe,S as Le}from"./modalAnimations-CCENKliM.js";import{t as R}from"./index-CjQ7mWKv.js";import He from"./DocumentPreviewModal-BhfBa8rV.js";import{M as Be}from"./Modal-BjJ_nX2Q.js";import{A as We}from"./index-CvKzrQIm.js";import{m as be}from"./proxy-BUFhk0Wh.js";import{X as Ve}from"./x-DrXySrr5.js";import{C as F}from"./circle-check-CXM40yk7.js";import{C as k}from"./circle-x-CHFI4rOT.js";import{C as ge}from"./circle-alert-DIrS-PEp.js";import{E as Ne}from"./eye-DZOo496r.js";import{C as Xe}from"./clock-yedA_mME.js";import{c as Ge}from"./createLucideIcon-BIWf6Fgr.js";import{F as we}from"./file-text-CjHuEEW2.js";import{C as Ke}from"./chevron-down-CmfXf0xW.js";import{C as Ue}from"./chevron-right-Dg3EFaoF.js";import{F as Ye}from"./folder-open-Dt0aD5aH.js";import{H as Ze}from"./history-CYjZsRfK.js";import{M as Je}from"./message-square-THXDma7t.js";import{f as z}from"./format-Dv9Rm441.js";import"./index-B_QUZuO0.js";import"./index-FRhtyj0h.js";import"./index-BGtqCWya.js";import"./index-Ct-Jk4RI.js";import"./index-Be4Hbpsc.js";import"./index-BdR5mO0l.js";import"./index-CkAoBwhz.js";import"./index-Bb94jkfk.js";import"./utils-D-KgF5mV.js";import"./index-CGrAONsN.js";import"./index-BdQq_4o_.js";import"./download-Xk6ccwe6.js";import"./transition-Dk-vnbkR.js";import"./dialog-DYcl7DcC.js";import"./en-US-DNUEYIb-.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],es=Ge("File",Qe);function Zs({invitation:s,onClose:a,onUpdated:r}){var Z,J,Q,ee,se,ae,te,le,re,ce,ie,oe,de,ne,me,xe,pe,ue,he,je;const{auth:l}=Te().props,[N,f]=h.useState("overview"),[m,j]=h.useState(!1),[D,b]=h.useState(!1),[x,i]=h.useState(""),[p,g]=h.useState({}),[w,v]=h.useState([]),[u,y]=h.useState({}),[A,ye]=h.useState(!1),[P,W]=h.useState(null),[_e,V]=h.useState(!1),[Ce,X]=h.useState(null),De=15*1024*1024;if(console.log("ðŸ” CoSupervisorInvitationDetailPanel - Full invitation:",s),console.log("ðŸ‘¤ Auth user:",l.user),console.log("ðŸ“‹ Student:",(Z=s.relationship)==null?void 0:Z.student),console.log("ðŸ« University:",(Q=(J=s.relationship)==null?void 0:J.student)==null?void 0:Q.university),console.log("ðŸ›ï¸ Faculty:",(se=(ee=s.relationship)==null?void 0:ee.student)==null?void 0:se.faculty),console.log("ðŸ“ Supervision request:",((ae=s.relationship)==null?void 0:ae.supervisionRequest)||((te=s.relationship)==null?void 0:te.supervision_request)),console.log("ðŸ”— Relationship ID:",(le=s.relationship)==null?void 0:le.id),!s)return null;const c=(re=s.relationship)==null?void 0:re.student,Ae=(ce=s.relationship)==null?void 0:ce.academician,S=s.cosupervisor;(ie=s.relationship)!=null&&ie.supervisionRequest||((oe=s.relationship)==null||oe.supervision_request);const Se=(de=s.relationship)==null?void 0:de.id,$=(()=>{var o,d,n;const t=(o=l.user)==null?void 0:o.unique_id;return t===s.cosupervisor_academician_id?"cosupervisor":t===((d=s.relationship)==null?void 0:d.academician_id)&&s.initiated_by==="student"?"main_supervisor":t===((n=s.relationship)==null?void 0:n.student_id)&&s.initiated_by==="main_supervisor"?"student":"viewer"})();console.log("ðŸ‘¥ Determined user role:",$);const G=(t,o)=>{const d=o.split(".").pop().toLowerCase(),n=["jpg","jpeg","png","gif","webp","svg"].includes(d),fe=d==="pdf";if((n||fe)&&t.size<De){const Fe=route("supervision.document-versions.preview",t.id),Pe=route("supervision.document-versions.download",t.id);X({preview_url:Fe,download_url:Pe,original_name:o,mime_type:fe?"application/pdf":`image/${d}`,size:t.size,size_formatted:t.size_formatted||`${(t.size/1024).toFixed(1)} KB`,created_at:t.created_at})}else window.open(route("supervision.document-versions.download",t.id),"_blank","noopener,noreferrer")},T=$==="cosupervisor"&&s.cosupervisor_status==="pending"&&!s.cancelled_at,I=$!=="cosupervisor"&&s.cosupervisor_status==="accepted"&&s.approver_status==="pending"&&!s.cancelled_at,K=async t=>{var o,d;if(t==="rejected"&&!x.trim()){R.error("Please provide a reason for rejection");return}j(!0);try{const n=await H.post(`/api/v1/app/supervision/cosupervisor-invitations/${s.id}/respond`,{response:t,rejection_reason:t==="rejected"?x:null});R.success(t==="accepted"?"Invitation accepted! Waiting for approval.":"Invitation rejected"),setTimeout(()=>{r==null||r(n.data.invitation),a==null||a()},1500)}catch(n){R.error(((d=(o=n.response)==null?void 0:o.data)==null?void 0:d.message)||"Failed to respond")}finally{j(!1),b(!1),i("")}},U=async t=>{var o,d;if(t==="rejected"&&!x.trim()){R.error("Please provide a reason for rejection");return}j(!0);try{const n=await H.post(`/api/v1/app/supervision/cosupervisor-invitations/${s.id}/approve`,{response:t,rejection_reason:t==="rejected"?x:null});R.success(t==="accepted"?"Co-supervisor approved!":"Co-supervisor invitation declined"),setTimeout(()=>{r==null||r(n.data.invitation),a==null||a()},1500)}catch(n){R.error(((d=(o=n.response)==null?void 0:o.data)==null?void 0:d.message)||"Failed to respond")}finally{j(!1),b(!1),i("")}},q=s.cancelled_at?{text:"Cancelled",color:"bg-gray-100 text-gray-700 border-gray-200",icon:k}:s.cosupervisor_status==="rejected"?{text:"Rejected by Co-supervisor",color:"bg-red-100 text-red-700 border-red-200",icon:k}:s.approver_status==="rejected"?{text:"Not Approved",color:"bg-red-100 text-red-700 border-red-200",icon:k}:s.completed_at?{text:"Completed",color:"bg-green-100 text-green-700 border-green-200",icon:F}:s.cosupervisor_status==="accepted"&&s.approver_status==="pending"?{text:"Awaiting Approval",color:"bg-yellow-100 text-yellow-700 border-yellow-200",icon:Xe}:{text:"Pending Response",color:"bg-blue-100 text-blue-700 border-blue-200",icon:ge},Re=q.icon,L=(c==null?void 0:c.full_name)||((ne=c==null?void 0:c.user)==null?void 0:ne.name)||"Student",Y=c!=null&&c.profile_picture?`/storage/${c.profile_picture}`:null,Ie=L.split(" ").map(t=>t[0]).join("").slice(0,2).toUpperCase(),ke=((me=c==null?void 0:c.universityDetails)==null?void 0:me.name)||((xe=c==null?void 0:c.universityDetails)==null?void 0:xe.full_name)||((pe=c==null?void 0:c.university_details)==null?void 0:pe.name)||((ue=c==null?void 0:c.university_details)==null?void 0:ue.full_name)||null;return e.jsxs(e.Fragment,{children:[e.jsx(We,{children:e.jsx(be.div,{...qe,className:"fixed inset-0 z-40 flex items-center justify-end bg-black/50",onClick:a,children:e.jsxs(be.div,{...Le,className:"w-full max-w-3xl h-full bg-white shadow-xl overflow-hidden flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx(Oe,{className:"h-12 w-12",children:Y?e.jsx("img",{src:Y,alt:L,className:"h-full w-full object-cover"}):e.jsx(ze,{className:"bg-indigo-100 text-indigo-700 text-sm font-semibold",children:Ie})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:L}),e.jsx("p",{className:"text-sm text-slate-600",children:ke||"Student"}),e.jsx("div",{className:"mt-2 flex items-center gap-3 flex-wrap",children:e.jsxs(B,{className:`${q.color} border flex items-center gap-1`,children:[e.jsx(Re,{className:"w-3 h-3"}),q.text]})})]})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(Ve,{className:"h-5 w-5 text-slate-500"})})]})}),e.jsxs("div",{className:"px-6 py-4 border-b bg-slate-50",children:[T&&!D&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(_,{onClick:()=>K("accepted"),disabled:m,className:"flex-1 bg-emerald-600 hover:bg-emerald-700",children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),"Accept Invitation"]}),e.jsxs(_,{variant:"outline",onClick:()=>b(!0),disabled:m,className:"flex-1 border-red-300 text-red-700 hover:bg-red-50",children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Decline"]})]}),I&&!D&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start gap-2 mb-3",children:[e.jsx(ge,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-yellow-900",children:"Your Approval Required"}),e.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:[(S==null?void 0:S.full_name)||((he=S==null?void 0:S.user)==null?void 0:he.name)||"The co-supervisor"," has accepted the invitation to be a co-supervisor."]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(_,{onClick:()=>U("accepted"),disabled:m,className:"flex-1 bg-emerald-600 hover:bg-emerald-700",children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),"Approve Co-Supervisor"]}),e.jsxs(_,{variant:"outline",onClick:()=>b(!0),disabled:m,className:"flex-1 border-red-300 text-red-700 hover:bg-red-50",children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Reject"]})]})]}),D&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for ",I?"Rejection":"Declining"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx($e,{value:x,onChange:t=>i(t.target.value),placeholder:"Please provide a reason...",className:"min-h-[80px]",maxLength:500}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[x.length,"/500"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>{b(!1),i("")},disabled:m,className:"flex-1",children:"Cancel"}),e.jsx(_,{variant:"destructive",onClick:()=>{T?K("rejected"):I&&U("rejected")},disabled:m||!x.trim(),className:"flex-1",children:m?"Processing...":"Confirm"})]})]}),!T&&!I&&s.cosupervisor_status==="accepted"&&s.approver_status==="pending"&&e.jsxs("div",{className:"text-sm text-blue-700 bg-blue-50 border border-blue-200 rounded p-3 text-center",children:["Waiting for ",s.initiated_by==="student"?"main supervisor":"student"," approval"]}),!T&&!I&&s.completed_at&&e.jsx("div",{className:"text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded p-3 text-center",children:"âœ“ Invitation accepted and approved - Co-supervisor relationship is active"})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(Me,{value:N,onValueChange:f,className:"h-full flex flex-col",children:[e.jsxs(Ee,{className:"px-6 bg-gray-100 w-full justify-start rounded-none h-auto p-0 gap-0",children:[e.jsx(M,{value:"overview",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Overview"}),e.jsx(M,{value:"documents",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Documents"}),e.jsx(M,{value:"message",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Message"}),e.jsx(M,{value:"timeline",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Timeline"})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx(E,{value:"overview",className:"mt-0 h-full",children:e.jsx(O,{className:"h-full",children:e.jsx(ss,{invitation:s,student:c,mainSupervisor:Ae,cosupervisor:S})})}),e.jsx(E,{value:"documents",className:"mt-0 h-full",children:e.jsx(O,{className:"h-full",children:e.jsx(as,{relationshipId:Se,documentsByFolder:p,availableFolders:w,expandedFolders:u,loading:A,onLoad:(t,o)=>{g(t),v(o);const d={};o.forEach(n=>{d[n]=!0}),y(d)},onLoadingChange:t=>ye(t),onToggleFolder:t=>{y({...u,[t]:!u[t]})},onViewVersions:t=>{W(t),V(!0)},onPreview:(t,o)=>{G(t,o)}})})}),e.jsx(E,{value:"message",className:"mt-0 h-full",children:e.jsx(O,{className:"h-full",children:e.jsx(ls,{invitation:s})})}),e.jsx(E,{value:"timeline",className:"mt-0 h-full",children:e.jsx(O,{className:"h-full",children:e.jsx(rs,{invitation:s})})})]})]})})]})})}),P&&e.jsx(Be,{show:_e,onClose:()=>{V(!1),W(null)},maxWidth:"2xl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-slate-900 mb-4",children:["Version History: ",P.name]}),e.jsx("div",{className:"space-y-3",children:(je=P.versions)==null?void 0:je.map(t=>{var d,n;const o=t.id===P.current_version_id;return e.jsx("div",{className:`p-4 rounded-lg border ${o?"bg-indigo-50 border-indigo-200":"bg-white border-slate-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"font-semibold text-slate-900",children:["Version ",t.version_number]}),o&&e.jsx(B,{className:"bg-indigo-600 text-white",children:"Current"})]}),e.jsxs("div",{className:"text-sm text-slate-600 space-y-1",children:[e.jsxs("p",{children:["Uploaded by: ",((d=t.uploader)==null?void 0:d.full_name)||((n=t.uploader)==null?void 0:n.name)||"Unknown"]}),e.jsxs("p",{children:["Date: ",z(new Date(t.created_at),"dd/MM/yyyy HH:mm")]}),e.jsxs("p",{children:["Size: ",t.size_formatted||`${(t.size/1024).toFixed(1)} KB`]}),t.notes&&e.jsxs("p",{className:"mt-2 text-slate-700",children:[e.jsx("span",{className:"font-medium",children:"Notes:"})," ",t.notes]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(_,{size:"sm",variant:"outline",onClick:()=>G(t,t.original_name),title:"Preview document",children:e.jsx(Ne,{className:"h-4 w-4"})})})]})},t.id)})})]})}),e.jsx(He,{file:Ce,onClose:()=>X(null)})]})}function ss({invitation:s,student:a,mainSupervisor:r,cosupervisor:l}){var b,x,i,p,g,w,v,u,y,A;const N=(a==null?void 0:a.full_name)||((b=a==null?void 0:a.user)==null?void 0:b.name)||"Student",f=(r==null?void 0:r.full_name)||((x=r==null?void 0:r.user)==null?void 0:x.name)||"Main Supervisor",m=(l==null?void 0:l.full_name)||((i=l==null?void 0:l.user)==null?void 0:i.name)||"Co-supervisor",j=((p=a==null?void 0:a.universityDetails)==null?void 0:p.name)||((g=a==null?void 0:a.universityDetails)==null?void 0:g.full_name)||((w=a==null?void 0:a.university_details)==null?void 0:w.name)||((v=a==null?void 0:a.university_details)==null?void 0:v.full_name)||"â€”",D=((u=a==null?void 0:a.faculty)==null?void 0:u.name)||((y=a==null?void 0:a.faculty)==null?void 0:y.full_name)||"â€”";return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Student Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(C,{label:"Full Name",value:N}),e.jsx(C,{label:"Email",value:((A=a==null?void 0:a.user)==null?void 0:A.email)||(a==null?void 0:a.email)||"â€”"}),e.jsx(C,{label:"University",value:j}),e.jsx(C,{label:"Faculty",value:D})]})]}),e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Invitation Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(C,{label:"Main Supervisor",value:f}),e.jsx(C,{label:"Invited Co-supervisor",value:m}),e.jsx(C,{label:"Initiated by",value:s.initiated_by==="student"?`${N} (Student)`:`${f} (Main Supervisor)`}),e.jsx(C,{label:"Sent",value:s.created_at?z(new Date(s.created_at),"PPp"):"â€”"})]})]}),!s.cancelled_at&&!s.completed_at&&e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Approval Progress"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s.cosupervisor_status==="accepted"?"bg-green-100 text-green-700":s.cosupervisor_status==="rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-500"}`,children:s.cosupervisor_status==="accepted"?e.jsx(F,{className:"w-5 h-5"}):"1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-slate-900",children:"Co-supervisor Response"}),e.jsx("p",{className:"text-sm text-slate-500",children:s.cosupervisor_status==="accepted"?"Accepted":s.cosupervisor_status==="rejected"?"Rejected":"Pending"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s.approver_status==="accepted"?"bg-green-100 text-green-700":s.approver_status==="rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-500"}`,children:s.approver_status==="accepted"?e.jsx(F,{className:"w-5 h-5"}):"2"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium text-slate-900",children:[s.initiated_by==="student"?"Main Supervisor":"Student"," Approval"]}),e.jsx("p",{className:"text-sm text-slate-500",children:s.approver_status==="accepted"?"Approved":s.approver_status==="rejected"?"Rejected":"Pending"})]})]})]})]})]})}const ve={Drafts:"bg-yellow-50 text-yellow-700 border-yellow-200","Final Papers":"bg-green-50 text-green-700 border-green-200","Meeting Notes":"bg-blue-50 text-blue-700 border-blue-200",Literature:"bg-purple-50 text-purple-700 border-purple-200",Data:"bg-indigo-50 text-indigo-700 border-indigo-200",General:"bg-slate-50 text-slate-700 border-slate-200"};function as({relationshipId:s,documentsByFolder:a,availableFolders:r,expandedFolders:l,loading:N,onLoad:f,onLoadingChange:m,onToggleFolder:j,onViewVersions:D,onPreview:b}){if(h.useEffect(()=>{(async()=>{var p,g,w,v;if(s){m(!0);try{const u=await H.get(`/api/v1/app/supervision/relationships/${s}/documents`);console.log("ðŸ“ Documents API response:",u.data);const y=((p=u.data.data)==null?void 0:p.documents_by_folder)||{},A=((g=u.data.data)==null?void 0:g.available_folders)||Object.keys(y);console.log("ðŸ“„ Documents by folder:",y),console.log("ðŸ“‚ Available folders:",A),f(y,A)}catch(u){console.error("âŒ Error fetching documents:",u),R.error(((v=(w=u.response)==null?void 0:w.data)==null?void 0:v.message)||"Failed to load documents"),f({},[])}finally{m(!1)}}})()},[s]),N)return e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-3",children:[1,2,3].map(i=>e.jsx("div",{className:"border border-slate-200 rounded-lg p-4 animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-200 rounded"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-slate-200 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-slate-100 rounded w-1/2"})]})]})},i))})});if(!s)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center text-slate-500 py-12",children:[e.jsx(es,{className:"w-12 h-12 mx-auto mb-3 text-slate-300"}),e.jsx("p",{children:"No relationship information available"})]})});const x=Object.values(a).reduce((i,p)=>i+p.length,0);return x===0?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center text-slate-500 py-12",children:[e.jsx(we,{className:"w-12 h-12 mx-auto mb-3 text-slate-300"}),e.jsx("p",{className:"font-medium text-slate-700",children:"No documents yet"}),e.jsx("p",{className:"text-sm mt-1",children:"Documents uploaded to this supervision will appear here"})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-900",children:"Supervision Documents"}),e.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:[x," document",x!==1?"s":""," across ",Object.keys(a).length," folder",Object.keys(a).length!==1?"s":""]}),e.jsx("p",{className:"text-sm text-indigo-600 mt-2",children:"ðŸ“– Read-only view - Documents shared between the student and main supervisor"})]}),e.jsx("div",{className:"space-y-4",children:r.map(i=>{const p=a[i]||[];if(p.length===0)return null;const g=l[i],w=ve[i]||ve.General;return e.jsxs("div",{className:"border border-slate-200 rounded-lg bg-white shadow-sm",children:[e.jsx("button",{onClick:()=>j(i),className:"w-full flex items-center justify-between p-4 hover:bg-slate-50 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[g?e.jsx(Ke,{className:"h-5 w-5 text-slate-400"}):e.jsx(Ue,{className:"h-5 w-5 text-slate-400"}),e.jsx(Ye,{className:"h-5 w-5 text-slate-600"}),e.jsx("span",{className:"font-semibold text-slate-900",children:i}),e.jsxs(B,{variant:"outline",className:w,children:[p.length," file",p.length!==1?"s":""]})]})}),g&&e.jsx("div",{className:"border-t border-slate-200 p-4 space-y-3",children:p.map(v=>e.jsx(ts,{document:v,onPreview:b,onViewVersions:D},v.id))})]},i)})})]})}function ts({document:s,onPreview:a,onViewVersions:r}){var f,m,j;const l=s.current_version||s.currentVersion,N=((f=s.versions)==null?void 0:f.length)||0;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg border border-slate-200 hover:border-indigo-300 transition-colors",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"p-2 bg-white rounded-md border border-slate-200",children:e.jsx(we,{className:"h-5 w-5 text-indigo-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-slate-900 truncate",children:s.name}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-slate-500",children:[e.jsxs("span",{children:["v",(l==null?void 0:l.version_number)||1]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:((m=l==null?void 0:l.uploader)==null?void 0:m.full_name)||((j=l==null?void 0:l.uploader)==null?void 0:j.name)||"Unknown"}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:l!=null&&l.created_at?z(new Date(l.created_at),"dd/MM/yyyy"):"â€”"})]}),s.notes&&e.jsx("p",{className:"text-sm text-slate-600 mt-2 line-clamp-2",children:s.notes})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{size:"sm",variant:"ghost",onClick:()=>a(l,l==null?void 0:l.original_name),title:"Preview document",children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsxs(_,{size:"sm",variant:"ghost",onClick:()=>r(s),title:"View version history",children:[e.jsx(Ze,{className:"h-4 w-4"}),N>1&&e.jsx("span",{className:"ml-1 text-xs",children:N})]})]})]})}function ls({invitation:s}){return e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("section",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm w-[720px]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Je,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Personal Invitation Message"})]}),s.invitation_message?e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-900 leading-relaxed whitespace-pre-line italic break-words max-w-full",children:['"',s.invitation_message,'"']})}):e.jsx("p",{className:"text-sm text-slate-500",children:"No personal message provided"}),s.rejection_reason&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Rejection Reason"}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-red-900 leading-relaxed whitespace-pre-line break-words max-w-full",children:['"',s.rejection_reason,'"']})})]})]})})}function rs({invitation:s}){const a=[];return s.created_at&&a.push({id:1,title:"Invitation Sent",date:s.created_at,status:"completed"}),s.cosupervisor_responded_at&&a.push({id:2,title:s.cosupervisor_status==="accepted"?"Co-supervisor Accepted":"Co-supervisor Declined",date:s.cosupervisor_responded_at,status:"completed"}),s.approver_responded_at&&a.push({id:3,title:s.approver_status==="accepted"?"Approved":"Not Approved",date:s.approver_responded_at,status:"completed"}),s.completed_at&&a.push({id:4,title:"Invitation Completed",date:s.completed_at,status:"completed"}),s.cancelled_at&&a.push({id:5,title:"Invitation Cancelled",date:s.cancelled_at,status:"cancelled"}),e.jsx("div",{className:"p-6",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Timeline"}),a.length===0?e.jsx("div",{className:"text-sm text-slate-500 text-center py-8",children:"No timeline events yet"}):e.jsx("div",{className:"space-y-4",children:a.map((r,l)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${r.status==="completed"?"bg-green-500":r.status==="cancelled"?"bg-red-500":"bg-slate-300"}`}),l<a.length-1&&e.jsx("div",{className:"w-0.5 h-full bg-slate-200 mt-2"})]}),e.jsxs("div",{className:"flex-1 pb-8",children:[e.jsx("h4",{className:"font-medium text-slate-900",children:r.title}),e.jsx("p",{className:"text-sm text-slate-500",children:r.date?z(new Date(r.date),"PPp"):"TBD"})]})]},r.id))})]})})}function C({label:s,value:a}){return e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:s}),e.jsx("div",{className:"text-sm text-slate-700",children:a||"â€”"})]})}export{Zs as default};
