import{r as x,W as _,j as e,Y as T,a as v,y as P}from"./app-Dr9IfFf8.js";import{T as h}from"./TextInput-B3QFYZP2.js";import{P as C}from"./PrimaryButton-DZ6PV5M-.js";import{G as B}from"./GuestLayout-y1sUdwDj.js";import{I as m}from"./InputLabel-BHKwTOwE.js";import{I as y}from"./InputError-Cuo1V5BZ.js";import{A as M}from"./ApplicationLogo-L7LkIofh.js";function Z({userRole:k,showAllOptions:S}){const[b,j]=x.useState(null),[o,l]=x.useState(!1),[F,r]=x.useState(""),[n,G]=x.useState(null),w=x.useRef(null),{data:s,setData:p,reset:Y,errors:f}=_({personalWebsite:"",institutionalWebsite:"",linkedinProfile:"",googleScholarProfile:"",researchgateProfile:""}),V=()=>Object.values(s).some(t=>t&&t.trim()!==""),N=t=>{j(t),r("")},U=t=>{const a=t.target.files[0];a&&(G(a),r(""))},A=async()=>{var t,a;l(!0),r("");try{const i=await v.post(route("ai.generate.automatic"));if(i.data.status==="success"&&i.data.generation_initiated)P.visit(route("role.edit"),{preserveState:!1,onSuccess:()=>{l(!1)}});else throw new Error("Generation could not be initiated")}catch(i){r(((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.error)||"An error occurred during AI profile generation"),l(!1)}},D=async t=>{var a,i;if(t.preventDefault(),!V()){r("Please provide at least one URL to continue");return}l(!0),r("");try{const c={personalWebsite:s.personalWebsite,institutionalWebsite:s.institutionalWebsite,linkedinProfile:s.linkedinProfile,scholarProfile:s.googleScholarProfile,researchgateProfile:s.researchgateProfile},g=await v.post(route("ai.urls.save"),c);if(g.data.status==="success"&&g.data.generation_initiated)P.visit(route("role.edit"),{preserveState:!1,onSuccess:()=>{l(!1)}});else throw new Error("Generation could not be initiated")}catch(c){r(((i=(a=c.response)==null?void 0:a.data)==null?void 0:i.error)||"An error occurred while saving URLs"),l(!1)}},L=async t=>{var c,g;if(t.preventDefault(),!n){r("Please upload a CV file to continue");return}const a=10*1024*1024,i=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","image/jpeg","image/png","image/tiff"];if(n.size>a){r("File size exceeds 10MB limit. Please upload a smaller file.");return}if(!i.includes(n.type)){r("File type not supported. Please upload PDF, DOC, DOCX, JPEG, PNG, or TIFF files.");return}l(!0),r("");try{const d=new FormData;d.append("CV_file",n),console.log("Uploading CV file to profile via role.updateCV route");const W=await v.post(route("role.updateCV"),d,{headers:{"Content-Type":"multipart/form-data"}});if(!W.data.success)throw new Error("Failed to upload CV to profile: "+(W.data.error||"Unknown error"));console.log("CV upload successful, now initiating profile generation");const I=new FormData;I.append("CV_file",n),console.log("Sending CV for processing via ai.generate.cv route");const u=await v.post(route("ai.generate.cv"),I,{headers:{"Content-Type":"multipart/form-data"}});if(console.log("CV processing response:",u.data),u.data.status==="success"||typeof u.data=="object"&&u.data.full_name||u.data.generation_initiated)console.log("CV processing successful, navigating to profile edit page"),P.visit(route("role.edit",{generation_initiated:!0}),{preserveState:!1,onSuccess:()=>{l(!1)}});else throw console.error("CV generation response format unexpected:",u.data),new Error("Generation could not be initiated: Invalid response format")}catch(d){console.error("CV processing error:",d),r(((g=(c=d.response)==null?void 0:c.data)==null?void 0:g.error)||d.message||"An error occurred while processing your CV"),l(!1)}},E=()=>{P.visit(route("role.edit"))},R=S,O=S;return e.jsxs(B,{children:[e.jsx(T,{title:"AI Profile Generation"}),e.jsxs("div",{className:"w-full max-w-2xl mx-auto mt-2 p-4 sm:p-6 lg:p-8",children:[e.jsx(M,{}),e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-xl overflow-hidden mx-2 sm:mx-0 p-6 md:p-8 lg:p-8 mt-6",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mb-4 md:mb-2 text-left md:text-center lg:text-center",children:["Generate Your ",k==="academician"?"Academic":k==="postgraduate"?"Postgraduate":"Undergraduate"," Profile"]}),F&&e.jsx("div",{className:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded text-center",children:F}),b?b==="automatic"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-600 mb-6",children:"We'll search the web for your academic information and generate a profile for you. This may take a moment."}),e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsx("button",{onClick:()=>j(null),className:"text-sm text-gray-600 hover:text-gray-900 underline",disabled:o,children:"Back"}),e.jsx(C,{onClick:A,disabled:o,className:"ml-4",children:o?"Processing...":"Generate Profile"})]})]}):b==="url"?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-gray-600 mb-6",children:[e.jsx("strong",{children:"URL Search is generally more reliable as it uses the website links you provide."})," Please enter at least one URL to continue."]}),e.jsx("form",{onSubmit:D,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"personalWebsite",value:"Personal Website"}),e.jsx(h,{id:"personalWebsite",type:"url",className:"mt-1 block w-full",value:s.personalWebsite,onChange:t=>p("personalWebsite",t.target.value),placeholder:"https://yourwebsite.com"}),e.jsx(y,{message:f.personalWebsite,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"institutionalWebsite",value:"Institutional Website"}),e.jsx(h,{id:"institutionalWebsite",type:"url",className:"mt-1 block w-full",value:s.institutionalWebsite,onChange:t=>p("institutionalWebsite",t.target.value),placeholder:"https://university.edu/faculty/you"}),e.jsx(y,{message:f.institutionalWebsite,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"linkedinProfile",value:"LinkedIn Profile"}),e.jsx(h,{id:"linkedinProfile",type:"url",className:"mt-1 block w-full",value:s.linkedinProfile,onChange:t=>p("linkedinProfile",t.target.value),placeholder:"https://linkedin.com/in/yourprofile"}),e.jsx(y,{message:f.linkedinProfile,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"googleScholarProfile",value:"Google Scholar Profile"}),e.jsx(h,{id:"googleScholarProfile",type:"url",className:"mt-1 block w-full",value:s.googleScholarProfile,onChange:t=>p("googleScholarProfile",t.target.value),placeholder:"https://scholar.google.com/citations?user=..."}),e.jsx(y,{message:f.googleScholarProfile,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"researchgateProfile",value:"ResearchGate Profile"}),e.jsx(h,{id:"researchgateProfile",type:"url",className:"mt-1 block w-full",value:s.researchgateProfile,onChange:t=>p("researchgateProfile",t.target.value),placeholder:"https://www.researchgate.net/profile/..."}),e.jsx(y,{message:f.researchgateProfile,className:"mt-2"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsx("button",{type:"button",onClick:()=>j(null),className:"text-sm text-gray-600 hover:text-gray-900 underline",disabled:o,children:"Back"}),e.jsx(C,{type:"submit",disabled:o||!V(),className:"ml-4",children:o?"Processing...":"Generate Profile"})]})]})})]}):b==="cv"?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-gray-600 mb-6",children:[e.jsx("strong",{children:"CV-based profile generation can extract information directly from your resume."})," Please upload your CV to continue."]}),e.jsx("form",{onSubmit:L,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"cv_file",value:"Upload Your CV"}),e.jsx("input",{id:"cv_file",type:"file",className:"mt-1 block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none p-2",onChange:U,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.tiff",ref:w}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Supported formats: PDF, DOCX, DOC, JPEG, PNG, TIFF"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsx("button",{type:"button",onClick:()=>{j(null),G(null),w.current&&(w.current.value="")},className:"text-sm text-gray-600 hover:text-gray-900 underline",disabled:o,children:"Back"}),e.jsx(C,{type:"submit",disabled:o||!n,className:"ml-4",children:o?"Processing...":"Generate Profile"})]})]})})]}):null:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-600 mb-6 text-left md:text-center lg:text-center",children:"Nexscholar can use AI to help you create your profile. How would you like to proceed?"}),e.jsxs("div",{className:"space-y-4",children:[R&&e.jsxs("button",{onClick:()=>N("automatic"),className:"w-full p-4 border rounded-lg hover:bg-gray-50 flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-gray-800",children:"Generate with Automatic Search"}),e.jsx("span",{className:"text-sm text-gray-600 mt-1 text-left",children:"We'll search the web for your academic information based on your name and institution."})]}),O&&e.jsxs("button",{onClick:()=>N("url"),className:"w-full p-4 border rounded-lg hover:bg-gray-50 flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-gray-800",children:"Generate Using My Profile URLs"}),e.jsx("span",{className:"text-sm text-gray-600 mt-1 text-left",children:"Provide your academic profile URLs for more accurate results."})]}),e.jsxs("button",{onClick:()=>N("cv"),className:"w-full p-4 border rounded-lg hover:bg-gray-50 flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-gray-800",children:"Generate From My CV"}),e.jsx("span",{className:"text-sm text-gray-600 mt-1 text-left",children:"Upload your CV for us to extract information and generate your profile."})]}),e.jsxs("button",{onClick:E,className:"w-full p-4 border rounded-lg hover:bg-gray-50 flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-gray-800",children:"Skip AI Generation for Now"}),e.jsx("span",{className:"text-sm text-gray-600 mt-1 text-left",children:"You can always generate your profile later from your profile settings."})]})]})]})]})]})]})}export{Z as default};
