import{r,j as e,a as D,y as z}from"./app-iMgHp_eS.js";import{V as k}from"./index---wvTow-.js";import{A as M,a as P,b as V,c as B,d as G,e as q,f as K,g as U}from"./alert-dialog-DTA1zc-v.js";import{C as J}from"./chevron-down-LlZn8pLr.js";import{S as X}from"./search-cbBBwD34.js";import{H as S}from"./history-B_uv49Ly.js";import{S as C}from"./sparkles-DUShLJ3x.js";import{C as Z}from"./clock-qgsdW-h0.js";import{f as Q}from"./format-BOijCLBA.js";import{T as ee}from"./trash-2-aKutZ3MS.js";import{T as te}from"./triangle-alert-tP59DIQ0.js";import"./index-ZtdpDmOR.js";import"./index-CBiZf16v.js";import"./index-CPRTWrZv.js";import"./index-CUVil98b.js";import"./index-CrTPggVb.js";import"./index-BF2RFu8G.js";import"./index-B_K2CkPG.js";import"./index-DGrGDkv0.js";import"./index-TSyOZiO6.js";import"./utils-CBfrqCZ4.js";import"./button-Ct11kXcH.js";import"./createLucideIcon-BXdi-pyk.js";import"./en-US-DIdCsyf3.js";const Te=({onSearch:f,researchOptions:se,isSearching:u=!1,initialQuery:re="",pageTitle:ae="Find Your Perfect Research Supervisor",searchDescription:oe="Enter your research interest, topic, or field of study below and we'll match you with supervisors who have relevant expertise.",placeholder:ne="e.g., Artificial Intelligence in Healthcare, Design Science Research...",tips:ie=[],error:y=null,children:le,searchQuery:o,onSearchQueryChange:b,searchType:a,onSearchTypeChange:A,isAcademician:v,userId:ce})=>{const[n,w]=r.useState([]),[H,j]=r.useState(!1),[E,l]=r.useState(!1),[h,i]=r.useState("history"),[N,c]=r.useState(null),[F,I]=r.useState([]),[L,d]=r.useState(!1),[x,p]=r.useState(null),m=r.useRef(null);r.useEffect(()=>{function t(s){m.current&&!m.current.contains(s.target)&&l(!1)}return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[m]),r.useEffect(()=>{(async()=>{j(!0);try{const s=await D.get(route("ai.matching.history"),{params:{search_type:a}});s.data&&s.data.histories&&(w(s.data.histories),i(s.data.histories.length>0?"history":"suggestions"))}catch(s){console.error("Error fetching search history:",s),i("suggestions")}finally{j(!1)}})()},[a]),r.useEffect(()=>{console.log("ðŸ’¡ Generating suggestions for searchType:",a),I((()=>{const s=[];return a==="supervisor"?s.push("Find me a supervisor specializing in machine learning and AI","I'm looking for experts in sustainable energy research","Who can guide me in data science and analytics?","Recommend supervisors for biomedical engineering research","Looking for mentors in computer vision and robotics"):a==="students"?s.push("Students interested in deep learning and neural networks","Find motivated researchers for data analysis projects","Looking for students passionate about climate change research","Find postgraduates with experience in molecular biology","Students working on mobile and web development"):(a==="collaborators"||console.warn("âš ï¸ Unexpected search type:",a,"- using default suggestions"),s.push("Find collaborators for interdisciplinary AI research","Looking for partners in climate science and sustainability","Who's working on cybersecurity and privacy research?","Find colleagues interested in educational technology","Collaborators for joint publication in data science")),s})())},[a]);const T=t=>{z.visit(route("ai.matching.index",{history:t}))},R=t=>{p(t),d(!0)},W=async()=>{if(x)try{await D.delete(route("ai.matching.history.delete",x)),w(t=>t.filter(s=>s.id!==x)),k.success("History deleted"),d(!1),p(null),n.length<=1&&i("suggestions")}catch(t){console.error("Error deleting history:",t),k.error("Failed to delete history"),d(!1),p(null)}},O=t=>{t.preventDefault(),c(null),f(o)},Y=t=>{const s=typeof t=="string"?t:t?.target?.value||"";b(s),c(null)},_=t=>{const s=typeof t=="string"?t:String(t);b(s),l(!1)},$=()=>{const t=[];return v||t.push({value:"supervisor",label:"Supervisor"}),v&&t.push({value:"students",label:"Students"}),t.push({value:"collaborators",label:"Collaborators"}),t};return e.jsxs("div",{className:"w-full max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"mb-4 sm:mb-6 text-center",children:e.jsx("h1",{className:"text-base sm:text-lg text-gray-600 font-normal",children:"What can we match you?"})}),e.jsxs("div",{className:"w-full max-w-4xl",children:[e.jsxs("form",{onSubmit:O,className:"relative",children:[e.jsx("div",{className:"relative bg-white rounded-full shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("select",{value:a,onChange:t=>A(t.target.value),className:"appearance-none bg-transparent border-none pl-3 sm:pl-5 pr-7 sm:pr-9 py-2.5 sm:py-3 text-xs sm:text-sm font-medium text-gray-700 focus:outline-none cursor-pointer",style:{minWidth:"110px"},children:$().map(t=>e.jsxs("option",{value:t.value,children:[t.icon," ",t.label]},t.value))}),e.jsx(J,{className:"absolute right-2 sm:right-2.5 top-1/2 -translate-y-1/2 text-gray-400 w-3.5 h-3.5 sm:w-4 sm:h-4 pointer-events-none"})]}),e.jsx("div",{className:"h-5 sm:h-6 w-px bg-gray-300 flex-shrink-0"}),e.jsx("input",{type:"text",value:typeof o=="string"?o:"",onChange:Y,onFocus:()=>l(!0),onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),o.trim().length>=3?(c(null),saveSearchToRecent(o),f(o),l(!1)):c("Please enter at least 3 characters to search"))},placeholder:"Ask me anything about your research match...",className:"flex-1 px-3 sm:px-5 py-2.5 sm:py-3 text-sm sm:text-base border-none outline-none focus:outline-none focus:ring-0 bg-transparent min-w-0"}),e.jsx("button",{type:"submit",disabled:u,className:`mr-1.5 sm:mr-2 p-2 sm:p-2.5 rounded-full flex-shrink-0 ${u?"bg-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 active:bg-blue-800 transition-colors"}`,children:u?e.jsxs("svg",{className:"animate-spin h-4 w-4 sm:h-5 sm:w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):e.jsx(X,{className:"h-4 w-4 sm:h-5 sm:w-5 text-white"})})]})}),E&&e.jsxs("div",{ref:m,className:"absolute top-full left-0 right-0 mt-1 bg-white rounded-2xl shadow-2xl border border-gray-200 z-50 overflow-hidden animate-slideDown max-h-[40vh]",style:{animation:"slideDown 0.2s ease-out"},children:[e.jsxs("div",{className:"flex border-b border-gray-200 bg-gray-50 flex-shrink-0",children:[e.jsxs("button",{type:"button",onClick:()=>i("history"),className:`flex-1 px-4 sm:px-6 py-2 sm:py-2.5 text-xs sm:text-sm font-medium transition-colors ${h==="history"?"text-blue-600 border-b-2 border-blue-600 bg-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[e.jsx(S,{className:"inline w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1.5 sm:mr-2"}),"History ",n.length>0&&`(${n.length})`]}),e.jsxs("button",{type:"button",onClick:()=>i("suggestions"),className:`flex-1 px-4 sm:px-6 py-2 sm:py-2.5 text-xs sm:text-sm font-medium transition-colors ${h==="suggestions"?"text-blue-600 border-b-2 border-blue-600 bg-white":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[e.jsx(C,{className:"inline w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1.5 sm:mr-2"}),"Suggestions"]})]}),e.jsx("div",{className:"overflow-y-auto p-2 sm:p-3",style:{maxHeight:"calc(40vh - 42px)"},children:h==="history"?e.jsx(e.Fragment,{children:H?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-3"}),e.jsx("p",{className:"text-sm",children:"Loading history..."})]}):n.length>0?e.jsx("div",{className:"space-y-1",children:n.map(t=>e.jsx("button",{type:"button",onClick:()=>T(t.id),className:"w-full text-left px-3 py-2.5 hover:bg-blue-50 rounded-lg transition-colors group border border-transparent hover:border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Z,{className:"mt-0.5 text-gray-400 group-hover:text-blue-600 w-4 h-4 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 truncate",children:t.search_query}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[Q(new Date(t.created_at),"dd/MM/yyyy")," | ",t.results_count," results"]})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),s.preventDefault(),R(t.id)},className:"ml-2 p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors opacity-0 group-hover:opacity-100",title:"Delete history",children:e.jsx(ee,{className:"w-4 h-4"})})]})},t.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(S,{className:"mx-auto w-12 h-12 mb-3 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No search history yet"}),e.jsx("p",{className:"text-xs mt-1",children:"Your searches will be saved here for 7 days"})]})}):e.jsx("div",{className:"space-y-2",children:F.map((t,s)=>e.jsxs("button",{type:"button",onClick:()=>_(t),className:"w-full px-4 py-3 text-sm text-gray-700 bg-gradient-to-r from-gray-50 to-blue-50 hover:from-blue-50 hover:to-blue-100 hover:text-blue-800 rounded-lg transition-all text-left border border-gray-200 hover:border-blue-400 hover:shadow-sm flex items-start group",children:[e.jsx(C,{className:"w-4 h-4 mr-3 mt-0.5 text-gray-400 group-hover:text-blue-500 flex-shrink-0"}),e.jsx("span",{className:"flex-1",children:t})]},s))})})]})]}),(N||y)&&e.jsx("p",{className:"text-red-500 mt-2 text-center text-xs sm:text-sm",children:N||y})]}),e.jsx(M,{open:L,onOpenChange:d,children:e.jsxs(P,{children:[e.jsxs(V,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5 text-amber-500"}),"Delete Search History?"]}),e.jsx(G,{children:"This will permanently delete this search from your history. This action cannot be undone."})]}),e.jsxs(q,{children:[e.jsx(K,{children:"Cancel"}),e.jsx(U,{onClick:W,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:"Delete"})]})]})})]})},g=document.createElement("style");g.textContent=`
  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
`;typeof document<"u"&&!document.getElementById("slideDown-animation")&&(g.id="slideDown-animation",document.head.appendChild(g));export{Te as default};
