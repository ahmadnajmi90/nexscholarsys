import{W as M,j as e,b as T,r as x,q as Q,y as n}from"./app-6KcAPae7.js";import{G as ye,M as ve}from"./MainLayout--yDNTBjU.js";import{T as Ne}from"./TextInput-CzIf-hPP.js";import{I as F,a as _}from"./InputError-C6goN80O.js";import{P as G}from"./PrimaryButton-BDNKdwtj.js";import{S as X}from"./SecondaryButton-BMSD-Ano.js";import{V as j,c as w}from"./index-DjCDrVl_.js";import{M as Ce}from"./Modal-CJvMaQW5.js";import{S as De}from"./react-select.esm-Caq7p8aY.js";import{M as Se}from"./ManageCollaboratorsModal-DneM9edZ.js";import{C as R}from"./ConfirmationModal-B03nOwCE.js";import"./purify.es-9JUW7zMc.js";import{C as Ge,a as We,b as Ee}from"./collapsible-BexDAxIe.js";import{B as C}from"./button-CrdDRXAu.js";import{c as Pe,d as Ae,D as Me,j as Oe,k as $e}from"./core.esm-CgHPs-sn.js";import{S as Fe,a as _e,b as Ie,c as Te,d as H}from"./select-BjYRA_id.js";import{C as Le}from"./chevron-down-ByZMo2lZ.js";import{C as Ye}from"./chevron-right-BAu-tXgn.js";import{F as I}from"./folder-open-BOmTEEi1.js";import{c as ee}from"./createLucideIcon-Dg0NKHwN.js";import{T as L}from"./trash-2-B4CrugC8.js";import{D as re,a as se,b as oe,c as te,e as ae}from"./dialog-RPNwQkV0.js";import{I as ne}from"./input-mPZbvcwj.js";import{L as le}from"./label-CB_vtBTU.js";import{A as ze,a as Be,b as Ue,c as Ve,d as qe,e as Re,f as He,g as Ze}from"./alert-dialog-DFZd1PJm.js";import{P as Z}from"./plus-TSWFZJVg.js";import{U as J}from"./users-BAT0uBt8.js";import{B as $}from"./briefcase-SOOxWO71.js";import{C as Je}from"./clock-BOVlrk4Y.js";import"./house-MPKGRuPU.js";import"./zap-Dc37O7Yf.js";import"./settings-nBn8_I0z.js";import"./useRoles-TTN5TAPq.js";import"./chevron-left-Dg3HzLsn.js";import"./proxy-6rU6RlCr.js";import"./user-round-Gn5hLxMS.js";import"./clipboard-list-CkK1RN7u.js";import"./dollar-sign-DG-1hJGs.js";import"./calendar-CKvWh2Fc.js";import"./file-text-CldtH22C.js";import"./message-square-DOAr_Oao.js";import"./graduation-cap-DsZZvawH.js";import"./building-BAo4hBJ-.js";import"./Dropdown-D9Vn_Uo-.js";import"./transition-CSwR4vyx.js";import"./sparkles-CxsEXFgy.js";import"./bookmark-CKOvIcZS.js";import"./folder-kanban-WJg5ri3Z.js";import"./building-2-BOmvfrGU.js";import"./database-CHeJJryD.js";import"./shield-Di9h5Q6c.js";import"./index-DaBARm37.js";import"./analytics-BQ374C1C.js";import"./iconBase-n0Q-2a7D.js";import"./index-Ce5Il87X.js";import"./supervisionConstants-BuM5-H5X.js";import"./utils-CBfrqCZ4.js";import"./ThreadPane-DyCNvQZd.js";import"./scroll-area-CgKTi-4v.js";import"./index-C3-aQ1HP.js";import"./index-JAD3o4sP.js";import"./index-C_9bpbuH.js";import"./index-Kc-fmclX.js";import"./index-uYzWXxXP.js";import"./index-BdQq_4o_.js";import"./format-BOijCLBA.js";import"./en-US-DIdCsyf3.js";import"./dialog-CwJFq24I.js";import"./download-BwAogcNS.js";import"./x-RVcZvC1Z.js";import"./isSameDay-BHs4V-zU.js";import"./constructNow-6bIQB1GK.js";import"./addDays-KHeCUDUr.js";import"./search-KJO1iUQT.js";import"./circle-check-big-DONTGj_Q.js";import"./tooltip-B6pzDCUw.js";import"./index-Cxfb7wM5.js";import"./index-4gt4wYEX.js";import"./index-CNVNpKw3.js";import"./floating-ui.dom-D5EC_49c.js";import"./index-CSjGVC7d.js";import"./index-CANaiMod.js";import"./index-Bby0leWS.js";import"./index-Chjiymov.js";import"./user-CAcetcbZ.js";import"./info-DJHCwYQy.js";import"./triangle-alert-BSO9t9M4.js";import"./index-D481xr_B.js";import"./index-CkzViFFx.js";import"./index-D5o-Dx5T.js";import"./index-BzUL8saQ.js";import"./check-yEdCv6kj.js";import"./chevron-up-BOXEedZS.js";import"./index-BT3GCukP.js";import"./index-CdJFUDDL.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Qe=ee("FolderPlus",Ke);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],er=ee("Pen",Xe);function rr({isOpen:s,onClose:l}){const{data:o,setData:m,post:f,processing:u,errors:d,reset:c}=M({name:"",description:""}),g=p=>{p.preventDefault(),f(route("project-hub.workspaces.store"),{onSuccess:()=>{j.success(`Workspace "${o.name}" created successfully.`),c(),l()},onError:i=>{console.error("Error creating workspace:",i),j.error("Failed to create workspace. Please check the form for errors.")}})};return s?e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:l}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md relative z-10",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Workspace"}),e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(F,{htmlFor:"name",value:"Workspace Name"}),e.jsx(Ne,{id:"name",type:"text",className:"mt-1 block w-full",value:o.name,onChange:p=>m("name",p.target.value),required:!0}),e.jsx(_,{message:d.name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(F,{htmlFor:"description",value:"Description (Optional)"}),e.jsx("textarea",{id:"description",className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",value:o.description,onChange:p=>m("description",p.target.value),rows:"3"}),e.jsx(_,{message:d.description,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(X,{onClick:l,disabled:u,children:"Cancel"}),e.jsx(G,{type:"submit",disabled:u,children:u?"Creating...":"Create Workspace"})]})]})]})]}):null}function sr({show:s,onClose:l,linkableProjects:o=[]}){const{data:m,setData:f,post:u,processing:d,errors:c,reset:g}=M({post_project_id:""}),p=i=>{i.preventDefault(),u(route("project-hub.projects.store"),{preserveScroll:!0,onSuccess:h=>{const k=o.find(y=>y.id===m.post_project_id),D=k?k.title:"Project";j.success(`Project "${D}" created successfully.`),g(),l()},onError:h=>{console.error("Error creating project:",h),j.error("Failed to create project. Please check the form for errors.")}})};return e.jsx(Ce,{show:s,onClose:l,maxWidth:"md",children:e.jsxs("form",{onSubmit:p,className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create Workspace from Project"}),e.jsxs("div",{className:"mb-6",children:[e.jsx(F,{htmlFor:"post_project_id",value:"Select a Project to Create a Workspace For",className:"mb-2"}),o.length>0?e.jsxs(e.Fragment,{children:[e.jsx(De,{id:"post_project_id",options:o.map(i=>({value:i.id,label:i.title})),onChange:i=>f("post_project_id",i?i.value:""),className:"w-full",classNamePrefix:"select",placeholder:"Select a project...",required:!0}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"The workspace will inherit the title and description from the selected project."})]}):e.jsxs("div",{className:"text-amber-600 py-4 px-3 bg-amber-50 border border-amber-200 rounded-md",children:[e.jsx("p",{className:"mb-3",children:"You don't have any projects available for linking. Please create a project first."}),e.jsx(T,{href:route("post-projects.create"),className:"inline-flex items-center px-4 py-2 bg-amber-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-amber-700 focus:bg-amber-700 active:bg-amber-900 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 transition ease-in-out duration-150",children:"Create Project"})]}),e.jsx(_,{message:c.post_project_id,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx(X,{onClick:l,className:"mr-2",children:"Cancel"}),e.jsx(G,{type:"submit",disabled:d||o.length===0,children:"Create Workspace"})]})]})})}function K({group:s,workspaces:l=[],isUngrouped:o=!1,allGroups:m=[],onEdit:f,onDelete:u}){const[d,c]=x.useState(!0),g=Array.isArray(l)?l:l?.data||[],{setNodeRef:p,isOver:i}=Pe({id:o?"ungrouped":`group-${s?.id}`,data:{type:"group",groupId:o?null:s?.id,isUngrouped:o}});return e.jsxs(Ge,{open:d,onOpenChange:c,className:"border rounded-lg bg-white shadow-sm",children:[e.jsxs(We,{className:"flex items-center justify-between w-full p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors rounded-t-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[d?e.jsx(Le,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}):e.jsx(Ye,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),e.jsx(I,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:o?"Ungrouped":s.name}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",g.length,")"]})]}),!o&&e.jsxs("div",{className:"flex items-center gap-2",onClick:h=>h.stopPropagation(),children:[e.jsx(C,{variant:"ghost",size:"sm",onClick:()=>f(s),className:"h-8 w-8 p-0",children:e.jsx(er,{className:"w-4 h-4"})}),e.jsx(C,{variant:"ghost",size:"sm",onClick:()=>u(s),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(L,{className:"w-4 h-4"})})]})]}),e.jsx(Ee,{children:e.jsx("div",{ref:p,className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4 transition-colors ${i?"bg-blue-50 dark:bg-blue-900/20":""}`,children:g.length===0?e.jsx("div",{className:"col-span-full text-center py-8 text-gray-500 dark:text-gray-400",children:i?"Drop workspace here":"No workspaces in this group"}):g.map(h=>e.jsx(or,{workspace:h,allGroups:m,currentGroupId:o?null:s?.id},h.id))})})]})}function or({workspace:s,allGroups:l,currentGroupId:o}){const{auth:m}=Q().props,{attributes:f,listeners:u,setNodeRef:d,transform:c,isDragging:g}=Ae({id:`workspace-${s.id}`,data:{type:"workspace",workspace:s}}),p=c?{transform:`translate3d(${c.x}px, ${c.y}px, 0)`}:void 0,h=(s.owner?.academician||s.owner?.postgraduate||s.owner?.undergraduate)?.full_name||s.owner?.name||"Unknown",k=m.user.id===s.owner_id?"You":h,D=m.user.id===s.owner_id,y=()=>{confirm(`Delete workspace "${s.name}"? This action cannot be undone and will delete all boards and tasks.`)&&n.delete(route("project-hub.workspaces.destroy",s.id),{preserveScroll:!0,onSuccess:()=>w.success("Workspace deleted successfully"),onError:()=>w.error("Failed to delete workspace")})},W=b=>{const P=b==="ungrouped"?null:b;P===null?n.post(route("project-hub.workspaces.unassign",s.id),{},{preserveScroll:!0,onSuccess:()=>w.success("Workspace moved to ungrouped"),onError:()=>w.error("Failed to move workspace")}):n.post(route("project-hub.workspace-groups.assign",{workspaceGroup:P,workspace:s.id}),{},{preserveScroll:!0,onSuccess:()=>w.success("Workspace moved to group"),onError:()=>w.error("Failed to move workspace")})};return e.jsxs("div",{ref:d,style:p,className:`relative border rounded-lg bg-white dark:bg-gray-800 hover:shadow-md transition-shadow ${g?"opacity-50 shadow-xl":""}`,children:[e.jsx("div",{...u,...f,className:"absolute top-2 left-2 p-1 cursor-move hover:bg-gray-100 dark:hover:bg-gray-700 rounded",title:"Drag to move",children:e.jsx(ye,{className:"w-4 h-4 text-gray-400"})}),D&&e.jsx("button",{onClick:b=>{b.preventDefault(),b.stopPropagation(),y()},className:"absolute top-2 right-2 p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"Delete workspace",children:e.jsx(L,{className:"w-4 h-4"})}),e.jsxs(T,{href:route("project-hub.workspaces.show",s.id),className:"block p-4 pl-10",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-2",children:s.name}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 mb-3",children:[e.jsxs("span",{children:["Owner: ",k]}),e.jsxs("span",{children:[s.members_count||0," members"]})]})]}),e.jsx("div",{className:"px-4 pb-3",onClick:b=>b.stopPropagation(),children:e.jsxs(Fe,{value:o?.toString()||"ungrouped",onValueChange:W,children:[e.jsx(_e,{className:"w-full h-8 text-xs",children:e.jsx(Ie,{placeholder:"Move to..."})}),e.jsxs(Te,{children:[e.jsx(H,{value:"ungrouped",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-3 h-3"}),"Ungrouped"]})}),l.map(b=>e.jsx(H,{value:b.id.toString(),children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-3 h-3"}),b.name]})},b.id))]})]})})]})}function tr({isOpen:s,onClose:l}){const{data:o,setData:m,post:f,processing:u,errors:d,reset:c}=M({name:""}),g=p=>{p.preventDefault(),f(route("project-hub.workspace-groups.store"),{onSuccess:()=>{c(),l(),w.success("Group created successfully")},onError:i=>{i.name?w.error(i.name):w.error("Failed to create group")}})};return e.jsx(re,{open:s,onOpenChange:l,children:e.jsxs(se,{className:"sm:max-w-[425px]",children:[e.jsx(oe,{children:e.jsx(te,{children:"Create Workspace Group"})}),e.jsxs("form",{onSubmit:g,children:[e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"name",children:"Group Name"}),e.jsx(ne,{id:"name",value:o.name,onChange:p=>m("name",p.target.value),placeholder:"e.g., DSPD1573 Student Groups",className:"w-full",autoFocus:!0}),d.name&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:d.name})]})}),e.jsxs(ae,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:l,disabled:u,children:"Cancel"}),e.jsx(C,{type:"submit",disabled:u||!o.name.trim(),children:u?"Creating...":"Create Group"})]})]})]})})}function ar({isOpen:s,onClose:l,group:o}){const{data:m,setData:f,put:u,processing:d,errors:c,reset:g}=M({name:o?.name||""});x.useEffect(()=>{o&&f("name",o.name)},[o]);const p=i=>{i.preventDefault(),o&&u(route("project-hub.workspace-groups.update",o.id),{preserveScroll:!0,onSuccess:()=>{g(),l(),w.success("Group updated successfully")},onError:h=>{h.name?w.error(h.name):w.error("Failed to update group")}})};return e.jsx(re,{open:s,onOpenChange:l,children:e.jsxs(se,{className:"sm:max-w-[425px]",children:[e.jsx(oe,{children:e.jsx(te,{children:"Edit Workspace Group"})}),e.jsxs("form",{onSubmit:p,children:[e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"name",children:"Group Name"}),e.jsx(ne,{id:"name",value:m.name,onChange:i=>f("name",i.target.value),placeholder:"e.g., DSPD1573 Student Groups",className:"w-full",autoFocus:!0}),c.name&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:c.name})]})}),e.jsxs(ae,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:l,disabled:d,children:"Cancel"}),e.jsx(C,{type:"submit",disabled:d||!m.name.trim(),children:d?"Updating...":"Update Group"})]})]})]})})}function nr({isOpen:s,onClose:l,group:o}){const m=()=>{o&&n.delete(route("project-hub.workspace-groups.destroy",o.id),{preserveScroll:!0,onSuccess:()=>{l(),w.success("Group deleted successfully. Workspaces moved to ungrouped.")},onError:()=>{w.error("Failed to delete group")}})};return e.jsx(ze,{open:s,onOpenChange:l,children:e.jsxs(Be,{children:[e.jsxs(Ue,{children:[e.jsx(Ve,{children:"Delete Workspace Group"}),e.jsxs(qe,{children:['Are you sure you want to delete "',o?.name,'"? All workspaces in this group will be moved to ungrouped. This action cannot be undone.']})]}),e.jsxs(Re,{children:[e.jsx(He,{children:"Cancel"}),e.jsx(Ze,{onClick:m,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:"Delete"})]})]})})}function lr({workspaceGroups:s=[],ungroupedWorkspaces:l=[],workspaces:o,projects:m,linkableProjects:f,connections:u}){Array.isArray(o)||o?.data;const d=Array.isArray(m)?m:m?.data||[],{auth:c}=Q().props,[g,p]=x.useState(!1),[i,h]=x.useState(!1),[k,D]=x.useState(null),[y,W]=x.useState(null),[b,P]=x.useState(!1),[ce,ie]=x.useState(null),[de,pe]=x.useState(null),[me,Y]=x.useState(!1),[ue,z]=x.useState(!1),[he,B]=x.useState(!1),[U,A]=x.useState(null),S=Array.isArray(s)?s:[],E=Array.isArray(l)?l:l?.data||[],V=c.user.academician!==null;x.useEffect(()=>{if(!window.Echo)return;const r=[];return S.forEach(a=>{(Array.isArray(a.workspaces)?a.workspaces:a.workspaces?.data||[]).forEach(v=>{const N=window.Echo.private(`workspaces.${v.id}`);r.push({id:v.id,type:"workspace",channel:N}),N.listen(".workspace.updated",()=>{console.log("Workspace updated, reloading..."),n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),N.listen(".workspace.deleted",()=>{console.log("Workspace deleted, reloading..."),n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),N.listen(".workspace.member.added",()=>{n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),N.listen(".workspace.member.removed",()=>{n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),N.listen(".board.created",()=>{n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),N.listen(".board.deleted",()=>{n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})})})}),E.forEach(a=>{const t=window.Echo.private(`workspaces.${a.id}`);r.push({id:a.id,type:"workspace",channel:t}),t.listen(".workspace.updated",()=>{n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),t.listen(".workspace.deleted",()=>{n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),t.listen(".workspace.member.added",()=>{n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),t.listen(".workspace.member.removed",()=>{n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),t.listen(".board.created",()=>{n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),t.listen(".board.deleted",()=>{n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})})}),d.forEach(a=>{const t=window.Echo.private(`projects.${a.id}`);r.push({id:a.id,type:"project",channel:t}),t.listen(".project.updated",()=>{n.reload({only:["projects"]})}),t.listen(".project.deleted",()=>{n.reload({only:["projects"]})}),t.listen(".project.member.added",()=>{n.reload({only:["projects"]})}),t.listen(".project.member.removed",()=>{n.reload({only:["projects"]})}),t.listen(".board.created",()=>{n.reload({only:["projects"]})}),t.listen(".board.deleted",()=>{n.reload({only:["projects"]})})}),()=>{r.forEach(({id:a,type:t})=>{console.log(`Unsubscribing from ${t}.${a}`),window.Echo.leave(`${t}s.${a}`)})}},[S.length,E.length,d.length]),x.useEffect(()=>{if(!window.Echo||!c.user.id)return;const r=window.Echo.private(`App.Models.User.${c.user.id}`);return r.listen(".workspace.member.added",a=>{console.log("You were added to a workspace:",a);const t=a.workspace?.name||"a workspace";j.success(`You were added to ${t}`),n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces"]})}),r.listen(".project.member.added",a=>{console.log("You were added to a project:",a);const t=a.project?.name||"a project";j.success(`You were added to ${t}`),n.reload({only:["projects"]})}),r.listen(".board.member.added",a=>{console.log("You were added to a board:",a);const t=a.board?.name||"a board",v=a.parent?.name||"";j.success(`You were added to board "${t}"${v?` in ${v}`:""}`),n.reload({only:["workspaceGroups","ungroupedWorkspaces","workspaces","projects"]})}),()=>{r.stopListening(".workspace.member.added"),r.stopListening(".project.member.added"),r.stopListening(".board.member.added"),window.Echo.leave(`App.Models.User.${c.user.id}`)}},[c.user.id]);const xe=()=>{k&&n.delete(route("project-hub.workspaces.destroy",k.id),{onSuccess:()=>{j.success(`Workspace "${k.name}" deleted successfully.`),D(null)},onError:r=>{console.error("Error deleting workspace:",r),j.error("Failed to delete workspace. Please try again.")}})},ge=(r,a)=>{r.preventDefault(),r.stopPropagation(),W(a)},je=()=>{y&&n.delete(route("project-hub.projects.destroy",y.id),{onSuccess:()=>{j.success(`Project "${y.name}" deleted successfully.`),W(null)},onError:r=>{console.error("Error deleting project:",r),j.error("Failed to delete project. Please try again.")}})},fe=r=>{A(r),z(!0)},we=r=>{A(r),B(!0)},[q,O]=x.useState(null),be=r=>{const{active:a}=r;a.data.current?.type==="workspace"&&O(a.data.current.workspace)},ke=r=>{const{active:a,over:t}=r;if(!t){O(null);return}if(t.data.current?.type==="group"){const v=a.data.current.workspace.id,N=t.data.current.groupId;N===null?n.post(route("project-hub.workspaces.unassign",v),{},{preserveScroll:!0,onSuccess:()=>j.success("Workspace moved to ungrouped"),onError:()=>j.error("Failed to move workspace")}):n.post(route("project-hub.workspace-groups.assign",{workspaceGroup:N,workspace:v}),{},{preserveScroll:!0,onSuccess:()=>j.success("Workspace moved to group"),onError:()=>j.error("Failed to move workspace")})}O(null)};return e.jsxs("div",{className:"space-y-8 lg:mt-2 mt-20",children:[e.jsxs("div",{className:"space-y-6 lg:mx-0 mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 pl-2",children:"Your Workspaces"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(C,{variant:"outline",onClick:()=>Y(!0),children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"})," New Group"]}),e.jsxs(G,{onClick:()=>p(!0),children:[e.jsx(Z,{className:"w-4 h-4 mr-2"})," New Workspace"]})]})]}),S.length===0&&E.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"mx-auto bg-gray-100 rounded-full w-16 h-16 flex items-center justify-center",children:e.jsx(J,{className:"w-8 h-8 text-gray-500"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No workspaces yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first workspace to start organizing your projects."}),e.jsxs(G,{onClick:()=>p(!0),children:[e.jsx(Z,{className:"w-4 h-4 mr-2"})," Create Workspace"]})]}):e.jsxs(Me,{collisionDetection:Oe,onDragStart:be,onDragEnd:ke,children:[e.jsxs("div",{className:"space-y-4",children:[S.map(r=>e.jsx(K,{group:r,workspaces:r.workspaces,allGroups:S,onEdit:fe,onDelete:we},r.id)),E.length>0&&e.jsx(K,{isUngrouped:!0,workspaces:E,allGroups:S})]}),e.jsx($e,{children:q?e.jsx("div",{className:"p-4 border rounded-lg bg-white shadow-xl opacity-90",children:e.jsx("h3",{className:"font-semibold text-gray-900",children:q.name})}):null})]})]}),e.jsxs("div",{className:"space-y-6 lg:mx-0 mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 pl-2",children:"Your Projects"}),e.jsx("div",{className:"space-x-2",children:V&&e.jsxs(G,{onClick:()=>h(!0),children:[e.jsx($,{className:"w-4 h-4 mr-2"})," New Project"]})})]}),d.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"mx-auto bg-gray-100 rounded-full w-16 h-16 flex items-center justify-center",children:e.jsx($,{className:"w-8 h-8 text-gray-500"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No projects yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first project to start organizing your research."}),e.jsx("div",{className:"space-x-2",children:V&&e.jsxs(G,{onClick:()=>h(!0),children:[e.jsx($,{className:"w-4 h-4 mr-2"})," Create Project"]})})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(r=>{const t=(r.owner.academician||r.owner.postgraduate||r.owner.undergraduate)?.full_name||r.owner.name;return e.jsxs("div",{className:"relative bg-blue-50 shadow rounded-lg hover:shadow-md transition-shadow duration-200",children:[e.jsxs(T,{href:route("project-hub.projects.show",r.id),className:"block p-5",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1 truncate pr-24",children:r.name}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mt-3",children:[e.jsxs("div",{className:"flex items-center mr-4 truncate",children:[e.jsx(J,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{children:["Owner: ",c.user.id===r.owner_id?"You":t]})]}),e.jsxs("div",{className:"flex items-center ml-auto",children:[e.jsx(Je,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:new Date(r.created_at).toLocaleDateString("en-GB")})]})]})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex space-x-1",children:[c.user.id===r.owner_id&&e.jsxs("div",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2 py-1 rounded-full flex items-center",children:[e.jsx("span",{className:"mr-1",children:"👑"}),e.jsx("span",{children:"Owner"})]}),c.user.id===r.owner_id&&e.jsx("button",{onClick:v=>ge(v,r),className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-blue-100 rounded-full",title:"Delete project",children:e.jsx(L,{className:"w-4 h-4"})})]})]},r.id)})})]}),e.jsx(rr,{isOpen:g,onClose:()=>p(!1)}),e.jsx(sr,{show:i,onClose:()=>h(!1),linkableProjects:f||[]}),e.jsx(Se,{show:b,onClose:()=>{P(!1),ie(null),pe(null)},context:ce,contextType:de,connections:u||[]}),e.jsx(R,{show:!!k,onClose:()=>D(null),onConfirm:xe,title:"Delete Workspace",message:k?`Are you sure you want to delete the workspace "${k.name}"? This action cannot be undone and will delete all boards and tasks within this workspace.`:""}),e.jsx(R,{show:!!y,onClose:()=>W(null),onConfirm:je,title:"Delete Project",message:y?`Are you sure you want to delete the project "${y.name}"? This action cannot be undone and will delete all boards and tasks within this project.`:""}),e.jsx(tr,{isOpen:me,onClose:()=>Y(!1)}),e.jsx(ar,{isOpen:ue,onClose:()=>{z(!1),A(null)},group:U}),e.jsx(nr,{isOpen:he,onClose:()=>{B(!1),A(null)},group:U})]})}lr.layout=s=>e.jsx(ve,{title:"NexLab",children:s,TopMenuOpen:!1});export{lr as default};
