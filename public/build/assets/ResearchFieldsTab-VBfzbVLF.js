import{r as o,a as w,j as s,y as S}from"./app-BrPd_5NA.js";import{V as n}from"./index-BBpOhVGp.js";import te from"./FieldOfResearchFormModal-D2ejmwWe.js";import le from"./ResearchAreaFormModal-CSxRfW39.js";import oe from"./NicheDomainFormModal-Cr_HrDHE.js";import A from"./ConfirmationModal-yNKdH32t.js";import{b as C,h as k,m as M,n as E}from"./index-CSsgwYU6.js";function fe(){const[_,L]=o.useState([]),[$,R]=o.useState([]),[P,O]=o.useState([]),[p,c]=o.useState({fields:!0,areas:!1,domains:!1}),[t,T]=o.useState(null),[l,f]=o.useState(null),[i,I]=o.useState({fields:"",areas:"",domains:""}),[d,r]=o.useState({fieldForm:!1,areaForm:!1,domainForm:!1,fieldDelete:!1,areaDelete:!1,domainDelete:!1}),[u,b]=o.useState(null),[h,g]=o.useState(null),[x,y]=o.useState(null),[j,m]=o.useState({field:"create",area:"create",domain:"create"});o.useEffect(()=>{v()},[i.fields]),o.useEffect(()=>{t?N():(R([]),f(null))},[t,i.areas]),o.useEffect(()=>{l?F():O([])},[l,i.domains]);const v=async()=>{c(e=>({...e,fields:!0}));try{const e=await w.get("/api/v1/app/fields-of-research",{params:{per_page:100,search:i.fields||void 0}});L(e.data.data)}catch(e){console.error("Error fetching fields of research:",e),n.error("Failed to load fields of research")}finally{c(e=>({...e,fields:!1}))}},N=async()=>{if(t){c(e=>({...e,areas:!0}));try{const e=await w.get("/api/v1/app/research-areas",{params:{field_of_research_id:t.id,per_page:100,search:i.areas||void 0}});R(e.data.data)}catch(e){console.error("Error fetching research areas:",e),n.error("Failed to load research areas")}finally{c(e=>({...e,areas:!1}))}}},F=async()=>{if(l){c(e=>({...e,domains:!0}));try{const e=await w.get("/api/v1/app/niche-domains",{params:{research_area_id:l.id,per_page:100,search:i.domains||void 0}});O(e.data.data)}catch(e){console.error("Error fetching niche domains:",e),n.error("Failed to load niche domains")}finally{c(e=>({...e,domains:!1}))}}},Q=e=>{T(e),f(null)},V=e=>{f(e)},D=(e,a)=>{I(re=>({...re,[e]:a}))},H=()=>{b(null),m(e=>({...e,field:"create"})),r(e=>({...e,fieldForm:!0}))},q=e=>{b(e),m(a=>({...a,field:"edit"})),r(a=>({...a,fieldForm:!0}))},z=e=>{b(e),r(a=>({...a,fieldDelete:!0}))},B=()=>{r(e=>({...e,fieldForm:!1})),v()},G=()=>{u&&S.delete(`/admin/data-management/fields-of-research/${u.id}`,{preserveScroll:!0,onSuccess:e=>{e.props?.flash?.success&&n.success(e.props.flash.success),e.props?.flash?.error&&n.error(e.props.flash.error),r(a=>({...a,fieldDelete:!1})),t&&t.id===u.id&&T(null),v()},onError:e=>{n.error("A client-side error occurred. Please try again."),console.error(e)}})},J=()=>{g(null),m(e=>({...e,area:"create"})),r(e=>({...e,areaForm:!0}))},K=e=>{g(e),m(a=>({...a,area:"edit"})),r(a=>({...a,areaForm:!0}))},U=e=>{g(e),r(a=>({...a,areaDelete:!0}))},W=()=>{r(e=>({...e,areaForm:!1})),N()},X=()=>{h&&S.delete(`/admin/data-management/research-areas/${h.id}`,{preserveScroll:!0,onSuccess:e=>{e.props?.flash?.success&&n.success(e.props.flash.success),e.props?.flash?.error&&n.error(e.props.flash.error),r(a=>({...a,areaDelete:!1})),l&&l.id===h.id&&f(null),N()},onError:e=>{n.error("A client-side error occurred. Please try again."),console.error(e)}})},Y=()=>{y(null),m(e=>({...e,domain:"create"})),r(e=>({...e,domainForm:!0}))},Z=e=>{y(e),m(a=>({...a,domain:"edit"})),r(a=>({...a,domainForm:!0}))},ee=e=>{y(e),r(a=>({...a,domainDelete:!0}))},se=()=>{r(e=>({...e,domainForm:!1})),F()},ae=()=>{x&&S.delete(`/admin/data-management/niche-domains/${x.id}`,{preserveScroll:!0,onSuccess:e=>{e.props?.flash?.success&&n.success(e.props.flash.success),e.props?.flash?.error&&n.error(e.props.flash.error),r(a=>({...a,domainDelete:!1})),F()},onError:e=>{n.error("A client-side error occurred. Please try again."),console.error(e)}})};return s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Research Fields Hierarchy"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Fields of Research"}),s.jsxs("button",{onClick:H,className:"inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",children:[s.jsx(C,{className:"mr-1"})," Add"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(k,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:i.fields,onChange:e=>D("fields",e.target.value),placeholder:"Search fields...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:p.fields?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):_.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No fields found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:_.map(e=>s.jsxs("li",{className:`py-3 px-2 cursor-pointer hover:bg-gray-50 ${t&&t.id===e.id?"bg-blue-50":""}`,onClick:()=>Q(e),children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:a=>{a.stopPropagation(),q(e)},className:"text-blue-600 hover:text-blue-900",children:s.jsx(M,{})}),s.jsx("button",{onClick:a=>{a.stopPropagation(),z(e)},className:"text-red-600 hover:text-red-900",children:s.jsx(E,{})})]})]}),s.jsxs("span",{className:"block text-xs text-gray-500",children:[e.research_areas_count||0," research areas"]})]},e.id))})})]}),s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Research Areas"}),s.jsxs("button",{onClick:()=>{t&&J()},disabled:!t,className:`inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest ${t?"hover:bg-blue-700 active:bg-blue-900":"opacity-50 cursor-not-allowed"} focus:outline-none focus:border-blue-900 focus:ring ring-blue-300`,children:[s.jsx(C,{className:"mr-1"})," Add Area"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(k,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:i.areas,onChange:e=>D("areas",e.target.value),placeholder:"Search areas...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",disabled:!t})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:t?p.areas?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):$.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No research areas found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:$.map(e=>s.jsxs("li",{className:`py-3 px-2 cursor-pointer hover:bg-gray-50 ${l&&l.id===e.id?"bg-blue-50":""}`,onClick:()=>V(e),children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:a=>{a.stopPropagation(),K(e)},className:"text-blue-600 hover:text-blue-900",children:s.jsx(M,{})}),s.jsx("button",{onClick:a=>{a.stopPropagation(),U(e)},className:"text-red-600 hover:text-red-900",children:s.jsx(E,{})})]})]}),s.jsxs("span",{className:"block text-xs text-gray-500",children:[e.niche_domains_count||0," niche domains"]})]},e.id))}):s.jsx("p",{className:"text-center py-4 text-gray-500",children:"Select a field to view research areas"})})]}),s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Niche Domains"}),s.jsxs("button",{onClick:()=>{l&&Y()},disabled:!l,className:`inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest ${l?"hover:bg-blue-700 active:bg-blue-900":"opacity-50 cursor-not-allowed"} focus:outline-none focus:border-blue-900 focus:ring ring-blue-300`,children:[s.jsx(C,{className:"mr-1"})," Add Domain"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(k,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:i.domains,onChange:e=>D("domains",e.target.value),placeholder:"Search domains...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",disabled:!l})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:l?p.domains?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):P.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No niche domains found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:P.map(e=>s.jsx("li",{className:"py-3 px-2 hover:bg-gray-50",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>Z(e),className:"text-blue-600 hover:text-blue-900",children:s.jsx(M,{})}),s.jsx("button",{onClick:()=>ee(e),className:"text-red-600 hover:text-red-900",children:s.jsx(E,{})})]})]})},e.id))}):s.jsx("p",{className:"text-center py-4 text-gray-500",children:"Select a research area to view niche domains"})})]})]}),s.jsx(te,{isOpen:d.fieldForm,onClose:B,field:u,mode:j.field}),s.jsx(le,{isOpen:d.areaForm,onClose:W,area:h,fieldId:t?t.id:null,mode:j.area}),s.jsx(oe,{isOpen:d.domainForm,onClose:se,domain:x,areaId:l?l.id:null,mode:j.domain}),s.jsx(A,{isOpen:d.fieldDelete,title:"Delete Field of Research",message:`Are you sure you want to delete "${u?.name}"? This action cannot be undone.`,onConfirm:G,onCancel:()=>r(e=>({...e,fieldDelete:!1}))}),s.jsx(A,{isOpen:d.areaDelete,title:"Delete Research Area",message:`Are you sure you want to delete "${h?.name}"? This action cannot be undone.`,onConfirm:X,onCancel:()=>r(e=>({...e,areaDelete:!1}))}),s.jsx(A,{isOpen:d.domainDelete,title:"Delete Niche Domain",message:`Are you sure you want to delete "${x?.name}"? This action cannot be undone.`,onConfirm:ae,onCancel:()=>r(e=>({...e,domainDelete:!1}))})]})}export{fe as default};
