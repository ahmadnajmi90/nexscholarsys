import{q as D,r as i,y as F,j as t,Y as G,a as C}from"./app-xmIh42KO.js";import{M as H}from"./MainLayout-CPl0HUIu.js";import{h as J}from"./index-D9eridZg.js";import K from"./AcademicianTable-zwP9yLDj.js";import Q from"./PostgraduateTable-D-TkbG6M.js";import V from"./UndergraduateTable-C7mDYqJF.js";import"./house-B_klPfw3.js";import"./createLucideIcon-DVFNR6_B.js";import"./zap-Bw3u2y3o.js";import"./users-BZFyQrBm.js";import"./folder-open-oQe88qJA.js";import"./settings-P6EtBnQ_.js";import"./useRoles-PJeD2Kzi.js";import"./chevron-left-CugAg8G6.js";import"./proxy-BAb5Dv9p.js";import"./user-round-CY-SkVGZ.js";import"./clipboard-list-ClXo_Dhd.js";import"./dollar-sign-Bn4bobhp.js";import"./calendar-s4DfQJnn.js";import"./file-text--rlsk2LO.js";import"./message-square-BBXQLeGc.js";import"./graduation-cap-scGiYA0W.js";import"./building-BY7nxrbx.js";import"./Dropdown-DwtwI7E_.js";import"./transition-wZyx5jV7.js";import"./sparkles-oh8aEPVE.js";import"./bookmark-BdJwoyC4.js";import"./folder-kanban-CN2KbaLX.js";import"./building-2-Ch3P9sYq.js";import"./database-Bq9LZVHr.js";import"./shield-CE5hrWmU.js";import"./index-gVQqUwf4.js";import"./analytics-BQ374C1C.js";import"./index-DjSnSkN9.js";import"./iconBase-CmbK3yE2.js";import"./supervisionConstants-BuM5-H5X.js";import"./utils-CBfrqCZ4.js";import"./ThreadPane-B1UkgXx6.js";import"./Modal-9xzh__1a.js";import"./dialog-B-e007Fb.js";import"./index-CLSrQ3eM.js";import"./scroll-area-AuKSir-5.js";import"./index-C-SKuI93.js";import"./index-CfHh2K1o.js";import"./index-DxyQ96zj.js";import"./index-D3U9SMCW.js";import"./index-BdQq_4o_.js";import"./format-BOijCLBA.js";import"./en-US-DIdCsyf3.js";import"./button-BxlM9Ynt.js";import"./download-DhGNF5t8.js";import"./x-CqhkXXcI.js";import"./isSameDay-BHs4V-zU.js";import"./constructNow-6bIQB1GK.js";import"./addDays-KHeCUDUr.js";import"./PrimaryButton-gsFALqdO.js";import"./SecondaryButton-sarh4spo.js";import"./search-ZOwBQLRx.js";import"./circle-check-big-DJvx1MoU.js";import"./chevron-right-W86pD0Cb.js";import"./tooltip-D_lGOzep.js";import"./index-CFWEupJ2.js";import"./index-Jct0HHTX.js";import"./index-C0RVqtAt.js";import"./floating-ui.dom-D5EC_49c.js";import"./index-C_m7Z3So.js";import"./index-Cn5-Ykwo.js";import"./index-DiD6aHt-.js";import"./index-Chjiymov.js";import"./dialog-Cc-SgjeX.js";import"./index-aBJ4ZnJk.js";import"./index-BayBrQ5A.js";import"./briefcase-DNLVAK73.js";import"./user-DqDDY9eD.js";import"./Pagination-BjA_hyeD.js";const ft=({academicians:y,postgraduates:v,undergraduates:w,activeTab:k,researchOptions:j,universities:u=[],faculties:g=[],statuses:L=[]})=>{const{url:A}=D();console.log(u);const R=()=>{const r=new URLSearchParams(window.location.search).get("tab");return r&&["academicians","postgraduates","undergraduates"].includes(r)?r:k||"academicians"},[o,$]=i.useState(R),[S,U]=i.useState(!1),[c,N]=i.useState(""),[a,f]=i.useState(""),[n,p]=i.useState(""),[l,E]=i.useState(""),x=i.useRef(null);i.useEffect(()=>{const e=new URLSearchParams(window.location.search);N(e.get("search")||""),f(e.get("university")||""),p(e.get("faculty")||""),E(e.get("status")||"")},[]),i.useEffect(()=>{let e=!1,r=a,s=n;if(a&&u.length>0&&(u.some(d=>d.id.toString()===a.toString())||(r="",s="",e=!0)),n&&g.length>0&&(g.some(d=>d.id.toString()===n.toString())||(s="",e=!0)),r!==a&&f(r),s!==n&&p(s),e){const m={tab:o,search:c||void 0,university:r||void 0,faculty:s||void 0,status:l||void 0};Object.keys(m).forEach(d=>{m[d]||delete m[d]}),F.get(route("admin.profiles.index",m),{preserveState:!0,replace:!0})}},[u,g,a,n,o,c,l]);const h=i.useCallback(()=>{x.current&&(clearTimeout(x.current),x.current=null)},[]);i.useEffect(()=>{const e=()=>U(!0),r=()=>U(!1);return document.addEventListener("inertia:start",e),document.addEventListener("inertia:finish",r),()=>{document.removeEventListener("inertia:start",e),document.removeEventListener("inertia:finish",r)}},[]),i.useEffect(()=>{$(R())},[A]),i.useEffect(()=>()=>{h()},[h]);const P=async(e,r)=>{try{return(await C.post(route("admin.profiles.reminder"),{userId:e,role:r})).data}catch(s){throw console.error("Error sending reminder:",s),s}},T=async(e,r)=>{try{return(await C.post(route("admin.profiles.batch-reminder"),{userIds:e,role:r})).data}catch(s){throw console.error("Error sending batch reminder:",s),s}},B=i.useCallback(e=>{N(e),h(),e===""?b({search:"",university:a,faculty:n,status:l}):x.current=setTimeout(()=>{b({search:e,university:a,faculty:n,status:l})},500)},[a,n,l,h]),b=(e={})=>{const r={tab:o,search:e.hasOwnProperty("search")?e.search:c,university:e.hasOwnProperty("university")?e.university:a,faculty:e.hasOwnProperty("faculty")?e.faculty:n,status:e.hasOwnProperty("status")?e.status:l};Object.keys(r).forEach(s=>{r[s]||delete r[s]}),F.get(route("admin.profiles.index",r),{preserveState:!0,replace:!0})},M=e=>{f(e),p(""),b({search:c,university:e,faculty:"",status:l})},O=e=>{p(e),b({search:c,university:a,faculty:e,status:l})},q=e=>{E(e),b({search:c,university:a,faculty:n,status:e})},I=g.filter(e=>!0),Y=[{id:"academicians",label:"Academicians",count:y?.total||0},{id:"postgraduates",label:"Postgraduates",count:v?.total||0},{id:"undergraduates",label:"Undergraduates",count:w?.total||0}],z=e=>{N(""),f(""),p(""),E(""),h(),F.get(route("admin.profiles.index",{tab:e}),{preserveState:!0,replace:!0})};return t.jsxs(H,{title:"User Profile Management",children:[t.jsx(G,{title:"User Profile Management"}),t.jsx("div",{className:"mb-0 lg:mb-6 px-4 lg:px-0 py-6 md:py-8 lg:py-0",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg border border-gray-200 mr-0",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:t.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-end",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search by Name"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx(J,{className:"h-4 w-4 text-gray-400"})}),t.jsx("input",{type:"text",id:"search",value:c,onChange:e=>B(e.target.value),placeholder:"Search users by name...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]}),t.jsxs("div",{className:"w-full lg:w-48",children:[t.jsx("label",{htmlFor:"university",className:"block text-sm font-medium text-gray-700 mb-1",children:"University"}),t.jsxs("select",{id:"university",value:a,onChange:e=>M(e.target.value),className:"block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[t.jsx("option",{value:"",children:"All Universities"}),u.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]})]}),t.jsxs("div",{className:"w-full lg:w-48",children:[t.jsx("label",{htmlFor:"faculty",className:"block text-sm font-medium text-gray-700 mb-1",children:"Faculty"}),t.jsxs("select",{id:"faculty",value:n,onChange:e=>O(e.target.value),className:`block w-full py-2 px-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${a?"bg-white":"bg-gray-100 text-gray-500 cursor-not-allowed"}`,disabled:!a,children:[t.jsx("option",{value:"",children:a?"All Faculties":"Please select a university first"}),I.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]})]}),t.jsxs("div",{className:"w-full lg:w-48",children:[t.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Profile Status"}),t.jsxs("select",{id:"status",value:l,onChange:e=>q(e.target.value),className:"block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[t.jsx("option",{value:"",children:"All Statuses"}),L.map(e=>t.jsx("option",{value:e,children:e},e))]})]})]})}),t.jsx("div",{className:"border-b border-gray-200",children:t.jsx("nav",{className:"flex -mb-px",children:Y.map(e=>t.jsx("button",{onClick:()=>z(e.id),className:`py-4 px-6 text-center border-b-2 font-medium text-sm sm:text-base ${o===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap flex items-center space-x-2`,children:t.jsx("span",{children:e.label})},e.id))})}),t.jsxs("div",{className:"p-6",children:[o==="academicians"&&t.jsx(K,{academics:y?.data||[],researchOptions:j,onSendReminder:P,onSendBatchReminder:T,pagination:y||{},currentTab:o,loading:S},`academicians-${o}`),o==="postgraduates"&&t.jsx(Q,{postgraduates:v?.data||[],researchOptions:j,onSendReminder:P,onSendBatchReminder:T,pagination:v||{},currentTab:o,loading:S},`postgraduates-${o}`),o==="undergraduates"&&t.jsx(V,{undergraduates:w?.data||[],researchOptions:j,onSendReminder:P,onSendBatchReminder:T,pagination:w||{},currentTab:o,loading:S},`undergraduates-${o}`)]})]})})})]})};export{ft as default};
