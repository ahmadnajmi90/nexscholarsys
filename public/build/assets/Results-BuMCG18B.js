import{j as e,R as L,r as o,b as I,a as P,Y as ae,y as z}from"./app-rYbU358d.js";import{z as F}from"./transition-B_nYpjLS.js";import{y as T}from"./dialog-CaSIdBKT.js";import{G as Z}from"./proxy-DSN9Mm5G.js";import{M as ne}from"./map-pin-BUWCYvtq.js";import{C as le}from"./clock-CIqwU-F-.js";import{U as H}from"./users-BuJjez-k.js";import{D as ie}from"./user-BzdKyGbP.js";import{S as J}from"./sparkles-DvBlgA-V.js";import{H as R}from"./heart-CZGjmZU-.js";import{E}from"./external-link-DGkq2Ko3.js";import{M as oe}from"./MainLayout-BNmRX-8r.js";import{T as D}from"./Tooltip-BBlLg46z.js";import{B as Q}from"./BookmarkHandler-BRP7ds8a.js";import{C as X}from"./circle-check-1RFBhsJ_.js";import{B as ce}from"./book-open-Dhe6CFHj.js";import{c as ee}from"./createLucideIcon-CM0hSFdW.js";import{U as M}from"./user-plus-D3HlIbmz.js";import{M as G}from"./mail-BRxxlL0f.js";import{V as de}from"./index-BKxsboN1.js";import{S as K}from"./search-DySNRSos.js";import{A as W}from"./arrow-left-CVNTXGcD.js";import"./folder-open-CyoBANYE.js";import"./useRoles-Y6rBB0LM.js";import"./chevron-left-T1e-ldnD.js";import"./calendar-CECQpE5j.js";import"./file-text-DoMWmR31.js";import"./building-D8-EkRDn.js";import"./shield-BSA4YE5o.js";import"./analytics-BQ374C1C.js";import"./Modal-lm5BdYHy.js";import"./briefcase-FLWxRI-E.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],Y=ee("Filter",me);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]],he=ee("FolderKanban",xe);function se({isOpen:s,onClose:a,title:t="AI Insight",content:c=""}){return e.jsx(F.Root,{show:s,as:L.Fragment,children:e.jsxs(T,{as:"div",className:"relative z-50",onClose:a,children:[e.jsx(F.Child,{as:L.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/30"})}),e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(F.Child,{as:L.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-150",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:e.jsxs(T.Panel,{className:"w-full max-w-lg transform overflow-hidden rounded-lg bg-white p-6 text-left align-middle shadow-xl transition-all",children:[e.jsx(T.Title,{className:"text-lg font-semibold text-gray-900 mb-2",children:t}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap leading-relaxed text-sm",children:c}),e.jsx("div",{className:"mt-6 text-right",children:e.jsx("button",{onClick:a,className:"inline-flex items-center px-4 py-2 text-sm rounded-md border border-gray-300 bg-white hover:bg-gray-50",children:"Close"})})]})})})})]})})}function ue({rec:s,onViewSupervisors:a}){var x,y,r,i;const t=s.postgraduate_program;if(!t)return null;const c=t.name||"Postgraduate Program",u=((x=t.university)==null?void 0:x.name)||((y=t.university)==null?void 0:y.full_name)||((r=t.university)==null?void 0:r.short_name)||"Unknown University",d=((i=t.faculty)==null?void 0:i.name)||"",j=typeof s.match_score=="number"?Math.round(s.match_score*100):null,N=j!==null?`${j}%`:"-",[k,f]=o.useState(!1),m=s.justification||"",g=t.duration_years||"",l=t.funding_info||"",v=t.country||"";return e.jsxs("div",{className:"border rounded-xl p-5 bg-white flex flex-col h-full shadow-sm transition-all duration-200 ease-in-out hover:shadow-xl hover:-translate-y-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-blue-50 border border-blue-200 flex items-center justify-center flex-shrink-0",children:e.jsx(Z,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-[1.05rem] font-semibold text-gray-900 leading-snug truncate",title:c,children:c}),e.jsx("div",{className:"text-sm text-gray-600 flex items-center gap-2",children:e.jsx("span",{className:"truncate",title:d?`${d}, ${u}`:u,children:d?`${d}`:""})})]})]}),e.jsx("div",{className:"ml-4",children:e.jsxs("div",{className:"px-2.5 py-1 rounded-full bg-green-50 border border-green-200 text-green-700 text-xs font-semibold text-right",children:[N," ",e.jsx("span",{className:"font-normal text-[11px] text-green-700",children:"Match"})]})})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-x-4 gap-y-2 text-sm text-gray-700",children:[u&&e.jsxs("div",{className:"col-span-2 flex items-center",children:[e.jsx(ne,{className:"w-4 h-4 mr-2 text-gray-400 flex-shrink-0"}),e.jsxs("span",{children:[u,", ",v]})]}),g&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"w-4 h-4 mr-2 text-gray-400 flex-shrink-0"}),e.jsxs("span",{children:[g," years"]})]}),typeof t.supervisors_count=="number"&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"w-4 h-4 mr-2 text-gray-400 flex-shrink-0"}),e.jsxs("span",{children:[t.supervisors_count," Supervisors"]})]}),l&&e.jsxs("div",{className:"col-span-2 flex items-center text-green-600",children:[e.jsx(ie,{className:"w-4 h-4 mr-2 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"text-green-700",children:l})]})]}),Array.isArray(t==null?void 0:t.research_areas)&&t.research_areas.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 mb-2",children:"Research Areas:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.research_areas.slice(0,3).map((b,h)=>e.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full bg-gray-100 text-gray-700 font-medium border border-gray-200",children:b},h))})]}),m&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-900",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 text-blue-800 font-semibold",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"AI Insight"})]}),e.jsx("div",{className:"flex items-start gap-2",children:e.jsx("p",{className:"leading-relaxed line-clamp-3",children:m})}),m.length>200&&e.jsx("button",{onClick:()=>f(!0),className:"mt-2 text-xs text-blue-700 hover:underline",children:"Show More…"}),e.jsx(se,{isOpen:k,onClose:()=>f(!1),title:"AI Insight",content:m})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 pt-4 border-t",children:[e.jsxs("button",{onClick:()=>a(t),className:"inline-flex items-center justify-center px-3 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700",children:[e.jsx(H,{className:"w-4 h-4 mr-2"})," View Supervisors"]}),e.jsxs("button",{className:"px-3 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50 flex items-center",children:[e.jsx(R,{className:"w-4 h-4 mr-2"})," Save"]}),t.application_url&&e.jsxs("a",{href:t.application_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-2 border rounded text-sm hover:bg-gray-50",children:[e.jsx(E,{className:"w-4 h-4 mr-2"})," Program Details"]})]})]})}function fe({supervisor:s}){var O,U;if(!s)return null;console.log(s);const a=s.name||"Supervisor",t=s.department||"",c=typeof s.match_score=="number"?Math.round(s.match_score*100):null,u=s.accepting_students!==!1,d=Array.isArray(s.research_areas)?s.research_areas:[],j=s.publications_count??0,N=s.post_projects_count??0,[k,f]=o.useState(!1),m=s.justification||"",g=s.academician||{},l=g.user||s.user||null,[v,x]=o.useState(!1),[y,r]=o.useState(((O=l==null?void 0:l.connection_status_with_auth_user)==null?void 0:O.status)||"not_connected"),[i,b]=o.useState(((U=l==null?void 0:l.connection_status_with_auth_user)==null?void 0:U.connection_id)||null),[h,w]=o.useState(!0),[A,_]=o.useState(!1),C="academician",p=g.id||s.academician_id||s.id;o.useEffect(()=>{let n=!0;async function B(){try{const $=await Q.checkBookmarkStatus(C,p);n&&_(!!$.is_bookmarked)}catch{}finally{n&&w(!1)}}return p?B():w(!1),()=>{n=!1}},[p]);const S=async()=>{if(l!=null&&l.id){x(!0);try{const n=await P.post(route("api.app.connections.store",l.id));n.data&&n.data.connection&&(r("pending_sent"),b(n.data.connection.id))}catch(n){console.error("Error sending connection request:",n)}finally{x(!1)}}},te=async()=>{if(i){x(!0);try{await P.patch(route("api.app.connections.accept",i)),r("connected")}catch(n){console.error("Error accepting connection request:",n)}finally{x(!1)}}},re=async()=>{if(!(!p||h)){w(!0);try{const n=await Q.toggleBookmark(C,p,"Academicians");_(!!n.is_bookmarked)}catch(n){console.error("Error toggling bookmark:",n)}finally{w(!1)}}},V=g.url||s.url||null,q=(s==null?void 0:s.email)||"";return e.jsxs("div",{className:"border rounded-xl p-5 bg-white shadow-sm transition-all duration-200 ease-in-out hover:shadow-lg hover:ring-2 hover:ring-indigo-200 hover:-translate-y-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-50 border border-indigo-200 flex items-center justify-center",children:e.jsx("img",{src:s.avatar_url!==null?`/storage/${s.avatar_url}`:"/storage/profile_pictures/default.jpg",alt:a,className:"w-full h-full object-cover rounded-full"})}),e.jsx("div",{className:"min-w-0",children:e.jsxs("h3",{className:"text-[1.05rem] font-semibold text-gray-900 leading-snug truncate",children:[a,t&&e.jsx("p",{className:"text-sm text-gray-600 truncate font-normal",children:t})]})})]}),e.jsx("div",{className:"flex flex-col items-end space-y-1 flex-shrink-0",children:c!==null&&e.jsxs("div",{className:"px-2.5 py-1 rounded-full bg-green-50 border border-green-200 text-green-700 text-xs font-semibold",children:[c,"% ",e.jsx("span",{className:"font-normal text-[11px]",children:"Match"})]})})]}),e.jsxs("div",{className:"mt-4 flex items-center space-x-4 text-sm text-gray-600",children:[u&&e.jsxs("div",{className:"inline-flex items-center gap-1.5 text-green-700",children:[e.jsx(X,{className:"w-4 h-4"}),e.jsx("span",{children:"Accepting Students"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"w-4 h-4 mr-1.5 text-gray-400"}),e.jsxs("span",{children:[j," Publications"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(he,{className:"w-4 h-4 mr-1.5 text-gray-400"}),e.jsxs("span",{children:[N," Projects"]})]})]}),d.length>0&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx("p",{className:"text-gray-800 text-sm font-medium",children:"Research Areas:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.map((n,B)=>e.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full bg-gray-100 text-gray-700 border border-gray-200",children:n},B))})]}),m&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-900",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 text-blue-800 font-semibold",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"AI Insight"})]}),e.jsx("div",{className:"flex items-start gap-2",children:e.jsx("p",{className:"leading-relaxed line-clamp-3",children:m})}),m.length>200&&e.jsx("button",{onClick:()=>f(!0),className:"mt-2 text-xs text-blue-700 hover:underline",children:"Show More…"}),e.jsx(se,{isOpen:k,onClose:()=>f(!1),title:"AI Insight",content:m})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 pt-4 border-t",children:[(()=>{if(v)return e.jsx("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-gray-400 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:"Processing..."});switch(y){case"connected":return e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Connected"]});case"pending_sent":return e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 bg-gray-400 text-white rounded-md text-sm font-medium flex-1",disabled:!0,children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Pending"]});case"pending_received":return e.jsxs("button",{onClick:te,className:"inline-flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700 flex-1",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Accept"]});case"not_connected":default:return e.jsxs("button",{onClick:S,className:"inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 flex-1",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Connect"]})}})(),V?e.jsxs(I,{href:route("academicians.show",V),className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 flex-1",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"View Profile"]}):e.jsxs("button",{className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-400 bg-white flex-1",disabled:!0,children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"View Profile"]}),e.jsx(D,{content:"Save",children:e.jsxs("button",{onClick:re,className:"inline-flex items-center justify-center h-9 w-9 border border-gray-300 rounded-md text-gray-600 bg-white hover:bg-gray-50",disabled:h,children:[e.jsx("span",{className:"sr-only",children:"Save"}),A?e.jsx(R,{className:"w-4 h-4 fill-red-500 text-red-500"}):e.jsx(R,{className:"w-4 h-4"})]})}),e.jsx(D,{content:"Contact",children:q?e.jsxs(I,{href:route("email.compose",{to:q}),className:"inline-flex items-center justify-center h-9 w-9 border border-gray-300 rounded-md text-gray-600 bg-white hover:bg-gray-50",children:[e.jsx("span",{className:"sr-only",children:"Contact"}),e.jsx(G,{className:"w-4 h-4"})]}):e.jsxs("button",{className:"inline-flex items-center justify-center h-9 w-9 border border-gray-300 rounded-md text-gray-300 bg-white",disabled:!0,children:[e.jsx("span",{className:"sr-only",children:"Contact"}),e.jsx(G,{className:"w-4 h-4"})]})})]})]})}function Ke({recommendations:s=[],selectedProgram:a=null,supervisors:t=[]}){var x,y;const[c,u]=o.useState(""),[d,j]=o.useState(""),[N,k]=o.useState("match_score_desc"),f=a?"Available Supervisors":"Postgraduate Program Recommendations",m=r=>{if(!(r!=null&&r.id))return de.error("Program not found");z.get(route("postgraduate-recommendations.supervisors",r.id))},g=()=>{z.get(route("postgraduate-recommendations.results"))},l=o.useMemo(()=>{let r=Array.isArray(s)?s.slice():[];if(c){const i=c.toLowerCase();r=r.filter(b=>{var p,S;const h=b.postgraduate_program;if(!h)return!1;const w=(h.name||"").toLowerCase().includes(i),A=(((p=h.university)==null?void 0:p.name)||"").toLowerCase().includes(i),_=(((S=h.faculty)==null?void 0:S.name)||"").toLowerCase().includes(i),C=(h.country||"").toLowerCase().includes(i);return w||A||_||C})}return N==="match_score_desc"&&r.sort((i,b)=>(b.match_score||0)-(i.match_score||0)),r},[s,c,N]),v=o.useMemo(()=>{if(!d)return t;const r=d.toLowerCase();return t.filter(i=>(i.name||"").toLowerCase().includes(r))},[t,d]);return e.jsx(oe,{title:f,children:e.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[e.jsx(ae,{title:f}),a?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{className:"text-sm text-gray-600 hover:text-gray-900 flex items-center",onClick:g,children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Back to All Programs"]}),e.jsx("div",{className:"mt-2 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-6 h-6 text-blue-600"}),e.jsxs("div",{className:"flex flex-col ml-1",children:[e.jsx("h2",{className:"text-m font-normal text-blue-900",children:a==null?void 0:a.name}),e.jsxs("p",{className:"text-sm text-blue-600",children:[(x=a==null?void 0:a.faculty)==null?void 0:x.name,", ",(y=a==null?void 0:a.university)==null?void 0:y.full_name]})]})]})})]}),e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-6",children:e.jsxs("div",{className:"flex items-center gap-2 w-full md:max-w-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 border border-gray-300 rounded-md px-3 bg-white",children:[e.jsx(K,{className:"w-4 h-4 text-gray-500"}),e.jsx("input",{value:d,onChange:r=>j(r.target.value),placeholder:"Search supervisors...",className:"border border-white w-full text-sm text-gray-700 placeholder:text-gray-400 focus:outline-none"})]}),e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm text-gray-700 hover:bg-gray-50",children:[e.jsx(Y,{className:"w-4 h-4"}),"Filters"]})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-5",children:[v.map(r=>e.jsx(fe,{supervisor:r},r.id)),t.length===0&&e.jsx("div",{className:"text-center text-gray-600 py-10 col-span-2",children:"No supervisors found for this program."})]}),t.length>0&&e.jsxs("div",{className:"text-center mt-12 py-8 border-t border-gray-200",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Want to explore other programs? Check out our other recommendations."}),e.jsxs(I,{href:route("postgraduate-recommendations.results"),className:"inline-flex items-center px-6 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Back to All Programs"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-start gap-3 bg-green-50 border border-green-200 text-green-900 px-4 py-3 rounded-md mb-5",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{className:"flex flex-col ml-1 text-sm",children:[e.jsx("p",{className:"font-semibold",children:"Analysis Complete!"}),e.jsxs("p",{children:["We found ",l.length," highly compatible Postgraduate Programs based on your profile and research interests."]})]})]})}),e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-6",children:e.jsxs("div",{className:"flex items-center gap-2 w-full md:max-w-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 border border-gray-300 rounded-md px-3 bg-white",children:[e.jsx(K,{className:"w-4 h-4 text-gray-500"}),e.jsx("input",{value:c,onChange:r=>u(r.target.value),placeholder:"Search programs, universities, or research areas...",className:"border border-white w-full text-sm text-gray-700 placeholder:text-gray-400 focus:outline-none"})]}),e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md bg-white text-sm text-gray-700 hover:bg-gray-50",children:[e.jsx(Y,{className:"w-4 h-4"}),"Filters"]})]})}),e.jsx("div",{className:"grid md:grid-cols-2 gap-5",children:l.map((r,i)=>e.jsx(ue,{rec:r,onViewSupervisors:()=>m(r.postgraduate_program)},i))}),e.jsxs("div",{className:"text-center mt-12 py-8 border-t border-gray-200",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Not seeing the perfect program? Try refining your search or contact our academic advisors."}),e.jsx(I,{href:route("postgraduate-recommendations.index"),className:"inline-flex items-center px-6 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Refine Search Criteria"})]})]})]})})}export{Ke as default};
