import{q as x,W as p,j as e,a as g,r as h}from"./app-DewsNuKu.js";import{M as f}from"./MainLayout-D1Tk-a7I.js";import{R as j}from"./quill.snow-DGVD7SC4.js";import{u as b}from"./useRoles-ChHhFBoK.js";import"./index-DyfeCr02.js";function N({tags:o,setTags:a}){const[l,n]=h.useState(""),d=t=>{if(t.key==="Enter"||t.key===","){t.preventDefault();const i=l.trim();i&&!o.includes(i)&&a([...o,i]),n("")}else t.key==="Backspace"&&!l.length&&o.length&&a(o.slice(0,o.length-1))},m=t=>{a(o.filter((i,u)=>u!==t))};return e.jsxs("div",{className:"flex flex-wrap items-center border rounded-lg p-2",children:[o.map((t,i)=>e.jsxs("div",{className:"bg-blue-200 text-blue-800 rounded-full px-3 py-1 m-1 flex items-center",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button",onClick:()=>m(i),className:"ml-2 text-sm text-blue-800",children:"Ã—"})]},i)),e.jsx("input",{type:"text",value:l,onChange:t=>n(t.target.value),onKeyDown:d,className:"flex-grow outline-none p-1",placeholder:"Type a tag and press enter"})]})}function k(){const{auth:o,post:a}=x().props;b();const{data:l,setData:n,post:d,processing:m,errors:t}=p({title:a.title||"",url:a.url||"",content:a.content||"",category:a.category||"",tags:a.tags||[],image:null,featured_image:null,attachment:null,status:a.status||"published"}),i=s=>{n("tags",s)};function u(s){s.preventDefault();const c=new FormData;Object.keys(l).forEach(r=>{(r==="image"||r==="featured_image"||r==="attachment")&&!l[r]||(r==="tags"?c.append(r,JSON.stringify(l[r])):(l[r]instanceof File,c.append(r,l[r])))}),d(route("create-posts.update",a.id),{data:c,headers:{"Content-Type":"multipart/form-data"},onSuccess:()=>{alert("Post updated successfully.")},onError:r=>{console.error("Error updating Post:",r),alert("Failed to update the Post. Please try again.")}})}return e.jsx(f,{children:e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:u,className:"bg-white p-6 rounded-lg max-w-7xl mx-auto space-y-6",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-700 text-center",children:"Edit Post"}),e.jsxs("div",{className:"grid grid-cols-10 gap-8",children:[e.jsxs("div",{className:"col-span-7",children:[e.jsxs("label",{className:"block text-gray-700 font-medium",children:["Post Title",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:l.title,onChange:s=>n("title",s.target.value),className:"mt-1 w-full rounded-lg border-gray-200 p-4 text-sm",placeholder:"Enter Post Title"}),t.title&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.title})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Category"}),e.jsxs("select",{id:"category",name:"category",value:l.category,onChange:s=>n("category",s.target.value),className:"mt-1 w-full rounded-lg border-gray-200 p-4 text-sm",children:[e.jsx("option",{value:"",disabled:!0,hidden:!0,children:"Select Category"}),e.jsx("option",{value:"General Discussion",children:"General Discussion"}),e.jsx("option",{value:"Academic Research",children:"Academic Research"}),e.jsx("option",{value:"Student Life",children:"Student Life"}),e.jsx("option",{value:"Career Opportunities",children:"Career Opportunities"}),e.jsx("option",{value:"Events & Workshops",children:"Events & Workshops"}),e.jsx("option",{value:"Scholarships & Funding",children:"Scholarships & Funding"})]}),t.category&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.category})]})]}),e.jsxs("div",{className:"grid grid-cols-10 gap-8",children:[e.jsxs("div",{className:"col-span-7",children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Post URL"}),e.jsx("input",{type:"url",value:l.url,disabled:!0,onChange:s=>n("url",s.target.value),className:"mt-1 w-full rounded-lg border-gray-200 p-4 bg-gray-100 text-sm cursor-not-allowed",placeholder:"Auto-generated from title"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Tags"}),e.jsx(N,{tags:l.tags,setTags:i}),t.tags&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.tags})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-8",children:[e.jsxs("div",{className:"col-span-8",children:[e.jsxs("label",{className:"block text-gray-700 font-medium",children:["Content ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"mt-1 w-full rounded-lg border border-gray-200",style:{height:"300px",overflowY:"auto"},children:e.jsx(j,{theme:"snow",value:l.content,onChange:s=>n("content",s),placeholder:"Enter content",style:{height:"300px",maxHeight:"300px"}})}),t.content&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.content})]}),e.jsxs("div",{className:"col-span-4 flex flex-col space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Upload Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>n("image",s.target.files[0]),className:"mt-1 w-full rounded-lg border-gray-200 p-2 text-sm"}),a.image&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Image:"}),e.jsx("a",{href:`/storage/${a.image}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:"View Image"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Upload Featured Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>n("featured_image",s.target.files[0]),className:"mt-1 w-full rounded-lg border-gray-200 p-2 text-sm"}),a.featured_image&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Featured Image:"}),e.jsx("a",{href:`/storage/${a.featured_image}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:"View Featured Image"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Upload Attachment"}),e.jsx("input",{type:"file",onChange:s=>n("attachment",s.target.files[0]),className:"mt-1 w-full rounded-lg border-gray-200 p-2 text-sm"}),a.attachment&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Current Attachment:"}),e.jsx("a",{href:`/storage/${a.attachment}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:"View Attachment"})]})]})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"submit",disabled:m,className:"inline-block rounded-lg bg-blue-500 px-5 py-3 text-sm font-medium text-white hover:bg-blue-600",children:"Update"}),e.jsx(g,{href:route("create-posts.index"),className:"inline-block rounded-lg bg-gray-300 px-5 py-3 text-sm font-medium text-gray-700 hover:bg-gray-400",children:"Cancel"})]})]})})})}export{k as default};
