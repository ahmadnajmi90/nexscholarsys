import{r as l,j as e,a as i,b as w}from"./app-DikJv5gO.js";import{e as b,a as D,b as H,f as G,c as M,g as T,h as z,i as B,j as P}from"./index-3-Iofj4O.js";import{u as W}from"./useRoles-Du-nPZAJ.js";import{H as J}from"./Helmet-BDl6jjgr.js";function Y({post:t,previous:m,next:h,academicians:x,postgraduates:g,undergraduates:u,isWelcome:f,auth:p}){const{isAcademician:y,isPostgraduate:N,isUndergraduate:k}=W(),[v,_]=l.useState(t.total_likes||0),[V,L]=l.useState(t.total_shares||0),[C,A]=l.useState(t.liked||!1),[j,r]=l.useState(!1),c=l.useRef(null);l.useEffect(()=>{const a=s=>{c.current&&!c.current.contains(s.target)&&r(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);const n=y&&x&&x.find(a=>a.academician_id===t.author_id)||N&&g&&g.find(a=>a.postgraduate_id===t.author_id)||k&&u&&u.find(a=>a.undergraduate_id===t.author_id)||null,F=t.title,S=t.excerpt||t.content.substring(0,200),$=window.location.href,d=t.featured_image?`/storage/${t.featured_image}`:"/storage/default-image.jpg",R=()=>{if(!p){window.location.href=route("login");return}w.post(route("posts.toggleLike",t.url)).then(a=>{_(a.data.total_likes),A(a.data.liked)}).catch(a=>console.error(a))},o=a=>{a(),w.post(route("posts.share",t.url)).then(s=>{L(s.data.total_shares)}).catch(s=>console.error(s))},U=()=>{const a=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}`;window.open(a,"_blank","width=600,height=400")},E=()=>{const a=`https://wa.me/?text=${encodeURIComponent(window.location.href)}`;window.open(a,"_blank")},I=()=>{const a=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(window.location.href)}`;window.open(a,"_blank","width=600,height=400")},O=()=>{navigator.clipboard.writeText(window.location.href).then(()=>{alert("Link copied to clipboard")})};return e.jsxs("div",{className:"px-10 md:px-16",children:[e.jsxs(J,{children:[e.jsx("meta",{property:"og:title",content:F}),e.jsx("meta",{property:"og:description",content:S}),e.jsx("meta",{property:"og:url",content:$}),e.jsx("meta",{property:"og:image",content:d}),e.jsx("meta",{property:"og:type",content:"article"}),e.jsx("meta",{property:"og:site_name",content:"Nexscholar"}),e.jsx("meta",{property:"og:image:width",content:"1200"}),e.jsx("meta",{property:"og:image:height",content:"630"}),e.jsx("meta",{property:"og:image",content:d}),e.jsx("meta",{property:"og:image",content:d})]}),f?e.jsx("div",{className:"absolute top-[6.2rem] left-2 md:top-[6.1rem] md:left-[1rem] z-10",children:e.jsx(i,{onClick:()=>window.history.back(),className:"flex items-center justify-center w-6 h-6 md:w-8 md:h-8 bg-blue-500 text-white rounded-full shadow-lg hover:bg-blue-600",children:e.jsx(b,{className:"text-lg md:text-xl"})})}):e.jsx("div",{className:"absolute top-[1.8rem] left-2 md:top-[5.5rem] md:left-[19.5rem] z-10",children:e.jsx(i,{onClick:()=>window.history.back(),className:"flex items-center justify-center w-6 h-6 md:w-8 md:h-8 bg-blue-500 text-white rounded-full shadow-lg hover:bg-blue-600",children:e.jsx(b,{className:"text-lg md:text-xl"})})}),e.jsxs("div",{className:"max-w-8xl mx-auto py-6",children:[t.title&&e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-4 text-left",children:t.title}),n?e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("img",{src:`/storage/${n.profile_picture}`,alt:n.full_name,className:"w-12 h-12 rounded-full object-cover shadow-md bg-gray-200 border-2 border-white"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:n.full_name}),e.jsx("div",{className:"text-gray-500",children:new Date(t.created_at).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]}):e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("img",{src:"/storage/Admin.jpg",alt:"Admin",className:"w-12 h-12 rounded-full object-cover shadow-md border-2 border-white"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:"Admin"}),e.jsx("div",{className:"text-gray-500",children:new Date(t.created_at).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]}),e.jsxs("div",{className:"my-4",children:[e.jsx("hr",{}),e.jsxs("div",{className:"flex flex-wrap items-center space-x-4 py-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{className:"w-6 h-6 text-gray-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:t.total_views})]}),e.jsxs("button",{onClick:R,className:"flex items-center",children:[C?e.jsx(H,{className:"w-6 h-6 text-red-600"}):e.jsx(G,{className:"w-6 h-6 text-gray-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:v})]}),e.jsxs("div",{className:"relative",ref:c,children:[e.jsx("button",{onClick:()=>r(!j),className:"flex items-center",children:e.jsx(M,{className:"w-6 h-6 text-gray-600"})}),j&&e.jsxs("div",{className:"absolute left-0 mt-2 w-40 bg-white shadow-lg rounded z-10",children:[e.jsxs("button",{onClick:()=>{o(O),r(!1)},className:"block w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center",children:[e.jsx(T,{className:"w-5 h-5 inline mr-2 text-gray-600"}),"Copy Link"]}),e.jsx("hr",{className:"my-1"}),e.jsxs("button",{onClick:()=>{o(U),r(!1)},className:"block w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center",children:[e.jsx(z,{className:"w-5 h-5 inline mr-2 text-blue-600"}),"Facebook"]}),e.jsxs("button",{onClick:()=>{o(E),r(!1)},className:"block w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center",children:[e.jsx(B,{className:"w-5 h-5 inline mr-2 text-green-600"}),"WhatsApp"]}),e.jsxs("button",{onClick:()=>{o(I),r(!1)},className:"block w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center",children:[e.jsx(P,{className:"w-5 h-5 inline mr-2 text-blue-700"}),"LinkedIn"]})]})]})]}),e.jsx("hr",{})]}),t.featured_image&&e.jsx("img",{src:`/storage/${t.featured_image}`,alt:"Banner",className:"w-full h-auto md:h-64 object-cover mb-4 rounded"}),e.jsx("div",{className:"mb-4 text-gray-700 prose w-full text-justify max-w-none break-words",dangerouslySetInnerHTML:{__html:t.content}}),t.category&&e.jsxs("p",{className:"mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Category:"})," ",t.category]}),t.tags&&e.jsxs("p",{className:"mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Tags:"})," ",Array.isArray(t.tags)?t.tags.join(", "):t.tags]}),t.attachment&&e.jsxs("p",{className:"mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Attachment:"}),e.jsx("a",{href:`/storage/${t.attachment}`,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-blue-500 underline",children:"View Attachment"})]}),t.images&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Gallery"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:JSON.parse(t.images).map((a,s)=>e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsx("img",{src:`/storage/${a}`,alt:`Gallery image ${s+1}`,className:"w-full h-auto md:h-32 object-cover"})},s))})]}),!f&&e.jsxs("div",{className:"max-w-3xl mx-auto py-6 flex justify-between",children:[m?e.jsx(i,{href:route("posts.show",m.url),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Previous"}):e.jsx("span",{}),h?e.jsx(i,{href:route("posts.show",h.url),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Next"}):e.jsx("span",{})]})]})]})}export{Y as default};
