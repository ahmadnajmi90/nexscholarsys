import{r,b as M,j as s,y as E}from"./app-6Mso6ff_.js";import{V as n}from"./index-BySJLeBq.js";import ne from"./SkillsDomainFormModal-DXM_NutP.js";import ie from"./SkillsSubdomainFormModal-CzxVU1uu.js";import de from"./SkillFormModal-DrJ9Igm6.js";import A from"./ConfirmationModal-DBTuWpqt.js";import{b as _,g as $,l as P,m as T}from"./index-C5PP5upB.js";import"./iconBase-CMTnGGm1.js";function ge(){const[O,R]=r.useState([]),[L,I]=r.useState([]),[Q,V]=r.useState([]),[j,p]=r.useState({domains:!0,subdomains:!1,skills:!1}),[t,H]=r.useState(null),[o,y]=r.useState(null),[d,q]=r.useState({domains:"",subdomains:"",skills:""}),[b,a]=r.useState({domainForm:!1,subdomainForm:!1,skillForm:!1,domainDelete:!1,subdomainDelete:!1,skillDelete:!1}),[u,k]=r.useState(null),[x,v]=r.useState(null),[h,N]=r.useState(null),[S,f]=r.useState({domain:"create",subdomain:"create",skill:"create"});r.useEffect(()=>{D()},[d.domains]),r.useEffect(()=>{t?w():(I([]),y(null))},[t,d.subdomains]),r.useEffect(()=>{o?F():V([])},[o,d.skills]);const D=async()=>{p(e=>({...e,domains:!0}));try{const e=await M.get("/api/v1/app/skills-domains",{params:{per_page:100,search:d.domains||void 0}});R(e.data.data)}catch(e){console.error("Error fetching skills domains:",e),n.error("Failed to load skills domains")}finally{p(e=>({...e,domains:!1}))}},w=async()=>{if(t){p(e=>({...e,subdomains:!0}));try{const e=await M.get("/api/v1/app/skills-subdomains",{params:{skills_domain_id:t.id,per_page:100,search:d.subdomains||void 0,with_domain:!0}});I(e.data.data)}catch(e){console.error("Error fetching skills subdomains:",e),n.error("Failed to load skills subdomains")}finally{p(e=>({...e,subdomains:!1}))}}},F=async()=>{if(o){p(e=>({...e,skills:!0}));try{const e=await M.get("/api/v1/app/skills",{params:{skills_subdomain_id:o.id,per_page:100,search:d.skills||void 0,with_hierarchy:!0}});V(e.data.data)}catch(e){console.error("Error fetching skills:",e),n.error("Failed to load skills")}finally{p(e=>({...e,skills:!1}))}}},z=e=>{H(e),y(null)},B=e=>{y(e)},C=(e,l)=>{q(i=>({...i,[e]:l}))},G=()=>{k(null),f(e=>({...e,domain:"create"})),a(e=>({...e,domainForm:!0}))},J=e=>{k(e),f(l=>({...l,domain:"edit"})),a(l=>({...l,domainForm:!0}))},K=e=>{k(e),a(l=>({...l,domainDelete:!0}))},U=()=>{a(e=>({...e,domainForm:!1})),D()},W=()=>{u&&E.delete(`/admin/data-management/skills-domains/${u.id}`,{preserveScroll:!0,onSuccess:e=>{var l,i,c,m;(i=(l=e.props)==null?void 0:l.flash)!=null&&i.success&&n.success(e.props.flash.success),(m=(c=e.props)==null?void 0:c.flash)!=null&&m.error&&n.error(e.props.flash.error),a(g=>({...g,domainDelete:!1})),t&&t.id===u.id&&H(null),D()},onError:e=>{n.error("A client-side error occurred. Please try again."),console.error(e)}})},X=()=>{v(null),f(e=>({...e,subdomain:"create"})),a(e=>({...e,subdomainForm:!0}))},Y=e=>{v(e),f(l=>({...l,subdomain:"edit"})),a(l=>({...l,subdomainForm:!0}))},Z=e=>{v(e),a(l=>({...l,subdomainDelete:!0}))},ee=()=>{a(e=>({...e,subdomainForm:!1})),w()},se=()=>{x&&E.delete(`/admin/data-management/skills-subdomains/${x.id}`,{preserveScroll:!0,onSuccess:e=>{var l,i,c,m;(i=(l=e.props)==null?void 0:l.flash)!=null&&i.success&&n.success(e.props.flash.success),(m=(c=e.props)==null?void 0:c.flash)!=null&&m.error&&n.error(e.props.flash.error),a(g=>({...g,subdomainDelete:!1})),o&&o.id===x.id&&y(null),w()},onError:e=>{n.error("A client-side error occurred. Please try again."),console.error(e)}})},le=()=>{N(null),f(e=>({...e,skill:"create"})),a(e=>({...e,skillForm:!0}))},ae=e=>{N(e),f(l=>({...l,skill:"edit"})),a(l=>({...l,skillForm:!0}))},te=e=>{N(e),a(l=>({...l,skillDelete:!0}))},oe=()=>{a(e=>({...e,skillForm:!1})),F()},re=()=>{h&&E.delete(`/admin/data-management/skills/${h.id}`,{preserveScroll:!0,onSuccess:e=>{var l,i,c,m;(i=(l=e.props)==null?void 0:l.flash)!=null&&i.success&&n.success(e.props.flash.success),(m=(c=e.props)==null?void 0:c.flash)!=null&&m.error&&n.error(e.props.flash.error),a(g=>({...g,skillDelete:!1})),F()},onError:e=>{n.error("A client-side error occurred. Please try again."),console.error(e)}})};return s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Skills Taxonomy Hierarchy"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Skills Domains"}),s.jsxs("button",{onClick:G,className:"inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300",children:[s.jsx(_,{className:"mr-1"})," Add"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx($,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:d.domains,onChange:e=>C("domains",e.target.value),placeholder:"Search domains...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:j.domains?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):O.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No domains found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:O.map(e=>s.jsxs("li",{className:`py-3 px-2 cursor-pointer hover:bg-gray-50 ${t&&t.id===e.id?"bg-blue-50":""}`,onClick:()=>z(e),children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:l=>{l.stopPropagation(),J(e)},className:"text-blue-600 hover:text-blue-900",children:s.jsx(P,{})}),s.jsx("button",{onClick:l=>{l.stopPropagation(),K(e)},className:"text-red-600 hover:text-red-900",children:s.jsx(T,{})})]})]}),s.jsxs("span",{className:"block text-xs text-gray-500",children:[e.subdomains_count||0," subdomains"]})]},e.id))})})]}),s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Skills Subdomains"}),s.jsxs("button",{onClick:()=>{t&&X()},disabled:!t,className:`inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest ${t?"hover:bg-blue-700 active:bg-blue-900":"opacity-50 cursor-not-allowed"} focus:outline-none focus:border-blue-900 focus:ring ring-blue-300`,children:[s.jsx(_,{className:"mr-1"})," Add Subdomain"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx($,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:d.subdomains,onChange:e=>C("subdomains",e.target.value),placeholder:"Search subdomains...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",disabled:!t})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:t?j.subdomains?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):L.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No subdomains found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:L.map(e=>s.jsxs("li",{className:`py-3 px-2 cursor-pointer hover:bg-gray-50 ${o&&o.id===e.id?"bg-blue-50":""}`,onClick:()=>B(e),children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:l=>{l.stopPropagation(),Y(e)},className:"text-blue-600 hover:text-blue-900",children:s.jsx(P,{})}),s.jsx("button",{onClick:l=>{l.stopPropagation(),Z(e)},className:"text-red-600 hover:text-red-900",children:s.jsx(T,{})})]})]}),s.jsxs("span",{className:"block text-xs text-gray-500",children:[e.skills_count||0," skills"]})]},e.id))}):s.jsx("p",{className:"text-center py-4 text-gray-500",children:"Select a domain to view subdomains"})})]}),s.jsxs("div",{className:"border rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Skills"}),s.jsxs("button",{onClick:()=>{o&&le()},disabled:!o,className:`inline-flex items-center px-3 py-1 bg-blue-600 border border-transparent rounded-md text-xs text-white uppercase tracking-widest ${o?"hover:bg-blue-700 active:bg-blue-900":"opacity-50 cursor-not-allowed"} focus:outline-none focus:border-blue-900 focus:ring ring-blue-300`,children:[s.jsx(_,{className:"mr-1"})," Add Skill"]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx($,{className:"text-gray-400"})}),s.jsx("input",{type:"text",value:d.skills,onChange:e=>C("skills",e.target.value),placeholder:"Search skills...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",disabled:!o})]})}),s.jsx("div",{className:"overflow-y-auto max-h-96",children:o?j.skills?s.jsx("p",{className:"text-center py-4",children:"Loading..."}):Q.length===0?s.jsx("p",{className:"text-center py-4 text-gray-500",children:"No skills found"}):s.jsx("ul",{className:"divide-y divide-gray-200",children:Q.map(e=>s.jsx("li",{className:"py-3 px-2 hover:bg-gray-50",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"block text-sm font-medium text-gray-900 truncate",children:e.name}),e.description&&s.jsx("span",{className:"block text-xs text-gray-500 mt-1",children:e.description}),s.jsxs("span",{className:"block text-xs text-gray-400 mt-1",children:[e.users_count||0," users"]})]}),s.jsxs("div",{className:"flex space-x-2 ml-2",children:[s.jsx("button",{onClick:()=>ae(e),className:"text-blue-600 hover:text-blue-900",children:s.jsx(P,{})}),s.jsx("button",{onClick:()=>te(e),className:"text-red-600 hover:text-red-900",children:s.jsx(T,{})})]})]})},e.id))}):s.jsx("p",{className:"text-center py-4 text-gray-500",children:"Select a subdomain to view skills"})})]})]}),s.jsx(ne,{isOpen:b.domainForm,onClose:U,domain:u,mode:S.domain}),s.jsx(ie,{isOpen:b.subdomainForm,onClose:ee,subdomain:x,domainId:t?t.id:null,selectedDomain:t,mode:S.subdomain}),s.jsx(de,{isOpen:b.skillForm,onClose:oe,skill:h,subdomainId:o?o.id:null,selectedSubdomain:o,mode:S.skill}),s.jsx(A,{isOpen:b.domainDelete,title:"Delete Skills Domain",message:`Are you sure you want to delete "${u==null?void 0:u.name}"? This action cannot be undone.`,onConfirm:W,onCancel:()=>a(e=>({...e,domainDelete:!1}))}),s.jsx(A,{isOpen:b.subdomainDelete,title:"Delete Skills Subdomain",message:`Are you sure you want to delete "${x==null?void 0:x.name}"? This action cannot be undone.`,onConfirm:se,onCancel:()=>a(e=>({...e,subdomainDelete:!1}))}),s.jsx(A,{isOpen:b.skillDelete,title:"Delete Skill",message:`Are you sure you want to delete "${h==null?void 0:h.name}"? This action cannot be undone.`,onConfirm:re,onCancel:()=>a(e=>({...e,skillDelete:!1}))})]})}export{ge as default};
