import{q as I,r as u,R as g,j as e,y as E}from"./app-C9aRItHR.js";import{O as U,S as P}from"./modalAnimations-CCENKliM.js";import{g as L,f as q,a as B}from"./supervisionHelpers-EJT0WNFw.js";import{T as F,a as V,b as h,c as v}from"./tabs-CFEHTnnM.js";import{B as n}from"./button-CSPEol7l.js";import{B as D}from"./badge-DncnOgy3.js";import{A as H,a as $}from"./avatar-CxvIrRZY.js";import{S as j}from"./scroll-area-BASTW5Mn.js";import{T as z}from"./ThreadPane-DwcafS7d.js";import J from"./ScheduleMeetingDialog-tNScvPE1.js";import X from"./UnifiedOverviewTab-DnnO0UKB.js";import Y from"./UnbindRequestModal-BdqK_7bW.js";import{R as G}from"./RelationshipHistoryTab-fmGdNK1b.js";import{T as K,a as Q,b as W,c as N}from"./tooltip-Bumx2StD.js";import{A as Z}from"./index-BXuOt4X-.js";import{m as w}from"./proxy-oGTuy5le.js";import{X as ee}from"./x-CwXSr9E4.js";import{C as se}from"./calendar-DOmFwYBu.js";import{V as te}from"./video-Oj1cMx8w.js";import{U as ae}from"./user-minus-DXCLUFtO.js";import{E as ie}from"./external-link-DzWtQSK0.js";import"./index-CrClJLlY.js";import"./index-CC4PcrzS.js";import"./index-CCAZcmHJ.js";import"./index-h1-N4bqM.js";import"./index-BqNwAq_Q.js";import"./index-COgthb8O.js";import"./index-D5McE1bZ.js";import"./index-eZvGyRKK.js";import"./index-DQC-i451.js";import"./utils-CBfrqCZ4.js";import"./index-CdJFUDDL.js";import"./index-BdQq_4o_.js";import"./Modal-Du6oGZ4g.js";import"./dialog-vzj-go99.js";import"./transition-BcdIoExo.js";import"./format-BOijCLBA.js";import"./en-US-DIdCsyf3.js";import"./file-text-Dda2OPaZ.js";import"./createLucideIcon-BKESxhZR.js";import"./download-DQFhyGLE.js";import"./index-XngfYQdO.js";import"./isSameDay-BHs4V-zU.js";import"./input-BRl5cfeF.js";import"./textarea-DFpeILRG.js";import"./label-BDDULwdX.js";import"./alert-CP91AL0h.js";import"./logError-BloCzXDJ.js";import"./useGoogleCalendar-BAd-iop4.js";import"./loader-circle-gYcNYlpl.js";import"./user-round-B6zt5dYE.js";import"./briefcase-Drgw6UyA.js";import"./mail-CFmvCR9a.js";import"./phone-DiFqFudg.js";import"./graduation-cap-CUV5l_Ya.js";import"./globe-OH7N1fpf.js";import"./calendar-clock-BwFdVJIm.js";import"./triangle-alert-CHajfL9r.js";import"./circle-alert-DnDjM5GH.js";import"./users-7wE4kwZt.js";import"./index-DFuKqaZl.js";import"./index-KT7cPyEo.js";import"./floating-ui.dom-D5EC_49c.js";import"./index-0pjh7AqE.js";import"./index-DJhbDaIo.js";function vs({relationship:s,onClose:l,onUpdated:d,isReadOnly:S=!1,defaultTab:c="overview"}){const{auth:C}=I().props,[T,f]=u.useState(c),[R,i]=u.useState(!1),[_,m]=u.useState(!1);g.useEffect(()=>{const t=O=>{O.detail?.relationship?.id===s?.id&&i(!0)};return window.addEventListener("open-schedule-meeting",t),()=>window.removeEventListener("open-schedule-meeting",t)},[s?.id]),g.useEffect(()=>{f(c)},[c]);const y=()=>{E.visit(route("supervision.relationships.show",s.id))};if(!s)return null;const r=s?.academician??{},p=r.full_name??"Supervisor",b=r.profile_picture?`/storage/${r.profile_picture}`:null,o=s.status??"active",a=s?.active_unbind_request||s?.activeUnbindRequest,x=a?"pending_unbind":o,M=!S&&o==="active"&&!a,k=L(p),A=x==="pending_unbind"?"Pending Unbind":q(x);return e.jsxs(e.Fragment,{children:[e.jsx(Z,{children:e.jsx(w.div,{...U,className:"fixed inset-0 z-40 flex items-center justify-end bg-black/50",onClick:l,children:e.jsxs(w.div,{...P,className:"w-full max-w-3xl h-full bg-white shadow-xl overflow-hidden flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx(H,{className:"h-12 w-12",children:b?e.jsx("img",{src:b,alt:p,className:"h-full w-full object-cover"}):e.jsx($,{className:"bg-indigo-100 text-indigo-700 text-sm font-semibold",children:k})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:p}),e.jsxs("p",{className:"text-sm text-slate-600",children:["Supervisor Â· ",s.role==="main"?"Main Supervisor":"Co-Supervisor"]}),e.jsx("div",{className:"mt-2",children:e.jsx(D,{className:`${B(x)} border`,children:A})})]})]}),e.jsx("button",{onClick:l,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(ee,{className:"h-5 w-5 text-slate-500"})})]})}),M&&e.jsxs("div",{className:"px-6 py-4 border-b bg-slate-50",children:[e.jsxs("div",{className:"flex gap-3 mb-3",children:[e.jsxs(n,{variant:"outline",className:"flex-1",onClick:()=>i(!0),children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Schedule Meeting"]}),e.jsxs(n,{className:"flex-1 bg-slate-900 hover:bg-slate-800",disabled:!s?.meetings||s.meetings.length===0||!s.meetings[0]?.location_link,onClick:()=>{const t=s?.meetings?.[0];t?.location_link&&window.open(t.location_link,"_blank","noopener,noreferrer")},children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Join Meeting"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(K,{children:e.jsxs(Q,{children:[e.jsx(W,{asChild:!0,children:e.jsx("div",{className:"flex-1",children:e.jsxs(n,{variant:"outline",className:"w-full border-red-300 text-red-700 hover:bg-red-50",onClick:()=>m(!0),disabled:a||o!=="active",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Remove Relationship"]})})}),a&&e.jsx(N,{children:e.jsx("p",{children:"Unbind request pending approval"})}),o!=="active"&&!a&&e.jsx(N,{children:e.jsx("p",{children:"Relationship is no longer active"})})]})}),e.jsxs(n,{variant:"outline",className:"flex-1",onClick:y,children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Show Full Page"]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(F,{value:T,onValueChange:f,className:"h-full flex flex-col",children:[e.jsxs(V,{className:"px-6 bg-gray-100 w-full justify-start rounded-none h-auto p-0 gap-0",children:[e.jsx(h,{value:"overview",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Overview"}),e.jsx(h,{value:"chat",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Chat"}),e.jsx(h,{value:"history",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"History"})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx(v,{value:"overview",className:"mt-0 h-full",children:e.jsx(j,{className:"h-full",children:e.jsx(X,{relationship:s,person:r,userRole:"student",activeUnbindRequest:a})})}),e.jsx(v,{value:"chat",className:"mt-0 h-full",children:s?.conversation_id?e.jsx("div",{className:"p-6 h-full",children:e.jsx("div",{className:"border border-slate-200 rounded-lg bg-white shadow-sm h-full overflow-hidden",children:e.jsx(z,{conversationId:s.conversation_id,auth:C,onConversationRead:()=>{},onConversationIncrementUnread:()=>{},onAfterSend:()=>d?.()})})}):e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:e.jsx("p",{className:"text-sm text-slate-500",children:"No conversation available yet."})})})}),e.jsx(v,{value:"history",className:"mt-0 h-full",children:e.jsx(j,{className:"h-full",children:e.jsx(G,{relationship:s})})})]})]})})]})})}),e.jsx(J,{relationship:R?s:null,onClose:()=>i(!1),onScheduled:()=>{i(!1),d?.()},userRole:"student"}),e.jsx(Y,{isOpen:_,relationship:s,onClose:()=>m(!1),onUnbindInitiated:()=>{m(!1),d?.(),l?.()},userRole:"student"})]})}export{vs as default};
