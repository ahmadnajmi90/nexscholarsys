import{r as i,j as e,b as V,a as W,Y as J}from"./app-DZMAG1Os.js";import{M as K}from"./MainLayout-pswa0FAN.js";import{F as Q}from"./FilterDropdown-DcC9oa05.js";import{a as Y,e as X,f as Z,g as ee,h as se,i as te,j as ae,k as re,F as ie,c as le}from"./index-CjVDtbtg.js";import"./index-Dpgo5ZGF.js";import{G as ne}from"./GuidedSearchInterface-2tnsy3dG.js";import{R as ce}from"./RecommendationModal-FoO6RnP1.js";import{R as oe}from"./RecommendationDisplay-Bv9pLX-I.js";import{B as de}from"./BookmarkButton-CxpEWLil.js";import{M as me}from"./MatchIndicator-CA6O65_K.js";import{u as he}from"./useRoles-XsbMiLit.js";import"./analytics-B60H_cQS.js";import"./react-select.esm-DD5_CwH9.js";const xe=({profile:s,universitiesList:N,faculties:B,users:L,researchOptions:v,aiInsights:w,searchQuery:_})=>{var E,F,O;const[S,d]=i.useState(!1),[k,x]=i.useState(!1),[r,u]=i.useState(null),[g,a]=i.useState(!1),[n,p]=i.useState(w),[j,$]=i.useState(!1),[A,z]=i.useState(!1),D=()=>{x(!0),W.get(route("academicians.quick-info",s.academician_id)).then(t=>{t.data&&t.data.academician?(u({...s,...t.data.academician,projects_count:t.data.projects_count||0,grants_count:t.data.grants_count||0,publications_count:t.data.publications_count||0}),d(!0),_&&M()):(u(s),d(!0)),x(!1)}).catch(t=>{console.error("Error fetching academician detail:",t),u(s),d(!0),x(!1)})},M=()=>{$(!0),W.post(route("supervisor.insights"),{academician_id:s.academician_id,query:_}).then(t=>{t.data&&t.data.insight&&p(t.data.insight),$(!1)}).catch(t=>{console.error("Error fetching detailed insights:",t),$(!1)})},T=t=>{t.preventDefault(),a(!0)},I=()=>{a(!1)},G=()=>(r==null?void 0:r.grants_count)||0,U=()=>(r==null?void 0:r.projects_count)||0,q=()=>(r==null?void 0:r.publications_count)||0;return console.log("Supervisor Profile Data:",s),e.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-2 left-2 bg-blue-500 text-white text-[10px] font-semibold px-2.5 py-0.5 rounded-full",children:((E=N.find(t=>t.id===s.university))==null?void 0:E.short_name)||"Unknown University"}),s.match_score&&e.jsx("div",{className:"absolute top-2 right-2 z-10",children:e.jsxs("div",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-bold",children:[Math.round(s.match_score*100),"% Match"]})}),e.jsx("div",{className:"h-32",children:e.jsx("img",{src:s.background_image!==null?`/storage/${s.background_image}`:"/storage/profile_background_images/default.jpg",alt:"Banner",className:"object-cover w-full h-full"})}),e.jsx("div",{className:"flex justify-center -mt-12",children:e.jsxs("div",{className:"relative w-24 h-24",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden border-4 border-white shadow-lg",children:e.jsx("img",{src:s.profile_picture!==null?`/storage/${s.profile_picture}`:"/storage/profile_pictures/default.jpg",alt:"Profile",className:"w-full h-full object-cover"})}),s.verified===1&&e.jsxs("div",{className:"absolute bottom-1 right-1 bg-white p-1 rounded-full group cursor-pointer shadow-md",children:[e.jsx("div",{className:"flex items-center justify-center w-7 h-7 bg-blue-500 rounded-full",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"absolute bottom-8 right-0 hidden group-hover:block bg-gray-800 text-white text-xs rounded px-3 py-2 shadow-lg z-10 w-48",children:["This account is verified by ",((F=N.find(t=>t.id===s.university))==null?void 0:F.full_name)||"Unknown University"]})]})]})}),e.jsxs("div",{className:"text-center mt-4",children:[e.jsx("h2",{className:"text-lg font-semibold truncate px-6",children:s.full_name}),e.jsx("p",{className:"text-gray-500 text-sm px-6",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",minHeight:"2.5rem"},children:Array.isArray(s.research_expertise)&&s.research_expertise.length>0?(()=>{const t=s.research_expertise[0],m=v.find(b=>`${b.field_of_research_id}-${b.research_area_id}-${b.niche_domain_id}`===t);return m?`${m.field_of_research_name} - ${m.research_area_name} - ${m.niche_domain_name}`:"Unknown"})():"No Field of Research or Expertise"}),e.jsx("p",{className:"text-gray-500 text-sm",children:s.current_position?s.current_position:"No Position"}),s.match_score&&e.jsx("div",{className:"mt-3 px-4",children:e.jsx(me,{score:s.match_score,showDetails:!1})}),w&&e.jsxs("div",{className:"mt-3 px-4 py-2 bg-blue-50 mx-4 rounded-md",children:[e.jsxs("div",{className:"flex items-center mb-1 justify-between",children:[e.jsxs("span",{className:"text-xs font-semibold text-blue-700 flex items-center",children:[e.jsx(Y,{className:"text-yellow-500 mr-2"}),"AI Match Insights"]}),e.jsx("button",{onClick:()=>z(!A),className:"text-blue-600 text-xs hover:underline",children:A?"Show less":"Show more"})]}),e.jsx("p",{className:`text-xs text-gray-700 text-left ${A?"h-auto":"h-16 overflow-y-auto"} pr-1`,children:w})]}),e.jsxs("div",{className:"mt-4 flex justify-center gap-2",children:[e.jsx("button",{onClick:D,className:"bg-blue-500 text-white text-[10px] px-2 font-semibold py-1 rounded-full hover:bg-blue-600",children:"Quick Info"}),e.jsx(V,{href:route("academicians.show",s.url),className:"bg-green-500 text-white text-[10px] px-2 font-semibold py-1 rounded-full hover:bg-green-600",children:"Full Profile"})]})]}),e.jsxs("div",{className:"flex justify-around items-center mt-6 py-4 border-t px-10",children:[e.jsx("a",{href:"#",className:"text-gray-500 text-lg cursor-pointer hover:text-blue-700",title:"Add Friend",children:e.jsx(X,{className:"text-lg"})}),e.jsx(V,{href:route("email.compose",{to:(O=L.find(t=>t.unique_id===s.academician_id))==null?void 0:O.email}),className:"text-gray-500 text-lg cursor-pointer hover:text-blue-700",title:"Send Email",children:e.jsx(Z,{className:"text-lg"})}),e.jsx("a",{href:"#",onClick:t=>T(s),className:"text-gray-500 text-lg hover:text-yellow-500",title:"Recommend",children:e.jsx(ee,{className:"text-lg"})}),e.jsx(de,{bookmarkableType:"academician",bookmarkableId:s.id,category:"Academicians",iconSize:"text-lg",tooltipPosition:"top"})]}),S&&r&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>d(!1),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-11/12 max-w-lg relative max-h-[80vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[k?e.jsxs("div",{className:"flex flex-col items-center justify-center py-10",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-500 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e.jsx("p",{className:"text-gray-600",children:"Loading academician information..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-xl font-bold mb-4 text-gray-800 ",children:r.full_name}),e.jsx("hr",{className:"border-t border-gray-800 mb-4"}),_&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("h4",{className:"text-lg font-semibold text-blue-800 mb-2 flex items-center",children:[e.jsx(Y,{className:"text-yellow-500 mr-2"}),"AI Match Insights"]}),j?e.jsxs("div",{className:"flex items-center justify-center p-4",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e.jsx("p",{className:"text-gray-600",children:"Generating detailed insights..."})]}):e.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:n})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Short Bio"}),e.jsx("p",{className:"text-gray-600 whitespace-pre-line",children:r.bio||"Not Provided"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Research Expertise"}),e.jsx("div",{className:"",children:(()=>{let t=r.research_expertise||[];return Array.isArray(t)&&t.length>0?e.jsx("div",{className:"space-y-2",children:t.map((m,b)=>{const R=v.find(C=>`${C.field_of_research_id}-${C.research_area_id}-${C.niche_domain_id}`===m);return R?e.jsxs("p",{className:"text-gray-600",children:[b+1,". ",R.field_of_research_name," - ",R.research_area_name," - ",R.niche_domain_name]},b):null})}):e.jsx("p",{className:"text-gray-600",children:"Not Provided"})})()})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Style of Supervision"}),e.jsx("div",{className:"space-y-2",children:Array.isArray(r.style_of_supervision)&&r.style_of_supervision.length>0?e.jsx("div",{className:"mt-2 text-normal text-gray-600",children:r.style_of_supervision.map((t,m)=>e.jsxs("div",{className:"mb-2",children:[e.jsxs("span",{className:"font-medium",children:[m+1,". ",t]}),e.jsxs("div",{className:"ml-4 text-sm",children:[t==="Directive Supervision"&&"Structured approach with active guidance and regular monitoring",t==="Facilitative Supervision"&&"Supportive approach encouraging student independence",t==="Coaching Supervision"&&"Focuses on personal development and academic growth",t==="Adaptive Supervision"&&"Flexible support based on student's changing needs",t==="Participatory Supervision"&&"Collaborative approach with shared decision-making"]})]},m))}):e.jsx("p",{className:"text-gray-600",children:"Not Specified"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Supervised Student"}),e.jsx("p",{className:"text-gray-600",children:r.supervised_students_count||"Not Provided"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Available Grant and Project"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("p",{className:"text-gray-600",children:[G()+U()," Projects/Grants"]}),e.jsxs(V,{href:route("academicians.projects",r.url),className:"mt-2 self-start text-xs px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition duration-200 flex items-center",children:[e.jsx("span",{children:"View Projects"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Total Publication"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("p",{className:"text-gray-600",children:[q()," Publications"]}),e.jsxs(V,{href:route("academicians.publications",r.url),className:"mt-2 self-start text-xs px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition duration-200 flex items-center",children:[e.jsx("span",{children:"View Publications"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Recommendation by Others"}),e.jsx(oe,{academicianId:r.academician_id})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Connect via"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("a",{href:r.google_scholar,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 text-lg hover:text-red-700",title:"Google Scholar",children:e.jsx(se,{})}),r.personal_website&&e.jsx("a",{href:r.personal_website,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 text-lg hover:text-green-700",title:"Personal Website",children:e.jsx(te,{})}),r.institution_website&&e.jsx("a",{href:r.institution_website,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 text-lg hover:text-blue-700",title:"Institutional Website",children:e.jsx(ae,{})}),e.jsx("a",{href:r.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 text-lg hover:text-blue-800",title:"LinkedIn",children:e.jsx(re,{})})]})]})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>d(!1),className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition duration-200",children:"Close"})})]})}),g&&e.jsx(ce,{academician:s,onClose:()=>a(!1),onSuccess:I})]})},ue=({searchResults:s,universitiesList:N,faculties:B,users:L,researchOptions:v,searchQuery:w,isSearching:_,isLoadingMore:S=!1,onLoadMore:d=()=>{}})=>{const[k,x]=i.useState([]),[r,u]=i.useState(!1),g=i.useRef(null);i.useEffect(()=>{if(s&&s.matches){x([]);const n=s.matches.slice(0,6);if(x(n),s.matches.slice(6).length>0){const j=setTimeout(()=>{x(s.matches)},300);return()=>clearTimeout(j)}}},[s]),i.useEffect(()=>{const n=new IntersectionObserver(([p])=>{u(p.isIntersecting)},{threshold:.1});return g.current&&n.observe(g.current),()=>{g.current&&n.unobserve(g.current)}},[g]),i.useEffect(()=>{r&&!S&&s&&s.has_more&&k.length>0&&d()},[r,S,s,d]);const a=n=>Array(n).fill(null).map((p,j)=>e.jsx(ge,{},`skeleton-${j}`));return _&&(!s||!s.matches)?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6",children:a(6)}):s&&s.matches?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:['Supervisor Matches for "',s.query,'"']}),e.jsxs("span",{className:"text-gray-500",children:[s.total," match",s.total!==1?"es":""," found"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6",children:[k.map((n,p)=>e.jsx(xe,{profile:{...n.academician,ai_insight:n.ai_insights,research_expertise:Array.isArray(n.academician.research_expertise)?n.academician.research_expertise:[],availability_as_supervisor:n.academician.availability_as_supervisor||0,match_score:n.score},universitiesList:N,faculties:B,users:L,researchOptions:v,aiInsights:n.ai_insights,searchQuery:w},`${n.academician.id}-${p}`)),k.length<s.matches.length&&a(Math.min(3,s.matches.length-k.length))]}),s.has_more&&e.jsx("div",{ref:g,className:"mt-8 text-center py-4",children:S?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Loading more results..."]}):e.jsx("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md",onClick:d,children:"Load more results"})}),s.total===0&&e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(ie,{className:"text-gray-400 text-5xl mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-gray-700 mb-2",children:"No matching supervisors found"}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"Try broadening your search terms or exploring different research areas."})]})]}):null},ge=()=>e.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden relative animate-pulse",children:[e.jsx("div",{className:"h-32 bg-gray-200"}),e.jsx("div",{className:"flex justify-center -mt-12",children:e.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-300 border-4 border-white"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4 mx-auto mb-3"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6 mx-auto mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/6 mx-auto mb-4"}),e.jsxs("div",{className:"mt-3 bg-gray-100 p-3 rounded-md",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full mb-1"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6 mb-1"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"})]}),e.jsxs("div",{className:"mt-4 flex justify-center gap-2",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-24"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-24"})]})]}),e.jsxs("div",{className:"mt-4 border-t border-gray-100 p-4 flex justify-around",children:[e.jsx("div",{className:"h-6 w-6 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-6 w-6 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-6 w-6 bg-gray-200 rounded-full"})]})]});function Pe({auth:s,universities:N,faculties:B,users:L,researchOptions:v}){const{isAdmin:w,isPostgraduate:_,isUndergraduate:S,isFacultyAdmin:d,isAcademician:k}=he(),[x,r]=i.useState(""),[u,g]=i.useState(!1),[a,n]=i.useState(null),[p,j]=i.useState(null),[$,A]=i.useState(1),[z,D]=i.useState(!1),[M,T]=i.useState([]),[I,G]=i.useState([]),[U,q]=i.useState(""),[E,F]=i.useState(!1),O=async o=>{if(!(u||!o||o.trim()==="")){r(o),g(!0),j(null),A(1);try{const l=await W.post(route("supervisor.search"),{query:o});if(l.data&&l.data.matches){console.log("Search results:",l.data);const y={...l.data,matches:l.data.matches.map(P=>({...P,score:P.score||.5}))};n(y)}else j("Received invalid search results")}catch(l){console.error("Search error:",l),j("Failed to perform search. Please try again later.")}finally{g(!1)}}},t=async()=>{if(z||!a||!a.has_more)return;D(!0);const o=$+1;try{const l=await W.post(route("supervisor.search"),{query:x,page:o});l.data&&l.data.matches&&(n(y=>({...l.data,matches:[...y.matches,...l.data.matches]})),A(o))}catch(l){console.error("Error loading more results:",l)}finally{D(!1)}},m=()=>!a||!a.matches?[]:a.matches.filter(o=>{const l=o.academician,y=M.length===0||Array.isArray(l.research_expertise)&&l.research_expertise.some(f=>M.includes(f)),P=l.university?l.university.toString():"",c=I.length===0||I.includes(P);let h=!0;if(U!==""){const f=l.availability_as_supervisor;h=(f===!0||f==="1"||f===1?"1":"0")===U}return y&&c&&h}),b=()=>!w&&!d||!a?null:e.jsx("div",{className:"mt-2 p-2 text-xs bg-gray-100 dark:bg-gray-800 rounded",children:e.jsxs("details",{children:[e.jsx("summary",{className:"cursor-pointer",children:"Search Debug Info"}),e.jsxs("div",{className:"mt-1 space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Search Method:"})," ",a.search_method==="qdrant"?"Qdrant Vector DB":"MySQL"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Total Results:"})," ",a.total]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Profile Used:"})," ",a.profile_used?"Yes":"No"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Page:"})," ",a.current_page," of ",Math.ceil(a.total/a.per_page)]}),e.jsxs("div",{className:"text-xs mt-2",children:[e.jsx("a",{href:`${window.location.pathname}?${new URLSearchParams({...Object.fromEntries(new URLSearchParams(window.location.search)),nocache:"true"})}`,className:"text-blue-500 hover:text-blue-700",children:"Clear Cache"})," | ",e.jsx("a",{href:`${window.location.pathname}?${new URLSearchParams({...Object.fromEntries(new URLSearchParams(window.location.search)),use_qdrant:"true"})}`,className:"text-blue-500 hover:text-blue-700",children:"Force Qdrant"})," | ",e.jsx("a",{href:`${window.location.pathname}?${new URLSearchParams({...Object.fromEntries(new URLSearchParams(window.location.search)),use_qdrant:"false"})}`,className:"text-blue-500 hover:text-blue-700",children:"Force MySQL"})]})]})]})}),C=(()=>{if(!a||!a.matches)return{researchAreas:[],universities:[]};const o=new Set;a.matches.forEach(c=>{Array.isArray(c.academician.research_expertise)&&c.academician.research_expertise.forEach(h=>{o.add(h)})});const l=Array.from(o).map(c=>{const h=v.find(f=>`${f.field_of_research_id}-${f.research_area_id}-${f.niche_domain_id}`===c);return h?{value:c,label:`${h.field_of_research_name} - ${h.research_area_name} - ${h.niche_domain_name}`}:{value:c,label:`${c}`}}),y=new Set;a.matches.forEach(c=>{c.academician.university&&y.add(c.academician.university.toString())});const P=Array.from(y).map(c=>{const h=N.find(f=>f.id.toString()===c);return{value:c,label:h?h.short_name:"Unknown University"}});return{researchAreas:l,universities:P}})(),H=a?{...a,matches:m(),total:m().length}:null;return e.jsxs(K,{title:"Find a Supervisor",isPostgraduate:_,isUndergraduate:S,isFacultyAdmin:d,children:[e.jsxs(J,{children:[e.jsx("title",{children:"Find a Supervisor - Nexscholar"}),e.jsx("meta",{name:"description",content:"Search for academic supervisors based on your research interests"})]}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg",children:e.jsxs("div",{className:"p-6 pb-16",children:[e.jsx(ne,{onSearch:O,researchOptions:v,isSearching:u,initialQuery:x}),a&&a.total>0&&e.jsx("button",{onClick:()=>F(!E),className:"fixed bottom-8 right-4 z-50 bg-blue-600 text-white p-3 rounded-full shadow-lg lg:hidden",children:e.jsx(le,{className:"text-xl"})}),(a||u)&&e.jsxs("div",{className:"mt-10 flex flex-col lg:flex-row gap-6",children:[a&&a.total>0&&e.jsxs("div",{className:`lg:block lg:w-1/4 bg-gray-50 p-4 rounded-lg shadow-sm ${E?"block fixed inset-0 z-50 bg-white overflow-auto p-6":"hidden"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Refine Results"}),e.jsx("button",{onClick:()=>F(!1),className:"text-gray-500 hover:text-gray-700 lg:hidden",children:"âœ•"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Q,{label:"Field of Research",options:C.researchAreas,selectedValues:M,setSelectedValues:T}),e.jsx(Q,{label:"University",options:C.universities,selectedValues:I,setSelectedValues:G}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mt-4 mb-2",children:"Available As Supervisor"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded",value:U,onChange:o=>q(o.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"1",children:"Yes"}),e.jsx("option",{value:"0",children:"No"})]})]}),e.jsx("div",{className:"pt-4 lg:hidden",children:e.jsx("button",{onClick:()=>F(!1),className:"w-full bg-blue-600 text-white py-2 rounded-lg",children:"Apply Filters"})})]})]}),e.jsx("div",{className:`${a&&a.total>0?"lg:w-3/4":"w-full"}`,children:e.jsx(ue,{searchResults:H||a,universitiesList:N,faculties:B,users:L,researchOptions:v,searchQuery:x,isSearching:u,isLoadingMore:z,onLoadMore:t})})]}),p&&!u&&e.jsx("div",{className:"mt-6 bg-red-50 border-l-4 border-red-500 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:p})})]})}),b()]})})]})}export{Pe as default};
