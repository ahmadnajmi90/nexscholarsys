import{q as I,r as j,R as T,j as e,y as P}from"./app-A8xQkvSk.js";import{T as B,a as H,b as d,c as n}from"./tabs-Cbyzn-fX.js";import{B as v}from"./button-Dz_rydmG.js";import{B as L}from"./badge-CFoP9Krf.js";import{A as F,a as V}from"./avatar-CbIr_OjG.js";import{S as R}from"./scroll-area-COMlVIOb.js";import $ from"./ResearchTab-B4EYMRFM.js";import z from"./DocumentsTab-B11iV4A2.js";import{T as J}from"./ThreadPane-CPpSuURI.js";import X from"./ScheduleMeetingDialog-C9eLZHwe.js";import G from"./StudentOverviewTab-B7N66E49.js";import{U as K,a as Q}from"./UnbindRequestModal-2eYhJEIj.js";import{T as W,a as Y,b as Z,c as _}from"./tooltip-Oo0Wz_lE.js";import{X as U}from"./x-vL7g-LuD.js";import{C as ee}from"./calendar-EpaZ4Aad.js";import{V as te}from"./video-DL3IJgDp.js";import{E as se}from"./external-link-RAq8nM7x.js";import{f as ae}from"./format-hTuirObu.js";import"./index-BEzQHz4a.js";import"./index-7Qlnuq3l.js";import"./index-CG1gsK_f.js";import"./index-DwuY8lh1.js";import"./index-OrEFxIKi.js";import"./index-DMPy21CI.js";import"./index-B0SlzLk6.js";import"./utils-CIsb_jhR.js";import"./clsx-B-dksMZM.js";import"./index-Dp3B9jqt.js";import"./index-Km-vM6Jb.js";import"./input-D2p8biwd.js";import"./textarea-DGdKxzUN.js";import"./separator-B59s4oDI.js";import"./logError-D4ezqrCx.js";import"./loader-circle-DkpR38mE.js";import"./createLucideIcon-DPzobtnR.js";import"./plus-BqbQZKPX.js";import"./trash-2-XEAf-v5f.js";import"./circle-check-ddCD_g9w.js";import"./circle-eov79Dsa.js";import"./select-BBDf1Ygo.js";import"./index-BlKfbGK4.js";import"./Combination-Bf5eV4ml.js";import"./tslib.es6-CmEaCU22.js";import"./index-Cp2nhW7C.js";import"./floating-ui.dom-eiE65J5j.js";import"./index-Db3xrL5F.js";import"./index-rTP0VXgG.js";import"./chevron-down-qnEAqpL2.js";import"./chevron-up-hxgrcUwj.js";import"./check-BeDd_wJ7.js";import"./Modal-D_n_zj3N.js";import"./dialog-BkDQGxoj.js";import"./transition-Bvb6H6Z4.js";import"./DocumentPreviewModal-CPJtZlTY.js";import"./file-text-BfC4OSQU.js";import"./download-CMnE0euH.js";import"./upload-DLfp_NaM.js";import"./chevron-right-Mpml_Nmb.js";import"./folder-open-Bj-Qb-PO.js";import"./eye-B05lsJ9f.js";import"./history-BxBz3cCN.js";import"./AttachmentPreviewModal-CXErbNPv.js";import"./en-US-DNUEYIb-.js";import"./label-BcrT7TVM.js";import"./alert-BBFXwXFc.js";import"./user-round-CEZUuFcg.js";import"./briefcase-CfUq1pnR.js";import"./mail-Dtimj1fp.js";import"./phone-D1xIudn-.js";import"./graduation-cap-the7C-yQ.js";import"./calendar-clock-BwBj7N73.js";import"./triangle-alert-BND9SWEh.js";function yt({relationship:t,onClose:r,onUpdated:a,isReadOnly:i=!1,defaultTab:c="overview"}){var w;const{auth:C}=I().props,[k,h]=j.useState(c),[M,m]=j.useState(!1),[O,b]=j.useState(!1);T.useEffect(()=>{const s=x=>{var y,S;((S=(y=x.detail)==null?void 0:y.relationship)==null?void 0:S.id)===(t==null?void 0:t.id)&&m(!0)};return window.addEventListener("open-schedule-meeting",s),()=>window.removeEventListener("open-schedule-meeting",s)},[t==null?void 0:t.id]),T.useEffect(()=>{h(c)},[c]);const A=()=>{P.visit(route("supervision.relationships.show",t.id))};if(!t)return null;const o=(t==null?void 0:t.academician)??{},f=o.full_name??"Supervisor",N=o.profile_picture?`/storage/${o.profile_picture}`:null,u=t.status??"active",l=(t==null?void 0:t.active_unbind_request)||(t==null?void 0:t.activeUnbindRequest),p=l?"pending_unbind":u,g=!i&&u==="active"&&!l,E=f.split(" ").map(s=>s[0]).join("").toUpperCase().slice(0,3),q=p==="pending_unbind"?"Pending Unbind":p.split("_").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" "),D=s=>{switch(s){case"active":return"bg-emerald-50 text-emerald-700 border-emerald-200";case"pending_unbind":return"bg-amber-50 text-amber-700 border-amber-200";case"completed":return"bg-blue-50 text-blue-700 border-blue-200";case"terminated":return"bg-red-50 text-red-700 border-red-200";default:return"bg-slate-50 text-slate-700 border-slate-200"}};return e.jsxs("div",{className:"fixed inset-0 z-40 flex items-center justify-end bg-black/50",onClick:r,children:[e.jsxs("div",{className:"w-full max-w-3xl h-full bg-white shadow-xl overflow-hidden flex flex-col animate-slide-in-right",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx(F,{className:"h-12 w-12",children:N?e.jsx("img",{src:N,alt:f,className:"h-full w-full object-cover"}):e.jsx(V,{className:"bg-indigo-100 text-indigo-700 text-sm font-semibold",children:E})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:f}),e.jsxs("p",{className:"text-sm text-slate-600",children:["Supervisor Â· ",t.role==="main"?"Main Supervisor":"Co-Supervisor"]}),e.jsx("div",{className:"mt-2",children:e.jsx(L,{className:`${D(p)} border`,children:q})})]})]}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(U,{className:"h-5 w-5 text-slate-500"})})]})}),g&&e.jsxs("div",{className:"px-6 py-4 border-b bg-slate-50",children:[e.jsxs("div",{className:"flex gap-3 mb-3",children:[e.jsxs(v,{variant:"outline",className:"flex-1",onClick:()=>m(!0),children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Schedule Meeting"]}),e.jsxs(v,{className:"flex-1 bg-slate-900 hover:bg-slate-800",disabled:!(t!=null&&t.meetings)||t.meetings.length===0||!((w=t.meetings[0])!=null&&w.location_link),onClick:()=>{var x;const s=(x=t==null?void 0:t.meetings)==null?void 0:x[0];s!=null&&s.location_link&&window.open(s.location_link,"_blank","noopener,noreferrer")},children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Join Meeting"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(W,{children:e.jsxs(Y,{children:[e.jsx(Z,{asChild:!0,children:e.jsx("div",{className:"flex-1",children:e.jsxs(v,{variant:"outline",className:"w-full border-red-300 text-red-700 hover:bg-red-50",onClick:()=>b(!0),disabled:l||u!=="active",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Remove Relationship"]})})}),l&&e.jsx(_,{children:e.jsx("p",{children:"Unbind request pending approval"})}),u!=="active"&&!l&&e.jsx(_,{children:e.jsx("p",{children:"Relationship is no longer active"})})]})}),e.jsxs(v,{variant:"outline",className:"flex-1",onClick:A,children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Show Full Page"]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs(B,{value:k,onValueChange:h,className:"h-full flex flex-col",children:[e.jsxs(H,{className:"px-6 bg-gray-100 w-full justify-start rounded-none h-auto p-0 gap-0",children:[e.jsx(d,{value:"overview",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Overview"}),e.jsx(d,{value:"research",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Research"}),e.jsx(d,{value:"documents",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Documents"}),e.jsx(d,{value:"chat",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"Chat"}),e.jsx(d,{value:"history",className:"data-[state=active]:bg-white data-[state=active]:border-b-2 data-[state=active]:border-indigo-600 data-[state=inactive]:bg-transparent rounded-none px-6 py-3",children:"History"})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx(n,{value:"overview",className:"mt-0 h-full",children:e.jsx(R,{className:"h-full",children:e.jsx(G,{relationship:t,academician:o,activeUnbindRequest:l})})}),e.jsx(n,{value:"research",className:"mt-0 h-full",children:e.jsx($,{relationship:t,onUpdated:a,isReadOnly:!g})}),e.jsx(n,{value:"documents",className:"mt-0 h-full",children:e.jsx(z,{relationship:t,onUpdated:a,isReadOnly:!g})}),e.jsx(n,{value:"chat",className:"mt-0 h-full",children:t!=null&&t.conversation_id?e.jsx("div",{className:"p-6 h-full",children:e.jsx("div",{className:"border border-slate-200 rounded-lg bg-white shadow-sm h-full overflow-hidden",children:e.jsx(J,{conversationId:t.conversation_id,auth:C,onConversationRead:()=>{},onConversationIncrementUnread:()=>{},onAfterSend:()=>a==null?void 0:a()})})}):e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"border border-slate-200 rounded-lg p-6 bg-white shadow-sm",children:e.jsx("p",{className:"text-sm text-slate-500",children:"No conversation available yet."})})})}),e.jsx(n,{value:"history",className:"mt-0 h-full",children:e.jsx(R,{className:"h-full",children:e.jsx(re,{relationship:t})})})]})]})})]}),e.jsx(X,{relationship:M?t:null,onClose:()=>m(!1),onScheduled:()=>{m(!1),a==null||a()},userRole:"student"}),e.jsx(Q,{isOpen:O,relationship:t,onClose:()=>b(!1),onUnbindInitiated:()=>{b(!1),a==null||a(),r==null||r()},userRole:"student"})]})}function re({relationship:t}){const r=[{id:1,title:"Relationship Started",date:t==null?void 0:t.accepted_at,status:"completed"},{id:2,title:"Active Supervision",date:t==null?void 0:t.accepted_at,status:(t==null?void 0:t.status)==="active"?"current":"completed"}];t!=null&&t.terminated_at&&r.push({id:3,title:"Relationship Terminated",date:t.terminated_at,status:"completed"});const a=i=>{switch(i){case"completed":return"bg-green-500";case"current":return"bg-blue-500";case"pending":return"bg-slate-300";default:return"bg-slate-300"}};return e.jsx("div",{className:"p-6",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Timeline"}),e.jsx("div",{className:"space-y-4",children:r.map((i,c)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${a(i.status)}`}),c<r.length-1&&e.jsx("div",{className:"w-0.5 h-full bg-slate-200 mt-2"})]}),e.jsxs("div",{className:"flex-1 pb-8",children:[e.jsx("h4",{className:"font-medium text-slate-900",children:i.title}),e.jsx("p",{className:"text-sm text-slate-500",children:i.date?ae(new Date(i.date),"dd/MM/yyyy HH:mm"):"TBD"})]})]},i.id))})]})})}export{yt as default};
