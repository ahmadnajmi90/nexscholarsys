import{r as p,W as R,j as e,Y as O,a as b,y as j}from"./app-BrPd_5NA.js";import{T as f}from"./TextInput-Gy7QpgdE.js";import{P as w}from"./PrimaryButton-DgeCsnCZ.js";import{G as _}from"./GuestLayout-DpXzO9LG.js";import{I as d,a as g}from"./InputError-DzUmfPi-.js";import{A as T}from"./ApplicationLogo-lwsXQdzA.js";import"./index-BBpOhVGp.js";function q({userRole:N,showAllOptions:C}){const[x,h]=p.useState(null),[a,o]=p.useState(!1),[k,s]=p.useState(""),[i,S]=p.useState(null),v=p.useRef(null),{data:r,setData:u,errors:m}=R({personalWebsite:"",institutionalWebsite:"",linkedinProfile:"",googleScholarProfile:"",researchgateProfile:""}),F=()=>Object.values(r).some(t=>t&&t.trim()!==""),P=t=>{h(t),s("")},W=t=>{const l=t.target.files[0];l&&(S(l),s(""))},I=async()=>{o(!0),s("");try{const t=await b.post(route("ai.generate.automatic"));if(t.data.status==="success"&&t.data.generation_initiated)j.visit(route("role.edit"),{preserveState:!1,onSuccess:()=>{o(!1)}});else throw new Error("Generation could not be initiated")}catch(t){s(t.response?.data?.error||"An error occurred during AI profile generation"),o(!1)}},U=async t=>{if(t.preventDefault(),!F()){s("Please provide at least one URL to continue");return}o(!0),s("");try{const l={personalWebsite:r.personalWebsite,institutionalWebsite:r.institutionalWebsite,linkedinProfile:r.linkedinProfile,scholarProfile:r.googleScholarProfile,researchgateProfile:r.researchgateProfile},y=await b.post(route("ai.urls.save"),l);if(y.data.status==="success"&&y.data.generation_initiated)j.visit(route("role.edit"),{preserveState:!1,onSuccess:()=>{o(!1)}});else throw new Error("Generation could not be initiated")}catch(l){s(l.response?.data?.error||"An error occurred while saving URLs"),o(!1)}},A=async t=>{if(t.preventDefault(),!i){s("Please upload a CV file to continue");return}const l=10*1024*1024,y=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","image/jpeg","image/png","image/tiff"];if(i.size>l){s("File size exceeds 10MB limit. Please upload a smaller file.");return}if(!y.includes(i.type)){s("File type not supported. Please upload PDF, DOC, DOCX, JPEG, PNG, or TIFF files.");return}o(!0),s("");try{const n=new FormData;n.append("CV_file",i),console.log("Uploading CV file to profile via role.updateCV route");const G=await b.post(route("role.updateCV"),n,{headers:{"Content-Type":"multipart/form-data"}});if(!G.data.success)throw new Error("Failed to upload CV to profile: "+(G.data.error||"Unknown error"));console.log("CV upload successful, now initiating profile generation");const V=new FormData;V.append("CV_file",i),console.log("Sending CV for processing via ai.generate.cv route");const c=await b.post(route("ai.generate.cv"),V,{headers:{"Content-Type":"multipart/form-data"}});if(console.log("CV processing response:",c.data),c.data.status==="success"||typeof c.data=="object"&&c.data.full_name||c.data.generation_initiated)console.log("CV processing successful, navigating to profile edit page"),j.visit(route("role.edit",{generation_initiated:!0}),{preserveState:!1,onSuccess:()=>{o(!1)}});else throw console.error("CV generation response format unexpected:",c.data),new Error("Generation could not be initiated: Invalid response format")}catch(n){console.error("CV processing error:",n),s(n.response?.data?.error||n.message||"An error occurred while processing your CV"),o(!1)}},D=()=>{j.visit(route("role.edit"))},L=C,E=C;return e.jsxs(_,{children:[e.jsx(O,{title:"AI Profile Generation"}),e.jsxs("div",{className:"w-full max-w-2xl mx-auto mt-2 p-4 sm:p-6 lg:p-8",children:[e.jsx(T,{}),e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-xl overflow-hidden mx-2 sm:mx-0 p-6 md:p-8 lg:p-8 mt-6",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mb-4 md:mb-2 text-left md:text-center lg:text-center",children:["Generate Your ",N==="academician"?"Academic":N==="postgraduate"?"Postgraduate":"Undergraduate"," Profile"]}),k&&e.jsx("div",{className:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded text-center",children:k}),x?x==="automatic"?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-600 mb-6",children:"We'll search the web for your academic information and generate a profile for you. This may take a moment."}),e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsx("button",{onClick:()=>h(null),className:"text-sm text-gray-600 hover:text-gray-900 underline",disabled:a,children:"Back"}),e.jsx(w,{onClick:I,disabled:a,className:"ml-4",children:a?"Processing...":"Generate Profile"})]})]}):x==="url"?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-gray-600 mb-6",children:[e.jsx("strong",{children:"URL Search is generally more reliable as it uses the website links you provide."})," Please enter at least one URL to continue."]}),e.jsx("form",{onSubmit:U,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"personalWebsite",value:"Personal Website"}),e.jsx(f,{id:"personalWebsite",type:"url",className:"mt-1 block w-full",value:r.personalWebsite,onChange:t=>u("personalWebsite",t.target.value),placeholder:"https://yourwebsite.com"}),e.jsx(g,{message:m.personalWebsite,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"institutionalWebsite",value:"Institutional Website"}),e.jsx(f,{id:"institutionalWebsite",type:"url",className:"mt-1 block w-full",value:r.institutionalWebsite,onChange:t=>u("institutionalWebsite",t.target.value),placeholder:"https://university.edu/faculty/you"}),e.jsx(g,{message:m.institutionalWebsite,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"linkedinProfile",value:"LinkedIn Profile"}),e.jsx(f,{id:"linkedinProfile",type:"url",className:"mt-1 block w-full",value:r.linkedinProfile,onChange:t=>u("linkedinProfile",t.target.value),placeholder:"https://linkedin.com/in/yourprofile"}),e.jsx(g,{message:m.linkedinProfile,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"googleScholarProfile",value:"Google Scholar Profile"}),e.jsx(f,{id:"googleScholarProfile",type:"url",className:"mt-1 block w-full",value:r.googleScholarProfile,onChange:t=>u("googleScholarProfile",t.target.value),placeholder:"https://scholar.google.com/citations?user=..."}),e.jsx(g,{message:m.googleScholarProfile,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"researchgateProfile",value:"ResearchGate Profile"}),e.jsx(f,{id:"researchgateProfile",type:"url",className:"mt-1 block w-full",value:r.researchgateProfile,onChange:t=>u("researchgateProfile",t.target.value),placeholder:"https://www.researchgate.net/profile/..."}),e.jsx(g,{message:m.researchgateProfile,className:"mt-2"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsx("button",{type:"button",onClick:()=>h(null),className:"text-sm text-gray-600 hover:text-gray-900 underline",disabled:a,children:"Back"}),e.jsx(w,{type:"submit",disabled:a||!F(),className:"ml-4",children:a?"Processing...":"Generate Profile"})]})]})})]}):x==="cv"?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-gray-600 mb-6",children:[e.jsx("strong",{children:"CV-based profile generation can extract information directly from your resume."})," Please upload your CV to continue."]}),e.jsx("form",{onSubmit:A,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"cv_file",value:"Upload Your CV"}),e.jsx("input",{id:"cv_file",type:"file",className:"mt-1 block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none p-2",onChange:W,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.tiff",ref:v}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Supported formats: PDF, DOCX, DOC, JPEG, PNG, TIFF"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsx("button",{type:"button",onClick:()=>{h(null),S(null),v.current&&(v.current.value="")},className:"text-sm text-gray-600 hover:text-gray-900 underline",disabled:a,children:"Back"}),e.jsx(w,{type:"submit",disabled:a||!i,className:"ml-4",children:a?"Processing...":"Generate Profile"})]})]})})]}):null:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-600 mb-6 text-left md:text-center lg:text-center",children:"Nexscholar can use AI to help you create your profile. How would you like to proceed?"}),e.jsxs("div",{className:"space-y-4",children:[L&&e.jsxs("button",{onClick:()=>P("automatic"),className:"w-full p-4 border rounded-lg hover:bg-gray-50 flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-gray-800",children:"Generate with Automatic Search"}),e.jsx("span",{className:"text-sm text-gray-600 mt-1 text-left",children:"We'll search the web for your academic information based on your name and institution."})]}),E&&e.jsxs("button",{onClick:()=>P("url"),className:"w-full p-4 border rounded-lg hover:bg-gray-50 flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-gray-800",children:"Generate Using My Profile URLs"}),e.jsx("span",{className:"text-sm text-gray-600 mt-1 text-left",children:"Provide your academic profile URLs for more accurate results."})]}),e.jsxs("button",{onClick:()=>P("cv"),className:"w-full p-4 border rounded-lg hover:bg-gray-50 flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-gray-800",children:"Generate From My CV"}),e.jsx("span",{className:"text-sm text-gray-600 mt-1 text-left",children:"Upload your CV for us to extract information and generate your profile."})]}),e.jsxs("button",{onClick:D,className:"w-full p-4 border rounded-lg hover:bg-gray-50 flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-gray-800",children:"Skip AI Generation for Now"}),e.jsx("span",{className:"text-sm text-gray-600 mt-1 text-left",children:"You can always generate your profile later from your profile settings."})]})]})]})]})]})]})}export{q as default};
