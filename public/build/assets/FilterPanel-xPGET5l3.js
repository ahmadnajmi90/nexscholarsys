import{r as v,j as e}from"./app-BrV4mhB5.js";import{S as y}from"./react-select.esm-Dsb6ZDms.js";import{d as q,e as z}from"./index-BqZErKH1.js";import"./iconBase-CzEEOJe4.js";function H({searchType:l,searchResults:t,universities:$,faculties:U,researchOptions:S,skills:N,selectedArea:E,setSelectedArea:_,selectedUniversity:k,setSelectedUniversity:w,selectedAvailability:C,setSelectedAvailability:A,selectedSkills:p,setSelectedSkills:F,onClose:f=null,isOpen:g=!0,toggleOpen:n=null}){const[b,m]=v.useState(g),j=v.useRef(null);v.useEffect(()=>{function a(s){j.current&&!j.current.contains(s.target)&&window.innerWidth<1024&&(m(!1),n&&n(!1))}return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[n]),v.useEffect(()=>{m(g)},[g]);const c=(()=>{if(!t||!t.matches)return{researchAreas:[],universities:[],skills:[]};const a=new Set,s=new Set;t.matches.forEach(i=>{const r=i.academician||i.student||{},o=l==="supervisor"||l==="collaborators"&&i.result_type==="academician"?r.research_expertise:r.student_type==="postgraduate"?r.field_of_research:r.research_preference;Array.isArray(o)&&o.forEach(d=>{a.add(d)}),Array.isArray(r.skills)&&r.skills.forEach(d=>{d&&d.id&&s.add(d.id)})});const x=(Array.isArray(N)?N:[]).filter(i=>s.has(i.id)).map(i=>{let r=i.name;return i.subdomain&&i.subdomain.domain?r=`${i.subdomain.domain.name} - ${i.subdomain.name} - ${i.name}`:i.full_name?r=i.full_name:r=i.name,{value:i.id,label:r}}),h=Array.from(a).map(i=>{const r=S.find(o=>`${o.field_of_research_id}-${o.research_area_id}-${o.niche_domain_id}`===i);return r?{value:i,label:`${r.field_of_research_name} - ${r.research_area_name} - ${r.niche_domain_name}`}:{value:i,label:`${i}`}}),u=new Set;t.matches.forEach(i=>{const r=i.academician||i.student||{};r.university&&u.add(r.university.toString())});const M=Array.from(u).map(i=>{const r=$.find(o=>o.id.toString()===i);return{value:i,label:r?r.short_name:"Unknown University"}});return{researchAreas:h,universities:M,skills:x}})(),L=()=>{var a,s;if(l==="supervisor")return"Available for Supervision";if(l==="students")return"Looking for Supervision";if(l==="collaborators"){const x=(a=t==null?void 0:t.matches)==null?void 0:a.some(u=>u.result_type==="academician"),h=(s=t==null?void 0:t.matches)==null?void 0:s.some(u=>u.result_type!=="academician");return x&&!h?"Available for Collaboration":!x&&h?"Looking for Supervision":"Availability"}return"Availability"},P=e.jsx("div",{className:"fixed top-20 right-4 z-50 flex items-center space-x-4 lg:hidden",children:e.jsx("button",{onClick:()=>{m(!b),n&&n(!b)},className:"bg-blue-600 text-white p-2 rounded-full shadow-lg",children:e.jsx(z,{className:"text-xl"})})});return e.jsxs(e.Fragment,{children:[P,e.jsx("div",{ref:j,className:`fixed lg:relative top-0 left-0 lg:block lg:w-full w-3/4 h-full bg-white rounded-lg shadow-lg transition-transform duration-300 z-30 ${b?"translate-x-0":"-translate-x-full"} lg:translate-x-0 overflow-auto pb-20 lg:pb-0`,children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Filters"}),e.jsx("button",{onClick:()=>{m(!1),n&&n(!1),f&&f()},className:"text-gray-500 hover:text-gray-700 lg:hidden",children:e.jsx(q,{})})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Research Area"}),e.jsx(y,{isMulti:!0,name:"researchAreas",options:c.researchAreas,value:c.researchAreas.filter(a=>E.includes(a.value)),onChange:a=>_(a?a.map(s=>s.value):[]),placeholder:"Filter by research area...",className:"basic-multi-select",classNamePrefix:"select",isSearchable:!0})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"University"}),e.jsx(y,{isMulti:!0,name:"universities",options:c.universities,value:c.universities.filter(a=>k.includes(a.value)),onChange:a=>w(a?a.map(s=>s.value):[]),placeholder:"Filter by university...",className:"basic-multi-select",classNamePrefix:"select",isSearchable:!0})]}),(l==="students"||l==="collaborators")&&e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skills"}),e.jsx(y,{isMulti:!0,name:"skills",options:c.skills,value:c.skills.filter(a=>p==null?void 0:p.includes(a.value)),onChange:a=>F(a?a.map(s=>s.value):[]),placeholder:"Filter by skills...",className:"basic-multi-select",classNamePrefix:"select",isSearchable:!0})]}),l!=="collaborators"&&e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:L()}),e.jsxs("select",{className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 
                          focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm 
                          rounded-md`,value:C,onChange:a=>A(a.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"1",children:"Yes"}),e.jsx("option",{value:"0",children:"No"})]})]}),e.jsx("button",{className:`w-full mt-2 px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm 
                    font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none 
                    focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`,onClick:()=>{_([]),w([]),A(""),F([])},children:"Reset All Filters"})]})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 lg:hidden",onClick:()=>{m(!1),n&&n(!1),f&&f()}})]})}export{H as default};
